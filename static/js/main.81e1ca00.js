/*! For license information please see main.81e1ca00.js.LICENSE.txt */
!function(){var e={7276:function(e,t,i){var n=i(1588).default,r=i(3808).default,s=i(1655).default,a=i(6389).default,o=i(6690).default,l=i(9728).default,u=i(3515).default;!function(e){"use strict";function t(e){if(!e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];throw u(Error,i)}}function i(e,t){return void 0!==e?e:t}var h=1e37,c=1e-5,f=c*c,d=3.14159265359,m=2,_=8,p=.1,v=2,y=.008,g=2/180*d,x=2*y,b=8,w=32,A=1,S=.2,M=8/180*d,C=2,k=C*C,B=.5*d,V=B*B,T=.2,P=.75,L=-1,E=2147483647,I=.75,R=1,F=.25,G=.5,D=2,O=D*D,N=256,z=2.5,U=.5,j=.01,W=2/180*d;function q(e){return null}function H(e){}function X(e){}var J=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;o(this,e),this.major=0,this.minor=0,this.revision=0,this.major=t,this.minor=i,this.revision=n}return l(e,[{key:"toString",value:function(){return this.major+"."+this.minor+"."+this.revision}}]),e}(),Y=new J(2,3,2),Z="master",Q="fbf51801d80fc389d43dc46524520e89043b6faf";function K(e){return parseInt(e,10)}function $(e){return Math.abs(parseInt(e,10))}function ee(e,t){for(var i=[],n=0;n<e;++n)i.push(t(n));return i}function te(e){for(var t=[],i=0;i<e;++i)t.push(null);return t}function ie(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=[],n=0;n<e;++n)i.push(t);return i}var ne=d/180,re=180/d,se=2*d,ae=Math.abs,oe=Math.min,le=Math.max;function ue(e,t,i){return e<t?t:e>i?i:e}function he(e,t){var i=e[0];e[0]=t[0],t[0]=i}var ce=isFinite;function fe(e){return e*e}function de(e){return 1/Math.sqrt(e)}var me=Math.sqrt,_e=Math.pow;function pe(e){return e*ne}function ve(e){return e*re}var ye=Math.cos,ge=Math.sin,xe=Math.acos,be=Math.asin,we=Math.atan2;function Ae(e){return e|=e>>1&2147483647,e|=e>>2&1073741823,e|=e>>4&268435455,e|=e>>8&16777215,1+(e|=e>>16&65535)}function Se(e){return e>0&&0===(e&e-1)}function Me(){return 2*Math.random()-1}function Ce(e,t){return(t-e)*Math.random()+e}var ke=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;o(this,e),this.x=t,this.y=i}return l(e,[{key:"Clone",value:function(){return new e(this.x,this.y)}},{key:"SetZero",value:function(){return this.x=0,this.y=0,this}},{key:"Set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"Copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"SelfAdd",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"SelfAddXY",value:function(e,t){return this.x+=e,this.y+=t,this}},{key:"SelfSub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"SelfSubXY",value:function(e,t){return this.x-=e,this.y-=t,this}},{key:"SelfMul",value:function(e){return this.x*=e,this.y*=e,this}},{key:"SelfMulAdd",value:function(e,t){return this.x+=e*t.x,this.y+=e*t.y,this}},{key:"SelfMulSub",value:function(e,t){return this.x-=e*t.x,this.y-=e*t.y,this}},{key:"Dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"Cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"Length",value:function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}},{key:"LengthSquared",value:function(){var e=this.x,t=this.y;return e*e+t*t}},{key:"Normalize",value:function(){var e=this.Length();if(e>=c){var t=1/e;this.x*=t,this.y*=t}return e}},{key:"SelfNormalize",value:function(){var e=this.Length();if(e>=c){var t=1/e;this.x*=t,this.y*=t}return this}},{key:"SelfRotate",value:function(e){var t=Math.cos(e),i=Math.sin(e),n=this.x;return this.x=t*n-i*this.y,this.y=i*n+t*this.y,this}},{key:"IsValid",value:function(){return isFinite(this.x)&&isFinite(this.y)}},{key:"SelfCrossVS",value:function(e){var t=this.x;return this.x=e*this.y,this.y=-e*t,this}},{key:"SelfCrossSV",value:function(e){var t=this.x;return this.x=-e*this.y,this.y=e*t,this}},{key:"SelfMinV",value:function(e){return this.x=oe(this.x,e.x),this.y=oe(this.y,e.y),this}},{key:"SelfMaxV",value:function(e){return this.x=le(this.x,e.x),this.y=le(this.y,e.y),this}},{key:"SelfAbs",value:function(){return this.x=ae(this.x),this.y=ae(this.y),this}},{key:"SelfNeg",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"SelfSkew",value:function(){var e=this.x;return this.x=-this.y,this.y=e,this}}],[{key:"MakeArray",value:function(t){return ee(t,(function(t){return new e}))}},{key:"AbsV",value:function(e,t){return t.x=ae(e.x),t.y=ae(e.y),t}},{key:"MinV",value:function(e,t,i){return i.x=oe(e.x,t.x),i.y=oe(e.y,t.y),i}},{key:"MaxV",value:function(e,t,i){return i.x=le(e.x,t.x),i.y=le(e.y,t.y),i}},{key:"ClampV",value:function(e,t,i,n){return n.x=ue(e.x,t.x,i.x),n.y=ue(e.y,t.y,i.y),n}},{key:"RotateV",value:function(e,t,i){var n=e.x,r=e.y,s=Math.cos(t),a=Math.sin(t);return i.x=s*n-a*r,i.y=a*n+s*r,i}},{key:"DotVV",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"CrossVV",value:function(e,t){return e.x*t.y-e.y*t.x}},{key:"CrossVS",value:function(e,t,i){var n=e.x;return i.x=t*e.y,i.y=-t*n,i}},{key:"CrossVOne",value:function(e,t){var i=e.x;return t.x=e.y,t.y=-i,t}},{key:"CrossSV",value:function(e,t,i){var n=t.x;return i.x=-e*t.y,i.y=e*n,i}},{key:"CrossOneV",value:function(e,t){var i=e.x;return t.x=-e.y,t.y=i,t}},{key:"AddVV",value:function(e,t,i){return i.x=e.x+t.x,i.y=e.y+t.y,i}},{key:"SubVV",value:function(e,t,i){return i.x=e.x-t.x,i.y=e.y-t.y,i}},{key:"MulSV",value:function(e,t,i){return i.x=t.x*e,i.y=t.y*e,i}},{key:"MulVS",value:function(e,t,i){return i.x=e.x*t,i.y=e.y*t,i}},{key:"AddVMulSV",value:function(e,t,i,n){return n.x=e.x+t*i.x,n.y=e.y+t*i.y,n}},{key:"SubVMulSV",value:function(e,t,i,n){return n.x=e.x-t*i.x,n.y=e.y-t*i.y,n}},{key:"AddVCrossSV",value:function(e,t,i,n){var r=i.x;return n.x=e.x-t*i.y,n.y=e.y+t*r,n}},{key:"MidVV",value:function(e,t,i){return i.x=.5*(e.x+t.x),i.y=.5*(e.y+t.y),i}},{key:"ExtVV",value:function(e,t,i){return i.x=.5*(t.x-e.x),i.y=.5*(t.y-e.y),i}},{key:"IsEqualToV",value:function(e,t){return e.x===t.x&&e.y===t.y}},{key:"DistanceVV",value:function(e,t){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}},{key:"DistanceSquaredVV",value:function(e,t){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}},{key:"NegV",value:function(e,t){return t.x=-e.x,t.y=-e.y,t}}]),e}();ke.ZERO=new ke(0,0),ke.UNITX=new ke(1,0),ke.UNITY=new ke(0,1),ke.s_t0=new ke,ke.s_t1=new ke,ke.s_t2=new ke,ke.s_t3=new ke;var Be=new ke(0,0),Ve=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;o(this,e),this.x=t,this.y=i,this.z=n}return l(e,[{key:"Clone",value:function(){return new e(this.x,this.y,this.z)}},{key:"SetZero",value:function(){return this.x=0,this.y=0,this.z=0,this}},{key:"SetXYZ",value:function(e,t,i){return this.x=e,this.y=t,this.z=i,this}},{key:"Copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"SelfNeg",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"SelfAdd",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"SelfAddXYZ",value:function(e,t,i){return this.x+=e,this.y+=t,this.z+=i,this}},{key:"SelfSub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"SelfSubXYZ",value:function(e,t,i){return this.x-=e,this.y-=t,this.z-=i,this}},{key:"SelfMul",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}}],[{key:"DotV3V3",value:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}},{key:"CrossV3V3",value:function(e,t,i){var n=e.x,r=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return i.x=r*l-s*o,i.y=s*a-n*l,i.z=n*o-r*a,i}}]),e}();Ve.ZERO=new Ve(0,0,0),Ve.s_t0=new Ve;var Te=function(){function e(){o(this,e),this.ex=new ke(1,0),this.ey=new ke(0,1)}return l(e,[{key:"Clone",value:function(){return(new e).Copy(this)}},{key:"SetSSSS",value:function(e,t,i,n){return this.ex.Set(e,i),this.ey.Set(t,n),this}},{key:"SetVV",value:function(e,t){return this.ex.Copy(e),this.ey.Copy(t),this}},{key:"SetAngle",value:function(e){var t=Math.cos(e),i=Math.sin(e);return this.ex.Set(t,i),this.ey.Set(-i,t),this}},{key:"Copy",value:function(e){return this.ex.Copy(e.ex),this.ey.Copy(e.ey),this}},{key:"SetIdentity",value:function(){return this.ex.Set(1,0),this.ey.Set(0,1),this}},{key:"SetZero",value:function(){return this.ex.SetZero(),this.ey.SetZero(),this}},{key:"GetAngle",value:function(){return Math.atan2(this.ex.y,this.ex.x)}},{key:"GetInverse",value:function(e){var t=this.ex.x,i=this.ey.x,n=this.ex.y,r=this.ey.y,s=t*r-i*n;return 0!==s&&(s=1/s),e.ex.x=s*r,e.ey.x=-s*i,e.ex.y=-s*n,e.ey.y=s*t,e}},{key:"Solve",value:function(e,t,i){var n=this.ex.x,r=this.ey.x,s=this.ex.y,a=this.ey.y,o=n*a-r*s;return 0!==o&&(o=1/o),i.x=o*(a*e-r*t),i.y=o*(n*t-s*e),i}},{key:"SelfAbs",value:function(){return this.ex.SelfAbs(),this.ey.SelfAbs(),this}},{key:"SelfInv",value:function(){return this.GetInverse(this),this}},{key:"SelfAddM",value:function(e){return this.ex.SelfAdd(e.ex),this.ey.SelfAdd(e.ey),this}},{key:"SelfSubM",value:function(e){return this.ex.SelfSub(e.ex),this.ey.SelfSub(e.ey),this}}],[{key:"FromVV",value:function(t,i){return(new e).SetVV(t,i)}},{key:"FromSSSS",value:function(t,i,n,r){return(new e).SetSSSS(t,i,n,r)}},{key:"FromAngle",value:function(t){return(new e).SetAngle(t)}},{key:"AbsM",value:function(e,t){var i=e.ex,n=e.ey;return t.ex.x=ae(i.x),t.ex.y=ae(i.y),t.ey.x=ae(n.x),t.ey.y=ae(n.y),t}},{key:"MulMV",value:function(e,t,i){var n=e.ex,r=e.ey,s=t.x,a=t.y;return i.x=n.x*s+r.x*a,i.y=n.y*s+r.y*a,i}},{key:"MulTMV",value:function(e,t,i){var n=e.ex,r=e.ey,s=t.x,a=t.y;return i.x=n.x*s+n.y*a,i.y=r.x*s+r.y*a,i}},{key:"AddMM",value:function(e,t,i){var n=e.ex,r=e.ey,s=t.ex,a=t.ey;return i.ex.x=n.x+s.x,i.ex.y=n.y+s.y,i.ey.x=r.x+a.x,i.ey.y=r.y+a.y,i}},{key:"MulMM",value:function(e,t,i){var n=e.ex.x,r=e.ex.y,s=e.ey.x,a=e.ey.y,o=t.ex.x,l=t.ex.y,u=t.ey.x,h=t.ey.y;return i.ex.x=n*o+s*l,i.ex.y=r*o+a*l,i.ey.x=n*u+s*h,i.ey.y=r*u+a*h,i}},{key:"MulTMM",value:function(e,t,i){var n=e.ex.x,r=e.ex.y,s=e.ey.x,a=e.ey.y,o=t.ex.x,l=t.ex.y,u=t.ey.x,h=t.ey.y;return i.ex.x=n*o+r*l,i.ex.y=s*o+a*l,i.ey.x=n*u+r*h,i.ey.y=s*u+a*h,i}}]),e}();Te.IDENTITY=new Te;var Pe=function(){function e(){o(this,e),this.ex=new Ve(1,0,0),this.ey=new Ve(0,1,0),this.ez=new Ve(0,0,1)}return l(e,[{key:"Clone",value:function(){return(new e).Copy(this)}},{key:"SetVVV",value:function(e,t,i){return this.ex.Copy(e),this.ey.Copy(t),this.ez.Copy(i),this}},{key:"Copy",value:function(e){return this.ex.Copy(e.ex),this.ey.Copy(e.ey),this.ez.Copy(e.ez),this}},{key:"SetIdentity",value:function(){return this.ex.SetXYZ(1,0,0),this.ey.SetXYZ(0,1,0),this.ez.SetXYZ(0,0,1),this}},{key:"SetZero",value:function(){return this.ex.SetZero(),this.ey.SetZero(),this.ez.SetZero(),this}},{key:"SelfAddM",value:function(e){return this.ex.SelfAdd(e.ex),this.ey.SelfAdd(e.ey),this.ez.SelfAdd(e.ez),this}},{key:"Solve33",value:function(e,t,i,n){var r=this.ex.x,s=this.ex.y,a=this.ex.z,o=this.ey.x,l=this.ey.y,u=this.ey.z,h=this.ez.x,c=this.ez.y,f=this.ez.z,d=r*(l*f-u*c)+s*(u*h-o*f)+a*(o*c-l*h);return 0!==d&&(d=1/d),n.x=d*(e*(l*f-u*c)+t*(u*h-o*f)+i*(o*c-l*h)),n.y=d*(r*(t*f-i*c)+s*(i*h-e*f)+a*(e*c-t*h)),n.z=d*(r*(l*i-u*t)+s*(u*e-o*i)+a*(o*t-l*e)),n}},{key:"Solve22",value:function(e,t,i){var n=this.ex.x,r=this.ey.x,s=this.ex.y,a=this.ey.y,o=n*a-r*s;return 0!==o&&(o=1/o),i.x=o*(a*e-r*t),i.y=o*(n*t-s*e),i}},{key:"GetInverse22",value:function(e){var t=this.ex.x,i=this.ey.x,n=this.ex.y,r=this.ey.y,s=t*r-i*n;0!==s&&(s=1/s),e.ex.x=s*r,e.ey.x=-s*i,e.ex.z=0,e.ex.y=-s*n,e.ey.y=s*t,e.ey.z=0,e.ez.x=0,e.ez.y=0,e.ez.z=0}},{key:"GetSymInverse33",value:function(e){var t=Ve.DotV3V3(this.ex,Ve.CrossV3V3(this.ey,this.ez,Ve.s_t0));0!==t&&(t=1/t);var i=this.ex.x,n=this.ey.x,r=this.ez.x,s=this.ey.y,a=this.ez.y,o=this.ez.z;e.ex.x=t*(s*o-a*a),e.ex.y=t*(r*a-n*o),e.ex.z=t*(n*a-r*s),e.ey.x=e.ex.y,e.ey.y=t*(i*o-r*r),e.ey.z=t*(r*n-i*a),e.ez.x=e.ex.z,e.ez.y=e.ey.z,e.ez.z=t*(i*s-n*n)}}],[{key:"MulM33V3",value:function(e,t,i){var n=t.x,r=t.y,s=t.z;return i.x=e.ex.x*n+e.ey.x*r+e.ez.x*s,i.y=e.ex.y*n+e.ey.y*r+e.ez.y*s,i.z=e.ex.z*n+e.ey.z*r+e.ez.z*s,i}},{key:"MulM33XYZ",value:function(e,t,i,n,r){return r.x=e.ex.x*t+e.ey.x*i+e.ez.x*n,r.y=e.ex.y*t+e.ey.y*i+e.ez.y*n,r.z=e.ex.z*t+e.ey.z*i+e.ez.z*n,r}},{key:"MulM33V2",value:function(e,t,i){var n=t.x,r=t.y;return i.x=e.ex.x*n+e.ey.x*r,i.y=e.ex.y*n+e.ey.y*r,i}},{key:"MulM33XY",value:function(e,t,i,n){return n.x=e.ex.x*t+e.ey.x*i,n.y=e.ex.y*t+e.ey.y*i,n}}]),e}();Pe.IDENTITY=new Pe;var Le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;o(this,e),this.s=0,this.c=1,t&&(this.s=Math.sin(t),this.c=Math.cos(t))}return l(e,[{key:"Clone",value:function(){return(new e).Copy(this)}},{key:"Copy",value:function(e){return this.s=e.s,this.c=e.c,this}},{key:"SetAngle",value:function(e){return this.s=Math.sin(e),this.c=Math.cos(e),this}},{key:"SetIdentity",value:function(){return this.s=0,this.c=1,this}},{key:"GetAngle",value:function(){return Math.atan2(this.s,this.c)}},{key:"GetXAxis",value:function(e){return e.x=this.c,e.y=this.s,e}},{key:"GetYAxis",value:function(e){return e.x=-this.s,e.y=this.c,e}}],[{key:"MulRR",value:function(e,t,i){var n=e.c,r=e.s,s=t.c,a=t.s;return i.s=r*s+n*a,i.c=n*s-r*a,i}},{key:"MulTRR",value:function(e,t,i){var n=e.c,r=e.s,s=t.c,a=t.s;return i.s=n*a-r*s,i.c=n*s+r*a,i}},{key:"MulRV",value:function(e,t,i){var n=e.c,r=e.s,s=t.x,a=t.y;return i.x=n*s-r*a,i.y=r*s+n*a,i}},{key:"MulTRV",value:function(e,t,i){var n=e.c,r=e.s,s=t.x,a=t.y;return i.x=n*s+r*a,i.y=-r*s+n*a,i}}]),e}();Le.IDENTITY=new Le;var Ee=function(){function e(){o(this,e),this.p=new ke,this.q=new Le}return l(e,[{key:"Clone",value:function(){return(new e).Copy(this)}},{key:"Copy",value:function(e){return this.p.Copy(e.p),this.q.Copy(e.q),this}},{key:"SetIdentity",value:function(){return this.p.SetZero(),this.q.SetIdentity(),this}},{key:"SetPositionRotation",value:function(e,t){return this.p.Copy(e),this.q.Copy(t),this}},{key:"SetPositionAngle",value:function(e,t){return this.p.Copy(e),this.q.SetAngle(t),this}},{key:"SetPosition",value:function(e){return this.p.Copy(e),this}},{key:"SetPositionXY",value:function(e,t){return this.p.Set(e,t),this}},{key:"SetRotation",value:function(e){return this.q.Copy(e),this}},{key:"SetRotationAngle",value:function(e){return this.q.SetAngle(e),this}},{key:"GetPosition",value:function(){return this.p}},{key:"GetRotation",value:function(){return this.q}},{key:"GetRotationAngle",value:function(){return this.q.GetAngle()}},{key:"GetAngle",value:function(){return this.q.GetAngle()}}],[{key:"MulXV",value:function(e,t,i){var n=e.q.c,r=e.q.s,s=t.x,a=t.y;return i.x=n*s-r*a+e.p.x,i.y=r*s+n*a+e.p.y,i}},{key:"MulTXV",value:function(e,t,i){var n=e.q.c,r=e.q.s,s=t.x-e.p.x,a=t.y-e.p.y;return i.x=n*s+r*a,i.y=-r*s+n*a,i}},{key:"MulXX",value:function(e,t,i){return Le.MulRR(e.q,t.q,i.q),ke.AddVV(Le.MulRV(e.q,t.p,i.p),e.p,i.p),i}},{key:"MulTXX",value:function(e,t,i){return Le.MulTRR(e.q,t.q,i.q),Le.MulTRV(e.q,ke.SubVV(t.p,e.p,i.p),i.p),i}}]),e}();Ee.IDENTITY=new Ee;var Ie,Re=function(){function e(){o(this,e),this.localCenter=new ke,this.c0=new ke,this.c=new ke,this.a0=0,this.a=0,this.alpha0=0}return l(e,[{key:"Clone",value:function(){return(new e).Copy(this)}},{key:"Copy",value:function(e){return this.localCenter.Copy(e.localCenter),this.c0.Copy(e.c0),this.c.Copy(e.c),this.a0=e.a0,this.a=e.a,this.alpha0=e.alpha0,this}},{key:"GetTransform",value:function(e,t){var i=1-t;e.p.x=i*this.c0.x+t*this.c.x,e.p.y=i*this.c0.y+t*this.c.y;var n=i*this.a0+t*this.a;return e.q.SetAngle(n),e.p.SelfSub(Le.MulRV(e.q,this.localCenter,ke.s_t0)),e}},{key:"Advance",value:function(e){var t=(e-this.alpha0)/(1-this.alpha0),i=1-t;this.c0.x=i*this.c0.x+t*this.c.x,this.c0.y=i*this.c0.y+t*this.c.y,this.a0=i*this.a0+t*this.a,this.alpha0=e}},{key:"Normalize",value:function(){var e=se*Math.floor(this.a0/se);this.a0-=e,this.a-=e}}]),e}(),Fe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;o(this,e),this.r=t,this.g=i,this.b=n,this.a=r}return l(e,[{key:"Clone",value:function(){return(new e).Copy(this)}},{key:"Copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}},{key:"IsEqual",value:function(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}},{key:"IsZero",value:function(){return 0===this.r&&0===this.g&&0===this.b&&0===this.a}},{key:"Set",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.a;this.SetRGBA(e,t,i,n)}},{key:"SetByteRGB",value:function(e,t,i){return this.r=e/255,this.g=t/255,this.b=i/255,this}},{key:"SetByteRGBA",value:function(e,t,i,n){return this.r=e/255,this.g=t/255,this.b=i/255,this.a=n/255,this}},{key:"SetRGB",value:function(e,t,i){return this.r=e,this.g=t,this.b=i,this}},{key:"SetRGBA",value:function(e,t,i,n){return this.r=e,this.g=t,this.b=i,this.a=n,this}},{key:"SelfAdd",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}},{key:"Add",value:function(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,t.a=this.a+e.a,t}},{key:"SelfSub",value:function(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this.a-=e.a,this}},{key:"Sub",value:function(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t.a=this.a-e.a,t}},{key:"SelfMul",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}},{key:"Mul",value:function(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t.a=this.a*e,t}},{key:"Mix",value:function(t,i){e.MixColors(this,t,i)}},{key:"MakeStyleString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.a;return e.MakeStyleString(this.r,this.g,this.b,t)}}],[{key:"MixColors",value:function(e,t,i){var n=i*(t.r-e.r),r=i*(t.g-e.g),s=i*(t.b-e.b),a=i*(t.a-e.a);e.r+=n,e.g+=r,e.b+=s,e.a+=a,t.r-=n,t.g-=r,t.b-=s,t.a-=a}},{key:"MakeStyleString",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return e*=255,t*=255,i*=255,n<1?"rgba(".concat(e,",").concat(t,",").concat(i,",").concat(n,")"):"rgb(".concat(e,",").concat(t,",").concat(i,")")}}]),e}();Fe.ZERO=new Fe(0,0,0,0),Fe.RED=new Fe(1,0,0),Fe.GREEN=new Fe(0,1,0),Fe.BLUE=new Fe(0,0,1),(Ie=e.b2DrawFlags||(e.b2DrawFlags={}))[Ie.e_none=0]="e_none",Ie[Ie.e_shapeBit=1]="e_shapeBit",Ie[Ie.e_jointBit=2]="e_jointBit",Ie[Ie.e_aabbBit=4]="e_aabbBit",Ie[Ie.e_pairBit=8]="e_pairBit",Ie[Ie.e_centerOfMassBit=16]="e_centerOfMassBit",Ie[Ie.e_particleBit=32]="e_particleBit",Ie[Ie.e_controllerBit=64]="e_controllerBit",Ie[Ie.e_all=63]="e_all";var Ge=function(){function e(){o(this,e),this.m_drawFlags=0}return l(e,[{key:"SetFlags",value:function(e){this.m_drawFlags=e}},{key:"GetFlags",value:function(){return this.m_drawFlags}},{key:"AppendFlags",value:function(e){this.m_drawFlags|=e}},{key:"ClearFlags",value:function(e){this.m_drawFlags&=~e}}]),e}(),De=function(){function e(){o(this,e),this.m_start=Date.now()}return l(e,[{key:"Reset",value:function(){return this.m_start=Date.now(),this}},{key:"GetMilliseconds",value:function(){return Date.now()-this.m_start}}]),e}(),Oe=function(){function e(){o(this,e),this.m_count=0,this.m_min_count=0,this.m_max_count=0}return l(e,[{key:"GetCount",value:function(){return this.m_count}},{key:"GetMinCount",value:function(){return this.m_min_count}},{key:"GetMaxCount",value:function(){return this.m_max_count}},{key:"ResetCount",value:function(){var e=this.m_count;return this.m_count=0,e}},{key:"ResetMinCount",value:function(){this.m_min_count=0}},{key:"ResetMaxCount",value:function(){this.m_max_count=0}},{key:"Increment",value:function(){this.m_count++,this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)}},{key:"Decrement",value:function(){this.m_count--,this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)}}]),e}(),Ne=function(){function e(t){o(this,e),this.m_stack=[],this.m_count=0,this.m_stack=ee(t,(function(e){return null})),this.m_count=0}return l(e,[{key:"Reset",value:function(){return this.m_count=0,this}},{key:"Push",value:function(e){this.m_stack[this.m_count]=e,this.m_count++}},{key:"Pop",value:function(){this.m_count--;var e=this.m_stack[this.m_count];if(this.m_stack[this.m_count]=null,null===e)throw new Error;return e}},{key:"GetCount",value:function(){return this.m_count}}]),e}(),ze=l((function e(){o(this,e)})),Ue=l((function e(){o(this,e)})),je=function(){function e(){o(this,e),this.m_buffer=ke.MakeArray(2),this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0}return l(e,[{key:"Copy",value:function(e){return e.m_vertices===e.m_buffer?(this.m_vertices=this.m_buffer,this.m_buffer[0].Copy(e.m_buffer[0]),this.m_buffer[1].Copy(e.m_buffer[1])):this.m_vertices=e.m_vertices,this.m_count=e.m_count,this.m_radius=e.m_radius,this}},{key:"Reset",value:function(){return this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0,this}},{key:"SetShape",value:function(e,t){e.SetupDistanceProxy(this,t)}},{key:"SetVerticesRadius",value:function(e,t,i){this.m_vertices=e,this.m_count=t,this.m_radius=i}},{key:"GetSupport",value:function(e){for(var t=0,i=ke.DotVV(this.m_vertices[0],e),n=1;n<this.m_count;++n){var r=ke.DotVV(this.m_vertices[n],e);r>i&&(t=n,i=r)}return t}},{key:"GetSupportVertex",value:function(e){for(var t=0,i=ke.DotVV(this.m_vertices[0],e),n=1;n<this.m_count;++n){var r=ke.DotVV(this.m_vertices[n],e);r>i&&(t=n,i=r)}return this.m_vertices[t]}},{key:"GetVertexCount",value:function(){return this.m_count}},{key:"GetVertex",value:function(e){return this.m_vertices[e]}}]),e}(),We=function(){function e(){o(this,e),this.metric=0,this.count=0,this.indexA=[0,0,0],this.indexB=[0,0,0]}return l(e,[{key:"Reset",value:function(){return this.metric=0,this.count=0,this}}]),e}(),qe=function(){function e(){o(this,e),this.proxyA=new je,this.proxyB=new je,this.transformA=new Ee,this.transformB=new Ee,this.useRadii=!1}return l(e,[{key:"Reset",value:function(){return this.proxyA.Reset(),this.proxyB.Reset(),this.transformA.SetIdentity(),this.transformB.SetIdentity(),this.useRadii=!1,this}}]),e}(),He=function(){function e(){o(this,e),this.pointA=new ke,this.pointB=new ke,this.distance=0,this.iterations=0}return l(e,[{key:"Reset",value:function(){return this.pointA.SetZero(),this.pointB.SetZero(),this.distance=0,this.iterations=0,this}}]),e}(),Xe=l((function e(){o(this,e),this.proxyA=new je,this.proxyB=new je,this.transformA=new Ee,this.transformB=new Ee,this.translationB=new ke})),Je=l((function e(){o(this,e),this.point=new ke,this.normal=new ke,this.lambda=0,this.iterations=0}));function Ye(){e.b2_gjkCalls=0,e.b2_gjkIters=0,e.b2_gjkMaxIters=0}e.b2_gjkCalls=0,e.b2_gjkIters=0,e.b2_gjkMaxIters=0;var Ze=function(){function e(){o(this,e),this.wA=new ke,this.wB=new ke,this.w=new ke,this.a=0,this.indexA=0,this.indexB=0}return l(e,[{key:"Copy",value:function(e){return this.wA.Copy(e.wA),this.wB.Copy(e.wB),this.w.Copy(e.w),this.a=e.a,this.indexA=e.indexA,this.indexB=e.indexB,this}}]),e}(),Qe=function(){function e(){o(this,e),this.m_v1=new Ze,this.m_v2=new Ze,this.m_v3=new Ze,this.m_vertices=[],this.m_count=0,this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}return l(e,[{key:"ReadCache",value:function(e,t,i,n,r){this.m_count=e.count;for(var s=this.m_vertices,a=0;a<this.m_count;++a){var o=s[a];o.indexA=e.indexA[a],o.indexB=e.indexB[a];var l=t.GetVertex(o.indexA),u=n.GetVertex(o.indexB);Ee.MulXV(i,l,o.wA),Ee.MulXV(r,u,o.wB),ke.SubVV(o.wB,o.wA,o.w),o.a=0}if(this.m_count>1){var h=e.metric,f=this.GetMetric();(f<.5*h||2*h<f||f<c)&&(this.m_count=0)}if(0===this.m_count){var d=s[0];d.indexA=0,d.indexB=0;var m=t.GetVertex(0),_=n.GetVertex(0);Ee.MulXV(i,m,d.wA),Ee.MulXV(r,_,d.wB),ke.SubVV(d.wB,d.wA,d.w),d.a=1,this.m_count=1}}},{key:"WriteCache",value:function(e){e.metric=this.GetMetric(),e.count=this.m_count;for(var t=this.m_vertices,i=0;i<this.m_count;++i)e.indexA[i]=t[i].indexA,e.indexB[i]=t[i].indexB}},{key:"GetSearchDirection",value:function(e){switch(this.m_count){case 1:return ke.NegV(this.m_v1.w,e);case 2:var t=ke.SubVV(this.m_v2.w,this.m_v1.w,e);return ke.CrossVV(t,ke.NegV(this.m_v1.w,ke.s_t0))>0?ke.CrossOneV(t,e):ke.CrossVOne(t,e);default:return e.SetZero()}}},{key:"GetClosestPoint",value:function(e){switch(this.m_count){case 0:case 3:default:return e.SetZero();case 1:return e.Copy(this.m_v1.w);case 2:return e.Set(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y)}}},{key:"GetWitnessPoints",value:function(e,t){switch(this.m_count){case 0:default:break;case 1:e.Copy(this.m_v1.wA),t.Copy(this.m_v1.wB);break;case 2:e.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,e.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,t.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,t.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:t.x=e.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,t.y=e.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y}}},{key:"GetMetric",value:function(){switch(this.m_count){case 0:case 1:default:return 0;case 2:return ke.DistanceVV(this.m_v1.w,this.m_v2.w);case 3:return ke.CrossVV(ke.SubVV(this.m_v2.w,this.m_v1.w,ke.s_t0),ke.SubVV(this.m_v3.w,this.m_v1.w,ke.s_t1))}}},{key:"Solve2",value:function(){var t=this.m_v1.w,i=this.m_v2.w,n=ke.SubVV(i,t,e.s_e12),r=-ke.DotVV(t,n);if(r<=0)return this.m_v1.a=1,void(this.m_count=1);var s=ke.DotVV(i,n);if(s<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);var a=1/(s+r);this.m_v1.a=s*a,this.m_v2.a=r*a,this.m_count=2}},{key:"Solve3",value:function(){var t=this.m_v1.w,i=this.m_v2.w,n=this.m_v3.w,r=ke.SubVV(i,t,e.s_e12),s=ke.DotVV(t,r),a=ke.DotVV(i,r),o=-s,l=ke.SubVV(n,t,e.s_e13),u=ke.DotVV(t,l),h=ke.DotVV(n,l),c=-u,f=ke.SubVV(n,i,e.s_e23),d=ke.DotVV(i,f),m=ke.DotVV(n,f),_=-d,p=ke.CrossVV(r,l),v=p*ke.CrossVV(i,n),y=p*ke.CrossVV(n,t),g=p*ke.CrossVV(t,i);if(o<=0&&c<=0)return this.m_v1.a=1,void(this.m_count=1);if(a>0&&o>0&&g<=0){var x=1/(a+o);return this.m_v1.a=a*x,this.m_v2.a=o*x,void(this.m_count=2)}if(h>0&&c>0&&y<=0){var b=1/(h+c);return this.m_v1.a=h*b,this.m_v3.a=c*b,this.m_count=2,void this.m_v2.Copy(this.m_v3)}if(a<=0&&_<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);if(h<=0&&m<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v3);if(m>0&&_>0&&v<=0){var w=1/(m+_);return this.m_v2.a=m*w,this.m_v3.a=_*w,this.m_count=2,void this.m_v1.Copy(this.m_v3)}var A=1/(v+y+g);this.m_v1.a=v*A,this.m_v2.a=y*A,this.m_v3.a=g*A,this.m_count=3}}]),e}();Qe.s_e12=new ke,Qe.s_e13=new ke,Qe.s_e23=new ke;var Ke=new Qe,$e=[0,0,0],et=[0,0,0],tt=new ke,it=new ke,nt=new ke,rt=new ke,st=new ke;function at(t,i,n){++e.b2_gjkCalls;var r=n.proxyA,s=n.proxyB,a=n.transformA,o=n.transformB,l=Ke;l.ReadCache(i,r,a,s,o);for(var u=l.m_vertices,h=20,d=$e,m=et,_=0,p=0;p<h;){_=l.m_count;for(var v=0;v<_;++v)d[v]=u[v].indexA,m[v]=u[v].indexB;switch(l.m_count){case 1:default:break;case 2:l.Solve2();break;case 3:l.Solve3()}if(3===l.m_count)break;var y=l.GetSearchDirection(it);if(y.LengthSquared()<f)break;var g=u[l.m_count];g.indexA=r.GetSupport(Le.MulTRV(a.q,ke.NegV(y,ke.s_t0),rt)),Ee.MulXV(a,r.GetVertex(g.indexA),g.wA),g.indexB=s.GetSupport(Le.MulTRV(o.q,y,st)),Ee.MulXV(o,s.GetVertex(g.indexB),g.wB),ke.SubVV(g.wB,g.wA,g.w),++p,++e.b2_gjkIters;for(var x=!1,b=0;b<_;++b)if(g.indexA===d[b]&&g.indexB===m[b]){x=!0;break}if(x)break;++l.m_count}if(e.b2_gjkMaxIters=le(e.b2_gjkMaxIters,p),l.GetWitnessPoints(t.pointA,t.pointB),t.distance=ke.DistanceVV(t.pointA,t.pointB),t.iterations=p,l.WriteCache(i),n.useRadii){var w=r.m_radius,A=s.m_radius;if(t.distance>w+A&&t.distance>c){t.distance-=w+A;var S=ke.SubVV(t.pointB,t.pointA,nt);S.Normalize(),t.pointA.SelfMulAdd(w,S),t.pointB.SelfMulSub(A,S)}else{var M=ke.MidVV(t.pointA,t.pointB,tt);t.pointA.Copy(M),t.pointB.Copy(M),t.distance=0}}}var ot,lt=new ke,ut=new Qe,ht=new ke,ct=new ke,ft=new ke,dt=new ke,mt=new ke,_t=new ke;function pt(e,t){e.iterations=0,e.lambda=1,e.normal.SetZero(),e.point.SetZero();var i=t.proxyA,n=t.proxyB,r=le(i.m_radius,x)+le(n.m_radius,x),s=t.transformA,a=t.transformB,o=t.translationB,l=lt.Set(0,0),u=0,h=ut;h.m_count=0;for(var c=h.m_vertices,f=i.GetSupport(Le.MulTRV(s.q,ke.NegV(o,ke.s_t1),ke.s_t0)),d=Ee.MulXV(s,i.GetVertex(f),ht),m=n.GetSupport(Le.MulTRV(a.q,o,ke.s_t0)),_=Ee.MulXV(a,n.GetVertex(m),ct),p=ke.SubVV(d,_,ft),v=le(x,r-x),g=.5*y,b=20,w=0;w<b&&ae(p.Length()-v)>g;){e.iterations+=1,f=i.GetSupport(Le.MulTRV(s.q,ke.NegV(p,ke.s_t1),ke.s_t0)),d=Ee.MulXV(s,i.GetVertex(f),ht),m=n.GetSupport(Le.MulTRV(a.q,p,ke.s_t0)),_=Ee.MulXV(a,n.GetVertex(m),ct);var A=ke.SubVV(d,_,dt);p.Normalize();var S=ke.DotVV(p,A),M=ke.DotVV(p,o);if(S-v>u*M){if(M<=0)return!1;if((u=(S-v)/M)>1)return!1;l.Copy(p).SelfNeg(),h.m_count=0}var C=c[h.m_count];switch(C.indexA=m,C.wA.Copy(_).SelfMulAdd(u,o),C.indexB=f,C.wB.Copy(d),C.w.Copy(C.wB).SelfSub(C.wA),C.a=1,h.m_count+=1,h.m_count){case 1:break;case 2:h.Solve2();break;case 3:h.Solve3()}if(3===h.m_count)return!1;h.GetClosestPoint(p),++w}var k=mt,B=_t;return h.GetWitnessPoints(k,B),p.LengthSquared()>0&&(l.Copy(p).SelfNeg(),l.Normalize()),e.normal.Copy(l),e.lambda=u,e.iterations=w,!0}(ot=e.b2ContactFeatureType||(e.b2ContactFeatureType={}))[ot.e_vertex=0]="e_vertex",ot[ot.e_face=1]="e_face";var vt,yt=function(){function e(){o(this,e),this._key=0,this._key_invalid=!1,this._indexA=0,this._indexB=0,this._typeA=0,this._typeB=0}return l(e,[{key:"key",get:function(){return this._key_invalid&&(this._key_invalid=!1,this._key=this._indexA|this._indexB<<8|this._typeA<<16|this._typeB<<24),this._key},set:function(e){this._key=e,this._key_invalid=!1,this._indexA=255&this._key,this._indexB=this._key>>8&255,this._typeA=this._key>>16&255,this._typeB=this._key>>24&255}},{key:"indexA",get:function(){return this._indexA},set:function(e){this._indexA=e,this._key_invalid=!0}},{key:"indexB",get:function(){return this._indexB},set:function(e){this._indexB=e,this._key_invalid=!0}},{key:"typeA",get:function(){return this._typeA},set:function(e){this._typeA=e,this._key_invalid=!0}},{key:"typeB",get:function(){return this._typeB},set:function(e){this._typeB=e,this._key_invalid=!0}}]),e}(),gt=function(){function e(){o(this,e),this.cf=new yt}return l(e,[{key:"Copy",value:function(e){return this.key=e.key,this}},{key:"Clone",value:function(){return(new e).Copy(this)}},{key:"key",get:function(){return this.cf.key},set:function(e){this.cf.key=e}}]),e}(),xt=function(){function e(){o(this,e),this.localPoint=new ke,this.normalImpulse=0,this.tangentImpulse=0,this.id=new gt}return l(e,[{key:"Reset",value:function(){this.localPoint.SetZero(),this.normalImpulse=0,this.tangentImpulse=0,this.id.key=0}},{key:"Copy",value:function(e){return this.localPoint.Copy(e.localPoint),this.normalImpulse=e.normalImpulse,this.tangentImpulse=e.tangentImpulse,this.id.Copy(e.id),this}}],[{key:"MakeArray",value:function(t){return ee(t,(function(t){return new e}))}}]),e}();(vt=e.b2ManifoldType||(e.b2ManifoldType={}))[vt.e_unknown=-1]="e_unknown",vt[vt.e_circles=0]="e_circles",vt[vt.e_faceA=1]="e_faceA",vt[vt.e_faceB=2]="e_faceB";var bt,wt=function(){function t(){o(this,t),this.points=xt.MakeArray(m),this.localNormal=new ke,this.localPoint=new ke,this.type=e.b2ManifoldType.e_unknown,this.pointCount=0}return l(t,[{key:"Reset",value:function(){for(var t=0;t<m;++t)this.points[t].Reset();this.localNormal.SetZero(),this.localPoint.SetZero(),this.type=e.b2ManifoldType.e_unknown,this.pointCount=0}},{key:"Copy",value:function(e){this.pointCount=e.pointCount;for(var t=0;t<m;++t)this.points[t].Copy(e.points[t]);return this.localNormal.Copy(e.localNormal),this.localPoint.Copy(e.localPoint),this.type=e.type,this}},{key:"Clone",value:function(){return(new t).Copy(this)}}]),t}(),At=function(){function t(){o(this,t),this.normal=new ke,this.points=ke.MakeArray(m),this.separations=ie(m)}return l(t,[{key:"Initialize",value:function(i,n,r,s,a){if(0!==i.pointCount)switch(i.type){case e.b2ManifoldType.e_circles:this.normal.Set(1,0);var o=Ee.MulXV(n,i.localPoint,t.Initialize_s_pointA),l=Ee.MulXV(s,i.points[0].localPoint,t.Initialize_s_pointB);ke.DistanceSquaredVV(o,l)>f&&ke.SubVV(l,o,this.normal).SelfNormalize();var u=ke.AddVMulSV(o,r,this.normal,t.Initialize_s_cA),h=ke.SubVMulSV(l,a,this.normal,t.Initialize_s_cB);ke.MidVV(u,h,this.points[0]),this.separations[0]=ke.DotVV(ke.SubVV(h,u,ke.s_t0),this.normal);break;case e.b2ManifoldType.e_faceA:Le.MulRV(n.q,i.localNormal,this.normal);for(var c=Ee.MulXV(n,i.localPoint,t.Initialize_s_planePoint),d=0;d<i.pointCount;++d){var m=Ee.MulXV(s,i.points[d].localPoint,t.Initialize_s_clipPoint),_=r-ke.DotVV(ke.SubVV(m,c,ke.s_t0),this.normal),p=ke.AddVMulSV(m,_,this.normal,t.Initialize_s_cA),v=ke.SubVMulSV(m,a,this.normal,t.Initialize_s_cB);ke.MidVV(p,v,this.points[d]),this.separations[d]=ke.DotVV(ke.SubVV(v,p,ke.s_t0),this.normal)}break;case e.b2ManifoldType.e_faceB:Le.MulRV(s.q,i.localNormal,this.normal);for(var y=Ee.MulXV(s,i.localPoint,t.Initialize_s_planePoint),g=0;g<i.pointCount;++g){var x=Ee.MulXV(n,i.points[g].localPoint,t.Initialize_s_clipPoint),b=a-ke.DotVV(ke.SubVV(x,y,ke.s_t0),this.normal),w=ke.AddVMulSV(x,b,this.normal,t.Initialize_s_cB),A=ke.SubVMulSV(x,r,this.normal,t.Initialize_s_cA);ke.MidVV(A,w,this.points[g]),this.separations[g]=ke.DotVV(ke.SubVV(A,w,ke.s_t0),this.normal)}this.normal.SelfNeg()}}}]),t}();function St(t,i,n,r){var s;for(s=0;s<n.pointCount;++s){var a=n.points[s].id.key;t[s]=e.b2PointState.b2_removeState;for(var o=0,l=r.pointCount;o<l;++o)if(r.points[o].id.key===a){t[s]=e.b2PointState.b2_persistState;break}}for(;s<m;++s)t[s]=e.b2PointState.b2_nullState;for(s=0;s<r.pointCount;++s){var u=r.points[s].id.key;i[s]=e.b2PointState.b2_addState;for(var h=0,c=n.pointCount;h<c;++h)if(n.points[h].id.key===u){i[s]=e.b2PointState.b2_persistState;break}}for(;s<m;++s)i[s]=e.b2PointState.b2_nullState}At.Initialize_s_pointA=new ke,At.Initialize_s_pointB=new ke,At.Initialize_s_cA=new ke,At.Initialize_s_cB=new ke,At.Initialize_s_planePoint=new ke,At.Initialize_s_clipPoint=new ke,(bt=e.b2PointState||(e.b2PointState={}))[bt.b2_nullState=0]="b2_nullState",bt[bt.b2_addState=1]="b2_addState",bt[bt.b2_persistState=2]="b2_persistState",bt[bt.b2_removeState=3]="b2_removeState";var Mt=function(){function e(){o(this,e),this.v=new ke,this.id=new gt}return l(e,[{key:"Copy",value:function(e){return this.v.Copy(e.v),this.id.Copy(e.id),this}}],[{key:"MakeArray",value:function(t){return ee(t,(function(t){return new e}))}}]),e}(),Ct=function(){function e(){o(this,e),this.p1=new ke,this.p2=new ke,this.maxFraction=1}return l(e,[{key:"Copy",value:function(e){return this.p1.Copy(e.p1),this.p2.Copy(e.p2),this.maxFraction=e.maxFraction,this}}]),e}(),kt=function(){function e(){o(this,e),this.normal=new ke,this.fraction=0}return l(e,[{key:"Copy",value:function(e){return this.normal.Copy(e.normal),this.fraction=e.fraction,this}}]),e}(),Bt=function(){function e(){o(this,e),this.lowerBound=new ke,this.upperBound=new ke,this.m_cache_center=new ke,this.m_cache_extent=new ke}return l(e,[{key:"Copy",value:function(e){return this.lowerBound.Copy(e.lowerBound),this.upperBound.Copy(e.upperBound),this}},{key:"IsValid",value:function(){var e=this.upperBound.x-this.lowerBound.x,t=this.upperBound.y-this.lowerBound.y,i=e>=0&&t>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()}},{key:"GetCenter",value:function(){return ke.MidVV(this.lowerBound,this.upperBound,this.m_cache_center)}},{key:"GetExtents",value:function(){return ke.ExtVV(this.lowerBound,this.upperBound,this.m_cache_extent)}},{key:"GetPerimeter",value:function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))}},{key:"Combine1",value:function(e){return this.lowerBound.x=oe(this.lowerBound.x,e.lowerBound.x),this.lowerBound.y=oe(this.lowerBound.y,e.lowerBound.y),this.upperBound.x=le(this.upperBound.x,e.upperBound.x),this.upperBound.y=le(this.upperBound.y,e.upperBound.y),this}},{key:"Combine2",value:function(e,t){return this.lowerBound.x=oe(e.lowerBound.x,t.lowerBound.x),this.lowerBound.y=oe(e.lowerBound.y,t.lowerBound.y),this.upperBound.x=le(e.upperBound.x,t.upperBound.x),this.upperBound.y=le(e.upperBound.y,t.upperBound.y),this}},{key:"Contains",value:function(e){var t=!0;return t=(t=(t=(t=t&&this.lowerBound.x<=e.lowerBound.x)&&this.lowerBound.y<=e.lowerBound.y)&&e.upperBound.x<=this.upperBound.x)&&e.upperBound.y<=this.upperBound.y}},{key:"RayCast",value:function(e,t){var i=-h,n=h,r=t.p1.x,s=t.p1.y,a=t.p2.x-t.p1.x,o=t.p2.y-t.p1.y,l=ae(a),u=ae(o),f=e.normal;if(l<c){if(r<this.lowerBound.x||this.upperBound.x<r)return!1}else{var d=1/a,m=(this.lowerBound.x-r)*d,_=(this.upperBound.x-r)*d,p=-1;if(m>_){var v=m;m=_,_=v,p=1}if(m>i&&(f.x=p,f.y=0,i=m),i>(n=oe(n,_)))return!1}if(u<c){if(s<this.lowerBound.y||this.upperBound.y<s)return!1}else{var y=1/o,g=(this.lowerBound.y-s)*y,x=(this.upperBound.y-s)*y,b=-1;if(g>x){var w=g;g=x,x=w,b=1}if(g>i&&(f.x=0,f.y=b,i=g),i>(n=oe(n,x)))return!1}return!(i<0||t.maxFraction<i)&&(e.fraction=i,!0)}},{key:"TestContain",value:function(e){return!(e.x<this.lowerBound.x||this.upperBound.x<e.x)&&!(e.y<this.lowerBound.y||this.upperBound.y<e.y)}},{key:"TestOverlap",value:function(e){var t=e.lowerBound.x-this.upperBound.x,i=e.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-e.upperBound.x,r=this.lowerBound.y-e.upperBound.y;return!(t>0||i>0)&&!(n>0||r>0)}}],[{key:"Combine",value:function(e,t,i){return i.Combine2(e,t),i}}]),e}();function Vt(e,t){var i=t.lowerBound.x-e.upperBound.x,n=t.lowerBound.y-e.upperBound.y,r=e.lowerBound.x-t.upperBound.x,s=e.lowerBound.y-t.upperBound.y;return!(i>0||n>0)&&!(r>0||s>0)}function Tt(t,i,n,r,s){var a=0,o=i[0],l=i[1],u=ke.DotVV(n,o.v)-r,h=ke.DotVV(n,l.v)-r;if(u<=0&&t[a++].Copy(o),h<=0&&t[a++].Copy(l),u*h<0){var c=u/(u-h),f=t[a].v;f.x=o.v.x+c*(l.v.x-o.v.x),f.y=o.v.y+c*(l.v.y-o.v.y);var d=t[a].id;d.cf.indexA=s,d.cf.indexB=o.id.cf.indexB,d.cf.typeA=e.b2ContactFeatureType.e_vertex,d.cf.typeB=e.b2ContactFeatureType.e_face,++a}return a}var Pt=new qe,Lt=new We,Et=new He;function It(e,t,i,n,r,s){var a=Pt.Reset();a.proxyA.SetShape(e,t),a.proxyB.SetShape(i,n),a.transformA.Copy(r),a.transformB.Copy(s),a.useRadii=!0;var o=Lt.Reset();o.count=0;var l=Et.Reset();return at(l,o,a),l.distance<10*c}function Rt(e){if(null===e)throw new Error;return e}var Ft=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;o(this,e),this.m_id=0,this.aabb=new Bt,this.parent=null,this.child1=null,this.child2=null,this.height=0,this.m_id=t}return l(e,[{key:"IsLeaf",value:function(){return null===this.child1}}]),e}(),Gt=function(){function e(){o(this,e),this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0,this.m_stack=new Ne(256)}return l(e,[{key:"Query",value:function(e,t){if(null!==this.m_root){var i=this.m_stack.Reset();for(i.Push(this.m_root);i.GetCount()>0;){var n=i.Pop();if(n.aabb.TestOverlap(e))if(n.IsLeaf()){if(!t(n))return}else i.Push(Rt(n.child1)),i.Push(Rt(n.child2))}}}},{key:"QueryPoint",value:function(e,t){if(null!==this.m_root){var i=this.m_stack.Reset();for(i.Push(this.m_root);i.GetCount()>0;){var n=i.Pop();if(n.aabb.TestContain(e))if(n.IsLeaf()){if(!t(n))return}else i.Push(Rt(n.child1)),i.Push(Rt(n.child2))}}}},{key:"RayCast",value:function(t,i){if(null!==this.m_root){var n=t.p1,r=t.p2,s=ke.SubVV(r,n,e.s_r);s.Normalize();var a=ke.CrossOneV(s,e.s_v),o=ke.AbsV(a,e.s_abs_v),l=t.maxFraction,u=e.s_segmentAABB,h=n.x+l*(r.x-n.x),c=n.y+l*(r.y-n.y);u.lowerBound.x=oe(n.x,h),u.lowerBound.y=oe(n.y,c),u.upperBound.x=le(n.x,h),u.upperBound.y=le(n.y,c);var f=this.m_stack.Reset();for(f.Push(this.m_root);f.GetCount()>0;){var d=f.Pop();if(Vt(d.aabb,u)){var m=d.aabb.GetCenter(),_=d.aabb.GetExtents();if(!(ae(ke.DotVV(a,ke.SubVV(n,m,ke.s_t0)))-ke.DotVV(o,_)>0))if(d.IsLeaf()){var p=e.s_subInput;p.p1.Copy(t.p1),p.p2.Copy(t.p2),p.maxFraction=l;var v=i(p,d);if(0===v)return;v>0&&(l=v,h=n.x+l*(r.x-n.x),c=n.y+l*(r.y-n.y),u.lowerBound.x=oe(n.x,h),u.lowerBound.y=oe(n.y,c),u.upperBound.x=le(n.x,h),u.upperBound.y=le(n.y,c))}else f.Push(Rt(d.child1)),f.Push(Rt(d.child2))}}}}},{key:"AllocateNode",value:function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t.height=0,delete t.userData,t}return new Ft(e.s_node_id++)}},{key:"FreeNode",value:function(e){e.parent=this.m_freeList,e.child1=null,e.child2=null,e.height=-1,delete e.userData,this.m_freeList=e}},{key:"CreateProxy",value:function(e,t){var i=this.AllocateNode(),n=p,r=p;return i.aabb.lowerBound.x=e.lowerBound.x-n,i.aabb.lowerBound.y=e.lowerBound.y-r,i.aabb.upperBound.x=e.upperBound.x+n,i.aabb.upperBound.y=e.upperBound.y+r,i.userData=t,i.height=0,this.InsertLeaf(i),i}},{key:"DestroyProxy",value:function(e){this.RemoveLeaf(e),this.FreeNode(e)}},{key:"MoveProxy",value:function(e,t,i){if(e.aabb.Contains(t))return!1;this.RemoveLeaf(e);var n=p+v*(i.x>0?i.x:-i.x),r=p+v*(i.y>0?i.y:-i.y);return e.aabb.lowerBound.x=t.lowerBound.x-n,e.aabb.lowerBound.y=t.lowerBound.y-r,e.aabb.upperBound.x=t.upperBound.x+n,e.aabb.upperBound.y=t.upperBound.y+r,this.InsertLeaf(e),!0}},{key:"InsertLeaf",value:function(t){if(++this.m_insertionCount,null===this.m_root)return this.m_root=t,void(this.m_root.parent=null);for(var i=t.aabb,n=this.m_root;!n.IsLeaf();){var r=Rt(n.child1),s=Rt(n.child2),a=n.aabb.GetPerimeter(),o=e.s_combinedAABB;o.Combine2(n.aabb,i);var l=o.GetPerimeter(),u=2*l,h=2*(l-a),c=void 0,f=e.s_aabb,d=void 0;r.IsLeaf()?(f.Combine2(i,r.aabb),c=f.GetPerimeter()+h):(f.Combine2(i,r.aabb),d=r.aabb.GetPerimeter(),c=f.GetPerimeter()-d+h);var m=void 0;if(s.IsLeaf()?(f.Combine2(i,s.aabb),m=f.GetPerimeter()+h):(f.Combine2(i,s.aabb),d=s.aabb.GetPerimeter(),m=f.GetPerimeter()-d+h),u<c&&u<m)break;n=c<m?r:s}var _=n,p=_.parent,v=this.AllocateNode();v.parent=p,delete v.userData,v.aabb.Combine2(i,_.aabb),v.height=_.height+1,p?(p.child1===_?p.child1=v:p.child2=v,v.child1=_,v.child2=t,_.parent=v,t.parent=v):(v.child1=_,v.child2=t,_.parent=v,t.parent=v,this.m_root=v);for(var y=t.parent;null!==y;){var g=Rt((y=this.Balance(y)).child1),x=Rt(y.child2);y.height=1+le(g.height,x.height),y.aabb.Combine2(g.aabb,x.aabb),y=y.parent}}},{key:"RemoveLeaf",value:function(e){if(e!==this.m_root){var t,i=Rt(e.parent),n=i&&i.parent;if(t=i.child1===e?Rt(i.child2):Rt(i.child1),n){n.child1===i?n.child1=t:n.child2=t,t.parent=n,this.FreeNode(i);for(var r=n;r;){var s=Rt((r=this.Balance(r)).child1),a=Rt(r.child2);r.aabb.Combine2(s.aabb,a.aabb),r.height=1+le(s.height,a.height),r=r.parent}}else this.m_root=t,t.parent=null,this.FreeNode(i)}else this.m_root=null}},{key:"Balance",value:function(e){if(e.IsLeaf()||e.height<2)return e;var t=Rt(e.child1),i=Rt(e.child2),n=i.height-t.height;if(n>1){var r=Rt(i.child1),s=Rt(i.child2);return i.child1=e,i.parent=e.parent,e.parent=i,null!==i.parent?i.parent.child1===e?i.parent.child1=i:i.parent.child2=i:this.m_root=i,r.height>s.height?(i.child2=r,e.child2=s,s.parent=e,e.aabb.Combine2(t.aabb,s.aabb),i.aabb.Combine2(e.aabb,r.aabb),e.height=1+le(t.height,s.height),i.height=1+le(e.height,r.height)):(i.child2=s,e.child2=r,r.parent=e,e.aabb.Combine2(t.aabb,r.aabb),i.aabb.Combine2(e.aabb,s.aabb),e.height=1+le(t.height,r.height),i.height=1+le(e.height,s.height)),i}if(n<-1){var a=Rt(t.child1),o=Rt(t.child2);return t.child1=e,t.parent=e.parent,e.parent=t,null!==t.parent?t.parent.child1===e?t.parent.child1=t:t.parent.child2=t:this.m_root=t,a.height>o.height?(t.child2=a,e.child1=o,o.parent=e,e.aabb.Combine2(i.aabb,o.aabb),t.aabb.Combine2(e.aabb,a.aabb),e.height=1+le(i.height,o.height),t.height=1+le(e.height,a.height)):(t.child2=o,e.child1=a,a.parent=e,e.aabb.Combine2(i.aabb,a.aabb),t.aabb.Combine2(e.aabb,o.aabb),e.height=1+le(i.height,a.height),t.height=1+le(e.height,o.height)),t}return e}},{key:"GetHeight",value:function(){return null===this.m_root?0:this.m_root.height}},{key:"GetAreaRatio",value:function(){if(null===this.m_root)return 0;var t=this.m_root.aabb.GetPerimeter();return e.GetAreaNode(this.m_root)/t}},{key:"ComputeHeightNode",value:function(e){if(!e||e.IsLeaf())return 0;var t=this.ComputeHeightNode(e.child1),i=this.ComputeHeightNode(e.child2);return 1+le(t,i)}},{key:"ComputeHeight",value:function(){return this.ComputeHeightNode(this.m_root)}},{key:"ValidateStructure",value:function(e){if(null!==e){this.m_root;var t=e;if(!t.IsLeaf()){var i=Rt(t.child1),n=Rt(t.child2);this.ValidateStructure(i),this.ValidateStructure(n)}}}},{key:"ValidateMetrics",value:function(t){if(null!==t){var i=t;if(!i.IsLeaf()){var n=Rt(i.child1),r=Rt(i.child2);e.s_aabb.Combine2(n.aabb,r.aabb),this.ValidateMetrics(n),this.ValidateMetrics(r)}}}},{key:"Validate",value:function(){}},{key:"GetMaxBalance",value:function(){return e.GetMaxBalanceNode(this.m_root,0)}},{key:"RebuildBottomUp",value:function(){this.Validate()}},{key:"ShiftOrigin",value:function(t){e.ShiftOriginNode(this.m_root,t)}}],[{key:"GetAreaNode",value:function(t){if(null===t)return 0;if(t.IsLeaf())return 0;var i=t.aabb.GetPerimeter();return i+=e.GetAreaNode(t.child1),i+=e.GetAreaNode(t.child2)}},{key:"GetMaxBalanceNode",value:function(e,t){if(null===e)return t;if(e.height<=1)return t;var i=Rt(e.child1),n=Rt(e.child2),r=ae(n.height-i.height);return le(t,r)}},{key:"ShiftOriginNode",value:function(t,i){if(null!==t&&!(t.height<=1)){var n=t.child1,r=t.child2;e.ShiftOriginNode(n,i),e.ShiftOriginNode(r,i),t.aabb.lowerBound.SelfSub(i),t.aabb.upperBound.SelfSub(i)}}}]),e}();Gt.s_r=new ke,Gt.s_v=new ke,Gt.s_abs_v=new ke,Gt.s_segmentAABB=new Bt,Gt.s_subInput=new Ct,Gt.s_combinedAABB=new Bt,Gt.s_aabb=new Bt,Gt.s_node_id=0;var Dt=l((function e(t,i){o(this,e),this.proxyA=t,this.proxyB=i})),Ot=function(){function e(){o(this,e),this.m_tree=new Gt,this.m_proxyCount=0,this.m_moveCount=0,this.m_moveBuffer=[],this.m_pairCount=0,this.m_pairBuffer=[]}return l(e,[{key:"CreateProxy",value:function(e,t){var i=this.m_tree.CreateProxy(e,t);return++this.m_proxyCount,this.BufferMove(i),i}},{key:"DestroyProxy",value:function(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)}},{key:"MoveProxy",value:function(e,t,i){this.m_tree.MoveProxy(e,t,i)&&this.BufferMove(e)}},{key:"TouchProxy",value:function(e){this.BufferMove(e)}},{key:"GetProxyCount",value:function(){return this.m_proxyCount}},{key:"UpdatePairs",value:function(e){var t=this;this.m_pairCount=0;for(var i=function(e){var i=t.m_moveBuffer[e];if(null===i)return"continue";var n=i.aabb;t.m_tree.Query(n,(function(e){if(e.m_id===i.m_id)return!0;var n,r;if(e.m_id<i.m_id?(n=e,r=i):(n=i,r=e),t.m_pairCount===t.m_pairBuffer.length)t.m_pairBuffer[t.m_pairCount]=new Dt(n,r);else{var s=t.m_pairBuffer[t.m_pairCount];s.proxyA=n,s.proxyB=r}return++t.m_pairCount,!0}))},n=0;n<this.m_moveCount;++n)i(n);this.m_moveCount=0,this.m_pairBuffer.length=this.m_pairCount,this.m_pairBuffer.sort(Nt);for(var r=0;r<this.m_pairCount;){var s=this.m_pairBuffer[r];for(e(s.proxyA.userData,s.proxyB.userData),++r;r<this.m_pairCount;){var a=this.m_pairBuffer[r];if(a.proxyA.m_id!==s.proxyA.m_id||a.proxyB.m_id!==s.proxyB.m_id)break;++r}}}},{key:"Query",value:function(e,t){this.m_tree.Query(e,t)}},{key:"QueryPoint",value:function(e,t){this.m_tree.QueryPoint(e,t)}},{key:"RayCast",value:function(e,t){this.m_tree.RayCast(e,t)}},{key:"GetTreeHeight",value:function(){return this.m_tree.GetHeight()}},{key:"GetTreeBalance",value:function(){return this.m_tree.GetMaxBalance()}},{key:"GetTreeQuality",value:function(){return this.m_tree.GetAreaRatio()}},{key:"ShiftOrigin",value:function(e){this.m_tree.ShiftOrigin(e)}},{key:"BufferMove",value:function(e){this.m_moveBuffer[this.m_moveCount]=e,++this.m_moveCount}},{key:"UnBufferMove",value:function(e){var t=this.m_moveBuffer.indexOf(e);this.m_moveBuffer[t]=null}}]),e}();function Nt(e,t){return e.proxyA.m_id===t.proxyA.m_id?e.proxyB.m_id-t.proxyB.m_id:e.proxyA.m_id-t.proxyA.m_id}function zt(){e.b2_toiTime=0,e.b2_toiMaxTime=0,e.b2_toiCalls=0,e.b2_toiIters=0,e.b2_toiMaxIters=0,e.b2_toiRootIters=0,e.b2_toiMaxRootIters=0}e.b2_toiTime=0,e.b2_toiMaxTime=0,e.b2_toiCalls=0,e.b2_toiIters=0,e.b2_toiMaxIters=0,e.b2_toiRootIters=0,e.b2_toiMaxRootIters=0;var Ut,jt=new Ee,Wt=new Ee,qt=new ke,Ht=new ke,Xt=new ke,Jt=new ke,Yt=new ke,Zt=l((function e(){o(this,e),this.proxyA=new je,this.proxyB=new je,this.sweepA=new Re,this.sweepB=new Re,this.tMax=0}));(Ut=e.b2TOIOutputState||(e.b2TOIOutputState={}))[Ut.e_unknown=0]="e_unknown",Ut[Ut.e_failed=1]="e_failed",Ut[Ut.e_overlapped=2]="e_overlapped",Ut[Ut.e_touching=3]="e_touching",Ut[Ut.e_separated=4]="e_separated";var Qt,Kt=l((function t(){o(this,t),this.state=e.b2TOIOutputState.e_unknown,this.t=0}));(Qt=e.b2SeparationFunctionType||(e.b2SeparationFunctionType={}))[Qt.e_unknown=-1]="e_unknown",Qt[Qt.e_points=0]="e_points",Qt[Qt.e_faceA=1]="e_faceA",Qt[Qt.e_faceB=2]="e_faceB";var $t=function(){function t(){o(this,t),this.m_sweepA=new Re,this.m_sweepB=new Re,this.m_type=e.b2SeparationFunctionType.e_unknown,this.m_localPoint=new ke,this.m_axis=new ke}return l(t,[{key:"Initialize",value:function(t,i,n,r,s,a){this.m_proxyA=i,this.m_proxyB=r;var o=t.count;this.m_sweepA.Copy(n),this.m_sweepB.Copy(s);var l=jt,u=Wt;if(this.m_sweepA.GetTransform(l,a),this.m_sweepB.GetTransform(u,a),1===o){this.m_type=e.b2SeparationFunctionType.e_points;var h=this.m_proxyA.GetVertex(t.indexA[0]),c=this.m_proxyB.GetVertex(t.indexB[0]),f=Ee.MulXV(l,h,qt),d=Ee.MulXV(u,c,Ht);ke.SubVV(d,f,this.m_axis);var m=this.m_axis.Normalize();return this.m_localPoint.SetZero(),m}if(t.indexA[0]===t.indexA[1]){this.m_type=e.b2SeparationFunctionType.e_faceB;var _=this.m_proxyB.GetVertex(t.indexB[0]),p=this.m_proxyB.GetVertex(t.indexB[1]);ke.CrossVOne(ke.SubVV(p,_,ke.s_t0),this.m_axis).SelfNormalize();var v=Le.MulRV(u.q,this.m_axis,Xt);ke.MidVV(_,p,this.m_localPoint);var y=Ee.MulXV(u,this.m_localPoint,Ht),g=this.m_proxyA.GetVertex(t.indexA[0]),x=Ee.MulXV(l,g,qt),b=ke.DotVV(ke.SubVV(x,y,ke.s_t0),v);return b<0&&(this.m_axis.SelfNeg(),b=-b),b}this.m_type=e.b2SeparationFunctionType.e_faceA;var w=this.m_proxyA.GetVertex(t.indexA[0]),A=this.m_proxyA.GetVertex(t.indexA[1]);ke.CrossVOne(ke.SubVV(A,w,ke.s_t0),this.m_axis).SelfNormalize();var S=Le.MulRV(l.q,this.m_axis,Xt);ke.MidVV(w,A,this.m_localPoint);var M=Ee.MulXV(l,this.m_localPoint,qt),C=this.m_proxyB.GetVertex(t.indexB[0]),k=Ee.MulXV(u,C,Ht),B=ke.DotVV(ke.SubVV(k,M,ke.s_t0),S);return B<0&&(this.m_axis.SelfNeg(),B=-B),B}},{key:"FindMinSeparation",value:function(t,i,n){var r=jt,s=Wt;switch(this.m_sweepA.GetTransform(r,n),this.m_sweepB.GetTransform(s,n),this.m_type){case e.b2SeparationFunctionType.e_points:var a=Le.MulTRV(r.q,this.m_axis,Jt),o=Le.MulTRV(s.q,ke.NegV(this.m_axis,ke.s_t0),Yt);t[0]=this.m_proxyA.GetSupport(a),i[0]=this.m_proxyB.GetSupport(o);var l=this.m_proxyA.GetVertex(t[0]),u=this.m_proxyB.GetVertex(i[0]),h=Ee.MulXV(r,l,qt),c=Ee.MulXV(s,u,Ht);return ke.DotVV(ke.SubVV(c,h,ke.s_t0),this.m_axis);case e.b2SeparationFunctionType.e_faceA:var f=Le.MulRV(r.q,this.m_axis,Xt),d=Ee.MulXV(r,this.m_localPoint,qt),m=Le.MulTRV(s.q,ke.NegV(f,ke.s_t0),Yt);t[0]=-1,i[0]=this.m_proxyB.GetSupport(m);var _=this.m_proxyB.GetVertex(i[0]),p=Ee.MulXV(s,_,Ht);return ke.DotVV(ke.SubVV(p,d,ke.s_t0),f);case e.b2SeparationFunctionType.e_faceB:var v=Le.MulRV(s.q,this.m_axis,Xt),y=Ee.MulXV(s,this.m_localPoint,Ht),g=Le.MulTRV(r.q,ke.NegV(v,ke.s_t0),Jt);i[0]=-1,t[0]=this.m_proxyA.GetSupport(g);var x=this.m_proxyA.GetVertex(t[0]),b=Ee.MulXV(r,x,qt);return ke.DotVV(ke.SubVV(b,y,ke.s_t0),v);default:return t[0]=-1,i[0]=-1,0}}},{key:"Evaluate",value:function(t,i,n){var r=jt,s=Wt;switch(this.m_sweepA.GetTransform(r,n),this.m_sweepB.GetTransform(s,n),this.m_type){case e.b2SeparationFunctionType.e_points:var a=this.m_proxyA.GetVertex(t),o=this.m_proxyB.GetVertex(i),l=Ee.MulXV(r,a,qt),u=Ee.MulXV(s,o,Ht);return ke.DotVV(ke.SubVV(u,l,ke.s_t0),this.m_axis);case e.b2SeparationFunctionType.e_faceA:var h=Le.MulRV(r.q,this.m_axis,Xt),c=Ee.MulXV(r,this.m_localPoint,qt),f=this.m_proxyB.GetVertex(i),d=Ee.MulXV(s,f,Ht);return ke.DotVV(ke.SubVV(d,c,ke.s_t0),h);case e.b2SeparationFunctionType.e_faceB:var m=Le.MulRV(s.q,this.m_axis,Xt),_=Ee.MulXV(s,this.m_localPoint,Ht),p=this.m_proxyA.GetVertex(t),v=Ee.MulXV(r,p,qt);return ke.DotVV(ke.SubVV(v,_,ke.s_t0),m);default:return 0}}}]),t}(),ei=new De,ti=new We,ii=new qe,ni=new He,ri=new $t,si=[0],ai=[0],oi=new Re,li=new Re;function ui(t,i){var n=ei.Reset();++e.b2_toiCalls,t.state=e.b2TOIOutputState.e_unknown,t.t=i.tMax;var r=i.proxyA,s=i.proxyB,a=le(_,r.m_count,s.m_count),o=oi.Copy(i.sweepA),l=li.Copy(i.sweepB);o.Normalize(),l.Normalize();var u=i.tMax,h=r.m_radius+s.m_radius,c=le(y,h-3*y),f=.25*y,d=0,m=20,p=0,v=ti;v.count=0;var g=ii;for(g.proxyA.Copy(i.proxyA),g.proxyB.Copy(i.proxyB),g.useRadii=!1;;){var x=jt,b=Wt;o.GetTransform(x,d),l.GetTransform(b,d),g.transformA.Copy(x),g.transformB.Copy(b);var w=ni;if(at(w,v,g),w.distance<=0){t.state=e.b2TOIOutputState.e_overlapped,t.t=0;break}if(w.distance<c+f){t.state=e.b2TOIOutputState.e_touching,t.t=d;break}var A=ri;A.Initialize(v,r,o,s,l,d);for(var S=!1,M=u,C=0;;){var k=si,B=ai,V=A.FindMinSeparation(k,B,M);if(V>c+f){t.state=e.b2TOIOutputState.e_separated,t.t=u,S=!0;break}if(V>c-f){d=M;break}var T=A.Evaluate(k[0],B[0],d);if(T<c-f){t.state=e.b2TOIOutputState.e_failed,t.t=d,S=!0;break}if(T<=c+f){t.state=e.b2TOIOutputState.e_touching,t.t=d,S=!0;break}for(var P=0,L=d,E=M;;){var I=0;I=1&P?L+(c-T)*(E-L)/(V-T):.5*(L+E),++P,++e.b2_toiRootIters;var R=A.Evaluate(k[0],B[0],I);if(ae(R-c)<f){M=I;break}if(R>c?(L=I,T=R):(E=I,V=R),50===P)break}if(e.b2_toiMaxRootIters=le(e.b2_toiMaxRootIters,P),++C===a)break}if(++p,++e.b2_toiIters,S)break;if(p===m){t.state=e.b2TOIOutputState.e_failed,t.t=d;break}}e.b2_toiMaxIters=le(e.b2_toiMaxIters,p);var F=n.GetMilliseconds();e.b2_toiMaxTime=le(e.b2_toiMaxTime,F),e.b2_toiTime+=F}var hi=new ke,ci=new ke;function fi(t,i,n,r,s){t.pointCount=0;var a=Ee.MulXV(n,i.m_p,hi),o=Ee.MulXV(s,r.m_p,ci),l=ke.DistanceSquaredVV(a,o),u=i.m_radius+r.m_radius;l>u*u||(t.type=e.b2ManifoldType.e_circles,t.localPoint.Copy(i.m_p),t.localNormal.SetZero(),t.pointCount=1,t.points[0].localPoint.Copy(r.m_p),t.points[0].id.key=0)}var di=new ke,mi=new ke,_i=new ke;function pi(t,i,n,r,s){t.pointCount=0;for(var a=Ee.MulXV(s,r.m_p,di),o=Ee.MulTXV(n,a,mi),l=0,u=-h,f=i.m_radius+r.m_radius,d=i.m_count,m=i.m_vertices,_=i.m_normals,p=0;p<d;++p){var v=ke.DotVV(_[p],ke.SubVV(o,m[p],ke.s_t0));if(v>f)return;v>u&&(u=v,l=p)}var y=l,g=(y+1)%d,x=m[y],b=m[g];if(u<c)return t.pointCount=1,t.type=e.b2ManifoldType.e_faceA,t.localNormal.Copy(_[l]),ke.MidVV(x,b,t.localPoint),t.points[0].localPoint.Copy(r.m_p),void(t.points[0].id.key=0);var w=ke.DotVV(ke.SubVV(o,x,ke.s_t0),ke.SubVV(b,x,ke.s_t1)),A=ke.DotVV(ke.SubVV(o,b,ke.s_t0),ke.SubVV(x,b,ke.s_t1));if(w<=0){if(ke.DistanceSquaredVV(o,x)>f*f)return;t.pointCount=1,t.type=e.b2ManifoldType.e_faceA,ke.SubVV(o,x,t.localNormal).SelfNormalize(),t.localPoint.Copy(x),t.points[0].localPoint.Copy(r.m_p),t.points[0].id.key=0}else if(A<=0){if(ke.DistanceSquaredVV(o,b)>f*f)return;t.pointCount=1,t.type=e.b2ManifoldType.e_faceA,ke.SubVV(o,b,t.localNormal).SelfNormalize(),t.localPoint.Copy(b),t.points[0].localPoint.Copy(r.m_p),t.points[0].id.key=0}else{var S=ke.MidVV(x,b,_i);if(ke.DotVV(ke.SubVV(o,S,ke.s_t1),_[y])>f)return;t.pointCount=1,t.type=e.b2ManifoldType.e_faceA,t.localNormal.Copy(_[y]).SelfNormalize(),t.localPoint.Copy(S),t.points[0].localPoint.Copy(r.m_p),t.points[0].id.key=0}}var vi=new ke,yi=new ke,gi=new ke,xi=new ke;function bi(e,t,i,n,r){for(var s=e.m_vertices,a=e.m_normals,o=n.m_count,l=n.m_vertices,u=Le.MulRV(t.q,a[i],vi),c=Le.MulTRV(r.q,u,yi),f=0,d=h,m=0;m<o;++m){var _=ke.DotVV(l[m],c);_<d&&(d=_,f=m)}var p=Ee.MulXV(t,s[i],gi),v=Ee.MulXV(r,l[f],xi);return ke.DotVV(ke.SubVV(v,p,ke.s_t0),u)}var wi=new ke,Ai=new ke;function Si(e,t,i,n,r){for(var s=t.m_count,a=t.m_normals,o=ke.SubVV(Ee.MulXV(r,n.m_centroid,ke.s_t0),Ee.MulXV(i,t.m_centroid,ke.s_t1),wi),l=Le.MulTRV(i.q,o,Ai),u=0,c=-h,f=0;f<s;++f){var d=ke.DotVV(a[f],l);d>c&&(c=d,u=f)}var m=bi(t,i,u,n,r),_=(u+s-1)%s,p=bi(t,i,_,n,r),v=(u+1)%s,y=bi(t,i,v,n,r),g=0,x=0,b=0;if(p>m&&p>y)b=-1,g=_,x=p;else{if(!(y>m))return e[0]=u,m;b=1,g=v,x=y}for(;(m=bi(t,i,u=-1===b?(g+s-1)%s:(g+1)%s,n,r))>x;)g=u,x=m;return e[0]=g,x}var Mi=new ke;function Ci(t,i,n,r,s,a){for(var o=i.m_normals,l=s.m_count,u=s.m_vertices,c=s.m_normals,f=Le.MulTRV(a.q,Le.MulRV(n.q,o[r],ke.s_t0),Mi),d=0,m=h,_=0;_<l;++_){var p=ke.DotVV(f,c[_]);p<m&&(m=p,d=_)}var v=d,y=(v+1)%l,g=t[0];Ee.MulXV(a,u[v],g.v);var x=g.id.cf;x.indexA=r,x.indexB=v,x.typeA=e.b2ContactFeatureType.e_face,x.typeB=e.b2ContactFeatureType.e_vertex;var b=t[1];Ee.MulXV(a,u[y],b.v);var w=b.id.cf;w.indexA=r,w.indexB=y,w.typeA=e.b2ContactFeatureType.e_face,w.typeB=e.b2ContactFeatureType.e_vertex}var ki=Mt.MakeArray(2),Bi=Mt.MakeArray(2),Vi=Mt.MakeArray(2),Ti=[0],Pi=[0],Li=new ke,Ei=new ke,Ii=new ke,Ri=new ke,Fi=new ke,Gi=new ke,Di=new ke,Oi=new ke;function Ni(t,i,n,r,s){t.pointCount=0;var a=i.m_radius+r.m_radius,o=Ti;o[0]=0;var l=Si(o,i,n,r,s);if(!(l>a)){var u=Pi;u[0]=0;var h=Si(u,r,s,i,n);if(!(h>a)){var c,f,d,_,p=0,v=0;h>.98*l+.001?(c=r,f=i,d=s,_=n,p=u[0],t.type=e.b2ManifoldType.e_faceB,v=1):(c=i,f=r,d=n,_=s,p=o[0],t.type=e.b2ManifoldType.e_faceA,v=0);var y=ki;Ci(y,c,d,p,f,_);var g=c.m_count,x=c.m_vertices,b=p,w=(p+1)%g,A=x[b],S=x[w],M=ke.SubVV(S,A,Li);M.Normalize();var C=ke.CrossVOne(M,Ei),k=ke.MidVV(A,S,Ii),B=Le.MulRV(d.q,M,Fi),V=ke.CrossVOne(B,Ri),T=Ee.MulXV(d,A,Di),P=Ee.MulXV(d,S,Oi),L=ke.DotVV(V,T),E=-ke.DotVV(B,T)+a,I=ke.DotVV(B,P)+a,R=Bi,F=Vi;if(!(Tt(R,y,ke.NegV(B,Gi),E,b)<2)&&!(Tt(F,R,B,I,w)<2)){t.localNormal.Copy(C),t.localPoint.Copy(k);for(var G=0,D=0;D<m;++D){var O=F[D];if(ke.DotVV(V,O.v)-L<=a){var N=t.points[G];if(Ee.MulTXV(_,O.v,N.localPoint),N.id.Copy(O.id),v){var z=N.id.cf;N.id.cf.indexA=z.indexB,N.id.cf.indexB=z.indexA,N.id.cf.typeA=z.typeB,N.id.cf.typeB=z.typeA}++G}}t.pointCount=G}}}}var zi=new ke,Ui=new ke,ji=new ke,Wi=new ke,qi=new ke,Hi=new ke,Xi=new ke,Ji=new gt;function Yi(t,i,n,r,s){t.pointCount=0;var a=Ee.MulTXV(n,Ee.MulXV(s,r.m_p,ke.s_t0),zi),o=i.m_vertex1,l=i.m_vertex2,u=ke.SubVV(l,o,Ui),h=ke.DotVV(u,ke.SubVV(l,a,ke.s_t0)),c=ke.DotVV(u,ke.SubVV(a,o,ke.s_t0)),f=i.m_radius+r.m_radius,d=Ji;if(d.cf.indexB=0,d.cf.typeB=e.b2ContactFeatureType.e_vertex,c<=0){var m=o,_=ke.SubVV(a,m,ji);if(ke.DotVV(_,_)>f*f)return;if(i.m_hasVertex0){var p=i.m_vertex0,v=o,y=ke.SubVV(v,p,Wi);if(ke.DotVV(y,ke.SubVV(v,a,ke.s_t0))>0)return}return d.cf.indexA=0,d.cf.typeA=e.b2ContactFeatureType.e_vertex,t.pointCount=1,t.type=e.b2ManifoldType.e_circles,t.localNormal.SetZero(),t.localPoint.Copy(m),t.points[0].id.Copy(d),void t.points[0].localPoint.Copy(r.m_p)}if(h<=0){var g=l,x=ke.SubVV(a,g,ji);if(ke.DotVV(x,x)>f*f)return;if(i.m_hasVertex3){var b=i.m_vertex3,w=l,A=ke.SubVV(b,w,qi);if(ke.DotVV(A,ke.SubVV(a,w,ke.s_t0))>0)return}return d.cf.indexA=1,d.cf.typeA=e.b2ContactFeatureType.e_vertex,t.pointCount=1,t.type=e.b2ManifoldType.e_circles,t.localNormal.SetZero(),t.localPoint.Copy(g),t.points[0].id.Copy(d),void t.points[0].localPoint.Copy(r.m_p)}var S=ke.DotVV(u,u),M=Hi;M.x=1/S*(h*o.x+c*l.x),M.y=1/S*(h*o.y+c*l.y);var C=ke.SubVV(a,M,ji);if(!(ke.DotVV(C,C)>f*f)){var k=Xi.Set(-u.y,u.x);ke.DotVV(k,ke.SubVV(a,o,ke.s_t0))<0&&k.Set(-k.x,-k.y),k.Normalize(),d.cf.indexA=0,d.cf.typeA=e.b2ContactFeatureType.e_face,t.pointCount=1,t.type=e.b2ManifoldType.e_faceA,t.localNormal.Copy(k),t.localPoint.Copy(o),t.points[0].id.Copy(d),t.points[0].localPoint.Copy(r.m_p)}}var Zi=l((function e(){o(this,e),this.type=0,this.index=0,this.separation=0})),Qi=l((function e(){o(this,e),this.vertices=[],this.normals=[],this.count=0})),Ki=l((function e(){o(this,e),this.i1=0,this.i2=0,this.v1=new ke,this.v2=new ke,this.normal=new ke,this.sideNormal1=new ke,this.sideOffset1=0,this.sideNormal2=new ke,this.sideOffset2=0})),$i=function(){function t(){o(this,t),this.m_polygonB=new Qi,this.m_xf=new Ee,this.m_centroidB=new ke,this.m_v0=new ke,this.m_v1=new ke,this.m_v2=new ke,this.m_v3=new ke,this.m_normal0=new ke,this.m_normal1=new ke,this.m_normal2=new ke,this.m_normal=new ke,this.m_type1=0,this.m_type2=0,this.m_lowerLimit=new ke,this.m_upperLimit=new ke,this.m_radius=0,this.m_front=!1}return l(t,[{key:"Collide",value:function(i,n,r,s,a){Ee.MulTXX(r,a,this.m_xf),Ee.MulXV(this.m_xf,s.m_centroid,this.m_centroidB),this.m_v0.Copy(n.m_vertex0),this.m_v1.Copy(n.m_vertex1),this.m_v2.Copy(n.m_vertex2),this.m_v3.Copy(n.m_vertex3);var o=n.m_hasVertex0,l=n.m_hasVertex3,u=ke.SubVV(this.m_v2,this.m_v1,t.s_edge1);u.Normalize(),this.m_normal1.Set(u.y,-u.x);var h=ke.DotVV(this.m_normal1,ke.SubVV(this.m_centroidB,this.m_v1,ke.s_t0)),c=0,f=0,d=!1,_=!1;if(o){var p=ke.SubVV(this.m_v1,this.m_v0,t.s_edge0);p.Normalize(),this.m_normal0.Set(p.y,-p.x),d=ke.CrossVV(p,u)>=0,c=ke.DotVV(this.m_normal0,ke.SubVV(this.m_centroidB,this.m_v0,ke.s_t0))}if(l){var v=ke.SubVV(this.m_v3,this.m_v2,t.s_edge2);v.Normalize(),this.m_normal2.Set(v.y,-v.x),_=ke.CrossVV(u,v)>0,f=ke.DotVV(this.m_normal2,ke.SubVV(this.m_centroidB,this.m_v2,ke.s_t0))}o&&l?d&&_?(this.m_front=c>=0||h>=0||f>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):d?(this.m_front=c>=0||h>=0&&f>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):_?(this.m_front=f>=0||c>=0&&h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):(this.m_front=c>=0&&h>=0&&f>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):o?d?(this.m_front=c>=0||h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):(this.m_front=c>=0&&h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):l?_?(this.m_front=h>=0||f>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=h>=0&&f>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=h>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1))),this.m_polygonB.count=s.m_count;for(var y=0;y<s.m_count;++y)this.m_polygonB.vertices.length<=y&&this.m_polygonB.vertices.push(new ke),this.m_polygonB.normals.length<=y&&this.m_polygonB.normals.push(new ke),Ee.MulXV(this.m_xf,s.m_vertices[y],this.m_polygonB.vertices[y]),Le.MulRV(this.m_xf.q,s.m_normals[y],this.m_polygonB.normals[y]);this.m_radius=s.m_radius+n.m_radius,i.pointCount=0;var g=this.ComputeEdgeSeparation(t.s_edgeAxis);if(0!==g.type&&!(g.separation>this.m_radius)){var x=this.ComputePolygonSeparation(t.s_polygonAxis);if(!(0!==x.type&&x.separation>this.m_radius)){var b,w=.98,A=.001;b=0===x.type?g:x.separation>w*g.separation+A?x:g;var S=t.s_ie,M=t.s_rf;if(1===b.type){i.type=e.b2ManifoldType.e_faceA;for(var C=0,k=ke.DotVV(this.m_normal,this.m_polygonB.normals[0]),B=1;B<this.m_polygonB.count;++B){var V=ke.DotVV(this.m_normal,this.m_polygonB.normals[B]);V<k&&(k=V,C=B)}var T=C,P=(T+1)%this.m_polygonB.count,L=S[0];L.v.Copy(this.m_polygonB.vertices[T]),L.id.cf.indexA=0,L.id.cf.indexB=T,L.id.cf.typeA=e.b2ContactFeatureType.e_face,L.id.cf.typeB=e.b2ContactFeatureType.e_vertex;var E=S[1];E.v.Copy(this.m_polygonB.vertices[P]),E.id.cf.indexA=0,E.id.cf.indexB=P,E.id.cf.typeA=e.b2ContactFeatureType.e_face,E.id.cf.typeB=e.b2ContactFeatureType.e_vertex,this.m_front?(M.i1=0,M.i2=1,M.v1.Copy(this.m_v1),M.v2.Copy(this.m_v2),M.normal.Copy(this.m_normal1)):(M.i1=1,M.i2=0,M.v1.Copy(this.m_v2),M.v2.Copy(this.m_v1),M.normal.Copy(this.m_normal1).SelfNeg())}else{i.type=e.b2ManifoldType.e_faceB;var I=S[0];I.v.Copy(this.m_v1),I.id.cf.indexA=0,I.id.cf.indexB=b.index,I.id.cf.typeA=e.b2ContactFeatureType.e_vertex,I.id.cf.typeB=e.b2ContactFeatureType.e_face;var R=S[1];R.v.Copy(this.m_v2),R.id.cf.indexA=0,R.id.cf.indexB=b.index,R.id.cf.typeA=e.b2ContactFeatureType.e_vertex,R.id.cf.typeB=e.b2ContactFeatureType.e_face,M.i1=b.index,M.i2=(M.i1+1)%this.m_polygonB.count,M.v1.Copy(this.m_polygonB.vertices[M.i1]),M.v2.Copy(this.m_polygonB.vertices[M.i2]),M.normal.Copy(this.m_polygonB.normals[M.i1])}M.sideNormal1.Set(M.normal.y,-M.normal.x),M.sideNormal2.Copy(M.sideNormal1).SelfNeg(),M.sideOffset1=ke.DotVV(M.sideNormal1,M.v1),M.sideOffset2=ke.DotVV(M.sideNormal2,M.v2);var F=t.s_clipPoints1,G=t.s_clipPoints2;if(!(Tt(F,S,M.sideNormal1,M.sideOffset1,M.i1)<m)&&!(Tt(G,F,M.sideNormal2,M.sideOffset2,M.i2)<m)){1===b.type?(i.localNormal.Copy(M.normal),i.localPoint.Copy(M.v1)):(i.localNormal.Copy(s.m_normals[M.i1]),i.localPoint.Copy(s.m_vertices[M.i1]));for(var D=0,O=0;O<m;++O)if(ke.DotVV(M.normal,ke.SubVV(G[O].v,M.v1,ke.s_t0))<=this.m_radius){var N=i.points[D];1===b.type?(Ee.MulTXV(this.m_xf,G[O].v,N.localPoint),N.id=G[O].id):(N.localPoint.Copy(G[O].v),N.id.cf.typeA=G[O].id.cf.typeB,N.id.cf.typeB=G[O].id.cf.typeA,N.id.cf.indexA=G[O].id.cf.indexB,N.id.cf.indexB=G[O].id.cf.indexA),++D}i.pointCount=D}}}}},{key:"ComputeEdgeSeparation",value:function(e){var t=e;t.type=1,t.index=this.m_front?0:1,t.separation=h;for(var i=0;i<this.m_polygonB.count;++i){var n=ke.DotVV(this.m_normal,ke.SubVV(this.m_polygonB.vertices[i],this.m_v1,ke.s_t0));n<t.separation&&(t.separation=n)}return t}},{key:"ComputePolygonSeparation",value:function(e){var i=e;i.type=0,i.index=-1,i.separation=-h;for(var n=t.s_perp.Set(-this.m_normal.y,this.m_normal.x),r=0;r<this.m_polygonB.count;++r){var s=ke.NegV(this.m_polygonB.normals[r],t.s_n),a=ke.DotVV(s,ke.SubVV(this.m_polygonB.vertices[r],this.m_v1,ke.s_t0)),o=ke.DotVV(s,ke.SubVV(this.m_polygonB.vertices[r],this.m_v2,ke.s_t0)),l=oe(a,o);if(l>this.m_radius)return i.type=2,i.index=r,i.separation=l,i;if(ke.DotVV(s,n)>=0){if(ke.DotVV(ke.SubVV(s,this.m_upperLimit,ke.s_t0),this.m_normal)<-g)continue}else if(ke.DotVV(ke.SubVV(s,this.m_lowerLimit,ke.s_t0),this.m_normal)<-g)continue;l>i.separation&&(i.type=2,i.index=r,i.separation=l)}return i}}]),t}();$i.s_edge1=new ke,$i.s_edge0=new ke,$i.s_edge2=new ke,$i.s_ie=Mt.MakeArray(2),$i.s_rf=new Ki,$i.s_clipPoints1=Mt.MakeArray(2),$i.s_clipPoints2=Mt.MakeArray(2),$i.s_edgeAxis=new Zi,$i.s_polygonAxis=new Zi,$i.s_n=new ke,$i.s_perp=new ke;var en=new $i;function tn(e,t,i,n,r){en.Collide(e,t,i,n,r)}var nn,rn=l((function e(){o(this,e),this.mass=0,this.center=new ke(0,0),this.I=0}));(nn=e.b2ShapeType||(e.b2ShapeType={}))[nn.e_unknown=-1]="e_unknown",nn[nn.e_circleShape=0]="e_circleShape",nn[nn.e_edgeShape=1]="e_edgeShape",nn[nn.e_polygonShape=2]="e_polygonShape",nn[nn.e_chainShape=3]="e_chainShape",nn[nn.e_shapeTypeCount=4]="e_shapeTypeCount";var sn=function(){function t(i,n){o(this,t),this.m_type=e.b2ShapeType.e_unknown,this.m_radius=0,this.m_type=i,this.m_radius=n}return l(t,[{key:"Copy",value:function(e){return this.m_radius=e.m_radius,this}},{key:"GetType",value:function(){return this.m_type}}]),t}(),an=function(t){s(u,t);var i=a(u);function u(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return o(this,u),(t=i.call(this,e.b2ShapeType.e_circleShape,n)).m_p=new ke,t}return l(u,[{key:"Set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.m_radius;return this.m_p.Copy(e),this.m_radius=t,this}},{key:"Clone",value:function(){return(new u).Copy(this)}},{key:"Copy",value:function(e){return n(r(u.prototype),"Copy",this).call(this,e),this.m_p.Copy(e.m_p),this}},{key:"GetChildCount",value:function(){return 1}},{key:"TestPoint",value:function(e,t){var i=Ee.MulXV(e,this.m_p,u.TestPoint_s_center),n=ke.SubVV(t,i,u.TestPoint_s_d);return ke.DotVV(n,n)<=fe(this.m_radius)}},{key:"ComputeDistance",value:function(e,t,i,n){var r=Ee.MulXV(e,this.m_p,u.ComputeDistance_s_center);return ke.SubVV(t,r,i),i.Normalize()-this.m_radius}},{key:"RayCast",value:function(e,t,i,n){var r=Ee.MulXV(i,this.m_p,u.RayCast_s_position),s=ke.SubVV(t.p1,r,u.RayCast_s_s),a=ke.DotVV(s,s)-fe(this.m_radius),o=ke.SubVV(t.p2,t.p1,u.RayCast_s_r),l=ke.DotVV(s,o),h=ke.DotVV(o,o),f=l*l-h*a;if(f<0||h<c)return!1;var d=-(l+me(f));return 0<=d&&d<=t.maxFraction*h&&(d/=h,e.fraction=d,ke.AddVMulSV(s,d,o,e.normal).SelfNormalize(),!0)}},{key:"ComputeAABB",value:function(e,t,i){var n=Ee.MulXV(t,this.m_p,u.ComputeAABB_s_p);e.lowerBound.Set(n.x-this.m_radius,n.y-this.m_radius),e.upperBound.Set(n.x+this.m_radius,n.y+this.m_radius)}},{key:"ComputeMass",value:function(e,t){var i=fe(this.m_radius);e.mass=t*d*i,e.center.Copy(this.m_p),e.I=e.mass*(.5*i+ke.DotVV(this.m_p,this.m_p))}},{key:"SetupDistanceProxy",value:function(e,t){e.m_vertices=e.m_buffer,e.m_vertices[0].Copy(this.m_p),e.m_count=1,e.m_radius=this.m_radius}},{key:"ComputeSubmergedArea",value:function(e,t,i,n){var r=Ee.MulXV(i,this.m_p,new ke),s=-(ke.DotVV(e,r)-t);if(s<-this.m_radius+c)return 0;if(s>this.m_radius)return n.Copy(r),d*this.m_radius*this.m_radius;var a=this.m_radius*this.m_radius,o=s*s,l=a*(be(s/this.m_radius)+d/2)+s*me(a-o),u=-2/3*_e(a-o,1.5)/l;return n.x=r.x+e.x*u,n.y=r.y+e.y*u,l}},{key:"Dump",value:function(e){e("    const shape: b2CircleShape = new b2CircleShape();\n"),e("    shape.m_radius = %.15f;\n",this.m_radius),e("    shape.m_p.Set(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)}}]),u}(sn);an.TestPoint_s_center=new ke,an.TestPoint_s_d=new ke,an.ComputeDistance_s_center=new ke,an.RayCast_s_position=new ke,an.RayCast_s_s=new ke,an.RayCast_s_r=new ke,an.ComputeAABB_s_p=new ke;var on=function(t){s(u,t);var i=a(u);function u(){var t;return o(this,u),(t=i.call(this,e.b2ShapeType.e_polygonShape,x)).m_centroid=new ke(0,0),t.m_vertices=[],t.m_normals=[],t.m_count=0,t}return l(u,[{key:"Clone",value:function(){return(new u).Copy(this)}},{key:"Copy",value:function(e){n(r(u.prototype),"Copy",this).call(this,e),this.m_centroid.Copy(e.m_centroid),this.m_count=e.m_count,this.m_vertices=ke.MakeArray(this.m_count),this.m_normals=ke.MakeArray(this.m_count);for(var t=0;t<this.m_count;++t)this.m_vertices[t].Copy(e.m_vertices[t]),this.m_normals[t].Copy(e.m_normals[t]);return this}},{key:"GetChildCount",value:function(){return 1}},{key:"Set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t<3)return this.SetAsBox(1,1);for(var n=t,r=[],s=0;s<n;++s){for(var a=e[i+s],o=!0,l=0;l<r.length;++l)if(ke.DistanceSquaredVV(a,r[l])<.5*y*(.5*y)){o=!1;break}o&&r.push(a)}if((n=r.length)<3)return this.SetAsBox(1,1);for(var h=0,c=r[0].x,f=1;f<n;++f){var d=r[f].x;(d>c||d===c&&r[f].y<r[h].y)&&(h=f,c=d)}for(var m=[],_=0,p=h;;){m[_]=p;for(var v=0,g=1;g<n;++g)if(v!==p){var x=ke.SubVV(r[v],r[m[_]],u.Set_s_r),b=ke.SubVV(r[g],r[m[_]],u.Set_s_v),w=ke.CrossVV(x,b);w<0&&(v=g),0===w&&b.LengthSquared()>x.LengthSquared()&&(v=g)}else v=g;if(++_,p=v,v===h)break}this.m_count=_,this.m_vertices=ke.MakeArray(this.m_count),this.m_normals=ke.MakeArray(this.m_count);for(var A=0;A<_;++A)this.m_vertices[A].Copy(r[m[A]]);for(var S=0;S<_;++S){var M=this.m_vertices[S],C=this.m_vertices[(S+1)%_],k=ke.SubVV(C,M,ke.s_t0);ke.CrossVOne(k,this.m_normals[S]).SelfNormalize()}return u.ComputeCentroid(this.m_vertices,_,this.m_centroid),this}},{key:"SetAsArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;return this.Set(e,t)}},{key:"SetAsBox",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(this.m_count=4,this.m_vertices=ke.MakeArray(this.m_count),this.m_normals=ke.MakeArray(this.m_count),this.m_vertices[0].Set(-e,-t),this.m_vertices[1].Set(e,-t),this.m_vertices[2].Set(e,t),this.m_vertices[3].Set(-e,t),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero(),i){this.m_centroid.Copy(i);var r=new Ee;r.SetPosition(i),r.SetRotationAngle(n);for(var s=0;s<this.m_count;++s)Ee.MulXV(r,this.m_vertices[s],this.m_vertices[s]),Le.MulRV(r.q,this.m_normals[s],this.m_normals[s])}return this}},{key:"TestPoint",value:function(e,t){for(var i=Ee.MulTXV(e,t,u.TestPoint_s_pLocal),n=0;n<this.m_count;++n)if(ke.DotVV(this.m_normals[n],ke.SubVV(i,this.m_vertices[n],ke.s_t0))>0)return!1;return!0}},{key:"ComputeDistance",value:function(e,t,i,n){for(var r=Ee.MulTXV(e,t,u.ComputeDistance_s_pLocal),s=-h,a=u.ComputeDistance_s_normalForMaxDistance.Copy(r),o=0;o<this.m_count;++o){var l=ke.DotVV(this.m_normals[o],ke.SubVV(r,this.m_vertices[o],ke.s_t0));l>s&&(s=l,a.Copy(this.m_normals[o]))}if(s>0){for(var c=u.ComputeDistance_s_minDistance.Copy(a),f=s*s,d=0;d<this.m_count;++d){var m=ke.SubVV(r,this.m_vertices[d],u.ComputeDistance_s_distance),_=m.LengthSquared();f>_&&(c.Copy(m),f=_)}return Le.MulRV(e.q,c,i),i.Normalize(),Math.sqrt(f)}return Le.MulRV(e.q,a,i),s}},{key:"RayCast",value:function(e,t,i,n){for(var r=Ee.MulTXV(i,t.p1,u.RayCast_s_p1),s=Ee.MulTXV(i,t.p2,u.RayCast_s_p2),a=ke.SubVV(s,r,u.RayCast_s_d),o=0,l=t.maxFraction,h=-1,c=0;c<this.m_count;++c){var f=ke.DotVV(this.m_normals[c],ke.SubVV(this.m_vertices[c],r,ke.s_t0)),d=ke.DotVV(this.m_normals[c],a);if(0===d){if(f<0)return!1}else d<0&&f<o*d?(o=f/d,h=c):d>0&&f<l*d&&(l=f/d);if(l<o)return!1}return h>=0&&(e.fraction=o,Le.MulRV(i.q,this.m_normals[h],e.normal),!0)}},{key:"ComputeAABB",value:function(e,t,i){for(var n=Ee.MulXV(t,this.m_vertices[0],e.lowerBound),r=e.upperBound.Copy(n),s=0;s<this.m_count;++s){var a=Ee.MulXV(t,this.m_vertices[s],u.ComputeAABB_s_v);ke.MinV(a,n,n),ke.MaxV(a,r,r)}var o=this.m_radius;n.SelfSubXY(o,o),r.SelfAddXY(o,o)}},{key:"ComputeMass",value:function(e,t){for(var i=u.ComputeMass_s_center.SetZero(),n=0,r=0,s=u.ComputeMass_s_s.SetZero(),a=0;a<this.m_count;++a)s.SelfAdd(this.m_vertices[a]);s.SelfMul(1/this.m_count);for(var o=1/3,l=0;l<this.m_count;++l){var h=ke.SubVV(this.m_vertices[l],s,u.ComputeMass_s_e1),c=ke.SubVV(this.m_vertices[(l+1)%this.m_count],s,u.ComputeMass_s_e2),f=ke.CrossVV(h,c),d=.5*f;n+=d,i.SelfAdd(ke.MulSV(d*o,ke.AddVV(h,c,ke.s_t0),ke.s_t1));var m=h.x,_=h.y,p=c.x,v=c.y;r+=.25*o*f*(m*m+p*m+p*p+(_*_+v*_+v*v))}e.mass=t*n,i.SelfMul(1/n),ke.AddVV(i,s,e.center),e.I=t*r,e.I+=e.mass*(ke.DotVV(e.center,e.center)-ke.DotVV(i,i))}},{key:"Validate",value:function(){for(var e=0;e<this.m_count;++e)for(var t=e,i=(e+1)%this.m_count,n=this.m_vertices[t],r=ke.SubVV(this.m_vertices[i],n,u.Validate_s_e),s=0;s<this.m_count;++s)if(s!==t&&s!==i){var a=ke.SubVV(this.m_vertices[s],n,u.Validate_s_v);if(ke.CrossVV(r,a)<0)return!1}return!0}},{key:"SetupDistanceProxy",value:function(e,t){e.m_vertices=this.m_vertices,e.m_count=this.m_count,e.m_radius=this.m_radius}},{key:"ComputeSubmergedArea",value:function(e,t,i,n){for(var r=Le.MulTRV(i.q,e,u.ComputeSubmergedArea_s_normalL),s=t-ke.DotVV(e,i.p),a=[],o=0,l=-1,h=-1,f=!1,d=0;d<this.m_count;++d){a[d]=ke.DotVV(r,this.m_vertices[d])-s;var m=a[d]<-c;d>0&&(m?f||(l=d-1,o++):f&&(h=d-1,o++)),f=m}switch(o){case 0:if(f){var _=u.ComputeSubmergedArea_s_md;return this.ComputeMass(_,1),Ee.MulXV(i,_.center,n),_.mass}return 0;case 1:-1===l?l=this.m_count-1:h=this.m_count-1}for(var p,v=(l+1)%this.m_count,y=(h+1)%this.m_count,g=(0-a[l])/(a[v]-a[l]),x=(0-a[h])/(a[y]-a[h]),b=u.ComputeSubmergedArea_s_intoVec.Set(this.m_vertices[l].x*(1-g)+this.m_vertices[v].x*g,this.m_vertices[l].y*(1-g)+this.m_vertices[v].y*g),w=u.ComputeSubmergedArea_s_outoVec.Set(this.m_vertices[h].x*(1-x)+this.m_vertices[y].x*x,this.m_vertices[h].y*(1-x)+this.m_vertices[y].y*x),A=0,S=u.ComputeSubmergedArea_s_center.SetZero(),M=this.m_vertices[v],C=v;C!==y;){p=(C=(C+1)%this.m_count)===y?w:this.m_vertices[C];var k=.5*((M.x-b.x)*(p.y-b.y)-(M.y-b.y)*(p.x-b.x));A+=k,S.x+=k*(b.x+M.x+p.x)/3,S.y+=k*(b.y+M.y+p.y)/3,M=p}return S.SelfMul(1/A),Ee.MulXV(i,S,n),A}},{key:"Dump",value:function(e){e("    const shape: b2PolygonShape = new b2PolygonShape();\n"),e("    const vs: b2Vec2[] = [];\n");for(var t=0;t<this.m_count;++t)e("    vs[%d] = new b2Vec2(%.15f, %.15f);\n",t,this.m_vertices[t].x,this.m_vertices[t].y);e("    shape.Set(vs, %d);\n",this.m_count)}}],[{key:"ComputeCentroid",value:function(e,t,i){var n=i;n.SetZero();for(var r=0,s=u.ComputeCentroid_s_pRef.SetZero(),a=1/3,o=0;o<t;++o){var l=s,h=e[o],c=e[(o+1)%t],f=ke.SubVV(h,l,u.ComputeCentroid_s_e1),d=ke.SubVV(c,l,u.ComputeCentroid_s_e2),m=.5*ke.CrossVV(f,d);r+=m,n.x+=m*a*(l.x+h.x+c.x),n.y+=m*a*(l.y+h.y+c.y)}return n.SelfMul(1/r),n}}]),u}(sn);on.Set_s_r=new ke,on.Set_s_v=new ke,on.TestPoint_s_pLocal=new ke,on.ComputeDistance_s_pLocal=new ke,on.ComputeDistance_s_normalForMaxDistance=new ke,on.ComputeDistance_s_minDistance=new ke,on.ComputeDistance_s_distance=new ke,on.RayCast_s_p1=new ke,on.RayCast_s_p2=new ke,on.RayCast_s_d=new ke,on.ComputeAABB_s_v=new ke,on.ComputeMass_s_center=new ke,on.ComputeMass_s_s=new ke,on.ComputeMass_s_e1=new ke,on.ComputeMass_s_e2=new ke,on.Validate_s_e=new ke,on.Validate_s_v=new ke,on.ComputeSubmergedArea_s_normalL=new ke,on.ComputeSubmergedArea_s_md=new rn,on.ComputeSubmergedArea_s_intoVec=new ke,on.ComputeSubmergedArea_s_outoVec=new ke,on.ComputeSubmergedArea_s_center=new ke,on.ComputeCentroid_s_pRef=new ke,on.ComputeCentroid_s_e1=new ke,on.ComputeCentroid_s_e2=new ke;var ln=function(t){s(u,t);var i=a(u);function u(){var t;return o(this,u),(t=i.call(this,e.b2ShapeType.e_edgeShape,x)).m_vertex1=new ke,t.m_vertex2=new ke,t.m_vertex0=new ke,t.m_vertex3=new ke,t.m_hasVertex0=!1,t.m_hasVertex3=!1,t}return l(u,[{key:"Set",value:function(e,t){return this.m_vertex1.Copy(e),this.m_vertex2.Copy(t),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this}},{key:"Clone",value:function(){return(new u).Copy(this)}},{key:"Copy",value:function(e){return n(r(u.prototype),"Copy",this).call(this,e),this.m_vertex1.Copy(e.m_vertex1),this.m_vertex2.Copy(e.m_vertex2),this.m_vertex0.Copy(e.m_vertex0),this.m_vertex3.Copy(e.m_vertex3),this.m_hasVertex0=e.m_hasVertex0,this.m_hasVertex3=e.m_hasVertex3,this}},{key:"GetChildCount",value:function(){return 1}},{key:"TestPoint",value:function(e,t){return!1}},{key:"ComputeDistance",value:function(e,t,i,n){var r=Ee.MulXV(e,this.m_vertex1,u.ComputeDistance_s_v1),s=Ee.MulXV(e,this.m_vertex2,u.ComputeDistance_s_v2),a=ke.SubVV(t,r,u.ComputeDistance_s_d),o=ke.SubVV(s,r,u.ComputeDistance_s_s),l=ke.DotVV(a,o);if(l>0){var h=ke.DotVV(o,o);l>h?ke.SubVV(t,s,a):a.SelfMulSub(l/h,o)}return i.Copy(a),i.Normalize()}},{key:"RayCast",value:function(e,t,i,n){var r=Ee.MulTXV(i,t.p1,u.RayCast_s_p1),s=Ee.MulTXV(i,t.p2,u.RayCast_s_p2),a=ke.SubVV(s,r,u.RayCast_s_d),o=this.m_vertex1,l=this.m_vertex2,h=ke.SubVV(l,o,u.RayCast_s_e),c=e.normal.Set(h.y,-h.x).SelfNormalize(),f=ke.DotVV(c,ke.SubVV(o,r,ke.s_t0)),d=ke.DotVV(c,a);if(0===d)return!1;var m=f/d;if(m<0||t.maxFraction<m)return!1;var _=ke.AddVMulSV(r,m,a,u.RayCast_s_q),p=ke.SubVV(l,o,u.RayCast_s_r),v=ke.DotVV(p,p);if(0===v)return!1;var y=ke.DotVV(ke.SubVV(_,o,ke.s_t0),p)/v;return!(y<0||1<y)&&(e.fraction=m,Le.MulRV(i.q,e.normal,e.normal),f>0&&e.normal.SelfNeg(),!0)}},{key:"ComputeAABB",value:function(e,t,i){var n=Ee.MulXV(t,this.m_vertex1,u.ComputeAABB_s_v1),r=Ee.MulXV(t,this.m_vertex2,u.ComputeAABB_s_v2);ke.MinV(n,r,e.lowerBound),ke.MaxV(n,r,e.upperBound);var s=this.m_radius;e.lowerBound.SelfSubXY(s,s),e.upperBound.SelfAddXY(s,s)}},{key:"ComputeMass",value:function(e,t){e.mass=0,ke.MidVV(this.m_vertex1,this.m_vertex2,e.center),e.I=0}},{key:"SetupDistanceProxy",value:function(e,t){e.m_vertices=e.m_buffer,e.m_vertices[0].Copy(this.m_vertex1),e.m_vertices[1].Copy(this.m_vertex2),e.m_count=2,e.m_radius=this.m_radius}},{key:"ComputeSubmergedArea",value:function(e,t,i,n){return n.SetZero(),0}},{key:"Dump",value:function(e){e("    const shape: b2EdgeShape = new b2EdgeShape();\n"),e("    shape.m_radius = %.15f;\n",this.m_radius),e("    shape.m_vertex0.Set(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y),e("    shape.m_vertex1.Set(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y),e("    shape.m_vertex2.Set(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y),e("    shape.m_vertex3.Set(%.15f, %.15f);\n",this.m_vertex3.x,this.m_vertex3.y),e("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0),e("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)}}]),u}(sn);ln.ComputeDistance_s_v1=new ke,ln.ComputeDistance_s_v2=new ke,ln.ComputeDistance_s_d=new ke,ln.ComputeDistance_s_s=new ke,ln.RayCast_s_p1=new ke,ln.RayCast_s_p2=new ke,ln.RayCast_s_d=new ke,ln.RayCast_s_e=new ke,ln.RayCast_s_q=new ke,ln.RayCast_s_r=new ke,ln.ComputeAABB_s_v1=new ke,ln.ComputeAABB_s_v2=new ke;var un=function(t){s(u,t);var i=a(u);function u(){var t;return o(this,u),(t=i.call(this,e.b2ShapeType.e_chainShape,x)).m_vertices=[],t.m_count=0,t.m_prevVertex=new ke,t.m_nextVertex=new ke,t.m_hasPrevVertex=!1,t.m_hasNextVertex=!1,t}return l(u,[{key:"CreateLoop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t<3)return this;this.m_count=t+1,this.m_vertices=ke.MakeArray(this.m_count);for(var n=0;n<t;++n)this.m_vertices[n].Copy(e[i+n]);return this.m_vertices[t].Copy(this.m_vertices[0]),this.m_prevVertex.Copy(this.m_vertices[this.m_count-2]),this.m_nextVertex.Copy(this.m_vertices[1]),this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this}},{key:"CreateChain",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.m_count=t,this.m_vertices=ke.MakeArray(t);for(var n=0;n<t;++n)this.m_vertices[n].Copy(e[i+n]);return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex.SetZero(),this.m_nextVertex.SetZero(),this}},{key:"SetPrevVertex",value:function(e){return this.m_prevVertex.Copy(e),this.m_hasPrevVertex=!0,this}},{key:"SetNextVertex",value:function(e){return this.m_nextVertex.Copy(e),this.m_hasNextVertex=!0,this}},{key:"Clone",value:function(){return(new u).Copy(this)}},{key:"Copy",value:function(e){return n(r(u.prototype),"Copy",this).call(this,e),this.CreateChain(e.m_vertices,e.m_count),this.m_prevVertex.Copy(e.m_prevVertex),this.m_nextVertex.Copy(e.m_nextVertex),this.m_hasPrevVertex=e.m_hasPrevVertex,this.m_hasNextVertex=e.m_hasNextVertex,this}},{key:"GetChildCount",value:function(){return this.m_count-1}},{key:"GetChildEdge",value:function(t,i){t.m_type=e.b2ShapeType.e_edgeShape,t.m_radius=this.m_radius,t.m_vertex1.Copy(this.m_vertices[i]),t.m_vertex2.Copy(this.m_vertices[i+1]),i>0?(t.m_vertex0.Copy(this.m_vertices[i-1]),t.m_hasVertex0=!0):(t.m_vertex0.Copy(this.m_prevVertex),t.m_hasVertex0=this.m_hasPrevVertex),i<this.m_count-2?(t.m_vertex3.Copy(this.m_vertices[i+2]),t.m_hasVertex3=!0):(t.m_vertex3.Copy(this.m_nextVertex),t.m_hasVertex3=this.m_hasNextVertex)}},{key:"TestPoint",value:function(e,t){return!1}},{key:"ComputeDistance",value:function(e,t,i,n){var r=u.ComputeDistance_s_edgeShape;return this.GetChildEdge(r,n),r.ComputeDistance(e,t,i,0)}},{key:"RayCast",value:function(e,t,i,n){var r=u.RayCast_s_edgeShape;return r.m_vertex1.Copy(this.m_vertices[n]),r.m_vertex2.Copy(this.m_vertices[(n+1)%this.m_count]),r.RayCast(e,t,i,0)}},{key:"ComputeAABB",value:function(e,t,i){var n=this.m_vertices[i],r=this.m_vertices[(i+1)%this.m_count],s=Ee.MulXV(t,n,u.ComputeAABB_s_v1),a=Ee.MulXV(t,r,u.ComputeAABB_s_v2);ke.MinV(s,a,e.lowerBound),ke.MaxV(s,a,e.upperBound)}},{key:"ComputeMass",value:function(e,t){e.mass=0,e.center.SetZero(),e.I=0}},{key:"SetupDistanceProxy",value:function(e,t){e.m_vertices=e.m_buffer,e.m_vertices[0].Copy(this.m_vertices[t]),t+1<this.m_count?e.m_vertices[1].Copy(this.m_vertices[t+1]):e.m_vertices[1].Copy(this.m_vertices[0]),e.m_count=2,e.m_radius=this.m_radius}},{key:"ComputeSubmergedArea",value:function(e,t,i,n){return n.SetZero(),0}},{key:"Dump",value:function(e){e("    const shape: b2ChainShape = new b2ChainShape();\n"),e("    const vs: b2Vec2[] = [];\n");for(var t=0;t<this.m_count;++t)e("    vs[%d] = new bVec2(%.15f, %.15f);\n",t,this.m_vertices[t].x,this.m_vertices[t].y);e("    shape.CreateChain(vs, %d);\n",this.m_count),e("    shape.m_prevVertex.Set(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y),e("    shape.m_nextVertex.Set(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y),e("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false"),e("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")}}]),u}(sn);un.ComputeDistance_s_edgeShape=new ln,un.RayCast_s_edgeShape=new ln,un.ComputeAABB_s_v1=new ke,un.ComputeAABB_s_v2=new ke;var hn=function(){function e(){o(this,e),this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return l(e,[{key:"Clone",value:function(){return(new e).Copy(this)}},{key:"Copy",value:function(e){return this.categoryBits=e.categoryBits,this.maskBits=e.maskBits,this.groupIndex=e.groupIndex||0,this}}]),e}();hn.DEFAULT=new hn;var cn,fn=l((function e(){o(this,e),this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter=new hn})),dn=l((function e(t){o(this,e),this.aabb=new Bt,this.childIndex=0,this.fixture=t})),mn=function(){function e(t,i){o(this,e),this.m_density=0,this.m_next=null,this.m_friction=0,this.m_restitution=0,this.m_proxies=[],this.m_proxyCount=0,this.m_filter=new hn,this.m_isSensor=!1,this.m_userData=null,this.m_body=i,this.m_shape=t.shape.Clone()}return l(e,[{key:"GetType",value:function(){return this.m_shape.GetType()}},{key:"GetShape",value:function(){return this.m_shape}},{key:"SetSensor",value:function(e){e!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=e)}},{key:"IsSensor",value:function(){return this.m_isSensor}},{key:"SetFilterData",value:function(e){this.m_filter.Copy(e),this.Refilter()}},{key:"GetFilterData",value:function(){return this.m_filter}},{key:"Refilter",value:function(){for(var e=this.m_body.GetContactList();e;){var t=e.contact,i=t.GetFixtureA(),n=t.GetFixtureB();i!==this&&n!==this||t.FlagForFiltering(),e=e.next}var r=this.m_body.GetWorld();if(null!==r)for(var s=r.m_contactManager.m_broadPhase,a=0;a<this.m_proxyCount;++a)s.TouchProxy(this.m_proxies[a].treeNode)}},{key:"GetBody",value:function(){return this.m_body}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(e){this.m_userData=e}},{key:"TestPoint",value:function(e){return this.m_shape.TestPoint(this.m_body.GetTransform(),e)}},{key:"ComputeDistance",value:function(e,t,i){return this.m_shape.ComputeDistance(this.m_body.GetTransform(),e,t,i)}},{key:"RayCast",value:function(e,t,i){return this.m_shape.RayCast(e,t,this.m_body.GetTransform(),i)}},{key:"GetMassData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new rn;return this.m_shape.ComputeMass(e,this.m_density),e}},{key:"SetDensity",value:function(e){this.m_density=e}},{key:"GetDensity",value:function(){return this.m_density}},{key:"GetFriction",value:function(){return this.m_friction}},{key:"SetFriction",value:function(e){this.m_friction=e}},{key:"GetRestitution",value:function(){return this.m_restitution}},{key:"SetRestitution",value:function(e){this.m_restitution=e}},{key:"GetAABB",value:function(e){return this.m_proxies[e].aabb}},{key:"Dump",value:function(e,t){e("    const fd: b2FixtureDef = new b2FixtureDef();\n"),e("    fd.friction = %.15f;\n",this.m_friction),e("    fd.restitution = %.15f;\n",this.m_restitution),e("    fd.density = %.15f;\n",this.m_density),e("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),e("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),e("    fd.filter.maskBits = %d;\n",this.m_filter.maskBits),e("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(e),e("\n"),e("    fd.shape = shape;\n"),e("\n"),e("    bodies[%d].CreateFixture(fd);\n",t)}},{key:"Create",value:function(e){var t=this;this.m_userData=e.userData,this.m_friction=i(e.friction,.2),this.m_restitution=i(e.restitution,0),this.m_next=null,this.m_filter.Copy(i(e.filter,hn.DEFAULT)),this.m_isSensor=i(e.isSensor,!1),this.m_proxies=ee(this.m_shape.GetChildCount(),(function(e){return new dn(t)})),this.m_proxyCount=0,this.m_density=i(e.density,0)}},{key:"Destroy",value:function(){}},{key:"CreateProxies",value:function(e){var t=this.m_body.m_world.m_contactManager.m_broadPhase;this.m_proxyCount=this.m_shape.GetChildCount();for(var i=0;i<this.m_proxyCount;++i){var n=this.m_proxies[i]=new dn(this);this.m_shape.ComputeAABB(n.aabb,e,i),n.treeNode=t.CreateProxy(n.aabb,n),n.childIndex=i}}},{key:"DestroyProxies",value:function(){for(var e=this.m_body.m_world.m_contactManager.m_broadPhase,t=0;t<this.m_proxyCount;++t){var i=this.m_proxies[t];delete i.treeNode.userData,e.DestroyProxy(i.treeNode),delete i.treeNode}this.m_proxyCount=0}},{key:"TouchProxies",value:function(){for(var e=this.m_body.m_world.m_contactManager.m_broadPhase,t=this.m_proxyCount,i=0;i<t;++i)e.TouchProxy(this.m_proxies[i].treeNode)}},{key:"Synchronize",value:function(t,i){if(0!==this.m_proxyCount)for(var n=this.m_body.m_world.m_contactManager.m_broadPhase,r=0;r<this.m_proxyCount;++r){var s=this.m_proxies[r],a=e.Synchronize_s_aabb1,o=e.Synchronize_s_aabb2;this.m_shape.ComputeAABB(a,t,r),this.m_shape.ComputeAABB(o,i,r),s.aabb.Combine2(a,o);var l=ke.SubVV(i.p,t.p,e.Synchronize_s_displacement);n.MoveProxy(s.treeNode,s.aabb,l)}}}]),e}();mn.Synchronize_s_aabb1=new Bt,mn.Synchronize_s_aabb2=new Bt,mn.Synchronize_s_displacement=new ke,(cn=e.b2BodyType||(e.b2BodyType={}))[cn.b2_unknown=-1]="b2_unknown",cn[cn.b2_staticBody=0]="b2_staticBody",cn[cn.b2_kinematicBody=1]="b2_kinematicBody",cn[cn.b2_dynamicBody=2]="b2_dynamicBody";var _n,pn,vn=l((function t(){o(this,t),this.type=e.b2BodyType.b2_staticBody,this.position=new ke(0,0),this.angle=0,this.linearVelocity=new ke(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.active=!0,this.userData=null,this.gravityScale=1})),yn=function(){function t(n,r){o(this,t),this.m_type=e.b2BodyType.b2_staticBody,this.m_islandFlag=!1,this.m_awakeFlag=!1,this.m_autoSleepFlag=!1,this.m_bulletFlag=!1,this.m_fixedRotationFlag=!1,this.m_activeFlag=!1,this.m_toiFlag=!1,this.m_islandIndex=0,this.m_xf=new Ee,this.m_xf0=new Ee,this.m_sweep=new Re,this.m_linearVelocity=new ke,this.m_angularVelocity=0,this.m_force=new ke,this.m_torque=0,this.m_prev=null,this.m_next=null,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_jointList=null,this.m_contactList=null,this.m_mass=1,this.m_invMass=1,this.m_I=0,this.m_invI=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_gravityScale=1,this.m_sleepTime=0,this.m_userData=null,this.m_controllerList=null,this.m_controllerCount=0,this.m_bulletFlag=i(n.bullet,!1),this.m_fixedRotationFlag=i(n.fixedRotation,!1),this.m_autoSleepFlag=i(n.allowSleep,!0),this.m_awakeFlag=i(n.awake,!0),this.m_activeFlag=i(n.active,!0),this.m_world=r,this.m_xf.p.Copy(i(n.position,ke.ZERO)),this.m_xf.q.SetAngle(i(n.angle,0)),this.m_xf0.Copy(this.m_xf),this.m_sweep.localCenter.SetZero(),this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a=this.m_xf.q.GetAngle(),this.m_sweep.alpha0=0,this.m_linearVelocity.Copy(i(n.linearVelocity,ke.ZERO)),this.m_angularVelocity=i(n.angularVelocity,0),this.m_linearDamping=i(n.linearDamping,0),this.m_angularDamping=i(n.angularDamping,0),this.m_gravityScale=i(n.gravityScale,1),this.m_force.SetZero(),this.m_torque=0,this.m_sleepTime=0,this.m_type=i(n.type,e.b2BodyType.b2_staticBody),n.type===e.b2BodyType.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_userData=n.userData,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_controllerList=null,this.m_controllerCount=0}return l(t,[{key:"CreateFixture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e instanceof sn?this.CreateFixtureShapeDensity(e,t):this.CreateFixtureDef(e)}},{key:"CreateFixtureDef",value:function(e){if(this.m_world.IsLocked())throw new Error;var t=new mn(e,this);return t.Create(e),this.m_activeFlag&&t.CreateProxies(this.m_xf),t.m_next=this.m_fixtureList,this.m_fixtureList=t,++this.m_fixtureCount,t.m_density>0&&this.ResetMassData(),this.m_world.m_newFixture=!0,t}},{key:"CreateFixtureShapeDensity",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.CreateFixtureShapeDensity_s_def;return n.shape=e,n.density=i,this.CreateFixtureDef(n)}},{key:"DestroyFixture",value:function(e){if(this.m_world.IsLocked())throw new Error;for(var t=this.m_fixtureList,i=null;null!==t;){if(t===e){i?i.m_next=e.m_next:this.m_fixtureList=e.m_next;break}i=t,t=t.m_next}for(var n=this.m_contactList;n;){var r=n.contact;n=n.next;var s=r.GetFixtureA(),a=r.GetFixtureB();e!==s&&e!==a||this.m_world.m_contactManager.Destroy(r)}this.m_activeFlag&&e.DestroyProxies(),e.m_next=null,e.Destroy(),--this.m_fixtureCount,this.ResetMassData()}},{key:"SetTransformVec",value:function(e,t){this.SetTransformXY(e.x,e.y,t)}},{key:"SetTransformXY",value:function(e,t,i){if(this.m_world.IsLocked())throw new Error;this.m_xf.q.SetAngle(i),this.m_xf.p.Set(e,t),this.m_xf0.Copy(this.m_xf),Ee.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=i,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=i;for(var n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},{key:"SetTransform",value:function(e){this.SetTransformVec(e.p,e.GetAngle())}},{key:"GetTransform",value:function(){return this.m_xf}},{key:"GetPosition",value:function(){return this.m_xf.p}},{key:"SetPosition",value:function(e){this.SetTransformVec(e,this.GetAngle())}},{key:"SetPositionXY",value:function(e,t){this.SetTransformXY(e,t,this.GetAngle())}},{key:"GetAngle",value:function(){return this.m_sweep.a}},{key:"SetAngle",value:function(e){this.SetTransformVec(this.GetPosition(),e)}},{key:"GetWorldCenter",value:function(){return this.m_sweep.c}},{key:"GetLocalCenter",value:function(){return this.m_sweep.localCenter}},{key:"SetLinearVelocity",value:function(t){this.m_type!==e.b2BodyType.b2_staticBody&&(ke.DotVV(t,t)>0&&this.SetAwake(!0),this.m_linearVelocity.Copy(t))}},{key:"GetLinearVelocity",value:function(){return this.m_linearVelocity}},{key:"SetAngularVelocity",value:function(t){this.m_type!==e.b2BodyType.b2_staticBody&&(t*t>0&&this.SetAwake(!0),this.m_angularVelocity=t)}},{key:"GetAngularVelocity",value:function(){return this.m_angularVelocity}},{key:"GetDefinition",value:function(e){return e.type=this.GetType(),e.allowSleep=this.m_autoSleepFlag,e.angle=this.GetAngle(),e.angularDamping=this.m_angularDamping,e.gravityScale=this.m_gravityScale,e.angularVelocity=this.m_angularVelocity,e.fixedRotation=this.m_fixedRotationFlag,e.bullet=this.m_bulletFlag,e.awake=this.m_awakeFlag,e.linearDamping=this.m_linearDamping,e.linearVelocity.Copy(this.GetLinearVelocity()),e.position.Copy(this.GetPosition()),e.userData=this.GetUserData(),e}},{key:"ApplyForce",value:function(t,i){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.m_type===e.b2BodyType.b2_dynamicBody&&(n&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(i.x-this.m_sweep.c.x)*t.y-(i.y-this.m_sweep.c.y)*t.x))}},{key:"ApplyForceToCenter",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.m_type===e.b2BodyType.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y))}},{key:"ApplyTorque",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.m_type===e.b2BodyType.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))}},{key:"ApplyLinearImpulse",value:function(t,i){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.m_type===e.b2BodyType.b2_dynamicBody&&(n&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((i.x-this.m_sweep.c.x)*t.y-(i.y-this.m_sweep.c.y)*t.x)))}},{key:"ApplyLinearImpulseToCenter",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.m_type===e.b2BodyType.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y))}},{key:"ApplyAngularImpulse",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.m_type===e.b2BodyType.b2_dynamicBody&&(i&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))}},{key:"GetMass",value:function(){return this.m_mass}},{key:"GetInertia",value:function(){return this.m_I+this.m_mass*ke.DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter)}},{key:"GetMassData",value:function(e){return e.mass=this.m_mass,e.I=this.m_I+this.m_mass*ke.DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter),e.center.Copy(this.m_sweep.localCenter),e}},{key:"SetMassData",value:function(i){if(this.m_world.IsLocked())throw new Error;if(this.m_type===e.b2BodyType.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=i.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,i.I>0&&!this.m_fixedRotationFlag&&(this.m_I=i.I-this.m_mass*ke.DotVV(i.center,i.center),this.m_invI=1/this.m_I);var n=t.SetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(i.center),Ee.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),ke.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,ke.SubVV(this.m_sweep.c,n,ke.s_t0),this.m_linearVelocity)}}},{key:"ResetMassData",value:function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type===e.b2BodyType.b2_staticBody||this.m_type===e.b2BodyType.b2_kinematicBody)return this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);for(var i=t.ResetMassData_s_localCenter.SetZero(),n=this.m_fixtureList;n;n=n.m_next)if(0!==n.m_density){var r=n.GetMassData(t.ResetMassData_s_massData);this.m_mass+=r.mass,i.x+=r.center.x*r.mass,i.y+=r.center.y*r.mass,this.m_I+=r.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,i.x*=this.m_invMass,i.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&!this.m_fixedRotationFlag?(this.m_I-=this.m_mass*ke.DotVV(i,i),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var s=t.ResetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(i),Ee.MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),ke.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,ke.SubVV(this.m_sweep.c,s,ke.s_t0),this.m_linearVelocity)}},{key:"GetWorldPoint",value:function(e,t){return Ee.MulXV(this.m_xf,e,t)}},{key:"GetWorldVector",value:function(e,t){return Le.MulRV(this.m_xf.q,e,t)}},{key:"GetLocalPoint",value:function(e,t){return Ee.MulTXV(this.m_xf,e,t)}},{key:"GetLocalVector",value:function(e,t){return Le.MulTRV(this.m_xf.q,e,t)}},{key:"GetLinearVelocityFromWorldPoint",value:function(e,t){return ke.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,ke.SubVV(e,this.m_sweep.c,ke.s_t0),t)}},{key:"GetLinearVelocityFromLocalPoint",value:function(e,t){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(e,t),t)}},{key:"GetLinearDamping",value:function(){return this.m_linearDamping}},{key:"SetLinearDamping",value:function(e){this.m_linearDamping=e}},{key:"GetAngularDamping",value:function(){return this.m_angularDamping}},{key:"SetAngularDamping",value:function(e){this.m_angularDamping=e}},{key:"GetGravityScale",value:function(){return this.m_gravityScale}},{key:"SetGravityScale",value:function(e){this.m_gravityScale=e}},{key:"SetType",value:function(t){if(this.m_world.IsLocked())throw new Error;if(this.m_type!==t){this.m_type=t,this.ResetMassData(),this.m_type===e.b2BodyType.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures()),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var i=this.m_contactList;i;){var n=i;i=i.next,this.m_world.m_contactManager.Destroy(n.contact)}this.m_contactList=null;for(var r=this.m_fixtureList;r;r=r.m_next)r.TouchProxies()}}},{key:"GetType",value:function(){return this.m_type}},{key:"SetBullet",value:function(e){this.m_bulletFlag=e}},{key:"IsBullet",value:function(){return this.m_bulletFlag}},{key:"SetSleepingAllowed",value:function(e){this.m_autoSleepFlag=e,e||this.SetAwake(!0)}},{key:"IsSleepingAllowed",value:function(){return this.m_autoSleepFlag}},{key:"SetAwake",value:function(e){e?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)}},{key:"IsAwake",value:function(){return this.m_awakeFlag}},{key:"SetActive",value:function(e){if(this.m_world.IsLocked())throw new Error;if(e!==this.IsActive())if(this.m_activeFlag=e,e)for(var t=this.m_fixtureList;t;t=t.m_next)t.CreateProxies(this.m_xf);else{for(var i=this.m_fixtureList;i;i=i.m_next)i.DestroyProxies();for(var n=this.m_contactList;n;){var r=n;n=n.next,this.m_world.m_contactManager.Destroy(r.contact)}this.m_contactList=null}}},{key:"IsActive",value:function(){return this.m_activeFlag}},{key:"SetFixedRotation",value:function(e){this.m_fixedRotationFlag!==e&&(this.m_fixedRotationFlag=e,this.m_angularVelocity=0,this.ResetMassData())}},{key:"IsFixedRotation",value:function(){return this.m_fixedRotationFlag}},{key:"GetFixtureList",value:function(){return this.m_fixtureList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(e){this.m_userData=e}},{key:"GetWorld",value:function(){return this.m_world}},{key:"Dump",value:function(t){var i=this.m_islandIndex;t("{\n"),t("  const bd: b2BodyDef = new b2BodyDef();\n");var n="";switch(this.m_type){case e.b2BodyType.b2_staticBody:n="b2BodyType.b2_staticBody";break;case e.b2BodyType.b2_kinematicBody:n="b2BodyType.b2_kinematicBody";break;case e.b2BodyType.b2_dynamicBody:n="b2BodyType.b2_dynamicBody"}t("  bd.type = %s;\n",n),t("  bd.position.Set(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y),t("  bd.angle = %.15f;\n",this.m_sweep.a),t("  bd.linearVelocity.Set(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y),t("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity),t("  bd.linearDamping = %.15f;\n",this.m_linearDamping),t("  bd.angularDamping = %.15f;\n",this.m_angularDamping),t("  bd.allowSleep = %s;\n",this.m_autoSleepFlag?"true":"false"),t("  bd.awake = %s;\n",this.m_awakeFlag?"true":"false"),t("  bd.fixedRotation = %s;\n",this.m_fixedRotationFlag?"true":"false"),t("  bd.bullet = %s;\n",this.m_bulletFlag?"true":"false"),t("  bd.active = %s;\n",this.m_activeFlag?"true":"false"),t("  bd.gravityScale = %.15f;\n",this.m_gravityScale),t("\n"),t("  bodies[%d] = this.m_world.CreateBody(bd);\n",this.m_islandIndex),t("\n");for(var r=this.m_fixtureList;r;r=r.m_next)t("  {\n"),r.Dump(t,i),t("  }\n");t("}\n")}},{key:"SynchronizeFixtures",value:function(){var e=t.SynchronizeFixtures_s_xf1;e.q.SetAngle(this.m_sweep.a0),Le.MulRV(e.q,this.m_sweep.localCenter,e.p),ke.SubVV(this.m_sweep.c0,e.p,e.p);for(var i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(e,this.m_xf)}},{key:"SynchronizeTransform",value:function(){this.m_xf.q.SetAngle(this.m_sweep.a),Le.MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),ke.SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)}},{key:"ShouldCollide",value:function(t){return(this.m_type!==e.b2BodyType.b2_staticBody||t.m_type!==e.b2BodyType.b2_staticBody)&&this.ShouldCollideConnected(t)}},{key:"ShouldCollideConnected",value:function(e){for(var t=this.m_jointList;t;t=t.next)if(t.other===e&&!t.joint.m_collideConnected)return!1;return!0}},{key:"Advance",value:function(e){this.m_sweep.Advance(e),this.m_sweep.c.Copy(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_xf.q.SetAngle(this.m_sweep.a),Le.MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),ke.SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)}},{key:"GetControllerList",value:function(){return this.m_controllerList}},{key:"GetControllerCount",value:function(){return this.m_controllerCount}}]),t}();yn.CreateFixtureShapeDensity_s_def=new fn,yn.SetMassData_s_oldCenter=new ke,yn.ResetMassData_s_localCenter=new ke,yn.ResetMassData_s_oldCenter=new ke,yn.ResetMassData_s_massData=new rn,yn.SynchronizeFixtures_s_xf1=new Ee,(pn=e.b2JointType||(e.b2JointType={}))[pn.e_unknownJoint=0]="e_unknownJoint",pn[pn.e_revoluteJoint=1]="e_revoluteJoint",pn[pn.e_prismaticJoint=2]="e_prismaticJoint",pn[pn.e_distanceJoint=3]="e_distanceJoint",pn[pn.e_pulleyJoint=4]="e_pulleyJoint",pn[pn.e_mouseJoint=5]="e_mouseJoint",pn[pn.e_gearJoint=6]="e_gearJoint",pn[pn.e_wheelJoint=7]="e_wheelJoint",pn[pn.e_weldJoint=8]="e_weldJoint",pn[pn.e_frictionJoint=9]="e_frictionJoint",pn[pn.e_ropeJoint=10]="e_ropeJoint",pn[pn.e_motorJoint=11]="e_motorJoint",pn[pn.e_areaJoint=12]="e_areaJoint",(_n=e.b2LimitState||(e.b2LimitState={}))[_n.e_inactiveLimit=0]="e_inactiveLimit",_n[_n.e_atLowerLimit=1]="e_atLowerLimit",_n[_n.e_atUpperLimit=2]="e_atUpperLimit",_n[_n.e_equalLimits=3]="e_equalLimits";var gn=function(){function e(){o(this,e),this.linear=new ke,this.angularA=0,this.angularB=0}return l(e,[{key:"SetZero",value:function(){return this.linear.SetZero(),this.angularA=0,this.angularB=0,this}},{key:"Set",value:function(e,t,i){return this.linear.Copy(e),this.angularA=t,this.angularB=i,this}}]),e}(),xn=l((function e(t,i){o(this,e),this.prev=null,this.next=null,this.joint=t,this.other=i})),bn=l((function t(i){o(this,t),this.type=e.b2JointType.e_unknownJoint,this.userData=null,this.collideConnected=!1,this.type=i})),wn=function(){function t(n){o(this,t),this.m_type=e.b2JointType.e_unknownJoint,this.m_prev=null,this.m_next=null,this.m_index=0,this.m_islandFlag=!1,this.m_collideConnected=!1,this.m_userData=null,this.m_type=n.type,this.m_edgeA=new xn(this,n.bodyB),this.m_edgeB=new xn(this,n.bodyA),this.m_bodyA=n.bodyA,this.m_bodyB=n.bodyB,this.m_collideConnected=i(n.collideConnected,!1),this.m_userData=n.userData}return l(t,[{key:"GetType",value:function(){return this.m_type}},{key:"GetBodyA",value:function(){return this.m_bodyA}},{key:"GetBodyB",value:function(){return this.m_bodyB}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(e){this.m_userData=e}},{key:"IsActive",value:function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()}},{key:"GetCollideConnected",value:function(){return this.m_collideConnected}},{key:"Dump",value:function(e){e("// Dump is not supported for this joint type.\n")}},{key:"ShiftOrigin",value:function(e){}}]),t}(),An=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_distanceJoint)).localAnchorA=new ke,t.localAnchorB=new ke,t.length=1,t.frequencyHz=0,t.dampingRatio=0,t}return l(n,[{key:"Initialize",value:function(e,t,i,n){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(n,this.localAnchorB),this.length=ke.DistanceVV(i,n),this.frequencyHz=0,this.dampingRatio=0}}]),n}(bn),Sn=function(e){s(n,e);var t=a(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).m_frequencyHz=0,r.m_dampingRatio=0,r.m_bias=0,r.m_localAnchorA=new ke,r.m_localAnchorB=new ke,r.m_gamma=0,r.m_impulse=0,r.m_length=0,r.m_indexA=0,r.m_indexB=0,r.m_u=new ke,r.m_rA=new ke,r.m_rB=new ke,r.m_localCenterA=new ke,r.m_localCenterB=new ke,r.m_invMassA=0,r.m_invMassB=0,r.m_invIA=0,r.m_invIB=0,r.m_mass=0,r.m_qA=new Le,r.m_qB=new Le,r.m_lalcA=new ke,r.m_lalcB=new ke,r.m_frequencyHz=i(e.frequencyHz,0),r.m_dampingRatio=i(e.dampingRatio,0),r.m_localAnchorA.Copy(e.localAnchorA),r.m_localAnchorB.Copy(e.localAnchorB),r.m_length=e.length,r}return l(n,[{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return t.x=e*this.m_impulse*this.m_u.x,t.y=e*this.m_impulse*this.m_u.y,t}},{key:"GetReactionTorque",value:function(e){return 0}},{key:"GetLocalAnchorA",value:function(){return this.m_localAnchorA}},{key:"GetLocalAnchorB",value:function(){return this.m_localAnchorB}},{key:"SetLength",value:function(e){this.m_length=e}},{key:"Length",value:function(){return this.m_length}},{key:"SetFrequency",value:function(e){this.m_frequencyHz=e}},{key:"GetFrequency",value:function(){return this.m_frequencyHz}},{key:"SetDampingRatio",value:function(e){this.m_dampingRatio=e}},{key:"GetDampingRatio",value:function(){return this.m_dampingRatio}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2DistanceJointDef = new b2DistanceJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),e("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),e("  jd.length = %.15f;\n",this.m_length),e("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),e("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},{key:"InitVelocityConstraints",value:function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,r=e.velocities[this.m_indexA].v,s=e.velocities[this.m_indexA].w,a=e.positions[this.m_indexB].c,o=e.positions[this.m_indexB].a,l=e.velocities[this.m_indexB].v,u=e.velocities[this.m_indexB].w,h=this.m_qA.SetAngle(i),c=this.m_qB.SetAngle(o);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),Le.MulRV(h,this.m_lalcA,this.m_rA),ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),Le.MulRV(c,this.m_lalcB,this.m_rB),this.m_u.x=a.x+this.m_rB.x-t.x-this.m_rA.x,this.m_u.y=a.y+this.m_rB.y-t.y-this.m_rA.y;var f=this.m_u.Length();f>y?this.m_u.SelfMul(1/f):this.m_u.SetZero();var m=ke.CrossVV(this.m_rA,this.m_u),_=ke.CrossVV(this.m_rB,this.m_u),p=this.m_invMassA+this.m_invIA*m*m+this.m_invMassB+this.m_invIB*_*_;if(this.m_mass=0!==p?1/p:0,this.m_frequencyHz>0){var v=f-this.m_length,g=2*d*this.m_frequencyHz,x=2*this.m_mass*this.m_dampingRatio*g,b=this.m_mass*g*g,w=e.step.dt;this.m_gamma=w*(x+w*b),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=v*w*b*this.m_gamma,p+=this.m_gamma,this.m_mass=0!==p?1/p:0}else this.m_gamma=0,this.m_bias=0;if(e.step.warmStarting){this.m_impulse*=e.step.dtRatio;var A=ke.MulSV(this.m_impulse,this.m_u,n.InitVelocityConstraints_s_P);r.SelfMulSub(this.m_invMassA,A),s-=this.m_invIA*ke.CrossVV(this.m_rA,A),l.SelfMulAdd(this.m_invMassB,A),u+=this.m_invIB*ke.CrossVV(this.m_rB,A)}else this.m_impulse=0;e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=u}},{key:"SolveVelocityConstraints",value:function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,r=e.velocities[this.m_indexB].v,s=e.velocities[this.m_indexB].w,a=ke.AddVCrossSV(t,i,this.m_rA,n.SolveVelocityConstraints_s_vpA),o=ke.AddVCrossSV(r,s,this.m_rB,n.SolveVelocityConstraints_s_vpB),l=ke.DotVV(this.m_u,ke.SubVV(o,a,ke.s_t0)),u=-this.m_mass*(l+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=u;var h=ke.MulSV(u,this.m_u,n.SolveVelocityConstraints_s_P);t.SelfMulSub(this.m_invMassA,h),i-=this.m_invIA*ke.CrossVV(this.m_rA,h),r.SelfMulAdd(this.m_invMassB,h),s+=this.m_invIB*ke.CrossVV(this.m_rB,h),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=s}},{key:"SolvePositionConstraints",value:function(e){if(this.m_frequencyHz>0)return!0;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,r=e.positions[this.m_indexB].c,s=e.positions[this.m_indexB].a,a=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(s),l=Le.MulRV(a,this.m_lalcA,this.m_rA),u=Le.MulRV(o,this.m_lalcB,this.m_rB),h=this.m_u;h.x=r.x+u.x-t.x-l.x,h.y=r.y+u.y-t.y-l.y;var c=this.m_u.Normalize()-this.m_length;c=ue(c,-S,S);var f=-this.m_mass*c,d=ke.MulSV(f,h,n.SolvePositionConstraints_s_P);return t.SelfMulSub(this.m_invMassA,d),i-=this.m_invIA*ke.CrossVV(l,d),r.SelfMulAdd(this.m_invMassB,d),s+=this.m_invIB*ke.CrossVV(u,d),e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=s,ae(c)<y}}]),n}(wn);Sn.InitVelocityConstraints_s_P=new ke,Sn.SolveVelocityConstraints_s_vpA=new ke,Sn.SolveVelocityConstraints_s_vpB=new ke,Sn.SolveVelocityConstraints_s_P=new ke,Sn.SolvePositionConstraints_s_P=new ke;var Mn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_areaJoint)).bodies=[],t.frequencyHz=0,t.dampingRatio=0,t}return l(n,[{key:"AddBody",value:function(e){this.bodies.push(e),1===this.bodies.length?this.bodyA=e:2===this.bodies.length&&(this.bodyB=e)}}]),n}(bn),Cn=function(e){s(n,e);var t=a(n);function n(e){var r;o(this,n),(r=t.call(this,e)).m_frequencyHz=0,r.m_dampingRatio=0,r.m_impulse=0,r.m_targetArea=0,r.m_bodies=e.bodies,r.m_frequencyHz=i(e.frequencyHz,0),r.m_dampingRatio=i(e.dampingRatio,0),r.m_targetLengths=ie(e.bodies.length),r.m_normals=ke.MakeArray(e.bodies.length),r.m_joints=[],r.m_deltas=ke.MakeArray(e.bodies.length),r.m_delta=new ke;var s=new An;s.frequencyHz=r.m_frequencyHz,s.dampingRatio=r.m_dampingRatio,r.m_targetArea=0;for(var a=0;a<r.m_bodies.length;++a){var l=r.m_bodies[a],u=r.m_bodies[(a+1)%r.m_bodies.length],h=l.GetWorldCenter(),c=u.GetWorldCenter();r.m_targetLengths[a]=ke.DistanceVV(h,c),r.m_targetArea+=ke.CrossVV(h,c),s.Initialize(l,u,h,c),r.m_joints[a]=l.GetWorld().CreateJoint(s)}return r.m_targetArea*=.5,r}return l(n,[{key:"GetAnchorA",value:function(e){return e}},{key:"GetAnchorB",value:function(e){return e}},{key:"GetReactionForce",value:function(e,t){return t}},{key:"GetReactionTorque",value:function(e){return 0}},{key:"SetFrequency",value:function(e){this.m_frequencyHz=e;for(var t=0;t<this.m_joints.length;++t)this.m_joints[t].SetFrequency(e)}},{key:"GetFrequency",value:function(){return this.m_frequencyHz}},{key:"SetDampingRatio",value:function(e){this.m_dampingRatio=e;for(var t=0;t<this.m_joints.length;++t)this.m_joints[t].SetDampingRatio(e)}},{key:"GetDampingRatio",value:function(){return this.m_dampingRatio}},{key:"Dump",value:function(e){e("Area joint dumping is not supported.\n")}},{key:"InitVelocityConstraints",value:function(e){for(var t=0;t<this.m_bodies.length;++t){var i=this.m_bodies[(t+this.m_bodies.length-1)%this.m_bodies.length],n=this.m_bodies[(t+1)%this.m_bodies.length],r=e.positions[i.m_islandIndex].c,s=e.positions[n.m_islandIndex].c,a=this.m_deltas[t];ke.SubVV(s,r,a)}if(e.step.warmStarting){this.m_impulse*=e.step.dtRatio;for(var o=0;o<this.m_bodies.length;++o){var l=this.m_bodies[o],u=e.velocities[l.m_islandIndex].v,h=this.m_deltas[o];u.x+=l.m_invMass*h.y*.5*this.m_impulse,u.y+=l.m_invMass*-h.x*.5*this.m_impulse}}else this.m_impulse=0}},{key:"SolveVelocityConstraints",value:function(e){for(var t=0,i=0,n=0;n<this.m_bodies.length;++n){var r=this.m_bodies[n],s=e.velocities[r.m_islandIndex].v,a=this.m_deltas[n];t+=a.LengthSquared()/r.GetMass(),i+=ke.CrossVV(s,a)}var o=-2*i/t;this.m_impulse+=o;for(var l=0;l<this.m_bodies.length;++l){var u=this.m_bodies[l],h=e.velocities[u.m_islandIndex].v,c=this.m_deltas[l];h.x+=u.m_invMass*c.y*.5*o,h.y+=u.m_invMass*-c.x*.5*o}}},{key:"SolvePositionConstraints",value:function(e){for(var t=0,i=0,n=0;n<this.m_bodies.length;++n){var r=this.m_bodies[n],s=this.m_bodies[(n+1)%this.m_bodies.length],a=e.positions[r.m_islandIndex].c,o=e.positions[s.m_islandIndex].c,l=ke.SubVV(o,a,this.m_delta),u=l.Length();u<c&&(u=1),this.m_normals[n].x=l.y/u,this.m_normals[n].y=-l.x/u,t+=u,i+=ke.CrossVV(a,o)}i*=.5;for(var h=.5*(this.m_targetArea-i)/t,f=!0,d=0;d<this.m_bodies.length;++d){var m=this.m_bodies[d],_=e.positions[m.m_islandIndex].c,p=(d+1)%this.m_bodies.length,v=ke.AddVV(this.m_normals[d],this.m_normals[p],this.m_delta);v.SelfMul(h);var g=v.LengthSquared();g>fe(S)&&v.SelfMul(S/me(g)),g>fe(y)&&(f=!1),_.x+=v.x,_.y+=v.y}return f}}]),n}(wn),kn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_frictionJoint)).localAnchorA=new ke,t.localAnchorB=new ke,t.maxForce=0,t.maxTorque=0,t}return l(n,[{key:"Initialize",value:function(e,t,i){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB)}}]),n}(bn),Bn=function(e){s(n,e);var t=a(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).m_localAnchorA=new ke,r.m_localAnchorB=new ke,r.m_linearImpulse=new ke,r.m_angularImpulse=0,r.m_maxForce=0,r.m_maxTorque=0,r.m_indexA=0,r.m_indexB=0,r.m_rA=new ke,r.m_rB=new ke,r.m_localCenterA=new ke,r.m_localCenterB=new ke,r.m_invMassA=0,r.m_invMassB=0,r.m_invIA=0,r.m_invIB=0,r.m_linearMass=new Te,r.m_angularMass=0,r.m_qA=new Le,r.m_qB=new Le,r.m_lalcA=new ke,r.m_lalcB=new ke,r.m_K=new Te,r.m_localAnchorA.Copy(e.localAnchorA),r.m_localAnchorB.Copy(e.localAnchorB),r.m_linearImpulse.SetZero(),r.m_maxForce=i(e.maxForce,0),r.m_maxTorque=i(e.maxTorque,0),r.m_linearMass.SetZero(),r}return l(n,[{key:"InitVelocityConstraints",value:function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].a,i=e.velocities[this.m_indexA].v,n=e.velocities[this.m_indexA].w,r=e.positions[this.m_indexB].a,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,o=this.m_qA.SetAngle(t),l=this.m_qB.SetAngle(r);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var u=Le.MulRV(o,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var h=Le.MulRV(l,this.m_lalcB,this.m_rB),c=this.m_invMassA,f=this.m_invMassB,d=this.m_invIA,m=this.m_invIB,_=this.m_K;if(_.ex.x=c+f+d*u.y*u.y+m*h.y*h.y,_.ex.y=-d*u.x*u.y-m*h.x*h.y,_.ey.x=_.ex.y,_.ey.y=c+f+d*u.x*u.x+m*h.x*h.x,_.GetInverse(this.m_linearMass),this.m_angularMass=d+m,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),e.step.warmStarting){this.m_linearImpulse.SelfMul(e.step.dtRatio),this.m_angularImpulse*=e.step.dtRatio;var p=this.m_linearImpulse;i.SelfMulSub(c,p),n-=d*(ke.CrossVV(this.m_rA,p)+this.m_angularImpulse),s.SelfMulAdd(f,p),a+=m*(ke.CrossVV(this.m_rB,p)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;e.velocities[this.m_indexA].w=n,e.velocities[this.m_indexB].w=a}},{key:"SolveVelocityConstraints",value:function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,r=e.velocities[this.m_indexB].v,s=e.velocities[this.m_indexB].w,a=this.m_invMassA,o=this.m_invMassB,l=this.m_invIA,u=this.m_invIB,h=e.step.dt,c=s-i,f=-this.m_angularMass*c,d=this.m_angularImpulse,m=h*this.m_maxTorque;this.m_angularImpulse=ue(this.m_angularImpulse+f,-m,m),i-=l*(f=this.m_angularImpulse-d),s+=u*f;var _=ke.SubVV(ke.AddVCrossSV(r,s,this.m_rB,ke.s_t0),ke.AddVCrossSV(t,i,this.m_rA,ke.s_t1),n.SolveVelocityConstraints_s_Cdot_v2),p=Te.MulMV(this.m_linearMass,_,n.SolveVelocityConstraints_s_impulseV).SelfNeg(),v=n.SolveVelocityConstraints_s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(p);var y=h*this.m_maxForce;this.m_linearImpulse.LengthSquared()>y*y&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(y)),ke.SubVV(this.m_linearImpulse,v,p),t.SelfMulSub(a,p),i-=l*ke.CrossVV(this.m_rA,p),r.SelfMulAdd(o,p),s+=u*ke.CrossVV(this.m_rB,p),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=s}},{key:"SolvePositionConstraints",value:function(e){return!0}},{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return t.x=e*this.m_linearImpulse.x,t.y=e*this.m_linearImpulse.y,t}},{key:"GetReactionTorque",value:function(e){return e*this.m_angularImpulse}},{key:"GetLocalAnchorA",value:function(){return this.m_localAnchorA}},{key:"GetLocalAnchorB",value:function(){return this.m_localAnchorB}},{key:"SetMaxForce",value:function(e){this.m_maxForce=e}},{key:"GetMaxForce",value:function(){return this.m_maxForce}},{key:"SetMaxTorque",value:function(e){this.m_maxTorque=e}},{key:"GetMaxTorque",value:function(){return this.m_maxTorque}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2FrictionJointDef = new b2FrictionJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),e("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),e("  jd.maxForce = %.15f;\n",this.m_maxForce),e("  jd.maxTorque = %.15f;\n",this.m_maxTorque),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}]),n}(wn);Bn.SolveVelocityConstraints_s_Cdot_v2=new ke,Bn.SolveVelocityConstraints_s_impulseV=new ke,Bn.SolveVelocityConstraints_s_oldImpulseV=new ke;var Vn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_gearJoint)).ratio=1,t}return l(n)}(bn),Tn=function(t){s(r,t);var n=a(r);function r(t){var s,a,l;o(this,r),(s=n.call(this,t)).m_typeA=e.b2JointType.e_unknownJoint,s.m_typeB=e.b2JointType.e_unknownJoint,s.m_localAnchorA=new ke,s.m_localAnchorB=new ke,s.m_localAnchorC=new ke,s.m_localAnchorD=new ke,s.m_localAxisC=new ke,s.m_localAxisD=new ke,s.m_referenceAngleA=0,s.m_referenceAngleB=0,s.m_constant=0,s.m_ratio=0,s.m_impulse=0,s.m_indexA=0,s.m_indexB=0,s.m_indexC=0,s.m_indexD=0,s.m_lcA=new ke,s.m_lcB=new ke,s.m_lcC=new ke,s.m_lcD=new ke,s.m_mA=0,s.m_mB=0,s.m_mC=0,s.m_mD=0,s.m_iA=0,s.m_iB=0,s.m_iC=0,s.m_iD=0,s.m_JvAC=new ke,s.m_JvBD=new ke,s.m_JwA=0,s.m_JwB=0,s.m_JwC=0,s.m_JwD=0,s.m_mass=0,s.m_qA=new Le,s.m_qB=new Le,s.m_qC=new Le,s.m_qD=new Le,s.m_lalcA=new ke,s.m_lalcB=new ke,s.m_lalcC=new ke,s.m_lalcD=new ke,s.m_joint1=t.joint1,s.m_joint2=t.joint2,s.m_typeA=s.m_joint1.GetType(),s.m_typeB=s.m_joint2.GetType(),s.m_bodyC=s.m_joint1.GetBodyA(),s.m_bodyA=s.m_joint1.GetBodyB();var u=s.m_bodyA.m_xf,h=s.m_bodyA.m_sweep.a,c=s.m_bodyC.m_xf,f=s.m_bodyC.m_sweep.a;if(s.m_typeA===e.b2JointType.e_revoluteJoint){var d=t.joint1;s.m_localAnchorC.Copy(d.m_localAnchorA),s.m_localAnchorA.Copy(d.m_localAnchorB),s.m_referenceAngleA=d.m_referenceAngle,s.m_localAxisC.SetZero(),a=h-f-s.m_referenceAngleA}else{var m=t.joint1;s.m_localAnchorC.Copy(m.m_localAnchorA),s.m_localAnchorA.Copy(m.m_localAnchorB),s.m_referenceAngleA=m.m_referenceAngle,s.m_localAxisC.Copy(m.m_localXAxisA);var _=s.m_localAnchorC,p=Le.MulTRV(c.q,ke.AddVV(Le.MulRV(u.q,s.m_localAnchorA,ke.s_t0),ke.SubVV(u.p,c.p,ke.s_t1),ke.s_t0),ke.s_t0);a=ke.DotVV(ke.SubVV(p,_,ke.s_t0),s.m_localAxisC)}s.m_bodyD=s.m_joint2.GetBodyA(),s.m_bodyB=s.m_joint2.GetBodyB();var v=s.m_bodyB.m_xf,y=s.m_bodyB.m_sweep.a,g=s.m_bodyD.m_xf,x=s.m_bodyD.m_sweep.a;if(s.m_typeB===e.b2JointType.e_revoluteJoint){var b=t.joint2;s.m_localAnchorD.Copy(b.m_localAnchorA),s.m_localAnchorB.Copy(b.m_localAnchorB),s.m_referenceAngleB=b.m_referenceAngle,s.m_localAxisD.SetZero(),l=y-x-s.m_referenceAngleB}else{var w=t.joint2;s.m_localAnchorD.Copy(w.m_localAnchorA),s.m_localAnchorB.Copy(w.m_localAnchorB),s.m_referenceAngleB=w.m_referenceAngle,s.m_localAxisD.Copy(w.m_localXAxisA);var A=s.m_localAnchorD,S=Le.MulTRV(g.q,ke.AddVV(Le.MulRV(v.q,s.m_localAnchorB,ke.s_t0),ke.SubVV(v.p,g.p,ke.s_t1),ke.s_t0),ke.s_t0);l=ke.DotVV(ke.SubVV(S,A,ke.s_t0),s.m_localAxisD)}return s.m_ratio=i(t.ratio,1),s.m_constant=a+s.m_ratio*l,s.m_impulse=0,s}return l(r,[{key:"InitVelocityConstraints",value:function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_indexC=this.m_bodyC.m_islandIndex,this.m_indexD=this.m_bodyD.m_islandIndex,this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter),this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter),this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var i=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v,s=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].a,o=t.velocities[this.m_indexB].v,l=t.velocities[this.m_indexB].w,u=t.positions[this.m_indexC].a,h=t.velocities[this.m_indexC].v,c=t.velocities[this.m_indexC].w,f=t.positions[this.m_indexD].a,d=t.velocities[this.m_indexD].v,m=t.velocities[this.m_indexD].w,_=this.m_qA.SetAngle(i),p=this.m_qB.SetAngle(a),v=this.m_qC.SetAngle(u),y=this.m_qD.SetAngle(f);if(this.m_mass=0,this.m_typeA===e.b2JointType.e_revoluteJoint)this.m_JvAC.SetZero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var g=Le.MulRV(v,this.m_localAxisC,r.InitVelocityConstraints_s_u);ke.SubVV(this.m_localAnchorC,this.m_lcC,this.m_lalcC);var x=Le.MulRV(v,this.m_lalcC,r.InitVelocityConstraints_s_rC);ke.SubVV(this.m_localAnchorA,this.m_lcA,this.m_lalcA);var b=Le.MulRV(_,this.m_lalcA,r.InitVelocityConstraints_s_rA);this.m_JvAC.Copy(g),this.m_JwC=ke.CrossVV(x,g),this.m_JwA=ke.CrossVV(b,g),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_typeB===e.b2JointType.e_revoluteJoint)this.m_JvBD.SetZero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{var w=Le.MulRV(y,this.m_localAxisD,r.InitVelocityConstraints_s_u);ke.SubVV(this.m_localAnchorD,this.m_lcD,this.m_lalcD);var A=Le.MulRV(y,this.m_lalcD,r.InitVelocityConstraints_s_rD);ke.SubVV(this.m_localAnchorB,this.m_lcB,this.m_lalcB);var S=Le.MulRV(p,this.m_lalcB,r.InitVelocityConstraints_s_rB);ke.MulSV(this.m_ratio,w,this.m_JvBD),this.m_JwD=this.m_ratio*ke.CrossVV(A,w),this.m_JwB=this.m_ratio*ke.CrossVV(S,w),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.step.warmStarting?(n.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),s+=this.m_iA*this.m_impulse*this.m_JwA,o.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),l+=this.m_iB*this.m_impulse*this.m_JwB,h.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),c-=this.m_iC*this.m_impulse*this.m_JwC,d.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),m-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,t.velocities[this.m_indexA].w=s,t.velocities[this.m_indexB].w=l,t.velocities[this.m_indexC].w=c,t.velocities[this.m_indexD].w=m}},{key:"SolveVelocityConstraints",value:function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,n=e.velocities[this.m_indexB].v,r=e.velocities[this.m_indexB].w,s=e.velocities[this.m_indexC].v,a=e.velocities[this.m_indexC].w,o=e.velocities[this.m_indexD].v,l=e.velocities[this.m_indexD].w,u=ke.DotVV(this.m_JvAC,ke.SubVV(t,s,ke.s_t0))+ke.DotVV(this.m_JvBD,ke.SubVV(n,o,ke.s_t0));u+=this.m_JwA*i-this.m_JwC*a+(this.m_JwB*r-this.m_JwD*l);var h=-this.m_mass*u;this.m_impulse+=h,t.SelfMulAdd(this.m_mA*h,this.m_JvAC),i+=this.m_iA*h*this.m_JwA,n.SelfMulAdd(this.m_mB*h,this.m_JvBD),r+=this.m_iB*h*this.m_JwB,s.SelfMulSub(this.m_mC*h,this.m_JvAC),a-=this.m_iC*h*this.m_JwC,o.SelfMulSub(this.m_mD*h,this.m_JvBD),l-=this.m_iD*h*this.m_JwD,e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=r,e.velocities[this.m_indexC].w=a,e.velocities[this.m_indexD].w=l}},{key:"SolvePositionConstraints",value:function(t){var i,n,s,a,o,l,u=t.positions[this.m_indexA].c,h=t.positions[this.m_indexA].a,c=t.positions[this.m_indexB].c,f=t.positions[this.m_indexB].a,d=t.positions[this.m_indexC].c,m=t.positions[this.m_indexC].a,_=t.positions[this.m_indexD].c,p=t.positions[this.m_indexD].a,v=this.m_qA.SetAngle(h),g=this.m_qB.SetAngle(f),x=this.m_qC.SetAngle(m),b=this.m_qD.SetAngle(p),w=0,A=this.m_JvAC,S=this.m_JvBD,M=0;if(this.m_typeA===e.b2JointType.e_revoluteJoint)A.SetZero(),s=1,o=1,M+=this.m_iA+this.m_iC,i=h-m-this.m_referenceAngleA;else{var C=Le.MulRV(x,this.m_localAxisC,r.SolvePositionConstraints_s_u),k=Le.MulRV(x,this.m_lalcC,r.SolvePositionConstraints_s_rC),B=Le.MulRV(v,this.m_lalcA,r.SolvePositionConstraints_s_rA);A.Copy(C),o=ke.CrossVV(k,C),s=ke.CrossVV(B,C),M+=this.m_mC+this.m_mA+this.m_iC*o*o+this.m_iA*s*s;var V=this.m_lalcC,T=Le.MulTRV(x,ke.AddVV(B,ke.SubVV(u,d,ke.s_t0),ke.s_t0),ke.s_t0);i=ke.DotVV(ke.SubVV(T,V,ke.s_t0),this.m_localAxisC)}if(this.m_typeB===e.b2JointType.e_revoluteJoint)S.SetZero(),a=this.m_ratio,l=this.m_ratio,M+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),n=f-p-this.m_referenceAngleB;else{var P=Le.MulRV(b,this.m_localAxisD,r.SolvePositionConstraints_s_u),L=Le.MulRV(b,this.m_lalcD,r.SolvePositionConstraints_s_rD),E=Le.MulRV(g,this.m_lalcB,r.SolvePositionConstraints_s_rB);ke.MulSV(this.m_ratio,P,S),l=this.m_ratio*ke.CrossVV(L,P),a=this.m_ratio*ke.CrossVV(E,P),M+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*l*l+this.m_iB*a*a;var I=this.m_lalcD,R=Le.MulTRV(b,ke.AddVV(E,ke.SubVV(c,_,ke.s_t0),ke.s_t0),ke.s_t0);n=ke.DotVV(ke.SubVV(R,I,ke.s_t0),this.m_localAxisD)}var F=i+this.m_ratio*n-this.m_constant,G=0;return M>0&&(G=-F/M),u.SelfMulAdd(this.m_mA*G,A),h+=this.m_iA*G*s,c.SelfMulAdd(this.m_mB*G,S),f+=this.m_iB*G*a,d.SelfMulSub(this.m_mC*G,A),m-=this.m_iC*G*o,_.SelfMulSub(this.m_mD*G,S),p-=this.m_iD*G*l,t.positions[this.m_indexA].a=h,t.positions[this.m_indexB].a=f,t.positions[this.m_indexC].a=m,t.positions[this.m_indexD].a=p,w<y}},{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return ke.MulSV(e*this.m_impulse,this.m_JvAC,t)}},{key:"GetReactionTorque",value:function(e){return e*this.m_impulse*this.m_JwA}},{key:"GetJoint1",value:function(){return this.m_joint1}},{key:"GetJoint2",value:function(){return this.m_joint2}},{key:"GetRatio",value:function(){return this.m_ratio}},{key:"SetRatio",value:function(e){this.m_ratio=e}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex,n=this.m_joint1.m_index,r=this.m_joint2.m_index;e("  const jd: b2GearJointDef = new b2GearJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.joint1 = joints[%d];\n",n),e("  jd.joint2 = joints[%d];\n",r),e("  jd.ratio = %.15f;\n",this.m_ratio),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}]),r}(wn);Tn.InitVelocityConstraints_s_u=new ke,Tn.InitVelocityConstraints_s_rA=new ke,Tn.InitVelocityConstraints_s_rB=new ke,Tn.InitVelocityConstraints_s_rC=new ke,Tn.InitVelocityConstraints_s_rD=new ke,Tn.SolvePositionConstraints_s_u=new ke,Tn.SolvePositionConstraints_s_rA=new ke,Tn.SolvePositionConstraints_s_rB=new ke,Tn.SolvePositionConstraints_s_rC=new ke,Tn.SolvePositionConstraints_s_rD=new ke;var Pn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_motorJoint)).linearOffset=new ke(0,0),t.angularOffset=0,t.maxForce=1,t.maxTorque=1,t.correctionFactor=.3,t}return l(n,[{key:"Initialize",value:function(e,t){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);var i=this.bodyA.GetAngle(),n=this.bodyB.GetAngle();this.angularOffset=n-i}}]),n}(bn),Ln=function(e){s(n,e);var t=a(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).m_linearOffset=new ke,r.m_angularOffset=0,r.m_linearImpulse=new ke,r.m_angularImpulse=0,r.m_maxForce=0,r.m_maxTorque=0,r.m_correctionFactor=.3,r.m_indexA=0,r.m_indexB=0,r.m_rA=new ke,r.m_rB=new ke,r.m_localCenterA=new ke,r.m_localCenterB=new ke,r.m_linearError=new ke,r.m_angularError=0,r.m_invMassA=0,r.m_invMassB=0,r.m_invIA=0,r.m_invIB=0,r.m_linearMass=new Te,r.m_angularMass=0,r.m_qA=new Le,r.m_qB=new Le,r.m_K=new Te,r.m_linearOffset.Copy(i(e.linearOffset,ke.ZERO)),r.m_linearImpulse.SetZero(),r.m_maxForce=i(e.maxForce,0),r.m_maxTorque=i(e.maxTorque,0),r.m_correctionFactor=i(e.correctionFactor,.3),r}return l(n,[{key:"GetAnchorA",value:function(e){var t=this.m_bodyA.GetPosition();return e.x=t.x,e.y=t.y,e}},{key:"GetAnchorB",value:function(e){var t=this.m_bodyB.GetPosition();return e.x=t.x,e.y=t.y,e}},{key:"GetReactionForce",value:function(e,t){return ke.MulSV(e,this.m_linearImpulse,t)}},{key:"GetReactionTorque",value:function(e){return e*this.m_angularImpulse}},{key:"SetLinearOffset",value:function(e){ke.IsEqualToV(e,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(e))}},{key:"GetLinearOffset",value:function(){return this.m_linearOffset}},{key:"SetAngularOffset",value:function(e){e!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=e)}},{key:"GetAngularOffset",value:function(){return this.m_angularOffset}},{key:"SetMaxForce",value:function(e){this.m_maxForce=e}},{key:"GetMaxForce",value:function(){return this.m_maxForce}},{key:"SetMaxTorque",value:function(e){this.m_maxTorque=e}},{key:"GetMaxTorque",value:function(){return this.m_maxTorque}},{key:"InitVelocityConstraints",value:function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,n=e.velocities[this.m_indexA].v,r=e.velocities[this.m_indexA].w,s=e.positions[this.m_indexB].c,a=e.positions[this.m_indexB].a,o=e.velocities[this.m_indexB].v,l=e.velocities[this.m_indexB].w,u=this.m_qA.SetAngle(i),h=this.m_qB.SetAngle(a),c=Le.MulRV(u,ke.SubVV(this.m_linearOffset,this.m_localCenterA,ke.s_t0),this.m_rA),f=Le.MulRV(h,ke.NegV(this.m_localCenterB,ke.s_t0),this.m_rB),d=this.m_invMassA,m=this.m_invMassB,_=this.m_invIA,p=this.m_invIB,v=this.m_K;if(v.ex.x=d+m+_*c.y*c.y+p*f.y*f.y,v.ex.y=-_*c.x*c.y-p*f.x*f.y,v.ey.x=v.ex.y,v.ey.y=d+m+_*c.x*c.x+p*f.x*f.x,v.GetInverse(this.m_linearMass),this.m_angularMass=_+p,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),ke.SubVV(ke.AddVV(s,f,ke.s_t0),ke.AddVV(t,c,ke.s_t1),this.m_linearError),this.m_angularError=a-i-this.m_angularOffset,e.step.warmStarting){this.m_linearImpulse.SelfMul(e.step.dtRatio),this.m_angularImpulse*=e.step.dtRatio;var y=this.m_linearImpulse;n.SelfMulSub(d,y),r-=_*(ke.CrossVV(c,y)+this.m_angularImpulse),o.SelfMulAdd(m,y),l+=p*(ke.CrossVV(f,y)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;e.velocities[this.m_indexA].w=r,e.velocities[this.m_indexB].w=l}},{key:"SolveVelocityConstraints",value:function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,r=e.velocities[this.m_indexB].v,s=e.velocities[this.m_indexB].w,a=this.m_invMassA,o=this.m_invMassB,l=this.m_invIA,u=this.m_invIB,h=e.step.dt,c=e.step.inv_dt,f=s-i+c*this.m_correctionFactor*this.m_angularError,d=-this.m_angularMass*f,m=this.m_angularImpulse,_=h*this.m_maxTorque;this.m_angularImpulse=ue(this.m_angularImpulse+d,-_,_),i-=l*(d=this.m_angularImpulse-m),s+=u*d;var p=this.m_rA,v=this.m_rB,y=ke.AddVV(ke.SubVV(ke.AddVV(r,ke.CrossSV(s,v,ke.s_t0),ke.s_t0),ke.AddVV(t,ke.CrossSV(i,p,ke.s_t1),ke.s_t1),ke.s_t2),ke.MulSV(c*this.m_correctionFactor,this.m_linearError,ke.s_t3),n.SolveVelocityConstraints_s_Cdot_v2),g=Te.MulMV(this.m_linearMass,y,n.SolveVelocityConstraints_s_impulse_v2).SelfNeg(),x=n.SolveVelocityConstraints_s_oldImpulse_v2.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(g);var b=h*this.m_maxForce;this.m_linearImpulse.LengthSquared()>b*b&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(b)),ke.SubVV(this.m_linearImpulse,x,g),t.SelfMulSub(a,g),i-=l*ke.CrossVV(p,g),r.SelfMulAdd(o,g),s+=u*ke.CrossVV(v,g),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=s}},{key:"SolvePositionConstraints",value:function(e){return!0}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2MotorJointDef = new b2MotorJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.linearOffset.Set(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y),e("  jd.angularOffset = %.15f;\n",this.m_angularOffset),e("  jd.maxForce = %.15f;\n",this.m_maxForce),e("  jd.maxTorque = %.15f;\n",this.m_maxTorque),e("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}]),n}(wn);Ln.SolveVelocityConstraints_s_Cdot_v2=new ke,Ln.SolveVelocityConstraints_s_impulse_v2=new ke,Ln.SolveVelocityConstraints_s_oldImpulse_v2=new ke;var En=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_mouseJoint)).target=new ke,t.maxForce=0,t.frequencyHz=5,t.dampingRatio=.7,t}return l(n)}(bn),In=function(e){s(n,e);var t=a(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).m_localAnchorB=new ke,r.m_targetA=new ke,r.m_frequencyHz=0,r.m_dampingRatio=0,r.m_beta=0,r.m_impulse=new ke,r.m_maxForce=0,r.m_gamma=0,r.m_indexA=0,r.m_indexB=0,r.m_rB=new ke,r.m_localCenterB=new ke,r.m_invMassB=0,r.m_invIB=0,r.m_mass=new Te,r.m_C=new ke,r.m_qB=new Le,r.m_lalcB=new ke,r.m_K=new Te,r.m_targetA.Copy(i(e.target,ke.ZERO)),Ee.MulTXV(r.m_bodyB.GetTransform(),r.m_targetA,r.m_localAnchorB),r.m_maxForce=i(e.maxForce,0),r.m_impulse.SetZero(),r.m_frequencyHz=i(e.frequencyHz,0),r.m_dampingRatio=i(e.dampingRatio,0),r.m_beta=0,r.m_gamma=0,r}return l(n,[{key:"SetTarget",value:function(e){this.m_bodyB.IsAwake()||this.m_bodyB.SetAwake(!0),this.m_targetA.Copy(e)}},{key:"GetTarget",value:function(){return this.m_targetA}},{key:"SetMaxForce",value:function(e){this.m_maxForce=e}},{key:"GetMaxForce",value:function(){return this.m_maxForce}},{key:"SetFrequency",value:function(e){this.m_frequencyHz=e}},{key:"GetFrequency",value:function(){return this.m_frequencyHz}},{key:"SetDampingRatio",value:function(e){this.m_dampingRatio=e}},{key:"GetDampingRatio",value:function(){return this.m_dampingRatio}},{key:"InitVelocityConstraints",value:function(e){this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexB].c,i=e.positions[this.m_indexB].a,n=e.velocities[this.m_indexB].v,r=e.velocities[this.m_indexB].w,s=this.m_qB.SetAngle(i),a=this.m_bodyB.GetMass(),o=2*d*this.m_frequencyHz,l=2*a*this.m_dampingRatio*o,u=a*(o*o),h=e.step.dt;this.m_gamma=h*(l+h*u),0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=h*u*this.m_gamma,ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),Le.MulRV(s,this.m_lalcB,this.m_rB);var c=this.m_K;c.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,c.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,c.ey.x=c.ex.y,c.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,c.GetInverse(this.m_mass),this.m_C.x=t.x+this.m_rB.x-this.m_targetA.x,this.m_C.y=t.y+this.m_rB.y-this.m_targetA.y,this.m_C.SelfMul(this.m_beta),r*=.98,e.step.warmStarting?(this.m_impulse.SelfMul(e.step.dtRatio),n.x+=this.m_invMassB*this.m_impulse.x,n.y+=this.m_invMassB*this.m_impulse.y,r+=this.m_invIB*ke.CrossVV(this.m_rB,this.m_impulse)):this.m_impulse.SetZero(),e.velocities[this.m_indexB].w=r}},{key:"SolveVelocityConstraints",value:function(e){var t=e.velocities[this.m_indexB].v,i=e.velocities[this.m_indexB].w,r=ke.AddVCrossSV(t,i,this.m_rB,n.SolveVelocityConstraints_s_Cdot),s=Te.MulMV(this.m_mass,ke.AddVV(r,ke.AddVV(this.m_C,ke.MulSV(this.m_gamma,this.m_impulse,ke.s_t0),ke.s_t0),ke.s_t0).SelfNeg(),n.SolveVelocityConstraints_s_impulse),a=n.SolveVelocityConstraints_s_oldImpulse.Copy(this.m_impulse);this.m_impulse.SelfAdd(s);var o=e.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>o*o&&this.m_impulse.SelfMul(o/this.m_impulse.Length()),ke.SubVV(this.m_impulse,a,s),t.SelfMulAdd(this.m_invMassB,s),i+=this.m_invIB*ke.CrossVV(this.m_rB,s),e.velocities[this.m_indexB].w=i}},{key:"SolvePositionConstraints",value:function(e){return!0}},{key:"GetAnchorA",value:function(e){return e.x=this.m_targetA.x,e.y=this.m_targetA.y,e}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return ke.MulSV(e,this.m_impulse,t)}},{key:"GetReactionTorque",value:function(e){return 0}},{key:"Dump",value:function(e){e("Mouse joint dumping is not supported.\n")}},{key:"ShiftOrigin",value:function(e){this.m_targetA.SelfSub(e)}}]),n}(wn);In.SolveVelocityConstraints_s_Cdot=new ke,In.SolveVelocityConstraints_s_impulse=new ke,In.SolveVelocityConstraints_s_oldImpulse=new ke;var Rn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_prismaticJoint)).localAnchorA=new ke,t.localAnchorB=new ke,t.localAxisA=new ke(1,0),t.referenceAngle=0,t.enableLimit=!1,t.lowerTranslation=0,t.upperTranslation=0,t.enableMotor=!1,t.maxMotorForce=0,t.motorSpeed=0,t}return l(n,[{key:"Initialize",value:function(e,t,i,n){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(n,this.localAxisA),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}]),n}(bn),Fn=function(t){s(r,t);var n=a(r);function r(t){var s;return o(this,r),(s=n.call(this,t)).m_localAnchorA=new ke,s.m_localAnchorB=new ke,s.m_localXAxisA=new ke,s.m_localYAxisA=new ke,s.m_referenceAngle=0,s.m_impulse=new Ve(0,0,0),s.m_motorImpulse=0,s.m_lowerTranslation=0,s.m_upperTranslation=0,s.m_maxMotorForce=0,s.m_motorSpeed=0,s.m_enableLimit=!1,s.m_enableMotor=!1,s.m_limitState=e.b2LimitState.e_inactiveLimit,s.m_indexA=0,s.m_indexB=0,s.m_localCenterA=new ke,s.m_localCenterB=new ke,s.m_invMassA=0,s.m_invMassB=0,s.m_invIA=0,s.m_invIB=0,s.m_axis=new ke(0,0),s.m_perp=new ke(0,0),s.m_s1=0,s.m_s2=0,s.m_a1=0,s.m_a2=0,s.m_K=new Pe,s.m_K3=new Pe,s.m_K2=new Te,s.m_motorMass=0,s.m_qA=new Le,s.m_qB=new Le,s.m_lalcA=new ke,s.m_lalcB=new ke,s.m_rA=new ke,s.m_rB=new ke,s.m_localAnchorA.Copy(i(t.localAnchorA,ke.ZERO)),s.m_localAnchorB.Copy(i(t.localAnchorB,ke.ZERO)),s.m_localXAxisA.Copy(i(t.localAxisA,new ke(1,0))).SelfNormalize(),ke.CrossOneV(s.m_localXAxisA,s.m_localYAxisA),s.m_referenceAngle=i(t.referenceAngle,0),s.m_lowerTranslation=i(t.lowerTranslation,0),s.m_upperTranslation=i(t.upperTranslation,0),s.m_maxMotorForce=i(t.maxMotorForce,0),s.m_motorSpeed=i(t.motorSpeed,0),s.m_enableLimit=i(t.enableLimit,!1),s.m_enableMotor=i(t.enableMotor,!1),s}return l(r,[{key:"InitVelocityConstraints",value:function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].c,n=t.positions[this.m_indexA].a,s=t.velocities[this.m_indexA].v,a=t.velocities[this.m_indexA].w,o=t.positions[this.m_indexB].c,l=t.positions[this.m_indexB].a,u=t.velocities[this.m_indexB].v,h=t.velocities[this.m_indexB].w,c=this.m_qA.SetAngle(n),f=this.m_qB.SetAngle(l);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var d=Le.MulRV(c,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var m=Le.MulRV(f,this.m_lalcB,this.m_rB),_=ke.AddVV(ke.SubVV(o,i,ke.s_t0),ke.SubVV(m,d,ke.s_t1),r.InitVelocityConstraints_s_d),p=this.m_invMassA,v=this.m_invMassB,g=this.m_invIA,x=this.m_invIB;if(Le.MulRV(c,this.m_localXAxisA,this.m_axis),this.m_a1=ke.CrossVV(ke.AddVV(_,d,ke.s_t0),this.m_axis),this.m_a2=ke.CrossVV(m,this.m_axis),this.m_motorMass=p+v+g*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),Le.MulRV(c,this.m_localYAxisA,this.m_perp),this.m_s1=ke.CrossVV(ke.AddVV(_,d,ke.s_t0),this.m_perp),this.m_s2=ke.CrossVV(m,this.m_perp),this.m_K.ex.x=p+v+g*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,this.m_K.ex.y=g*this.m_s1+x*this.m_s2,this.m_K.ex.z=g*this.m_s1*this.m_a1+x*this.m_s2*this.m_a2,this.m_K.ey.x=this.m_K.ex.y,this.m_K.ey.y=g+x,0===this.m_K.ey.y&&(this.m_K.ey.y=1),this.m_K.ey.z=g*this.m_a1+x*this.m_a2,this.m_K.ez.x=this.m_K.ex.z,this.m_K.ez.y=this.m_K.ey.z,this.m_K.ez.z=p+v+g*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_enableLimit){var b=ke.DotVV(this.m_axis,_);ae(this.m_upperTranslation-this.m_lowerTranslation)<2*y?this.m_limitState=e.b2LimitState.e_equalLimits:b<=this.m_lowerTranslation?this.m_limitState!==e.b2LimitState.e_atLowerLimit&&(this.m_limitState=e.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):b>=this.m_upperTranslation?this.m_limitState!==e.b2LimitState.e_atUpperLimit&&(this.m_limitState=e.b2LimitState.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=e.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=e.b2LimitState.e_inactiveLimit,this.m_impulse.z=0;if(this.m_enableMotor||(this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse.SelfMul(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio;var w=ke.AddVV(ke.MulSV(this.m_impulse.x,this.m_perp,ke.s_t0),ke.MulSV(this.m_motorImpulse+this.m_impulse.z,this.m_axis,ke.s_t1),r.InitVelocityConstraints_s_P),A=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,S=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;s.SelfMulSub(p,w),a-=g*A,u.SelfMulAdd(v,w),h+=x*S}else this.m_impulse.SetZero(),this.m_motorImpulse=0;t.velocities[this.m_indexA].w=a,t.velocities[this.m_indexB].w=h}},{key:"SolveVelocityConstraints",value:function(t){var i=t.velocities[this.m_indexA].v,n=t.velocities[this.m_indexA].w,s=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,o=this.m_invMassA,l=this.m_invMassB,u=this.m_invIA,h=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==e.b2LimitState.e_equalLimits){var c=ke.DotVV(this.m_axis,ke.SubVV(s,i,ke.s_t0))+this.m_a2*a-this.m_a1*n,f=this.m_motorMass*(this.m_motorSpeed-c),d=this.m_motorImpulse,m=t.step.dt*this.m_maxMotorForce;this.m_motorImpulse=ue(this.m_motorImpulse+f,-m,m),f=this.m_motorImpulse-d;var _=ke.MulSV(f,this.m_axis,r.SolveVelocityConstraints_s_P),p=f*this.m_a1,v=f*this.m_a2;i.SelfMulSub(o,_),n-=u*p,s.SelfMulAdd(l,_),a+=h*v}var y=ke.DotVV(this.m_perp,ke.SubVV(s,i,ke.s_t0))+this.m_s2*a-this.m_s1*n,g=a-n;if(this.m_enableLimit&&this.m_limitState!==e.b2LimitState.e_inactiveLimit){var x=ke.DotVV(this.m_axis,ke.SubVV(s,i,ke.s_t0))+this.m_a2*a-this.m_a1*n,b=r.SolveVelocityConstraints_s_f1.Copy(this.m_impulse),w=this.m_K.Solve33(-y,-g,-x,r.SolveVelocityConstraints_s_df3);this.m_impulse.SelfAdd(w),this.m_limitState===e.b2LimitState.e_atLowerLimit?this.m_impulse.z=le(this.m_impulse.z,0):this.m_limitState===e.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=oe(this.m_impulse.z,0));var A=-y-(this.m_impulse.z-b.z)*this.m_K.ez.x,S=-g-(this.m_impulse.z-b.z)*this.m_K.ez.y,M=this.m_K.Solve22(A,S,r.SolveVelocityConstraints_s_f2r);M.x+=b.x,M.y+=b.y,this.m_impulse.x=M.x,this.m_impulse.y=M.y,w.x=this.m_impulse.x-b.x,w.y=this.m_impulse.y-b.y,w.z=this.m_impulse.z-b.z;var C=ke.AddVV(ke.MulSV(w.x,this.m_perp,ke.s_t0),ke.MulSV(w.z,this.m_axis,ke.s_t1),r.SolveVelocityConstraints_s_P),k=w.x*this.m_s1+w.y+w.z*this.m_a1,B=w.x*this.m_s2+w.y+w.z*this.m_a2;i.SelfMulSub(o,C),n-=u*k,s.SelfMulAdd(l,C),a+=h*B}else{var V=this.m_K.Solve22(-y,-g,r.SolveVelocityConstraints_s_df2);this.m_impulse.x+=V.x,this.m_impulse.y+=V.y;var T=ke.MulSV(V.x,this.m_perp,r.SolveVelocityConstraints_s_P),P=V.x*this.m_s1+V.y,L=V.x*this.m_s2+V.y;i.SelfMulSub(o,T),n-=u*P,s.SelfMulAdd(l,T),a+=h*L}t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].w=a}},{key:"SolvePositionConstraints",value:function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,n=e.positions[this.m_indexB].c,s=e.positions[this.m_indexB].a,a=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(s),l=this.m_invMassA,u=this.m_invMassB,h=this.m_invIA,c=this.m_invIB,f=Le.MulRV(a,this.m_lalcA,this.m_rA),d=Le.MulRV(o,this.m_lalcB,this.m_rB),m=ke.SubVV(ke.AddVV(n,d,ke.s_t0),ke.AddVV(t,f,ke.s_t1),r.SolvePositionConstraints_s_d),_=Le.MulRV(a,this.m_localXAxisA,this.m_axis),p=ke.CrossVV(ke.AddVV(m,f,ke.s_t0),_),v=ke.CrossVV(d,_),x=Le.MulRV(a,this.m_localYAxisA,this.m_perp),b=ke.CrossVV(ke.AddVV(m,f,ke.s_t0),x),w=ke.CrossVV(d,x),A=r.SolvePositionConstraints_s_impulse,M=ke.DotVV(x,m),C=s-i-this.m_referenceAngle,k=ae(M),B=ae(C),V=!1,T=0;if(this.m_enableLimit){var P=ke.DotVV(_,m);ae(this.m_upperTranslation-this.m_lowerTranslation)<2*y?(T=ue(P,-S,S),k=le(k,ae(P)),V=!0):P<=this.m_lowerTranslation?(T=ue(P-this.m_lowerTranslation+y,-S,0),k=le(k,this.m_lowerTranslation-P),V=!0):P>=this.m_upperTranslation&&(T=ue(P-this.m_upperTranslation-y,0,S),k=le(k,P-this.m_upperTranslation),V=!0)}if(V){var L=l+u+h*b*b+c*w*w,E=h*b+c*w,I=h*b*p+c*w*v,R=h+c;0===R&&(R=1);var F=h*p+c*v,G=l+u+h*p*p+c*v*v,D=this.m_K3;D.ex.SetXYZ(L,E,I),D.ey.SetXYZ(E,R,F),D.ez.SetXYZ(I,F,G),A=D.Solve33(-M,-C,-T,A)}else{var O=l+u+h*b*b+c*w*w,N=h*b+c*w,z=h+c;0===z&&(z=1);var U=this.m_K2;U.ex.Set(O,N),U.ey.Set(N,z);var j=U.Solve(-M,-C,r.SolvePositionConstraints_s_impulse1);A.x=j.x,A.y=j.y,A.z=0}var W=ke.AddVV(ke.MulSV(A.x,x,ke.s_t0),ke.MulSV(A.z,_,ke.s_t1),r.SolvePositionConstraints_s_P),q=A.x*b+A.y+A.z*p,H=A.x*w+A.y+A.z*v;return t.SelfMulSub(l,W),i-=h*q,n.SelfMulAdd(u,W),s+=c*H,e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=s,k<=y&&B<=g}},{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return t.x=e*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t.y=e*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y),t}},{key:"GetReactionTorque",value:function(e){return e*this.m_impulse.y}},{key:"GetLocalAnchorA",value:function(){return this.m_localAnchorA}},{key:"GetLocalAnchorB",value:function(){return this.m_localAnchorB}},{key:"GetLocalAxisA",value:function(){return this.m_localXAxisA}},{key:"GetReferenceAngle",value:function(){return this.m_referenceAngle}},{key:"GetJointTranslation",value:function(){var e=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,r.GetJointTranslation_s_pA),t=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,r.GetJointTranslation_s_pB),i=ke.SubVV(t,e,r.GetJointTranslation_s_d),n=this.m_bodyA.GetWorldVector(this.m_localXAxisA,r.GetJointTranslation_s_axis);return ke.DotVV(i,n)}},{key:"GetJointSpeed",value:function(){var e=this.m_bodyA,t=this.m_bodyB;ke.SubVV(this.m_localAnchorA,e.m_sweep.localCenter,this.m_lalcA);var i=Le.MulRV(e.m_xf.q,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,t.m_sweep.localCenter,this.m_lalcB);var n=Le.MulRV(t.m_xf.q,this.m_lalcB,this.m_rB),r=ke.AddVV(e.m_sweep.c,i,ke.s_t0),s=ke.AddVV(t.m_sweep.c,n,ke.s_t1),a=ke.SubVV(s,r,ke.s_t2),o=e.GetWorldVector(this.m_localXAxisA,this.m_axis),l=e.m_linearVelocity,u=t.m_linearVelocity,h=e.m_angularVelocity,c=t.m_angularVelocity;return ke.DotVV(a,ke.CrossSV(h,o,ke.s_t0))+ke.DotVV(o,ke.SubVV(ke.AddVCrossSV(u,c,n,ke.s_t0),ke.AddVCrossSV(l,h,i,ke.s_t1),ke.s_t0))}},{key:"IsLimitEnabled",value:function(){return this.m_enableLimit}},{key:"EnableLimit",value:function(e){e!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=e,this.m_impulse.z=0)}},{key:"GetLowerLimit",value:function(){return this.m_lowerTranslation}},{key:"GetUpperLimit",value:function(){return this.m_upperTranslation}},{key:"SetLimits",value:function(e,t){e===this.m_lowerTranslation&&t===this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=e,this.m_upperTranslation=t,this.m_impulse.z=0)}},{key:"IsMotorEnabled",value:function(){return this.m_enableMotor}},{key:"EnableMotor",value:function(e){e!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e)}},{key:"SetMotorSpeed",value:function(e){e!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e)}},{key:"GetMotorSpeed",value:function(){return this.m_motorSpeed}},{key:"SetMaxMotorForce",value:function(e){e!==this.m_maxMotorForce&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=e)}},{key:"GetMaxMotorForce",value:function(){return this.m_maxMotorForce}},{key:"GetMotorForce",value:function(e){return e*this.m_motorImpulse}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2PrismaticJointDef = new b2PrismaticJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),e("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),e("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),e("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),e("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),e("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation),e("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation),e("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),e("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),e("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}]),r}(wn);Fn.InitVelocityConstraints_s_d=new ke,Fn.InitVelocityConstraints_s_P=new ke,Fn.SolveVelocityConstraints_s_P=new ke,Fn.SolveVelocityConstraints_s_f2r=new ke,Fn.SolveVelocityConstraints_s_f1=new Ve,Fn.SolveVelocityConstraints_s_df3=new Ve,Fn.SolveVelocityConstraints_s_df2=new ke,Fn.SolvePositionConstraints_s_d=new ke,Fn.SolvePositionConstraints_s_impulse=new Ve,Fn.SolvePositionConstraints_s_impulse1=new ke,Fn.SolvePositionConstraints_s_P=new ke,Fn.GetJointTranslation_s_pA=new ke,Fn.GetJointTranslation_s_pB=new ke,Fn.GetJointTranslation_s_d=new ke,Fn.GetJointTranslation_s_axis=new ke;var Gn=2,Dn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_pulleyJoint)).groundAnchorA=new ke(-1,1),t.groundAnchorB=new ke(1,1),t.localAnchorA=new ke(-1,0),t.localAnchorB=new ke(1,0),t.lengthA=0,t.lengthB=0,t.ratio=1,t.collideConnected=!0,t}return l(n,[{key:"Initialize",value:function(e,t,i,n,r,s,a){this.bodyA=e,this.bodyB=t,this.groundAnchorA.Copy(i),this.groundAnchorB.Copy(n),this.bodyA.GetLocalPoint(r,this.localAnchorA),this.bodyB.GetLocalPoint(s,this.localAnchorB),this.lengthA=ke.DistanceVV(r,i),this.lengthB=ke.DistanceVV(s,n),this.ratio=a}}]),n}(bn),On=function(e){s(n,e);var t=a(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).m_groundAnchorA=new ke,r.m_groundAnchorB=new ke,r.m_lengthA=0,r.m_lengthB=0,r.m_localAnchorA=new ke,r.m_localAnchorB=new ke,r.m_constant=0,r.m_ratio=0,r.m_impulse=0,r.m_indexA=0,r.m_indexB=0,r.m_uA=new ke,r.m_uB=new ke,r.m_rA=new ke,r.m_rB=new ke,r.m_localCenterA=new ke,r.m_localCenterB=new ke,r.m_invMassA=0,r.m_invMassB=0,r.m_invIA=0,r.m_invIB=0,r.m_mass=0,r.m_qA=new Le,r.m_qB=new Le,r.m_lalcA=new ke,r.m_lalcB=new ke,r.m_groundAnchorA.Copy(i(e.groundAnchorA,new ke(-1,1))),r.m_groundAnchorB.Copy(i(e.groundAnchorB,new ke(1,0))),r.m_localAnchorA.Copy(i(e.localAnchorA,new ke(-1,0))),r.m_localAnchorB.Copy(i(e.localAnchorB,new ke(1,0))),r.m_lengthA=i(e.lengthA,0),r.m_lengthB=i(e.lengthB,0),r.m_ratio=i(e.ratio,1),r.m_constant=i(e.lengthA,0)+r.m_ratio*i(e.lengthB,0),r.m_impulse=0,r}return l(n,[{key:"InitVelocityConstraints",value:function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,r=e.velocities[this.m_indexA].v,s=e.velocities[this.m_indexA].w,a=e.positions[this.m_indexB].c,o=e.positions[this.m_indexB].a,l=e.velocities[this.m_indexB].v,u=e.velocities[this.m_indexB].w,h=this.m_qA.SetAngle(i),c=this.m_qB.SetAngle(o);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),Le.MulRV(h,this.m_lalcA,this.m_rA),ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),Le.MulRV(c,this.m_lalcB,this.m_rB),this.m_uA.Copy(t).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA),this.m_uB.Copy(a).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);var f=this.m_uA.Length(),d=this.m_uB.Length();f>10*y?this.m_uA.SelfMul(1/f):this.m_uA.SetZero(),d>10*y?this.m_uB.SelfMul(1/d):this.m_uB.SetZero();var m=ke.CrossVV(this.m_rA,this.m_uA),_=ke.CrossVV(this.m_rB,this.m_uB),p=this.m_invMassA+this.m_invIA*m*m,v=this.m_invMassB+this.m_invIB*_*_;if(this.m_mass=p+this.m_ratio*this.m_ratio*v,this.m_mass>0&&(this.m_mass=1/this.m_mass),e.step.warmStarting){this.m_impulse*=e.step.dtRatio;var g=ke.MulSV(-this.m_impulse,this.m_uA,n.InitVelocityConstraints_s_PA),x=ke.MulSV(-this.m_ratio*this.m_impulse,this.m_uB,n.InitVelocityConstraints_s_PB);r.SelfMulAdd(this.m_invMassA,g),s+=this.m_invIA*ke.CrossVV(this.m_rA,g),l.SelfMulAdd(this.m_invMassB,x),u+=this.m_invIB*ke.CrossVV(this.m_rB,x)}else this.m_impulse=0;e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=u}},{key:"SolveVelocityConstraints",value:function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,r=e.velocities[this.m_indexB].v,s=e.velocities[this.m_indexB].w,a=ke.AddVCrossSV(t,i,this.m_rA,n.SolveVelocityConstraints_s_vpA),o=ke.AddVCrossSV(r,s,this.m_rB,n.SolveVelocityConstraints_s_vpB),l=-ke.DotVV(this.m_uA,a)-this.m_ratio*ke.DotVV(this.m_uB,o),u=-this.m_mass*l;this.m_impulse+=u;var h=ke.MulSV(-u,this.m_uA,n.SolveVelocityConstraints_s_PA),c=ke.MulSV(-this.m_ratio*u,this.m_uB,n.SolveVelocityConstraints_s_PB);t.SelfMulAdd(this.m_invMassA,h),i+=this.m_invIA*ke.CrossVV(this.m_rA,h),r.SelfMulAdd(this.m_invMassB,c),s+=this.m_invIB*ke.CrossVV(this.m_rB,c),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=s}},{key:"SolvePositionConstraints",value:function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,r=e.positions[this.m_indexB].c,s=e.positions[this.m_indexB].a,a=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(s);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var l=Le.MulRV(a,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var u=Le.MulRV(o,this.m_lalcB,this.m_rB),h=this.m_uA.Copy(t).SelfAdd(l).SelfSub(this.m_groundAnchorA),c=this.m_uB.Copy(r).SelfAdd(u).SelfSub(this.m_groundAnchorB),f=h.Length(),d=c.Length();f>10*y?h.SelfMul(1/f):h.SetZero(),d>10*y?c.SelfMul(1/d):c.SetZero();var m=ke.CrossVV(l,h),_=ke.CrossVV(u,c),p=this.m_invMassA+this.m_invIA*m*m,v=this.m_invMassB+this.m_invIB*_*_,g=p+this.m_ratio*this.m_ratio*v;g>0&&(g=1/g);var x=this.m_constant-f-this.m_ratio*d,b=ae(x),w=-g*x,A=ke.MulSV(-w,h,n.SolvePositionConstraints_s_PA),S=ke.MulSV(-this.m_ratio*w,c,n.SolvePositionConstraints_s_PB);return t.SelfMulAdd(this.m_invMassA,A),i+=this.m_invIA*ke.CrossVV(l,A),r.SelfMulAdd(this.m_invMassB,S),s+=this.m_invIB*ke.CrossVV(u,S),e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=s,b<y}},{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return t.x=e*this.m_impulse*this.m_uB.x,t.y=e*this.m_impulse*this.m_uB.y,t}},{key:"GetReactionTorque",value:function(e){return 0}},{key:"GetGroundAnchorA",value:function(){return this.m_groundAnchorA}},{key:"GetGroundAnchorB",value:function(){return this.m_groundAnchorB}},{key:"GetLengthA",value:function(){return this.m_lengthA}},{key:"GetLengthB",value:function(){return this.m_lengthB}},{key:"GetRatio",value:function(){return this.m_ratio}},{key:"GetCurrentLengthA",value:function(){var e=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,n.GetCurrentLengthA_s_p),t=this.m_groundAnchorA;return ke.DistanceVV(e,t)}},{key:"GetCurrentLengthB",value:function(){var e=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,n.GetCurrentLengthB_s_p),t=this.m_groundAnchorB;return ke.DistanceVV(e,t)}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2PulleyJointDef = new b2PulleyJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.groundAnchorA.Set(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y),e("  jd.groundAnchorB.Set(%.15f, %.15f);\n",this.m_groundAnchorB.x,this.m_groundAnchorB.y),e("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),e("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),e("  jd.lengthA = %.15f;\n",this.m_lengthA),e("  jd.lengthB = %.15f;\n",this.m_lengthB),e("  jd.ratio = %.15f;\n",this.m_ratio),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},{key:"ShiftOrigin",value:function(e){this.m_groundAnchorA.SelfSub(e),this.m_groundAnchorB.SelfSub(e)}}]),n}(wn);On.InitVelocityConstraints_s_PA=new ke,On.InitVelocityConstraints_s_PB=new ke,On.SolveVelocityConstraints_s_vpA=new ke,On.SolveVelocityConstraints_s_vpB=new ke,On.SolveVelocityConstraints_s_PA=new ke,On.SolveVelocityConstraints_s_PB=new ke,On.SolvePositionConstraints_s_PA=new ke,On.SolvePositionConstraints_s_PB=new ke,On.GetCurrentLengthA_s_p=new ke,On.GetCurrentLengthB_s_p=new ke;var Nn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_revoluteJoint)).localAnchorA=new ke(0,0),t.localAnchorB=new ke(0,0),t.referenceAngle=0,t.enableLimit=!1,t.lowerAngle=0,t.upperAngle=0,t.enableMotor=!1,t.motorSpeed=0,t.maxMotorTorque=0,t}return l(n,[{key:"Initialize",value:function(e,t,i){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}]),n}(bn),zn=function(t){s(r,t);var n=a(r);function r(t){var s;return o(this,r),(s=n.call(this,t)).m_localAnchorA=new ke,s.m_localAnchorB=new ke,s.m_impulse=new Ve,s.m_motorImpulse=0,s.m_enableMotor=!1,s.m_maxMotorTorque=0,s.m_motorSpeed=0,s.m_enableLimit=!1,s.m_referenceAngle=0,s.m_lowerAngle=0,s.m_upperAngle=0,s.m_indexA=0,s.m_indexB=0,s.m_rA=new ke,s.m_rB=new ke,s.m_localCenterA=new ke,s.m_localCenterB=new ke,s.m_invMassA=0,s.m_invMassB=0,s.m_invIA=0,s.m_invIB=0,s.m_mass=new Pe,s.m_motorMass=0,s.m_limitState=e.b2LimitState.e_inactiveLimit,s.m_qA=new Le,s.m_qB=new Le,s.m_lalcA=new ke,s.m_lalcB=new ke,s.m_K=new Te,s.m_localAnchorA.Copy(i(t.localAnchorA,ke.ZERO)),s.m_localAnchorB.Copy(i(t.localAnchorB,ke.ZERO)),s.m_referenceAngle=i(t.referenceAngle,0),s.m_impulse.SetZero(),s.m_motorImpulse=0,s.m_lowerAngle=i(t.lowerAngle,0),s.m_upperAngle=i(t.upperAngle,0),s.m_maxMotorTorque=i(t.maxMotorTorque,0),s.m_motorSpeed=i(t.motorSpeed,0),s.m_enableLimit=i(t.enableLimit,!1),s.m_enableMotor=i(t.enableMotor,!1),s.m_limitState=e.b2LimitState.e_inactiveLimit,s}return l(r,[{key:"InitVelocityConstraints",value:function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v,s=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].a,o=t.velocities[this.m_indexB].v,l=t.velocities[this.m_indexB].w,u=this.m_qA.SetAngle(i),h=this.m_qB.SetAngle(a);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),Le.MulRV(u,this.m_lalcA,this.m_rA),ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),Le.MulRV(h,this.m_lalcB,this.m_rB);var c=this.m_invMassA,f=this.m_invMassB,d=this.m_invIA,m=this.m_invIB,_=d+m===0;if(this.m_mass.ex.x=c+f+this.m_rA.y*this.m_rA.y*d+this.m_rB.y*this.m_rB.y*m,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*d-this.m_rB.y*this.m_rB.x*m,this.m_mass.ez.x=-this.m_rA.y*d-this.m_rB.y*m,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=c+f+this.m_rA.x*this.m_rA.x*d+this.m_rB.x*this.m_rB.x*m,this.m_mass.ez.y=this.m_rA.x*d+this.m_rB.x*m,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=d+m,this.m_motorMass=d+m,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_enableMotor&&!_||(this.m_motorImpulse=0),this.m_enableLimit&&!_){var p=a-i-this.m_referenceAngle;ae(this.m_upperAngle-this.m_lowerAngle)<2*g?this.m_limitState=e.b2LimitState.e_equalLimits:p<=this.m_lowerAngle?(this.m_limitState!==e.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=e.b2LimitState.e_atLowerLimit):p>=this.m_upperAngle?(this.m_limitState!==e.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=e.b2LimitState.e_atUpperLimit):(this.m_limitState=e.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=e.b2LimitState.e_inactiveLimit;if(t.step.warmStarting){this.m_impulse.SelfMul(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio;var v=r.InitVelocityConstraints_s_P.Set(this.m_impulse.x,this.m_impulse.y);n.SelfMulSub(c,v),s-=d*(ke.CrossVV(this.m_rA,v)+this.m_motorImpulse+this.m_impulse.z),o.SelfMulAdd(f,v),l+=m*(ke.CrossVV(this.m_rB,v)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0;t.velocities[this.m_indexA].w=s,t.velocities[this.m_indexB].w=l}},{key:"SolveVelocityConstraints",value:function(t){var i=t.velocities[this.m_indexA].v,n=t.velocities[this.m_indexA].w,s=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,o=this.m_invMassA,l=this.m_invMassB,u=this.m_invIA,h=this.m_invIB,c=u+h===0;if(this.m_enableMotor&&this.m_limitState!==e.b2LimitState.e_equalLimits&&!c){var f=a-n-this.m_motorSpeed,d=-this.m_motorMass*f,m=this.m_motorImpulse,_=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=ue(this.m_motorImpulse+d,-_,_),n-=u*(d=this.m_motorImpulse-m),a+=h*d}if(this.m_enableLimit&&this.m_limitState!==e.b2LimitState.e_inactiveLimit&&!c){var p=ke.SubVV(ke.AddVCrossSV(s,a,this.m_rB,ke.s_t0),ke.AddVCrossSV(i,n,this.m_rA,ke.s_t1),r.SolveVelocityConstraints_s_Cdot1),v=a-n,y=this.m_mass.Solve33(p.x,p.y,v,r.SolveVelocityConstraints_s_impulse_v3).SelfNeg();if(this.m_limitState===e.b2LimitState.e_equalLimits)this.m_impulse.SelfAdd(y);else if(this.m_limitState===e.b2LimitState.e_atLowerLimit)if(this.m_impulse.z+y.z<0){var g=-p.x+this.m_impulse.z*this.m_mass.ez.x,x=-p.y+this.m_impulse.z*this.m_mass.ez.y,b=this.m_mass.Solve22(g,x,r.SolveVelocityConstraints_s_reduced_v2);y.x=b.x,y.y=b.y,y.z=-this.m_impulse.z,this.m_impulse.x+=b.x,this.m_impulse.y+=b.y,this.m_impulse.z=0}else this.m_impulse.SelfAdd(y);else if(this.m_limitState===e.b2LimitState.e_atUpperLimit)if(this.m_impulse.z+y.z>0){var w=-p.x+this.m_impulse.z*this.m_mass.ez.x,A=-p.y+this.m_impulse.z*this.m_mass.ez.y,S=this.m_mass.Solve22(w,A,r.SolveVelocityConstraints_s_reduced_v2);y.x=S.x,y.y=S.y,y.z=-this.m_impulse.z,this.m_impulse.x+=S.x,this.m_impulse.y+=S.y,this.m_impulse.z=0}else this.m_impulse.SelfAdd(y);var M=r.SolveVelocityConstraints_s_P.Set(y.x,y.y);i.SelfMulSub(o,M),n-=u*(ke.CrossVV(this.m_rA,M)+y.z),s.SelfMulAdd(l,M),a+=h*(ke.CrossVV(this.m_rB,M)+y.z)}else{var C=ke.SubVV(ke.AddVCrossSV(s,a,this.m_rB,ke.s_t0),ke.AddVCrossSV(i,n,this.m_rA,ke.s_t1),r.SolveVelocityConstraints_s_Cdot_v2),k=this.m_mass.Solve22(-C.x,-C.y,r.SolveVelocityConstraints_s_impulse_v2);this.m_impulse.x+=k.x,this.m_impulse.y+=k.y,i.SelfMulSub(o,k),n-=u*ke.CrossVV(this.m_rA,k),s.SelfMulAdd(l,k),a+=h*ke.CrossVV(this.m_rB,k)}t.velocities[this.m_indexA].w=n,t.velocities[this.m_indexB].w=a}},{key:"SolvePositionConstraints",value:function(t){var i=t.positions[this.m_indexA].c,n=t.positions[this.m_indexA].a,s=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,o=this.m_qA.SetAngle(n),l=this.m_qB.SetAngle(a),u=0,h=0,c=this.m_invIA+this.m_invIB===0;if(this.m_enableLimit&&this.m_limitState!==e.b2LimitState.e_inactiveLimit&&!c){var f=a-n-this.m_referenceAngle,d=0;if(this.m_limitState===e.b2LimitState.e_equalLimits){var m=ue(f-this.m_lowerAngle,-M,M);d=-this.m_motorMass*m,u=ae(m)}else if(this.m_limitState===e.b2LimitState.e_atLowerLimit){var _=f-this.m_lowerAngle;u=-_,_=ue(_+g,-M,0),d=-this.m_motorMass*_}else if(this.m_limitState===e.b2LimitState.e_atUpperLimit){var p=f-this.m_upperAngle;u=p,p=ue(p-g,0,M),d=-this.m_motorMass*p}n-=this.m_invIA*d,a+=this.m_invIB*d}o.SetAngle(n),l.SetAngle(a),ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var v=Le.MulRV(o,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var x=Le.MulRV(l,this.m_lalcB,this.m_rB),b=ke.SubVV(ke.AddVV(s,x,ke.s_t0),ke.AddVV(i,v,ke.s_t1),r.SolvePositionConstraints_s_C_v2);h=b.Length();var w=this.m_invMassA,A=this.m_invMassB,S=this.m_invIA,C=this.m_invIB,k=this.m_K;k.ex.x=w+A+S*v.y*v.y+C*x.y*x.y,k.ex.y=-S*v.x*v.y-C*x.x*x.y,k.ey.x=k.ex.y,k.ey.y=w+A+S*v.x*v.x+C*x.x*x.x;var B=k.Solve(b.x,b.y,r.SolvePositionConstraints_s_impulse).SelfNeg();return i.SelfMulSub(w,B),n-=S*ke.CrossVV(v,B),s.SelfMulAdd(A,B),a+=C*ke.CrossVV(x,B),t.positions[this.m_indexA].a=n,t.positions[this.m_indexB].a=a,h<=y&&u<=g}},{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return t.x=e*this.m_impulse.x,t.y=e*this.m_impulse.y,t}},{key:"GetReactionTorque",value:function(e){return e*this.m_impulse.z}},{key:"GetLocalAnchorA",value:function(){return this.m_localAnchorA}},{key:"GetLocalAnchorB",value:function(){return this.m_localAnchorB}},{key:"GetReferenceAngle",value:function(){return this.m_referenceAngle}},{key:"GetJointAngle",value:function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle}},{key:"GetJointSpeed",value:function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity}},{key:"IsMotorEnabled",value:function(){return this.m_enableMotor}},{key:"EnableMotor",value:function(e){e!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e)}},{key:"GetMotorTorque",value:function(e){return e*this.m_motorImpulse}},{key:"GetMotorSpeed",value:function(){return this.m_motorSpeed}},{key:"SetMaxMotorTorque",value:function(e){e!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=e)}},{key:"GetMaxMotorTorque",value:function(){return this.m_maxMotorTorque}},{key:"IsLimitEnabled",value:function(){return this.m_enableLimit}},{key:"EnableLimit",value:function(e){e!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=e,this.m_impulse.z=0)}},{key:"GetLowerLimit",value:function(){return this.m_lowerAngle}},{key:"GetUpperLimit",value:function(){return this.m_upperAngle}},{key:"SetLimits",value:function(e,t){e===this.m_lowerAngle&&t===this.m_upperAngle||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=e,this.m_upperAngle=t)}},{key:"SetMotorSpeed",value:function(e){e!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e)}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2RevoluteJointDef = new b2RevoluteJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),e("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),e("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),e("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),e("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle),e("  jd.upperAngle = %.15f;\n",this.m_upperAngle),e("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),e("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),e("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}]),r}(wn);zn.InitVelocityConstraints_s_P=new ke,zn.SolveVelocityConstraints_s_P=new ke,zn.SolveVelocityConstraints_s_Cdot_v2=new ke,zn.SolveVelocityConstraints_s_Cdot1=new ke,zn.SolveVelocityConstraints_s_impulse_v3=new Ve,zn.SolveVelocityConstraints_s_reduced_v2=new ke,zn.SolveVelocityConstraints_s_impulse_v2=new ke,zn.SolvePositionConstraints_s_C_v2=new ke,zn.SolvePositionConstraints_s_impulse=new ke;var Un=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_ropeJoint)).localAnchorA=new ke(-1,0),t.localAnchorB=new ke(1,0),t.maxLength=0,t}return l(n)}(bn),jn=function(t){s(r,t);var n=a(r);function r(t){var s;return o(this,r),(s=n.call(this,t)).m_localAnchorA=new ke,s.m_localAnchorB=new ke,s.m_maxLength=0,s.m_length=0,s.m_impulse=0,s.m_indexA=0,s.m_indexB=0,s.m_u=new ke,s.m_rA=new ke,s.m_rB=new ke,s.m_localCenterA=new ke,s.m_localCenterB=new ke,s.m_invMassA=0,s.m_invMassB=0,s.m_invIA=0,s.m_invIB=0,s.m_mass=0,s.m_state=e.b2LimitState.e_inactiveLimit,s.m_qA=new Le,s.m_qB=new Le,s.m_lalcA=new ke,s.m_lalcB=new ke,s.m_localAnchorA.Copy(i(t.localAnchorA,new ke(-1,0))),s.m_localAnchorB.Copy(i(t.localAnchorB,new ke(1,0))),s.m_maxLength=i(t.maxLength,0),s}return l(r,[{key:"InitVelocityConstraints",value:function(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var i=t.positions[this.m_indexA].c,n=t.positions[this.m_indexA].a,s=t.velocities[this.m_indexA].v,a=t.velocities[this.m_indexA].w,o=t.positions[this.m_indexB].c,l=t.positions[this.m_indexB].a,u=t.velocities[this.m_indexB].v,h=t.velocities[this.m_indexB].w,c=this.m_qA.SetAngle(n),f=this.m_qB.SetAngle(l);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),Le.MulRV(c,this.m_lalcA,this.m_rA),ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),Le.MulRV(f,this.m_lalcB,this.m_rB),this.m_u.Copy(o).SelfAdd(this.m_rB).SelfSub(i).SelfSub(this.m_rA),this.m_length=this.m_u.Length();var d=this.m_length-this.m_maxLength;if(this.m_state=d>0?e.b2LimitState.e_atUpperLimit:e.b2LimitState.e_inactiveLimit,!(this.m_length>y))return this.m_u.SetZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.SelfMul(1/this.m_length);var m=ke.CrossVV(this.m_rA,this.m_u),_=ke.CrossVV(this.m_rB,this.m_u),p=this.m_invMassA+this.m_invIA*m*m+this.m_invMassB+this.m_invIB*_*_;if(this.m_mass=0!==p?1/p:0,t.step.warmStarting){this.m_impulse*=t.step.dtRatio;var v=ke.MulSV(this.m_impulse,this.m_u,r.InitVelocityConstraints_s_P);s.SelfMulSub(this.m_invMassA,v),a-=this.m_invIA*ke.CrossVV(this.m_rA,v),u.SelfMulAdd(this.m_invMassB,v),h+=this.m_invIB*ke.CrossVV(this.m_rB,v)}else this.m_impulse=0;t.velocities[this.m_indexA].w=a,t.velocities[this.m_indexB].w=h}},{key:"SolveVelocityConstraints",value:function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,n=e.velocities[this.m_indexB].v,s=e.velocities[this.m_indexB].w,a=ke.AddVCrossSV(t,i,this.m_rA,r.SolveVelocityConstraints_s_vpA),o=ke.AddVCrossSV(n,s,this.m_rB,r.SolveVelocityConstraints_s_vpB),l=this.m_length-this.m_maxLength,u=ke.DotVV(this.m_u,ke.SubVV(o,a,ke.s_t0));l<0&&(u+=e.step.inv_dt*l);var h=-this.m_mass*u,c=this.m_impulse;this.m_impulse=oe(0,this.m_impulse+h),h=this.m_impulse-c;var f=ke.MulSV(h,this.m_u,r.SolveVelocityConstraints_s_P);t.SelfMulSub(this.m_invMassA,f),i-=this.m_invIA*ke.CrossVV(this.m_rA,f),n.SelfMulAdd(this.m_invMassB,f),s+=this.m_invIB*ke.CrossVV(this.m_rB,f),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=s}},{key:"SolvePositionConstraints",value:function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,n=e.positions[this.m_indexB].c,s=e.positions[this.m_indexB].a,a=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(s);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var l=Le.MulRV(a,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var u=Le.MulRV(o,this.m_lalcB,this.m_rB),h=this.m_u.Copy(n).SelfAdd(u).SelfSub(t).SelfSub(l),c=h.Normalize(),f=c-this.m_maxLength;f=ue(f,0,S);var d=-this.m_mass*f,m=ke.MulSV(d,h,r.SolvePositionConstraints_s_P);return t.SelfMulSub(this.m_invMassA,m),i-=this.m_invIA*ke.CrossVV(l,m),n.SelfMulAdd(this.m_invMassB,m),s+=this.m_invIB*ke.CrossVV(u,m),e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=s,c-this.m_maxLength<y}},{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return ke.MulSV(e*this.m_impulse,this.m_u,t)}},{key:"GetReactionTorque",value:function(e){return 0}},{key:"GetLocalAnchorA",value:function(){return this.m_localAnchorA}},{key:"GetLocalAnchorB",value:function(){return this.m_localAnchorB}},{key:"SetMaxLength",value:function(e){this.m_maxLength=e}},{key:"GetMaxLength",value:function(){return this.m_maxLength}},{key:"GetLimitState",value:function(){return this.m_state}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2RopeJointDef = new b2RopeJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),e("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),e("  jd.maxLength = %.15f;\n",this.m_maxLength),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}]),r}(wn);jn.InitVelocityConstraints_s_P=new ke,jn.SolveVelocityConstraints_s_vpA=new ke,jn.SolveVelocityConstraints_s_vpB=new ke,jn.SolveVelocityConstraints_s_P=new ke,jn.SolvePositionConstraints_s_P=new ke;var Wn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_weldJoint)).localAnchorA=new ke,t.localAnchorB=new ke,t.referenceAngle=0,t.frequencyHz=0,t.dampingRatio=0,t}return l(n,[{key:"Initialize",value:function(e,t,i){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}]),n}(bn),qn=function(e){s(n,e);var t=a(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).m_frequencyHz=0,r.m_dampingRatio=0,r.m_bias=0,r.m_localAnchorA=new ke,r.m_localAnchorB=new ke,r.m_referenceAngle=0,r.m_gamma=0,r.m_impulse=new Ve(0,0,0),r.m_indexA=0,r.m_indexB=0,r.m_rA=new ke,r.m_rB=new ke,r.m_localCenterA=new ke,r.m_localCenterB=new ke,r.m_invMassA=0,r.m_invMassB=0,r.m_invIA=0,r.m_invIB=0,r.m_mass=new Pe,r.m_qA=new Le,r.m_qB=new Le,r.m_lalcA=new ke,r.m_lalcB=new ke,r.m_K=new Pe,r.m_frequencyHz=i(e.frequencyHz,0),r.m_dampingRatio=i(e.dampingRatio,0),r.m_localAnchorA.Copy(i(e.localAnchorA,ke.ZERO)),r.m_localAnchorB.Copy(i(e.localAnchorB,ke.ZERO)),r.m_referenceAngle=i(e.referenceAngle,0),r.m_impulse.SetZero(),r}return l(n,[{key:"InitVelocityConstraints",value:function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].a,i=e.velocities[this.m_indexA].v,r=e.velocities[this.m_indexA].w,s=e.positions[this.m_indexB].a,a=e.velocities[this.m_indexB].v,o=e.velocities[this.m_indexB].w,l=this.m_qA.SetAngle(t),u=this.m_qB.SetAngle(s);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),Le.MulRV(l,this.m_lalcA,this.m_rA),ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),Le.MulRV(u,this.m_lalcB,this.m_rB);var h=this.m_invMassA,c=this.m_invMassB,f=this.m_invIA,m=this.m_invIB,_=this.m_K;if(_.ex.x=h+c+this.m_rA.y*this.m_rA.y*f+this.m_rB.y*this.m_rB.y*m,_.ey.x=-this.m_rA.y*this.m_rA.x*f-this.m_rB.y*this.m_rB.x*m,_.ez.x=-this.m_rA.y*f-this.m_rB.y*m,_.ex.y=_.ey.x,_.ey.y=h+c+this.m_rA.x*this.m_rA.x*f+this.m_rB.x*this.m_rB.x*m,_.ez.y=this.m_rA.x*f+this.m_rB.x*m,_.ex.z=_.ez.x,_.ey.z=_.ez.y,_.ez.z=f+m,this.m_frequencyHz>0){_.GetInverse22(this.m_mass);var p=f+m,v=p>0?1/p:0,y=s-t-this.m_referenceAngle,g=2*d*this.m_frequencyHz,x=2*v*this.m_dampingRatio*g,b=v*g*g,w=e.step.dt;this.m_gamma=w*(x+w*b),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=y*w*b*this.m_gamma,p+=this.m_gamma,this.m_mass.ez.z=0!==p?1/p:0}else _.GetSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0;if(e.step.warmStarting){this.m_impulse.SelfMul(e.step.dtRatio);var A=n.InitVelocityConstraints_s_P.Set(this.m_impulse.x,this.m_impulse.y);i.SelfMulSub(h,A),r-=f*(ke.CrossVV(this.m_rA,A)+this.m_impulse.z),a.SelfMulAdd(c,A),o+=m*(ke.CrossVV(this.m_rB,A)+this.m_impulse.z)}else this.m_impulse.SetZero();e.velocities[this.m_indexA].w=r,e.velocities[this.m_indexB].w=o}},{key:"SolveVelocityConstraints",value:function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,r=e.velocities[this.m_indexB].v,s=e.velocities[this.m_indexB].w,a=this.m_invMassA,o=this.m_invMassB,l=this.m_invIA,u=this.m_invIB;if(this.m_frequencyHz>0){var h=s-i,c=-this.m_mass.ez.z*(h+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=c,i-=l*c,s+=u*c;var f=ke.SubVV(ke.AddVCrossSV(r,s,this.m_rB,ke.s_t0),ke.AddVCrossSV(t,i,this.m_rA,ke.s_t1),n.SolveVelocityConstraints_s_Cdot1),d=Pe.MulM33XY(this.m_mass,f.x,f.y,n.SolveVelocityConstraints_s_impulse1).SelfNeg();this.m_impulse.x+=d.x,this.m_impulse.y+=d.y;var m=d;t.SelfMulSub(a,m),i-=l*ke.CrossVV(this.m_rA,m),r.SelfMulAdd(o,m),s+=u*ke.CrossVV(this.m_rB,m)}else{var _=ke.SubVV(ke.AddVCrossSV(r,s,this.m_rB,ke.s_t0),ke.AddVCrossSV(t,i,this.m_rA,ke.s_t1),n.SolveVelocityConstraints_s_Cdot1),p=s-i,v=Pe.MulM33XYZ(this.m_mass,_.x,_.y,p,n.SolveVelocityConstraints_s_impulse).SelfNeg();this.m_impulse.SelfAdd(v);var y=n.SolveVelocityConstraints_s_P.Set(v.x,v.y);t.SelfMulSub(a,y),i-=l*(ke.CrossVV(this.m_rA,y)+v.z),r.SelfMulAdd(o,y),s+=u*(ke.CrossVV(this.m_rB,y)+v.z)}e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=s}},{key:"SolvePositionConstraints",value:function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,r=e.positions[this.m_indexB].c,s=e.positions[this.m_indexB].a,a=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(s),l=this.m_invMassA,u=this.m_invMassB,h=this.m_invIA,c=this.m_invIB;ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var f=Le.MulRV(a,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var d,m,_=Le.MulRV(o,this.m_lalcB,this.m_rB),p=this.m_K;if(p.ex.x=l+u+f.y*f.y*h+_.y*_.y*c,p.ey.x=-f.y*f.x*h-_.y*_.x*c,p.ez.x=-f.y*h-_.y*c,p.ex.y=p.ey.x,p.ey.y=l+u+f.x*f.x*h+_.x*_.x*c,p.ez.y=f.x*h+_.x*c,p.ex.z=p.ez.x,p.ey.z=p.ez.y,p.ez.z=h+c,this.m_frequencyHz>0){var v=ke.SubVV(ke.AddVV(r,_,ke.s_t0),ke.AddVV(t,f,ke.s_t1),n.SolvePositionConstraints_s_C1);d=v.Length(),m=0;var x=p.Solve22(v.x,v.y,n.SolvePositionConstraints_s_P).SelfNeg();t.SelfMulSub(l,x),i-=h*ke.CrossVV(f,x),r.SelfMulAdd(u,x),s+=c*ke.CrossVV(_,x)}else{var b=ke.SubVV(ke.AddVV(r,_,ke.s_t0),ke.AddVV(t,f,ke.s_t1),n.SolvePositionConstraints_s_C1),w=s-i-this.m_referenceAngle;d=b.Length(),m=ae(w);var A=p.Solve33(b.x,b.y,w,n.SolvePositionConstraints_s_impulse).SelfNeg(),S=n.SolvePositionConstraints_s_P.Set(A.x,A.y);t.SelfMulSub(l,S),i-=h*(ke.CrossVV(this.m_rA,S)+A.z),r.SelfMulAdd(u,S),s+=c*(ke.CrossVV(this.m_rB,S)+A.z)}return e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=s,d<=y&&m<=g}},{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return t.x=e*this.m_impulse.x,t.y=e*this.m_impulse.y,t}},{key:"GetReactionTorque",value:function(e){return e*this.m_impulse.z}},{key:"GetLocalAnchorA",value:function(){return this.m_localAnchorA}},{key:"GetLocalAnchorB",value:function(){return this.m_localAnchorB}},{key:"GetReferenceAngle",value:function(){return this.m_referenceAngle}},{key:"SetFrequency",value:function(e){this.m_frequencyHz=e}},{key:"GetFrequency",value:function(){return this.m_frequencyHz}},{key:"SetDampingRatio",value:function(e){this.m_dampingRatio=e}},{key:"GetDampingRatio",value:function(){return this.m_dampingRatio}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2WeldJointDef = new b2WeldJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),e("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),e("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),e("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),e("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}]),n}(wn);qn.InitVelocityConstraints_s_P=new ke,qn.SolveVelocityConstraints_s_Cdot1=new ke,qn.SolveVelocityConstraints_s_impulse1=new ke,qn.SolveVelocityConstraints_s_impulse=new Ve,qn.SolveVelocityConstraints_s_P=new ke,qn.SolvePositionConstraints_s_C1=new ke,qn.SolvePositionConstraints_s_P=new ke,qn.SolvePositionConstraints_s_impulse=new Ve;var Hn=function(t){s(n,t);var i=a(n);function n(){var t;return o(this,n),(t=i.call(this,e.b2JointType.e_wheelJoint)).localAnchorA=new ke(0,0),t.localAnchorB=new ke(0,0),t.localAxisA=new ke(1,0),t.enableMotor=!1,t.maxMotorTorque=0,t.motorSpeed=0,t.frequencyHz=2,t.dampingRatio=.7,t}return l(n,[{key:"Initialize",value:function(e,t,i,n){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(n,this.localAxisA)}}]),n}(bn),Xn=function(e){s(n,e);var t=a(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).m_frequencyHz=0,r.m_dampingRatio=0,r.m_localAnchorA=new ke,r.m_localAnchorB=new ke,r.m_localXAxisA=new ke,r.m_localYAxisA=new ke,r.m_impulse=0,r.m_motorImpulse=0,r.m_springImpulse=0,r.m_maxMotorTorque=0,r.m_motorSpeed=0,r.m_enableMotor=!1,r.m_indexA=0,r.m_indexB=0,r.m_localCenterA=new ke,r.m_localCenterB=new ke,r.m_invMassA=0,r.m_invMassB=0,r.m_invIA=0,r.m_invIB=0,r.m_ax=new ke,r.m_ay=new ke,r.m_sAx=0,r.m_sBx=0,r.m_sAy=0,r.m_sBy=0,r.m_mass=0,r.m_motorMass=0,r.m_springMass=0,r.m_bias=0,r.m_gamma=0,r.m_qA=new Le,r.m_qB=new Le,r.m_lalcA=new ke,r.m_lalcB=new ke,r.m_rA=new ke,r.m_rB=new ke,r.m_frequencyHz=i(e.frequencyHz,2),r.m_dampingRatio=i(e.dampingRatio,.7),r.m_localAnchorA.Copy(i(e.localAnchorA,ke.ZERO)),r.m_localAnchorB.Copy(i(e.localAnchorB,ke.ZERO)),r.m_localXAxisA.Copy(i(e.localAxisA,ke.UNITX)),ke.CrossOneV(r.m_localXAxisA,r.m_localYAxisA),r.m_maxMotorTorque=i(e.maxMotorTorque,0),r.m_motorSpeed=i(e.motorSpeed,0),r.m_enableMotor=i(e.enableMotor,!1),r.m_ax.SetZero(),r.m_ay.SetZero(),r}return l(n,[{key:"GetMotorSpeed",value:function(){return this.m_motorSpeed}},{key:"GetMaxMotorTorque",value:function(){return this.m_maxMotorTorque}},{key:"SetSpringFrequencyHz",value:function(e){this.m_frequencyHz=e}},{key:"GetSpringFrequencyHz",value:function(){return this.m_frequencyHz}},{key:"SetSpringDampingRatio",value:function(e){this.m_dampingRatio=e}},{key:"GetSpringDampingRatio",value:function(){return this.m_dampingRatio}},{key:"InitVelocityConstraints",value:function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=this.m_invMassA,i=this.m_invMassB,r=this.m_invIA,s=this.m_invIB,a=e.positions[this.m_indexA].c,o=e.positions[this.m_indexA].a,l=e.velocities[this.m_indexA].v,u=e.velocities[this.m_indexA].w,h=e.positions[this.m_indexB].c,c=e.positions[this.m_indexB].a,f=e.velocities[this.m_indexB].v,m=e.velocities[this.m_indexB].w,_=this.m_qA.SetAngle(o),p=this.m_qB.SetAngle(c);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var v=Le.MulRV(_,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var y=Le.MulRV(p,this.m_lalcB,this.m_rB),g=ke.SubVV(ke.AddVV(h,y,ke.s_t0),ke.AddVV(a,v,ke.s_t1),n.InitVelocityConstraints_s_d);if(Le.MulRV(_,this.m_localYAxisA,this.m_ay),this.m_sAy=ke.CrossVV(ke.AddVV(g,v,ke.s_t0),this.m_ay),this.m_sBy=ke.CrossVV(y,this.m_ay),this.m_mass=t+i+r*this.m_sAy*this.m_sAy+s*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){Le.MulRV(_,this.m_localXAxisA,this.m_ax),this.m_sAx=ke.CrossVV(ke.AddVV(g,v,ke.s_t0),this.m_ax),this.m_sBx=ke.CrossVV(y,this.m_ax);var x=t+i+r*this.m_sAx*this.m_sAx+s*this.m_sBx*this.m_sBx;if(x>0){this.m_springMass=1/x;var b=ke.DotVV(g,this.m_ax),w=2*d*this.m_frequencyHz,A=2*this.m_springMass*this.m_dampingRatio*w,S=this.m_springMass*w*w,M=e.step.dt;this.m_gamma=M*(A+M*S),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=b*M*S*this.m_gamma,this.m_springMass=x+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=r+s,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),e.step.warmStarting){this.m_impulse*=e.step.dtRatio,this.m_springImpulse*=e.step.dtRatio,this.m_motorImpulse*=e.step.dtRatio;var C=ke.AddVV(ke.MulSV(this.m_impulse,this.m_ay,ke.s_t0),ke.MulSV(this.m_springImpulse,this.m_ax,ke.s_t1),n.InitVelocityConstraints_s_P),k=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,B=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;l.SelfMulSub(this.m_invMassA,C),u-=this.m_invIA*k,f.SelfMulAdd(this.m_invMassB,C),m+=this.m_invIB*B}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;e.velocities[this.m_indexA].w=u,e.velocities[this.m_indexB].w=m}},{key:"SolveVelocityConstraints",value:function(e){var t=this.m_invMassA,i=this.m_invMassB,r=this.m_invIA,s=this.m_invIB,a=e.velocities[this.m_indexA].v,o=e.velocities[this.m_indexA].w,l=e.velocities[this.m_indexB].v,u=e.velocities[this.m_indexB].w,h=ke.DotVV(this.m_ax,ke.SubVV(l,a,ke.s_t0))+this.m_sBx*u-this.m_sAx*o,c=-this.m_springMass*(h+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=c;var f=ke.MulSV(c,this.m_ax,n.SolveVelocityConstraints_s_P),d=c*this.m_sAx,m=c*this.m_sBx;a.SelfMulSub(t,f),o-=r*d,l.SelfMulAdd(i,f);var _=(u+=s*m)-o-this.m_motorSpeed,p=-this.m_motorMass*_,v=this.m_motorImpulse,y=e.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=ue(this.m_motorImpulse+p,-y,y),o-=r*(p=this.m_motorImpulse-v),u+=s*p;var g=ke.DotVV(this.m_ay,ke.SubVV(l,a,ke.s_t0))+this.m_sBy*u-this.m_sAy*o,x=-this.m_mass*g;this.m_impulse+=x;var b=ke.MulSV(x,this.m_ay,n.SolveVelocityConstraints_s_P),w=x*this.m_sAy,A=x*this.m_sBy;a.SelfMulSub(t,b),o-=r*w,l.SelfMulAdd(i,b),u+=s*A,e.velocities[this.m_indexA].w=o,e.velocities[this.m_indexB].w=u}},{key:"SolvePositionConstraints",value:function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,r=e.positions[this.m_indexB].c,s=e.positions[this.m_indexB].a,a=this.m_qA.SetAngle(i),o=this.m_qB.SetAngle(s);ke.SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var l=Le.MulRV(a,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var u,h=Le.MulRV(o,this.m_lalcB,this.m_rB),c=ke.AddVV(ke.SubVV(r,t,ke.s_t0),ke.SubVV(h,l,ke.s_t1),n.SolvePositionConstraints_s_d),f=Le.MulRV(a,this.m_localYAxisA,this.m_ay),d=ke.CrossVV(ke.AddVV(c,l,ke.s_t0),f),m=ke.CrossVV(h,f),_=ke.DotVV(c,this.m_ay),p=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;u=0!==p?-_/p:0;var v=ke.MulSV(u,f,n.SolvePositionConstraints_s_P),g=u*d,x=u*m;return t.SelfMulSub(this.m_invMassA,v),i-=this.m_invIA*g,r.SelfMulAdd(this.m_invMassB,v),s+=this.m_invIB*x,e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=s,ae(_)<=y}},{key:"GetDefinition",value:function(e){return e}},{key:"GetAnchorA",value:function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}},{key:"GetAnchorB",value:function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}},{key:"GetReactionForce",value:function(e,t){return t.x=e*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x),t.y=e*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y),t}},{key:"GetReactionTorque",value:function(e){return e*this.m_motorImpulse}},{key:"GetLocalAnchorA",value:function(){return this.m_localAnchorA}},{key:"GetLocalAnchorB",value:function(){return this.m_localAnchorB}},{key:"GetLocalAxisA",value:function(){return this.m_localXAxisA}},{key:"GetJointTranslation",value:function(){return this.GetPrismaticJointTranslation()}},{key:"GetJointLinearSpeed",value:function(){return this.GetPrismaticJointSpeed()}},{key:"GetJointAngle",value:function(){return this.GetRevoluteJointAngle()}},{key:"GetJointAngularSpeed",value:function(){return this.GetRevoluteJointSpeed()}},{key:"GetPrismaticJointTranslation",value:function(){var e=this.m_bodyA,t=this.m_bodyB,i=e.GetWorldPoint(this.m_localAnchorA,new ke),n=t.GetWorldPoint(this.m_localAnchorB,new ke),r=ke.SubVV(n,i,new ke),s=e.GetWorldVector(this.m_localXAxisA,new ke);return ke.DotVV(r,s)}},{key:"GetPrismaticJointSpeed",value:function(){var e=this.m_bodyA,t=this.m_bodyB;ke.SubVV(this.m_localAnchorA,e.m_sweep.localCenter,this.m_lalcA);var i=Le.MulRV(e.m_xf.q,this.m_lalcA,this.m_rA);ke.SubVV(this.m_localAnchorB,t.m_sweep.localCenter,this.m_lalcB);var n=Le.MulRV(t.m_xf.q,this.m_lalcB,this.m_rB),r=ke.AddVV(e.m_sweep.c,i,ke.s_t0),s=ke.AddVV(t.m_sweep.c,n,ke.s_t1),a=ke.SubVV(s,r,ke.s_t2),o=e.GetWorldVector(this.m_localXAxisA,new ke),l=e.m_linearVelocity,u=t.m_linearVelocity,h=e.m_angularVelocity,c=t.m_angularVelocity;return ke.DotVV(a,ke.CrossSV(h,o,ke.s_t0))+ke.DotVV(o,ke.SubVV(ke.AddVCrossSV(u,c,n,ke.s_t0),ke.AddVCrossSV(l,h,i,ke.s_t1),ke.s_t0))}},{key:"GetRevoluteJointAngle",value:function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a}},{key:"GetRevoluteJointSpeed",value:function(){var e=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-e}},{key:"IsMotorEnabled",value:function(){return this.m_enableMotor}},{key:"EnableMotor",value:function(e){e!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e)}},{key:"SetMotorSpeed",value:function(e){e!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e)}},{key:"SetMaxMotorTorque",value:function(e){e!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=e)}},{key:"GetMotorTorque",value:function(e){return e*this.m_motorImpulse}},{key:"Dump",value:function(e){var t=this.m_bodyA.m_islandIndex,i=this.m_bodyB.m_islandIndex;e("  const jd: b2WheelJointDef = new b2WheelJointDef();\n"),e("  jd.bodyA = bodies[%d];\n",t),e("  jd.bodyB = bodies[%d];\n",i),e("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),e("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),e("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),e("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),e("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),e("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),e("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),e("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),e("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),e("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}}]),n}(wn);function Jn(e,t){return me(e*t)}function Yn(e,t){return e>t?e:t}Xn.InitVelocityConstraints_s_d=new ke,Xn.InitVelocityConstraints_s_P=new ke,Xn.SolveVelocityConstraints_s_P=new ke,Xn.SolvePositionConstraints_s_d=new ke,Xn.SolvePositionConstraints_s_P=new ke;var Zn=l((function e(t){o(this,e),this.prev=null,this.next=null,this.contact=t})),Qn=function(){function e(){o(this,e),this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_prev=null,this.m_next=null,this.m_indexA=0,this.m_indexB=0,this.m_manifold=new wt,this.m_toiCount=0,this.m_toi=0,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_oldManifold=new wt,this.m_nodeA=new Zn(this),this.m_nodeB=new Zn(this)}return l(e,[{key:"GetManifold",value:function(){return this.m_manifold}},{key:"GetWorldManifold",value:function(e){var t=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape();e.Initialize(this.m_manifold,t.GetTransform(),n.m_radius,i.GetTransform(),r.m_radius)}},{key:"IsTouching",value:function(){return this.m_touchingFlag}},{key:"SetEnabled",value:function(e){this.m_enabledFlag=e}},{key:"IsEnabled",value:function(){return this.m_enabledFlag}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetFixtureA",value:function(){return this.m_fixtureA}},{key:"GetChildIndexA",value:function(){return this.m_indexA}},{key:"GetFixtureB",value:function(){return this.m_fixtureB}},{key:"GetChildIndexB",value:function(){return this.m_indexB}},{key:"FlagForFiltering",value:function(){this.m_filterFlag=!0}},{key:"SetFriction",value:function(e){this.m_friction=e}},{key:"GetFriction",value:function(){return this.m_friction}},{key:"ResetFriction",value:function(){this.m_friction=Jn(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)}},{key:"SetRestitution",value:function(e){this.m_restitution=e}},{key:"GetRestitution",value:function(){return this.m_restitution}},{key:"ResetRestitution",value:function(){this.m_restitution=Yn(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)}},{key:"SetTangentSpeed",value:function(e){this.m_tangentSpeed=e}},{key:"GetTangentSpeed",value:function(){return this.m_tangentSpeed}},{key:"Reset",value:function(e,t,i,n){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!0,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_fixtureA=e,this.m_fixtureB=i,this.m_indexA=t,this.m_indexB=n,this.m_manifold.pointCount=0,this.m_prev=null,this.m_next=null,delete this.m_nodeA.contact,this.m_nodeA.prev=null,this.m_nodeA.next=null,delete this.m_nodeA.other,delete this.m_nodeB.contact,this.m_nodeB.prev=null,this.m_nodeB.next=null,delete this.m_nodeB.other,this.m_toiCount=0,this.m_friction=Jn(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=Yn(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)}},{key:"Update",value:function(e){var t=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=t,this.m_enabledFlag=!0;var i=!1,n=this.m_touchingFlag,r=this.m_fixtureA.IsSensor(),s=this.m_fixtureB.IsSensor(),a=r||s,o=this.m_fixtureA.GetBody(),l=this.m_fixtureB.GetBody(),u=o.GetTransform(),h=l.GetTransform();if(a){var c=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();i=It(c,this.m_indexA,f,this.m_indexB,u,h),this.m_manifold.pointCount=0}else{this.Evaluate(this.m_manifold,u,h),i=this.m_manifold.pointCount>0;for(var d=0;d<this.m_manifold.pointCount;++d){var m=this.m_manifold.points[d];m.normalImpulse=0,m.tangentImpulse=0;for(var _=m.id,p=0;p<this.m_oldManifold.pointCount;++p){var v=this.m_oldManifold.points[p];if(v.id.key===_.key){m.normalImpulse=v.normalImpulse,m.tangentImpulse=v.tangentImpulse;break}}}i!==n&&(o.SetAwake(!0),l.SetAwake(!0))}this.m_touchingFlag=i,!n&&i&&e&&e.BeginContact(this),n&&!i&&e&&e.EndContact(this),!a&&i&&e&&e.PreSolve(this,this.m_oldManifold)}},{key:"ComputeTOI",value:function(t,i){var n=e.ComputeTOI_s_input;n.proxyA.SetShape(this.m_fixtureA.GetShape(),this.m_indexA),n.proxyB.SetShape(this.m_fixtureB.GetShape(),this.m_indexB),n.sweepA.Copy(t),n.sweepB.Copy(i),n.tMax=y;var r=e.ComputeTOI_s_output;return ui(r,n),r.t}}]),e}();Qn.ComputeTOI_s_input=new Zt,Qn.ComputeTOI_s_output=new Kt;var Kn=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.call(this)}return l(i,[{key:"Reset",value:function(e,t,s,a){n(r(i.prototype),"Reset",this).call(this,e,t,s,a)}},{key:"Evaluate",value:function(e,t,i){fi(e,this.m_fixtureA.GetShape(),t,this.m_fixtureB.GetShape(),i)}}],[{key:"Create",value:function(e){return new i}},{key:"Destroy",value:function(e,t){}}]),i}(Qn),$n=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.call(this)}return l(i,[{key:"Reset",value:function(e,t,s,a){n(r(i.prototype),"Reset",this).call(this,e,t,s,a)}},{key:"Evaluate",value:function(e,t,i){Ni(e,this.m_fixtureA.GetShape(),t,this.m_fixtureB.GetShape(),i)}}],[{key:"Create",value:function(e){return new i}},{key:"Destroy",value:function(e,t){}}]),i}(Qn),er=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.call(this)}return l(i,[{key:"Reset",value:function(e,t,s,a){n(r(i.prototype),"Reset",this).call(this,e,t,s,a)}},{key:"Evaluate",value:function(e,t,i){pi(e,this.m_fixtureA.GetShape(),t,this.m_fixtureB.GetShape(),i)}}],[{key:"Create",value:function(e){return new i}},{key:"Destroy",value:function(e,t){}}]),i}(Qn),tr=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.call(this)}return l(i,[{key:"Reset",value:function(e,t,s,a){n(r(i.prototype),"Reset",this).call(this,e,t,s,a)}},{key:"Evaluate",value:function(e,t,i){Yi(e,this.m_fixtureA.GetShape(),t,this.m_fixtureB.GetShape(),i)}}],[{key:"Create",value:function(e){return new i}},{key:"Destroy",value:function(e,t){}}]),i}(Qn),ir=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.call(this)}return l(i,[{key:"Reset",value:function(e,t,s,a){n(r(i.prototype),"Reset",this).call(this,e,t,s,a)}},{key:"Evaluate",value:function(e,t,i){tn(e,this.m_fixtureA.GetShape(),t,this.m_fixtureB.GetShape(),i)}}],[{key:"Create",value:function(e){return new i}},{key:"Destroy",value:function(e,t){}}]),i}(Qn),nr=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.call(this)}return l(i,[{key:"Reset",value:function(e,t,s,a){n(r(i.prototype),"Reset",this).call(this,e,t,s,a)}},{key:"Evaluate",value:function(e,t,n){var r=this.m_fixtureA.GetShape(),s=this.m_fixtureB.GetShape(),a=r,o=i.Evaluate_s_edge;a.GetChildEdge(o,this.m_indexA),Yi(e,o,t,s,n)}}],[{key:"Create",value:function(e){return new i}},{key:"Destroy",value:function(e,t){}}]),i}(Qn);nr.Evaluate_s_edge=new ln;var rr=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.call(this)}return l(i,[{key:"Reset",value:function(e,t,s,a){n(r(i.prototype),"Reset",this).call(this,e,t,s,a)}},{key:"Evaluate",value:function(e,t,n){var r=this.m_fixtureA.GetShape(),s=this.m_fixtureB.GetShape(),a=r,o=i.Evaluate_s_edge;a.GetChildEdge(o,this.m_indexA),tn(e,o,t,s,n)}}],[{key:"Create",value:function(e){return new i}},{key:"Destroy",value:function(e,t){}}]),i}(Qn);rr.Evaluate_s_edge=new ln;var sr=l((function e(){o(this,e),this.createFcn=null,this.destroyFcn=null,this.primary=!1})),ar=function(){function t(e){o(this,t),this.m_allocator=null,this.m_allocator=e,this.InitializeRegisters()}return l(t,[{key:"AddType",value:function(e,t,i,n){var r=this,s=ee(256,(function(t){return e(r.m_allocator)}));function a(t){return s.pop()||e(t)}function o(e,t){s.push(e)}this.m_registers[i][n].createFcn=a,this.m_registers[i][n].destroyFcn=o,this.m_registers[i][n].primary=!0,i!==n&&(this.m_registers[n][i].createFcn=a,this.m_registers[n][i].destroyFcn=o,this.m_registers[n][i].primary=!1)}},{key:"InitializeRegisters",value:function(){this.m_registers=[];for(var t=0;t<e.b2ShapeType.e_shapeTypeCount;t++){this.m_registers[t]=[];for(var i=0;i<e.b2ShapeType.e_shapeTypeCount;i++)this.m_registers[t][i]=new sr}this.AddType(Kn.Create,Kn.Destroy,e.b2ShapeType.e_circleShape,e.b2ShapeType.e_circleShape),this.AddType(er.Create,er.Destroy,e.b2ShapeType.e_polygonShape,e.b2ShapeType.e_circleShape),this.AddType($n.Create,$n.Destroy,e.b2ShapeType.e_polygonShape,e.b2ShapeType.e_polygonShape),this.AddType(tr.Create,tr.Destroy,e.b2ShapeType.e_edgeShape,e.b2ShapeType.e_circleShape),this.AddType(ir.Create,ir.Destroy,e.b2ShapeType.e_edgeShape,e.b2ShapeType.e_polygonShape),this.AddType(nr.Create,nr.Destroy,e.b2ShapeType.e_chainShape,e.b2ShapeType.e_circleShape),this.AddType(rr.Create,rr.Destroy,e.b2ShapeType.e_chainShape,e.b2ShapeType.e_polygonShape)}},{key:"Create",value:function(e,t,i,n){var r=e.GetType(),s=i.GetType(),a=this.m_registers[r][s];if(a.createFcn){var o=a.createFcn(this.m_allocator);return a.primary?o.Reset(e,t,i,n):o.Reset(i,n,e,t),o}return null}},{key:"Destroy",value:function(e){var t=e.m_fixtureA,i=e.m_fixtureB;e.m_manifold.pointCount>0&&!t.IsSensor()&&!i.IsSensor()&&(t.GetBody().SetAwake(!0),i.GetBody().SetAwake(!0));var n=t.GetType(),r=i.GetType(),s=this.m_registers[n][r];s.destroyFcn&&s.destroyFcn(e,this.m_allocator)}}]),t}(),or=function(){function e(){o(this,e)}return l(e,[{key:"SayGoodbyeJoint",value:function(e){}},{key:"SayGoodbyeFixture",value:function(e){}},{key:"SayGoodbyeParticleGroup",value:function(e){}},{key:"SayGoodbyeParticle",value:function(e,t){}}]),e}(),lr=function(){function t(){o(this,t)}return l(t,[{key:"ShouldCollide",value:function(t,i){var n=t.GetBody(),r=i.GetBody();if(r.GetType()===e.b2BodyType.b2_staticBody&&n.GetType()===e.b2BodyType.b2_staticBody)return!1;if(!r.ShouldCollideConnected(n))return!1;var s=t.GetFilterData(),a=i.GetFilterData();return s.groupIndex===a.groupIndex&&0!==s.groupIndex?s.groupIndex>0:0!==(s.maskBits&a.categoryBits)&&0!==(s.categoryBits&a.maskBits)}},{key:"ShouldCollideFixtureParticle",value:function(e,t,i){return!0}},{key:"ShouldCollideParticleParticle",value:function(e,t,i){return!0}}]),t}();lr.b2_defaultFilter=new lr;var ur=l((function e(){o(this,e),this.normalImpulses=ie(m),this.tangentImpulses=ie(m),this.count=0})),hr=function(){function e(){o(this,e)}return l(e,[{key:"BeginContact",value:function(e){}},{key:"EndContact",value:function(e){}},{key:"BeginContactFixtureParticle",value:function(e,t){}},{key:"EndContactFixtureParticle",value:function(e,t){}},{key:"BeginContactParticleParticle",value:function(e,t){}},{key:"EndContactParticleParticle",value:function(e,t){}},{key:"PreSolve",value:function(e,t){}},{key:"PostSolve",value:function(e,t){}}]),e}();hr.b2_defaultListener=new hr;var cr=function(){function e(){o(this,e)}return l(e,[{key:"ReportFixture",value:function(e){return!0}},{key:"ReportParticle",value:function(e,t){return!1}},{key:"ShouldQueryParticleSystem",value:function(e){return!0}}]),e}(),fr=function(){function e(){o(this,e)}return l(e,[{key:"ReportFixture",value:function(e,t,i,n){return n}},{key:"ReportParticle",value:function(e,t,i,n,r){return 0}},{key:"ShouldQueryParticleSystem",value:function(e){return!0}}]),e}(),dr=function(){function t(){o(this,t),this.m_broadPhase=new Ot,this.m_contactList=null,this.m_contactCount=0,this.m_contactFilter=lr.b2_defaultFilter,this.m_contactListener=hr.b2_defaultListener,this.m_allocator=null,this.m_contactFactory=new ar(this.m_allocator)}return l(t,[{key:"AddPair",value:function(e,t){var i=e.fixture,n=t.fixture,r=e.childIndex,s=t.childIndex,a=i.GetBody(),o=n.GetBody();if(a!==o){for(var l=o.GetContactList();l;){if(l.other===a){var u=l.contact.GetFixtureA(),h=l.contact.GetFixtureB(),c=l.contact.GetChildIndexA(),f=l.contact.GetChildIndexB();if(u===i&&h===n&&c===r&&f===s)return;if(u===n&&h===i&&c===s&&f===r)return}l=l.next}if(!this.m_contactFilter||this.m_contactFilter.ShouldCollide(i,n)){var d=this.m_contactFactory.Create(i,r,n,s);null!==d&&(i=d.GetFixtureA(),n=d.GetFixtureB(),r=d.GetChildIndexA(),s=d.GetChildIndexB(),a=i.m_body,o=n.m_body,d.m_prev=null,d.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=d),this.m_contactList=d,d.m_nodeA.contact=d,d.m_nodeA.other=o,d.m_nodeA.prev=null,d.m_nodeA.next=a.m_contactList,null!==a.m_contactList&&(a.m_contactList.prev=d.m_nodeA),a.m_contactList=d.m_nodeA,d.m_nodeB.contact=d,d.m_nodeB.other=a,d.m_nodeB.prev=null,d.m_nodeB.next=o.m_contactList,null!==o.m_contactList&&(o.m_contactList.prev=d.m_nodeB),o.m_contactList=d.m_nodeB,i.IsSensor()||n.IsSensor()||(a.SetAwake(!0),o.SetAwake(!0)),++this.m_contactCount)}}}},{key:"FindNewContacts",value:function(){var e=this;this.m_broadPhase.UpdatePairs((function(t,i){e.AddPair(t,i)}))}},{key:"Destroy",value:function(e){var t=e.GetFixtureA(),i=e.GetFixtureB(),n=t.GetBody(),r=i.GetBody();this.m_contactListener&&e.IsTouching()&&this.m_contactListener.EndContact(e),e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_contactList&&(this.m_contactList=e.m_next),e.m_nodeA.prev&&(e.m_nodeA.prev.next=e.m_nodeA.next),e.m_nodeA.next&&(e.m_nodeA.next.prev=e.m_nodeA.prev),e.m_nodeA===n.m_contactList&&(n.m_contactList=e.m_nodeA.next),e.m_nodeB.prev&&(e.m_nodeB.prev.next=e.m_nodeB.next),e.m_nodeB.next&&(e.m_nodeB.next.prev=e.m_nodeB.prev),e.m_nodeB===r.m_contactList&&(r.m_contactList=e.m_nodeB.next),this.m_contactFactory.Destroy(e),--this.m_contactCount}},{key:"Collide",value:function(){for(var t=this.m_contactList;t;){var i=t.GetFixtureA(),n=t.GetFixtureB(),r=t.GetChildIndexA(),s=t.GetChildIndexB(),a=i.GetBody(),o=n.GetBody();if(t.m_filterFlag){if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(i,n)){var l=t;t=l.m_next,this.Destroy(l);continue}t.m_filterFlag=!1}var u=a.IsAwake()&&a.m_type!==e.b2BodyType.b2_staticBody,h=o.IsAwake()&&o.m_type!==e.b2BodyType.b2_staticBody;if(u||h){var c=i.m_proxies[r].treeNode,f=n.m_proxies[s].treeNode;if(Vt(c.aabb,f.aabb))t.Update(this.m_contactListener),t=t.m_next;else{var d=t;t=d.m_next,this.Destroy(d)}}else t=t.m_next}}}]),t}(),mr=function(){function e(){o(this,e),this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0}return l(e,[{key:"Reset",value:function(){return this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0,this}}]),e}(),_r=function(){function e(){o(this,e),this.dt=0,this.inv_dt=0,this.dtRatio=0,this.velocityIterations=0,this.positionIterations=0,this.particleIterations=0,this.warmStarting=!1}return l(e,[{key:"Copy",value:function(e){return this.dt=e.dt,this.inv_dt=e.inv_dt,this.dtRatio=e.dtRatio,this.positionIterations=e.positionIterations,this.velocityIterations=e.velocityIterations,this.particleIterations=e.particleIterations,this.warmStarting=e.warmStarting,this}}]),e}(),pr=function(){function e(){o(this,e),this.c=new ke,this.a=0}return l(e,null,[{key:"MakeArray",value:function(t){return ee(t,(function(t){return new e}))}}]),e}(),vr=function(){function e(){o(this,e),this.v=new ke,this.w=0}return l(e,null,[{key:"MakeArray",value:function(t){return ee(t,(function(t){return new e}))}}]),e}(),yr=l((function e(){o(this,e),this.step=new _r})),gr=!1,xr=function(){function e(){o(this,e),this.rA=new ke,this.rB=new ke,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}return l(e,null,[{key:"MakeArray",value:function(t){return ee(t,(function(t){return new e}))}}]),e}(),br=function(){function e(){o(this,e),this.points=xr.MakeArray(m),this.normal=new ke,this.tangent=new ke,this.normalMass=new Te,this.K=new Te,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.invIA=0,this.invIB=0,this.friction=0,this.restitution=0,this.tangentSpeed=0,this.pointCount=0,this.contactIndex=0}return l(e,null,[{key:"MakeArray",value:function(t){return ee(t,(function(t){return new e}))}}]),e}(),wr=function(){function t(){o(this,t),this.localPoints=ke.MakeArray(m),this.localNormal=new ke,this.localPoint=new ke,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.localCenterA=new ke,this.localCenterB=new ke,this.invIA=0,this.invIB=0,this.type=e.b2ManifoldType.e_unknown,this.radiusA=0,this.radiusB=0,this.pointCount=0}return l(t,null,[{key:"MakeArray",value:function(e){return ee(e,(function(e){return new t}))}}]),t}(),Ar=l((function e(){o(this,e),this.step=new _r,this.count=0,this.allocator=null})),Sr=function(){function t(){o(this,t),this.normal=new ke,this.point=new ke,this.separation=0}return l(t,[{key:"Initialize",value:function(i,n,r,s){var a=t.Initialize_s_pointA,o=t.Initialize_s_pointB,l=t.Initialize_s_planePoint,u=t.Initialize_s_clipPoint;switch(i.type){case e.b2ManifoldType.e_circles:Ee.MulXV(n,i.localPoint,a),Ee.MulXV(r,i.localPoints[0],o),ke.SubVV(o,a,this.normal).SelfNormalize(),ke.MidVV(a,o,this.point),this.separation=ke.DotVV(ke.SubVV(o,a,ke.s_t0),this.normal)-i.radiusA-i.radiusB;break;case e.b2ManifoldType.e_faceA:Le.MulRV(n.q,i.localNormal,this.normal),Ee.MulXV(n,i.localPoint,l),Ee.MulXV(r,i.localPoints[s],u),this.separation=ke.DotVV(ke.SubVV(u,l,ke.s_t0),this.normal)-i.radiusA-i.radiusB,this.point.Copy(u);break;case e.b2ManifoldType.e_faceB:Le.MulRV(r.q,i.localNormal,this.normal),Ee.MulXV(r,i.localPoint,l),Ee.MulXV(n,i.localPoints[s],u),this.separation=ke.DotVV(ke.SubVV(u,l,ke.s_t0),this.normal)-i.radiusA-i.radiusB,this.point.Copy(u),this.normal.SelfNeg()}}}]),t}();Sr.Initialize_s_pointA=new ke,Sr.Initialize_s_pointB=new ke,Sr.Initialize_s_planePoint=new ke,Sr.Initialize_s_clipPoint=new ke;var Mr=function(){function e(){o(this,e),this.m_step=new _r,this.m_allocator=null,this.m_positionConstraints=wr.MakeArray(1024),this.m_velocityConstraints=br.MakeArray(1024),this.m_count=0}return l(e,[{key:"Initialize",value:function(e){if(this.m_step.Copy(e.step),this.m_allocator=e.allocator,this.m_count=e.count,this.m_positionConstraints.length<this.m_count)for(var t=le(2*this.m_positionConstraints.length,this.m_count);this.m_positionConstraints.length<t;)this.m_positionConstraints[this.m_positionConstraints.length]=new wr;if(this.m_velocityConstraints.length<this.m_count)for(var i=le(2*this.m_velocityConstraints.length,this.m_count);this.m_velocityConstraints.length<i;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new br;this.m_positions=e.positions,this.m_velocities=e.velocities,this.m_contacts=e.contacts;for(var n=0;n<this.m_count;++n){var r=this.m_contacts[n],s=r.m_fixtureA,a=r.m_fixtureB,o=s.GetShape(),l=a.GetShape(),u=o.m_radius,h=l.m_radius,c=s.GetBody(),f=a.GetBody(),d=r.GetManifold(),m=d.pointCount,_=this.m_velocityConstraints[n];_.friction=r.m_friction,_.restitution=r.m_restitution,_.tangentSpeed=r.m_tangentSpeed,_.indexA=c.m_islandIndex,_.indexB=f.m_islandIndex,_.invMassA=c.m_invMass,_.invMassB=f.m_invMass,_.invIA=c.m_invI,_.invIB=f.m_invI,_.contactIndex=n,_.pointCount=m,_.K.SetZero(),_.normalMass.SetZero();var p=this.m_positionConstraints[n];p.indexA=c.m_islandIndex,p.indexB=f.m_islandIndex,p.invMassA=c.m_invMass,p.invMassB=f.m_invMass,p.localCenterA.Copy(c.m_sweep.localCenter),p.localCenterB.Copy(f.m_sweep.localCenter),p.invIA=c.m_invI,p.invIB=f.m_invI,p.localNormal.Copy(d.localNormal),p.localPoint.Copy(d.localPoint),p.pointCount=m,p.radiusA=u,p.radiusB=h,p.type=d.type;for(var v=0;v<m;++v){var y=d.points[v],g=_.points[v];this.m_step.warmStarting?(g.normalImpulse=this.m_step.dtRatio*y.normalImpulse,g.tangentImpulse=this.m_step.dtRatio*y.tangentImpulse):(g.normalImpulse=0,g.tangentImpulse=0),g.rA.SetZero(),g.rB.SetZero(),g.normalMass=0,g.tangentMass=0,g.velocityBias=0,p.localPoints[v].Copy(y.localPoint)}}return this}},{key:"InitializeVelocityConstraints",value:function(){for(var t=e.InitializeVelocityConstraints_s_xfA,i=e.InitializeVelocityConstraints_s_xfB,n=e.InitializeVelocityConstraints_s_worldManifold,r=1e3,s=0;s<this.m_count;++s){var a=this.m_velocityConstraints[s],o=this.m_positionConstraints[s],l=o.radiusA,u=o.radiusB,h=this.m_contacts[a.contactIndex].GetManifold(),c=a.indexA,f=a.indexB,d=a.invMassA,m=a.invMassB,_=a.invIA,p=a.invIB,v=o.localCenterA,y=o.localCenterB,g=this.m_positions[c].c,x=this.m_positions[c].a,b=this.m_velocities[c].v,w=this.m_velocities[c].w,S=this.m_positions[f].c,M=this.m_positions[f].a,C=this.m_velocities[f].v,k=this.m_velocities[f].w;t.q.SetAngle(x),i.q.SetAngle(M),ke.SubVV(g,Le.MulRV(t.q,v,ke.s_t0),t.p),ke.SubVV(S,Le.MulRV(i.q,y,ke.s_t0),i.p),n.Initialize(h,t,l,i,u),a.normal.Copy(n.normal),ke.CrossVOne(a.normal,a.tangent);for(var B=a.pointCount,V=0;V<B;++V){var T=a.points[V];ke.SubVV(n.points[V],g,T.rA),ke.SubVV(n.points[V],S,T.rB);var P=ke.CrossVV(T.rA,a.normal),L=ke.CrossVV(T.rB,a.normal),E=d+m+_*P*P+p*L*L;T.normalMass=E>0?1/E:0;var I=a.tangent,R=ke.CrossVV(T.rA,I),F=ke.CrossVV(T.rB,I),G=d+m+_*R*R+p*F*F;T.tangentMass=G>0?1/G:0,T.velocityBias=0;var D=ke.DotVV(a.normal,ke.SubVV(ke.AddVCrossSV(C,k,T.rB,ke.s_t0),ke.AddVCrossSV(b,w,T.rA,ke.s_t1),ke.s_t0));D<-A&&(T.velocityBias+=-a.restitution*D)}if(2===a.pointCount&&gr){var O=a.points[0],N=a.points[1],z=ke.CrossVV(O.rA,a.normal),U=ke.CrossVV(O.rB,a.normal),j=ke.CrossVV(N.rA,a.normal),W=ke.CrossVV(N.rB,a.normal),q=d+m+_*z*z+p*U*U,H=d+m+_*j*j+p*W*W,X=d+m+_*z*j+p*U*W;q*q<r*(q*H-X*X)?(a.K.ex.Set(q,X),a.K.ey.Set(X,H),a.K.GetInverse(a.normalMass)):a.pointCount=1}}}},{key:"WarmStart",value:function(){for(var t=e.WarmStart_s_P,i=0;i<this.m_count;++i){for(var n=this.m_velocityConstraints[i],r=n.indexA,s=n.indexB,a=n.invMassA,o=n.invIA,l=n.invMassB,u=n.invIB,h=n.pointCount,c=this.m_velocities[r].v,f=this.m_velocities[r].w,d=this.m_velocities[s].v,m=this.m_velocities[s].w,_=n.normal,p=n.tangent,v=0;v<h;++v){var y=n.points[v];ke.AddVV(ke.MulSV(y.normalImpulse,_,ke.s_t0),ke.MulSV(y.tangentImpulse,p,ke.s_t1),t),f-=o*ke.CrossVV(y.rA,t),c.SelfMulSub(a,t),m+=u*ke.CrossVV(y.rB,t),d.SelfMulAdd(l,t)}this.m_velocities[r].w=f,this.m_velocities[s].w=m}}},{key:"SolveVelocityConstraints",value:function(){for(var t=e.SolveVelocityConstraints_s_dv,i=e.SolveVelocityConstraints_s_dv1,n=e.SolveVelocityConstraints_s_dv2,r=e.SolveVelocityConstraints_s_P,s=e.SolveVelocityConstraints_s_a,a=e.SolveVelocityConstraints_s_b,o=e.SolveVelocityConstraints_s_x,l=e.SolveVelocityConstraints_s_d,u=e.SolveVelocityConstraints_s_P1,h=e.SolveVelocityConstraints_s_P2,c=e.SolveVelocityConstraints_s_P1P2,f=0;f<this.m_count;++f){for(var d=this.m_velocityConstraints[f],m=d.indexA,_=d.indexB,p=d.invMassA,v=d.invIA,y=d.invMassB,g=d.invIB,x=d.pointCount,b=this.m_velocities[m].v,w=this.m_velocities[m].w,A=this.m_velocities[_].v,S=this.m_velocities[_].w,M=d.normal,C=d.tangent,k=d.friction,B=0;B<x;++B){var V=d.points[B];ke.SubVV(ke.AddVCrossSV(A,S,V.rB,ke.s_t0),ke.AddVCrossSV(b,w,V.rA,ke.s_t1),t);var T=ke.DotVV(t,C)-d.tangentSpeed,P=V.tangentMass*-T,L=k*V.normalImpulse,E=ue(V.tangentImpulse+P,-L,L);P=E-V.tangentImpulse,V.tangentImpulse=E,ke.MulSV(P,C,r),b.SelfMulSub(p,r),w-=v*ke.CrossVV(V.rA,r),A.SelfMulAdd(y,r),S+=g*ke.CrossVV(V.rB,r)}if(1===d.pointCount||!1===gr)for(var I=0;I<x;++I){var R=d.points[I];ke.SubVV(ke.AddVCrossSV(A,S,R.rB,ke.s_t0),ke.AddVCrossSV(b,w,R.rA,ke.s_t1),t);var F=ke.DotVV(t,M),G=-R.normalMass*(F-R.velocityBias),D=le(R.normalImpulse+G,0);G=D-R.normalImpulse,R.normalImpulse=D,ke.MulSV(G,M,r),b.SelfMulSub(p,r),w-=v*ke.CrossVV(R.rA,r),A.SelfMulAdd(y,r),S+=g*ke.CrossVV(R.rB,r)}else{var O=d.points[0],N=d.points[1];s.Set(O.normalImpulse,N.normalImpulse),ke.SubVV(ke.AddVCrossSV(A,S,O.rB,ke.s_t0),ke.AddVCrossSV(b,w,O.rA,ke.s_t1),i),ke.SubVV(ke.AddVCrossSV(A,S,N.rB,ke.s_t0),ke.AddVCrossSV(b,w,N.rA,ke.s_t1),n);var z=ke.DotVV(i,M),U=ke.DotVV(n,M);for(a.x=z-O.velocityBias,a.y=U-N.velocityBias,a.SelfSub(Te.MulMV(d.K,s,ke.s_t0));;){if(Te.MulMV(d.normalMass,a,o).SelfNeg(),o.x>=0&&o.y>=0){ke.SubVV(o,s,l),ke.MulSV(l.x,M,u),ke.MulSV(l.y,M,h),ke.AddVV(u,h,c),b.SelfMulSub(p,c),w-=v*(ke.CrossVV(O.rA,u)+ke.CrossVV(N.rA,h)),A.SelfMulAdd(y,c),S+=g*(ke.CrossVV(O.rB,u)+ke.CrossVV(N.rB,h)),O.normalImpulse=o.x,N.normalImpulse=o.y;break}if(o.x=-O.normalMass*a.x,o.y=0,z=0,U=d.K.ex.y*o.x+a.y,o.x>=0&&U>=0){ke.SubVV(o,s,l),ke.MulSV(l.x,M,u),ke.MulSV(l.y,M,h),ke.AddVV(u,h,c),b.SelfMulSub(p,c),w-=v*(ke.CrossVV(O.rA,u)+ke.CrossVV(N.rA,h)),A.SelfMulAdd(y,c),S+=g*(ke.CrossVV(O.rB,u)+ke.CrossVV(N.rB,h)),O.normalImpulse=o.x,N.normalImpulse=o.y;break}if(o.x=0,o.y=-N.normalMass*a.y,z=d.K.ey.x*o.y+a.x,U=0,o.y>=0&&z>=0){ke.SubVV(o,s,l),ke.MulSV(l.x,M,u),ke.MulSV(l.y,M,h),ke.AddVV(u,h,c),b.SelfMulSub(p,c),w-=v*(ke.CrossVV(O.rA,u)+ke.CrossVV(N.rA,h)),A.SelfMulAdd(y,c),S+=g*(ke.CrossVV(O.rB,u)+ke.CrossVV(N.rB,h)),O.normalImpulse=o.x,N.normalImpulse=o.y;break}if(o.x=0,o.y=0,z=a.x,U=a.y,z>=0&&U>=0){ke.SubVV(o,s,l),ke.MulSV(l.x,M,u),ke.MulSV(l.y,M,h),ke.AddVV(u,h,c),b.SelfMulSub(p,c),w-=v*(ke.CrossVV(O.rA,u)+ke.CrossVV(N.rA,h)),A.SelfMulAdd(y,c),S+=g*(ke.CrossVV(O.rB,u)+ke.CrossVV(N.rB,h)),O.normalImpulse=o.x,N.normalImpulse=o.y;break}break}}this.m_velocities[m].w=w,this.m_velocities[_].w=S}}},{key:"StoreImpulses",value:function(){for(var e=0;e<this.m_count;++e)for(var t=this.m_velocityConstraints[e],i=this.m_contacts[t.contactIndex].GetManifold(),n=0;n<t.pointCount;++n)i.points[n].normalImpulse=t.points[n].normalImpulse,i.points[n].tangentImpulse=t.points[n].tangentImpulse}},{key:"SolvePositionConstraints",value:function(){for(var t=e.SolvePositionConstraints_s_xfA,i=e.SolvePositionConstraints_s_xfB,n=e.SolvePositionConstraints_s_psm,r=e.SolvePositionConstraints_s_rA,s=e.SolvePositionConstraints_s_rB,a=e.SolvePositionConstraints_s_P,o=0,l=0;l<this.m_count;++l){for(var u=this.m_positionConstraints[l],h=u.indexA,c=u.indexB,f=u.localCenterA,d=u.invMassA,m=u.invIA,_=u.localCenterB,p=u.invMassB,v=u.invIB,g=u.pointCount,x=this.m_positions[h].c,b=this.m_positions[h].a,w=this.m_positions[c].c,A=this.m_positions[c].a,M=0;M<g;++M){t.q.SetAngle(b),i.q.SetAngle(A),ke.SubVV(x,Le.MulRV(t.q,f,ke.s_t0),t.p),ke.SubVV(w,Le.MulRV(i.q,_,ke.s_t0),i.p),n.Initialize(u,t,i,M);var C=n.normal,k=n.point,B=n.separation;ke.SubVV(k,x,r),ke.SubVV(k,w,s),o=oe(o,B);var V=ue(T*(B+y),-S,0),P=ke.CrossVV(r,C),L=ke.CrossVV(s,C),E=d+p+m*P*P+v*L*L,I=E>0?-V/E:0;ke.MulSV(I,C,a),x.SelfMulSub(d,a),b-=m*ke.CrossVV(r,a),w.SelfMulAdd(p,a),A+=v*ke.CrossVV(s,a)}this.m_positions[h].a=b,this.m_positions[c].a=A}return o>-3*y}},{key:"SolveTOIPositionConstraints",value:function(t,i){for(var n=e.SolveTOIPositionConstraints_s_xfA,r=e.SolveTOIPositionConstraints_s_xfB,s=e.SolveTOIPositionConstraints_s_psm,a=e.SolveTOIPositionConstraints_s_rA,o=e.SolveTOIPositionConstraints_s_rB,l=e.SolveTOIPositionConstraints_s_P,u=0,h=0;h<this.m_count;++h){var c=this.m_positionConstraints[h],f=c.indexA,d=c.indexB,m=c.localCenterA,_=c.localCenterB,p=c.pointCount,v=0,g=0;f!==t&&f!==i||(v=c.invMassA,g=c.invIA);var x=0,b=0;d!==t&&d!==i||(x=c.invMassB,b=c.invIB);for(var w=this.m_positions[f].c,A=this.m_positions[f].a,M=this.m_positions[d].c,C=this.m_positions[d].a,k=0;k<p;++k){n.q.SetAngle(A),r.q.SetAngle(C),ke.SubVV(w,Le.MulRV(n.q,m,ke.s_t0),n.p),ke.SubVV(M,Le.MulRV(r.q,_,ke.s_t0),r.p),s.Initialize(c,n,r,k);var B=s.normal,V=s.point,T=s.separation;ke.SubVV(V,w,a),ke.SubVV(V,M,o),u=oe(u,T);var L=ue(P*(T+y),-S,0),E=ke.CrossVV(a,B),I=ke.CrossVV(o,B),R=v+x+g*E*E+b*I*I,F=R>0?-L/R:0;ke.MulSV(F,B,l),w.SelfMulSub(v,l),A-=g*ke.CrossVV(a,l),M.SelfMulAdd(x,l),C+=b*ke.CrossVV(o,l)}this.m_positions[f].a=A,this.m_positions[d].a=C}return u>=-1.5*y}}]),e}();Mr.InitializeVelocityConstraints_s_xfA=new Ee,Mr.InitializeVelocityConstraints_s_xfB=new Ee,Mr.InitializeVelocityConstraints_s_worldManifold=new At,Mr.WarmStart_s_P=new ke,Mr.SolveVelocityConstraints_s_dv=new ke,Mr.SolveVelocityConstraints_s_dv1=new ke,Mr.SolveVelocityConstraints_s_dv2=new ke,Mr.SolveVelocityConstraints_s_P=new ke,Mr.SolveVelocityConstraints_s_a=new ke,Mr.SolveVelocityConstraints_s_b=new ke,Mr.SolveVelocityConstraints_s_x=new ke,Mr.SolveVelocityConstraints_s_d=new ke,Mr.SolveVelocityConstraints_s_P1=new ke,Mr.SolveVelocityConstraints_s_P2=new ke,Mr.SolveVelocityConstraints_s_P1P2=new ke,Mr.SolvePositionConstraints_s_xfA=new Ee,Mr.SolvePositionConstraints_s_xfB=new Ee,Mr.SolvePositionConstraints_s_psm=new Sr,Mr.SolvePositionConstraints_s_rA=new ke,Mr.SolvePositionConstraints_s_rB=new ke,Mr.SolvePositionConstraints_s_P=new ke,Mr.SolveTOIPositionConstraints_s_xfA=new Ee,Mr.SolveTOIPositionConstraints_s_xfB=new Ee,Mr.SolveTOIPositionConstraints_s_psm=new Sr,Mr.SolveTOIPositionConstraints_s_rA=new ke,Mr.SolveTOIPositionConstraints_s_rB=new ke,Mr.SolveTOIPositionConstraints_s_P=new ke;var Cr,kr=function(){function t(){o(this,t),this.m_allocator=null,this.m_bodies=[],this.m_contacts=[],this.m_joints=[],this.m_positions=pr.MakeArray(1024),this.m_velocities=vr.MakeArray(1024),this.m_bodyCount=0,this.m_jointCount=0,this.m_contactCount=0,this.m_bodyCapacity=0,this.m_contactCapacity=0,this.m_jointCapacity=0}return l(t,[{key:"Initialize",value:function(e,t,i,n,r){if(this.m_bodyCapacity=e,this.m_contactCapacity=t,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=r,this.m_positions.length<e)for(var s=le(2*this.m_positions.length,e);this.m_positions.length<s;)this.m_positions[this.m_positions.length]=new pr;if(this.m_velocities.length<e)for(var a=le(2*this.m_velocities.length,e);this.m_velocities.length<a;)this.m_velocities[this.m_velocities.length]=new vr}},{key:"Clear",value:function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0}},{key:"AddBody",value:function(e){e.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=e}},{key:"AddContact",value:function(e){this.m_contacts[this.m_contactCount++]=e}},{key:"AddJoint",value:function(e){this.m_joints[this.m_jointCount++]=e}},{key:"Solve",value:function(i,n,r,s){for(var a=t.s_timer.Reset(),o=n.dt,l=0;l<this.m_bodyCount;++l){var u=this.m_bodies[l];this.m_positions[l].c.Copy(u.m_sweep.c);var c=u.m_sweep.a,f=this.m_velocities[l].v.Copy(u.m_linearVelocity),d=u.m_angularVelocity;u.m_sweep.c0.Copy(u.m_sweep.c),u.m_sweep.a0=u.m_sweep.a,u.m_type===e.b2BodyType.b2_dynamicBody&&(f.x+=o*(u.m_gravityScale*r.x+u.m_invMass*u.m_force.x),f.y+=o*(u.m_gravityScale*r.y+u.m_invMass*u.m_force.y),d+=o*u.m_invI*u.m_torque,f.SelfMul(1/(1+o*u.m_linearDamping)),d*=1/(1+o*u.m_angularDamping)),this.m_positions[l].a=c,this.m_velocities[l].w=d}a.Reset();var m=t.s_solverData;m.step.Copy(n),m.positions=this.m_positions,m.velocities=this.m_velocities;var _=t.s_contactSolverDef;_.step.Copy(n),_.contacts=this.m_contacts,_.count=this.m_contactCount,_.positions=this.m_positions,_.velocities=this.m_velocities,_.allocator=this.m_allocator;var p=t.s_contactSolver.Initialize(_);p.InitializeVelocityConstraints(),n.warmStarting&&p.WarmStart();for(var v=0;v<this.m_jointCount;++v)this.m_joints[v].InitVelocityConstraints(m);i.solveInit=a.GetMilliseconds(),a.Reset();for(var y=0;y<n.velocityIterations;++y){for(var g=0;g<this.m_jointCount;++g)this.m_joints[g].SolveVelocityConstraints(m);p.SolveVelocityConstraints()}p.StoreImpulses(),i.solveVelocity=a.GetMilliseconds();for(var x=0;x<this.m_bodyCount;++x){var b=this.m_positions[x].c,w=this.m_positions[x].a,A=this.m_velocities[x].v,S=this.m_velocities[x].w,M=ke.MulSV(o,A,t.s_translation);if(ke.DotVV(M,M)>k){var T=C/M.Length();A.SelfMul(T)}var P=o*S;P*P>V&&(S*=B/ae(P)),b.x+=o*A.x,b.y+=o*A.y,w+=o*S,this.m_positions[x].a=w,this.m_velocities[x].w=S}a.Reset();for(var L=!1,E=0;E<n.positionIterations;++E){for(var I=p.SolvePositionConstraints(),R=!0,F=0;F<this.m_jointCount;++F){var G=this.m_joints[F].SolvePositionConstraints(m);R=R&&G}if(I&&R){L=!0;break}}for(var D=0;D<this.m_bodyCount;++D){var O=this.m_bodies[D];O.m_sweep.c.Copy(this.m_positions[D].c),O.m_sweep.a=this.m_positions[D].a,O.m_linearVelocity.Copy(this.m_velocities[D].v),O.m_angularVelocity=this.m_velocities[D].w,O.SynchronizeTransform()}if(i.solvePosition=a.GetMilliseconds(),this.Report(p.m_velocityConstraints),s){for(var N=h,z=j*j,q=W*W,H=0;H<this.m_bodyCount;++H){var X=this.m_bodies[H];X.GetType()!==e.b2BodyType.b2_staticBody&&(!X.m_autoSleepFlag||X.m_angularVelocity*X.m_angularVelocity>q||ke.DotVV(X.m_linearVelocity,X.m_linearVelocity)>z?(X.m_sleepTime=0,N=0):(X.m_sleepTime+=o,N=oe(N,X.m_sleepTime)))}if(N>=U&&L)for(var J=0;J<this.m_bodyCount;++J)this.m_bodies[J].SetAwake(!1)}}},{key:"SolveTOI",value:function(e,i,n){for(var r=0;r<this.m_bodyCount;++r){var s=this.m_bodies[r];this.m_positions[r].c.Copy(s.m_sweep.c),this.m_positions[r].a=s.m_sweep.a,this.m_velocities[r].v.Copy(s.m_linearVelocity),this.m_velocities[r].w=s.m_angularVelocity}var a=t.s_contactSolverDef;a.contacts=this.m_contacts,a.count=this.m_contactCount,a.allocator=this.m_allocator,a.step.Copy(e),a.positions=this.m_positions,a.velocities=this.m_velocities;for(var o=t.s_contactSolver.Initialize(a),l=0;l<e.positionIterations&&!o.SolveTOIPositionConstraints(i,n);++l);this.m_bodies[i].m_sweep.c0.Copy(this.m_positions[i].c),this.m_bodies[i].m_sweep.a0=this.m_positions[i].a,this.m_bodies[n].m_sweep.c0.Copy(this.m_positions[n].c),this.m_bodies[n].m_sweep.a0=this.m_positions[n].a,o.InitializeVelocityConstraints();for(var u=0;u<e.velocityIterations;++u)o.SolveVelocityConstraints();for(var h=e.dt,c=0;c<this.m_bodyCount;++c){var f=this.m_positions[c].c,d=this.m_positions[c].a,m=this.m_velocities[c].v,_=this.m_velocities[c].w,p=ke.MulSV(h,m,t.s_translation);if(ke.DotVV(p,p)>k){var v=C/p.Length();m.SelfMul(v)}var y=h*_;y*y>V&&(_*=B/ae(y)),f.SelfMulAdd(h,m),d+=h*_,this.m_positions[c].a=d,this.m_velocities[c].w=_;var g=this.m_bodies[c];g.m_sweep.c.Copy(f),g.m_sweep.a=d,g.m_linearVelocity.Copy(m),g.m_angularVelocity=_,g.SynchronizeTransform()}this.Report(o.m_velocityConstraints)}},{key:"Report",value:function(e){if(null!==this.m_listener)for(var i=0;i<this.m_contactCount;++i){var n=this.m_contacts[i];if(n){var r=e[i],s=t.s_impulse;s.count=r.pointCount;for(var a=0;a<r.pointCount;++a)s.normalImpulses[a]=r.points[a].normalImpulse,s.tangentImpulses[a]=r.points[a].tangentImpulse;this.m_listener.PostSolve(n,s)}}}}]),t}();kr.s_timer=new De,kr.s_solverData=new yr,kr.s_contactSolverDef=new Ar,kr.s_contactSolver=new Mr,kr.s_translation=new ke,kr.s_impulse=new ur,(Cr=e.b2ParticleFlag||(e.b2ParticleFlag={}))[Cr.b2_waterParticle=0]="b2_waterParticle",Cr[Cr.b2_zombieParticle=2]="b2_zombieParticle",Cr[Cr.b2_wallParticle=4]="b2_wallParticle",Cr[Cr.b2_springParticle=8]="b2_springParticle",Cr[Cr.b2_elasticParticle=16]="b2_elasticParticle",Cr[Cr.b2_viscousParticle=32]="b2_viscousParticle",Cr[Cr.b2_powderParticle=64]="b2_powderParticle",Cr[Cr.b2_tensileParticle=128]="b2_tensileParticle",Cr[Cr.b2_colorMixingParticle=256]="b2_colorMixingParticle",Cr[Cr.b2_destructionListenerParticle=512]="b2_destructionListenerParticle",Cr[Cr.b2_barrierParticle=1024]="b2_barrierParticle",Cr[Cr.b2_staticPressureParticle=2048]="b2_staticPressureParticle",Cr[Cr.b2_reactiveParticle=4096]="b2_reactiveParticle",Cr[Cr.b2_repulsiveParticle=8192]="b2_repulsiveParticle",Cr[Cr.b2_fixtureContactListenerParticle=16384]="b2_fixtureContactListenerParticle",Cr[Cr.b2_particleContactListenerParticle=32768]="b2_particleContactListenerParticle",Cr[Cr.b2_fixtureContactFilterParticle=65536]="b2_fixtureContactFilterParticle",Cr[Cr.b2_particleContactFilterParticle=131072]="b2_particleContactFilterParticle";var Br=l((function e(){o(this,e),this.flags=0,this.position=new ke,this.velocity=new ke,this.color=new Fe(0,0,0,0),this.lifetime=0,this.userData=null,this.group=null}));function Vr(e,t,i){var n=8,r=.01;return ue(Math.ceil(Math.sqrt(e/(r*t))*i),1,n)}var Tr,Pr=function(){function e(){o(this,e),this.m_index=L}return l(e,[{key:"GetIndex",value:function(){return this.m_index}},{key:"SetIndex",value:function(e){this.m_index=e}}]),e}();(Tr=e.b2ParticleGroupFlag||(e.b2ParticleGroupFlag={}))[Tr.b2_solidParticleGroup=1]="b2_solidParticleGroup",Tr[Tr.b2_rigidParticleGroup=2]="b2_rigidParticleGroup",Tr[Tr.b2_particleGroupCanBeEmpty=4]="b2_particleGroupCanBeEmpty",Tr[Tr.b2_particleGroupWillBeDestroyed=8]="b2_particleGroupWillBeDestroyed",Tr[Tr.b2_particleGroupNeedsUpdateDepth=16]="b2_particleGroupNeedsUpdateDepth",Tr[Tr.b2_particleGroupInternalMask=24]="b2_particleGroupInternalMask";var Lr=l((function e(){o(this,e),this.flags=0,this.groupFlags=0,this.position=new ke,this.angle=0,this.linearVelocity=new ke,this.angularVelocity=0,this.color=new Fe,this.strength=1,this.shapeCount=0,this.stride=0,this.particleCount=0,this.lifetime=0,this.userData=null,this.group=null})),Er=function(){function t(e){o(this,t),this.m_firstIndex=0,this.m_lastIndex=0,this.m_groupFlags=0,this.m_strength=1,this.m_prev=null,this.m_next=null,this.m_timestamp=-1,this.m_mass=0,this.m_inertia=0,this.m_center=new ke,this.m_linearVelocity=new ke,this.m_angularVelocity=0,this.m_transform=new Ee,this.m_userData=null,this.m_system=e}return l(t,[{key:"GetNext",value:function(){return this.m_next}},{key:"GetParticleSystem",value:function(){return this.m_system}},{key:"GetParticleCount",value:function(){return this.m_lastIndex-this.m_firstIndex}},{key:"GetBufferIndex",value:function(){return this.m_firstIndex}},{key:"ContainsParticle",value:function(e){return this.m_firstIndex<=e&&e<this.m_lastIndex}},{key:"GetAllParticleFlags",value:function(){if(!this.m_system.m_flagsBuffer.data)throw new Error;for(var e=0,t=this.m_firstIndex;t<this.m_lastIndex;t++)e|=this.m_system.m_flagsBuffer.data[t];return e}},{key:"GetGroupFlags",value:function(){return this.m_groupFlags}},{key:"SetGroupFlags",value:function(t){t|=this.m_groupFlags&e.b2ParticleGroupFlag.b2_particleGroupInternalMask,this.m_system.SetGroupFlags(this,t)}},{key:"GetMass",value:function(){return this.UpdateStatistics(),this.m_mass}},{key:"GetInertia",value:function(){return this.UpdateStatistics(),this.m_inertia}},{key:"GetCenter",value:function(){return this.UpdateStatistics(),this.m_center}},{key:"GetLinearVelocity",value:function(){return this.UpdateStatistics(),this.m_linearVelocity}},{key:"GetAngularVelocity",value:function(){return this.UpdateStatistics(),this.m_angularVelocity}},{key:"GetTransform",value:function(){return this.m_transform}},{key:"GetPosition",value:function(){return this.m_transform.p}},{key:"GetAngle",value:function(){return this.m_transform.q.GetAngle()}},{key:"GetLinearVelocityFromWorldPoint",value:function(e,i){var n=t.GetLinearVelocityFromWorldPoint_s_t0;return this.UpdateStatistics(),ke.AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,ke.SubVV(e,this.m_center,n),i)}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(e){this.m_userData=e}},{key:"ApplyForce",value:function(e){this.m_system.ApplyForce(this.m_firstIndex,this.m_lastIndex,e)}},{key:"ApplyLinearImpulse",value:function(e){this.m_system.ApplyLinearImpulse(this.m_firstIndex,this.m_lastIndex,e)}},{key:"DestroyParticles",value:function(e){if(this.m_system.m_world.IsLocked())throw new Error;for(var t=this.m_firstIndex;t<this.m_lastIndex;t++)this.m_system.DestroyParticle(t,e)}},{key:"UpdateStatistics",value:function(){if(!this.m_system.m_positionBuffer.data)throw new Error;if(!this.m_system.m_velocityBuffer.data)throw new Error;var e=new ke,t=new ke;if(this.m_timestamp!==this.m_system.m_timestamp){var i=this.m_system.GetParticleMass();this.m_mass=i*(this.m_lastIndex-this.m_firstIndex),this.m_center.SetZero(),this.m_linearVelocity.SetZero();for(var n=this.m_firstIndex;n<this.m_lastIndex;n++)this.m_center.SelfMulAdd(i,this.m_system.m_positionBuffer.data[n]),this.m_linearVelocity.SelfMulAdd(i,this.m_system.m_velocityBuffer.data[n]);if(this.m_mass>0){var r=1/this.m_mass;this.m_center.SelfMul(r),this.m_linearVelocity.SelfMul(r)}this.m_inertia=0,this.m_angularVelocity=0;for(var s=this.m_firstIndex;s<this.m_lastIndex;s++)ke.SubVV(this.m_system.m_positionBuffer.data[s],this.m_center,e),ke.SubVV(this.m_system.m_velocityBuffer.data[s],this.m_linearVelocity,t),this.m_inertia+=i*ke.DotVV(e,e),this.m_angularVelocity+=i*ke.CrossVV(e,t);this.m_inertia>0&&(this.m_angularVelocity*=1/this.m_inertia),this.m_timestamp=this.m_system.m_timestamp}}}]),t}();Er.GetLinearVelocityFromWorldPoint_s_t0=new ke;var Ir=function(){function e(t){o(this,e),this.m_front=0,this.m_back=0,this.m_capacity=0,this.m_buffer=ee(t,(function(e){return null})),this.m_capacity=t}return l(e,[{key:"Push",value:function(e){if(this.m_back>=this.m_capacity){for(var t=this.m_front;t<this.m_back;t++)this.m_buffer[t-this.m_front]=this.m_buffer[t];this.m_back-=this.m_front,this.m_front=0,this.m_back>=this.m_capacity&&(this.m_capacity>0?(this.m_buffer.concat(ee(this.m_capacity,(function(e){return null}))),this.m_capacity*=2):(this.m_buffer.concat(ee(1,(function(e){return null}))),this.m_capacity=1))}this.m_buffer[this.m_back]=e,this.m_back++}},{key:"Pop",value:function(){this.m_buffer[this.m_front]=null,this.m_front++}},{key:"Empty",value:function(){return this.m_front===this.m_back}},{key:"Front",value:function(){var e=this.m_buffer[this.m_front];if(!e)throw new Error;return e}}]),e}(),Rr=function(){function e(t){o(this,e),this.m_generatorCapacity=0,this.m_generatorCount=0,this.m_countX=0,this.m_countY=0,this.m_diagram=[],this.m_generatorBuffer=ee(t,(function(t){return new e.Generator})),this.m_generatorCapacity=t}return l(e,[{key:"AddGenerator",value:function(e,t,i){var n=this.m_generatorBuffer[this.m_generatorCount++];n.center.Copy(e),n.tag=t,n.necessary=i}},{key:"Generate",value:function(t,i){for(var n=1/t,r=new ke(+h,+h),s=new ke(-h,-h),a=0,o=0;o<this.m_generatorCount;o++){var l=this.m_generatorBuffer[o];l.necessary&&(ke.MinV(r,l.center,r),ke.MaxV(s,l.center,s),++a)}if(0===a)return this.m_countX=0,void(this.m_countY=0);r.x-=i,r.y-=i,s.x+=i,s.y+=i,this.m_countX=1+Math.floor(n*(s.x-r.x)),this.m_countY=1+Math.floor(n*(s.y-r.y)),this.m_diagram=[];for(var u=new Ir(4*this.m_countX*this.m_countY),c=0;c<this.m_generatorCount;c++){var f=this.m_generatorBuffer[c];f.center.SelfSub(r).SelfMul(n);var d=Math.floor(f.center.x),m=Math.floor(f.center.y);d>=0&&m>=0&&d<this.m_countX&&m<this.m_countY&&u.Push(new e.Task(d,m,d+m*this.m_countX,f))}for(;!u.Empty();){var _=u.Front(),p=_.m_x,v=_.m_y,y=_.m_i,g=_.m_generator;u.Pop(),this.m_diagram[y]||(this.m_diagram[y]=g,p>0&&u.Push(new e.Task(p-1,v,y-1,g)),v>0&&u.Push(new e.Task(p,v-1,y-this.m_countX,g)),p<this.m_countX-1&&u.Push(new e.Task(p+1,v,y+1,g)),v<this.m_countY-1&&u.Push(new e.Task(p,v+1,y+this.m_countX,g)))}for(var x=0;x<this.m_countY;x++)for(var b=0;b<this.m_countX-1;b++){var w=b+x*this.m_countX,A=this.m_diagram[w],S=this.m_diagram[w+1];A!==S&&(u.Push(new e.Task(b,x,w,S)),u.Push(new e.Task(b+1,x,w+1,A)))}for(var M=0;M<this.m_countY-1;M++)for(var C=0;C<this.m_countX;C++){var k=C+M*this.m_countX,B=this.m_diagram[k],V=this.m_diagram[k+this.m_countX];B!==V&&(u.Push(new e.Task(C,M,k,V)),u.Push(new e.Task(C,M+1,k+this.m_countX,B)))}for(;!u.Empty();){var T=u.Front(),P=T.m_x,L=T.m_y,E=T.m_i,I=T.m_generator;u.Pop();var R=this.m_diagram[E],F=I;if(R!==F){var G=R.center.x-P,D=R.center.y-L,O=F.center.x-P,N=F.center.y-L;G*G+D*D>O*O+N*N&&(this.m_diagram[E]=F,P>0&&u.Push(new e.Task(P-1,L,E-1,F)),L>0&&u.Push(new e.Task(P,L-1,E-this.m_countX,F)),P<this.m_countX-1&&u.Push(new e.Task(P+1,L,E+1,F)),L<this.m_countY-1&&u.Push(new e.Task(P,L+1,E+this.m_countX,F)))}}}},{key:"GetNodes",value:function(e){for(var t=0;t<this.m_countY-1;t++)for(var i=0;i<this.m_countX-1;i++){var n=i+t*this.m_countX,r=this.m_diagram[n],s=this.m_diagram[n+1],a=this.m_diagram[n+this.m_countX],o=this.m_diagram[n+1+this.m_countX];s!==a&&(r!==s&&r!==a&&(r.necessary||s.necessary||a.necessary)&&e(r.tag,s.tag,a.tag),o!==s&&o!==a&&(r.necessary||s.necessary||a.necessary)&&e(s.tag,o.tag,a.tag))}}}]),e}();function Fr(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function Gr(e,t){return e<t}function Dr(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-t,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gr,r=t,s=[],a=0;;){for(;r+1<i;i++){var o=e[r+Math.floor(Math.random()*(i-r))];s[a++]=i;for(var l=r-1;;){for(;n(e[++l],o););for(;n(o,e[--i]););if(l>=i)break;Fr(e,l,i)}}if(0===a)break;r=i,i=s[--a]}return e}function Or(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Dr(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gr)}function Nr(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n=0,r=0;r<i;++r)t(e[r])||(r!==n?Fr(e,n++,r):++n);return n}function zr(e,t,i,n){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gr,s=i-t;s>0;){var a=Math.floor(s/2),o=t+a;r(e[o],n)?(t=++o,s-=a+1):s=a}return t}function Ur(e,t,i,n){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gr,s=i-t;s>0;){var a=Math.floor(s/2),o=t+a;r(n,e[o])?s=a:(t=++o,s-=a+1)}return t}function jr(e,t,i,n){for(var r=i;t!==r;)Fr(e,t++,r++),r===n?r=i:t===i&&(i=r)}function Wr(e,t,i,n){if(t===i)return i;for(var r=t;++t!==i;)n(e[r],e[t])||Fr(e,++r,t);return++r}!function(e){var t=l((function e(){o(this,e),this.center=new ke,this.tag=0,this.necessary=!1}));e.Generator=t;var i=l((function e(t,i,n,r){o(this,e),this.m_x=t,this.m_y=i,this.m_i=n,this.m_generator=r}));e.Task=i}(Rr||(Rr={}));var qr=function(){function e(t){o(this,e),this.data=[],this.count=0,this.capacity=0,this.allocator=t}return l(e,[{key:"Append",value:function(){return this.count>=this.capacity&&this.Grow(),this.count++}},{key:"Reserve",value:function(e){if(!(this.capacity>=e)){for(var t=this.capacity;t<e;++t)this.data[t]=this.allocator();this.capacity=e}}},{key:"Grow",value:function(){var e=this.capacity?2*this.capacity:N;this.Reserve(e)}},{key:"Free",value:function(){0!==this.data.length&&(this.data=[],this.capacity=0,this.count=0)}},{key:"Shorten",value:function(e){}},{key:"Data",value:function(){return this.data}},{key:"GetCount",value:function(){return this.count}},{key:"SetCount",value:function(e){this.count=e}},{key:"GetCapacity",value:function(){return this.capacity}},{key:"RemoveIf",value:function(e){this.count=Nr(this.data,e,this.count)}},{key:"Unique",value:function(e){this.count=Wr(this.data,0,this.count,e)}}]),e}(),Hr=function(e){s(i,e);var t=a(i);function i(e){var n;return o(this,i),(n=t.call(this)).m_system=e,n}return l(i,[{key:"ShouldQueryParticleSystem",value:function(e){return!1}},{key:"ReportFixture",value:function(e){if(e.IsSensor())return!0;for(var t=e.GetShape().GetChildCount(),i=0;i<t;i++)for(var n=e.GetAABB(i),r=this.m_system.GetInsideBoundsEnumerator(n),s=void 0;(s=r.GetNext())>=0;)this.ReportFixtureAndParticle(e,i,s);return!0}},{key:"ReportParticle",value:function(e,t){return!1}},{key:"ReportFixtureAndParticle",value:function(e,t,i){}}]),i}(cr),Xr=function(){function e(){o(this,e),this.indexA=0,this.indexB=0,this.weight=0,this.normal=new ke,this.flags=0}return l(e,[{key:"SetIndices",value:function(e,t){this.indexA=e,this.indexB=t}},{key:"SetWeight",value:function(e){this.weight=e}},{key:"SetNormal",value:function(e){this.normal.Copy(e)}},{key:"SetFlags",value:function(e){this.flags=e}},{key:"GetIndexA",value:function(){return this.indexA}},{key:"GetIndexB",value:function(){return this.indexB}},{key:"GetWeight",value:function(){return this.weight}},{key:"GetNormal",value:function(){return this.normal}},{key:"GetFlags",value:function(){return this.flags}},{key:"IsEqual",value:function(e){return this.indexA===e.indexA&&this.indexB===e.indexB&&this.flags===e.flags&&this.weight===e.weight&&this.normal.x===e.normal.x&&this.normal.y===e.normal.y}},{key:"IsNotEqual",value:function(e){return!this.IsEqual(e)}},{key:"ApproximatelyEqual",value:function(e){var t=.01,i=1e-4;return this.indexA===e.indexA&&this.indexB===e.indexB&&this.flags===e.flags&&ae(this.weight-e.weight)<t&&ke.DistanceSquaredVV(this.normal,e.normal)<i}}]),e}(),Jr=l((function e(){o(this,e),this.index=0,this.weight=0,this.normal=new ke,this.mass=0})),Yr=l((function e(){o(this,e),this.indexA=0,this.indexB=0,this.flags=0,this.strength=0,this.distance=0})),Zr=l((function e(){o(this,e),this.indexA=0,this.indexB=0,this.indexC=0,this.flags=0,this.strength=0,this.pa=new ke(0,0),this.pb=new ke(0,0),this.pc=new ke(0,0),this.ka=0,this.kb=0,this.kc=0,this.s=0})),Qr=function(){function e(){o(this,e),this.strictContactCheck=!1,this.density=1,this.gravityScale=1,this.radius=1,this.maxCount=0,this.pressureStrength=.005,this.dampingStrength=1,this.elasticStrength=.25,this.springStrength=.25,this.viscousStrength=.25,this.surfaceTensionPressureStrength=.2,this.surfaceTensionNormalStrength=.2,this.repulsiveStrength=1,this.powderStrength=.5,this.ejectionStrength=.5,this.staticPressureStrength=.2,this.staticPressureRelaxation=.2,this.staticPressureIterations=8,this.colorMixingStrength=.5,this.destroyByAge=!0,this.lifetimeGranularity=1/60}return l(e,[{key:"Copy",value:function(e){return this.strictContactCheck=e.strictContactCheck,this.density=e.density,this.gravityScale=e.gravityScale,this.radius=e.radius,this.maxCount=e.maxCount,this.pressureStrength=e.pressureStrength,this.dampingStrength=e.dampingStrength,this.elasticStrength=e.elasticStrength,this.springStrength=e.springStrength,this.viscousStrength=e.viscousStrength,this.surfaceTensionPressureStrength=e.surfaceTensionPressureStrength,this.surfaceTensionNormalStrength=e.surfaceTensionNormalStrength,this.repulsiveStrength=e.repulsiveStrength,this.powderStrength=e.powderStrength,this.ejectionStrength=e.ejectionStrength,this.staticPressureStrength=e.staticPressureStrength,this.staticPressureRelaxation=e.staticPressureRelaxation,this.staticPressureIterations=e.staticPressureIterations,this.colorMixingStrength=e.colorMixingStrength,this.destroyByAge=e.destroyByAge,this.lifetimeGranularity=e.lifetimeGranularity,this}},{key:"Clone",value:function(){return(new e).Copy(this)}}]),e}(),Kr=function(){function t(e,i){o(this,t),this.m_paused=!1,this.m_timestamp=0,this.m_allParticleFlags=0,this.m_needsUpdateAllParticleFlags=!1,this.m_allGroupFlags=0,this.m_needsUpdateAllGroupFlags=!1,this.m_hasForce=!1,this.m_iterationIndex=0,this.m_inverseDensity=0,this.m_particleDiameter=0,this.m_inverseDiameter=0,this.m_squaredDiameter=0,this.m_count=0,this.m_internalAllocatedCapacity=0,this.m_handleIndexBuffer=new t.UserOverridableBuffer,this.m_flagsBuffer=new t.UserOverridableBuffer,this.m_positionBuffer=new t.UserOverridableBuffer,this.m_velocityBuffer=new t.UserOverridableBuffer,this.m_forceBuffer=[],this.m_weightBuffer=[],this.m_staticPressureBuffer=[],this.m_accumulationBuffer=[],this.m_accumulation2Buffer=[],this.m_depthBuffer=[],this.m_colorBuffer=new t.UserOverridableBuffer,this.m_groupBuffer=[],this.m_userDataBuffer=new t.UserOverridableBuffer,this.m_stuckThreshold=0,this.m_lastBodyContactStepBuffer=new t.UserOverridableBuffer,this.m_bodyContactCountBuffer=new t.UserOverridableBuffer,this.m_consecutiveContactStepsBuffer=new t.UserOverridableBuffer,this.m_stuckParticleBuffer=new qr((function(){return 0})),this.m_proxyBuffer=new qr((function(){return new t.Proxy})),this.m_contactBuffer=new qr((function(){return new Xr})),this.m_bodyContactBuffer=new qr((function(){return new Jr})),this.m_pairBuffer=new qr((function(){return new Yr})),this.m_triadBuffer=new qr((function(){return new Zr})),this.m_expirationTimeBuffer=new t.UserOverridableBuffer,this.m_indexByExpirationTimeBuffer=new t.UserOverridableBuffer,this.m_timeElapsed=0,this.m_expirationTimeBufferRequiresSorting=!1,this.m_groupCount=0,this.m_groupList=null,this.m_def=new Qr,this.m_prev=null,this.m_next=null,this.SetStrictContactCheck(e.strictContactCheck),this.SetDensity(e.density),this.SetGravityScale(e.gravityScale),this.SetRadius(e.radius),this.SetMaxParticleCount(e.maxCount),this.m_def=e.Clone(),this.m_world=i,this.SetDestructionByAge(this.m_def.destroyByAge)}return l(t,[{key:"Drop",value:function(){for(;this.m_groupList;)this.DestroyParticleGroup(this.m_groupList);this.FreeUserOverridableBuffer(this.m_handleIndexBuffer),this.FreeUserOverridableBuffer(this.m_flagsBuffer),this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer),this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer),this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer),this.FreeUserOverridableBuffer(this.m_positionBuffer),this.FreeUserOverridableBuffer(this.m_velocityBuffer),this.FreeUserOverridableBuffer(this.m_colorBuffer),this.FreeUserOverridableBuffer(this.m_userDataBuffer),this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer),this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer),this.FreeBuffer(this.m_forceBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_weightBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_staticPressureBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_accumulationBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_accumulation2Buffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_depthBuffer,this.m_internalAllocatedCapacity),this.FreeBuffer(this.m_groupBuffer,this.m_internalAllocatedCapacity)}},{key:"CreateParticle",value:function(e){if(this.m_world.IsLocked())throw new Error;if(this.m_count>=this.m_internalAllocatedCapacity){var t=this.m_count?2*this.m_count:N;this.ReallocateInternalAllocatedBuffers(t)}if(this.m_count>=this.m_internalAllocatedCapacity){if(!this.m_def.destroyByAge)return L;this.DestroyOldestParticle(0,!1),this.SolveZombie()}var n=this.m_count++;if(!this.m_flagsBuffer.data)throw new Error;if(this.m_flagsBuffer.data[n]=0,this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[n]=0),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[n]=0),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[n]=0),!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;this.m_positionBuffer.data[n]=(this.m_positionBuffer.data[n]||new ke).Copy(i(e.position,ke.ZERO)),this.m_velocityBuffer.data[n]=(this.m_velocityBuffer.data[n]||new ke).Copy(i(e.velocity,ke.ZERO)),this.m_weightBuffer[n]=0,this.m_forceBuffer[n]=(this.m_forceBuffer[n]||new ke).SetZero(),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[n]=0),this.m_depthBuffer&&(this.m_depthBuffer[n]=0);var r=(new Fe).Copy(i(e.color,Fe.ZERO));!this.m_colorBuffer.data&&r.IsZero()||(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data[n]=(this.m_colorBuffer.data[n]||new Fe).Copy(r)),(this.m_userDataBuffer.data||e.userData)&&(this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data[n]=e.userData),this.m_handleIndexBuffer.data&&(this.m_handleIndexBuffer.data[n]=null);var s=this.m_proxyBuffer.data[this.m_proxyBuffer.Append()],a=i(e.lifetime,0),o=a>0;if(this.m_expirationTimeBuffer.data||o){if(this.SetParticleLifetime(n,o?a:this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed())),!this.m_indexByExpirationTimeBuffer.data)throw new Error;this.m_indexByExpirationTimeBuffer.data[n]=n}s.index=n;var l=i(e.group,null);return this.m_groupBuffer[n]=l,l&&(l.m_firstIndex<l.m_lastIndex?(this.RotateBuffer(l.m_firstIndex,l.m_lastIndex,n),l.m_lastIndex=n+1):(l.m_firstIndex=n,l.m_lastIndex=n+1)),this.SetParticleFlags(n,i(e.flags,0)),n}},{key:"GetParticleHandleFromIndex",value:function(e){this.m_handleIndexBuffer.data=this.RequestBuffer(this.m_handleIndexBuffer.data);var t=this.m_handleIndexBuffer.data[e];return t||((t=new Pr).SetIndex(e),this.m_handleIndexBuffer.data[e]=t,t)}},{key:"DestroyParticle",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.m_flagsBuffer.data)throw new Error;var n=e.b2ParticleFlag.b2_zombieParticle;i&&(n|=e.b2ParticleFlag.b2_destructionListenerParticle),this.SetParticleFlags(t,this.m_flagsBuffer.data[t]|n)}},{key:"DestroyOldestParticle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.GetParticleCount();if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;if(!this.m_expirationTimeBuffer.data)throw new Error;var n=this.m_indexByExpirationTimeBuffer.data[i-(e+1)],r=this.m_indexByExpirationTimeBuffer.data[e];this.DestroyParticle(this.m_expirationTimeBuffer.data[n]>0?n:r,t)}},{key:"DestroyParticlesInShape",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.DestroyParticlesInShape_s_aabb;if(this.m_world.IsLocked())throw new Error;var s=new t.DestroyParticlesInShapeCallback(this,e,i,n),a=r;return e.ComputeAABB(a,i,0),this.m_world.QueryAABB(s,a),s.Destroyed()}},{key:"CreateParticleGroup",value:function(e){var n=t.CreateParticleGroup_s_transform;if(this.m_world.IsLocked())throw new Error;var r=n;r.SetPositionAngle(i(e.position,ke.ZERO),i(e.angle,0));var s=this.m_count;if(e.shape&&this.CreateParticlesWithShapeForGroup(e.shape,e,r),e.shapes&&this.CreateParticlesWithShapesForGroup(e.shapes,i(e.shapeCount,e.shapes.length),e,r),e.positionData)for(var a=i(e.particleCount,e.positionData.length),o=0;o<a;o++){var l=e.positionData[o];this.CreateParticleForGroup(e,r,l)}var u=this.m_count,h=new Er(this);h.m_firstIndex=s,h.m_lastIndex=u,h.m_strength=i(e.strength,1),h.m_userData=e.userData,h.m_transform.Copy(r),h.m_prev=null,h.m_next=this.m_groupList,this.m_groupList&&(this.m_groupList.m_prev=h),this.m_groupList=h,++this.m_groupCount;for(var c=s;c<u;c++)this.m_groupBuffer[c]=h;this.SetGroupFlags(h,i(e.groupFlags,0));var f=new t.ConnectionFilter;return this.UpdateContacts(!0),this.UpdatePairsAndTriads(s,u,f),e.group&&(this.JoinParticleGroups(e.group,h),h=e.group),h}},{key:"JoinParticleGroups",value:function(e,i){if(this.m_world.IsLocked())throw new Error;this.RotateBuffer(i.m_firstIndex,i.m_lastIndex,this.m_count),this.RotateBuffer(e.m_firstIndex,e.m_lastIndex,i.m_firstIndex);var n=new t.JoinParticleGroupsFilter(i.m_firstIndex);this.UpdateContacts(!0),this.UpdatePairsAndTriads(e.m_firstIndex,i.m_lastIndex,n);for(var r=i.m_firstIndex;r<i.m_lastIndex;r++)this.m_groupBuffer[r]=e;var s=e.m_groupFlags|i.m_groupFlags;this.SetGroupFlags(e,s),e.m_lastIndex=i.m_lastIndex,i.m_firstIndex=i.m_lastIndex,this.DestroyParticleGroup(i)}},{key:"SplitParticleGroup",value:function(e){this.UpdateContacts(!0);var i=ee(e.GetParticleCount(),(function(e){return new t.ParticleListNode}));t.InitializeParticleLists(e,i),this.MergeParticleListsInContact(e,i);var n=t.FindLongestParticleList(e,i);this.MergeZombieParticleListNodes(e,i,n),this.CreateParticleGroupsFromParticleList(e,i,n),this.UpdatePairsAndTriadsWithParticleList(e,i)}},{key:"GetParticleGroupList",value:function(){return this.m_groupList}},{key:"GetParticleGroupCount",value:function(){return this.m_groupCount}},{key:"GetParticleCount",value:function(){return this.m_count}},{key:"GetMaxParticleCount",value:function(){return this.m_def.maxCount}},{key:"SetMaxParticleCount",value:function(e){this.m_def.maxCount=e}},{key:"GetAllParticleFlags",value:function(){return this.m_allParticleFlags}},{key:"GetAllGroupFlags",value:function(){return this.m_allGroupFlags}},{key:"SetPaused",value:function(e){this.m_paused=e}},{key:"GetPaused",value:function(){return this.m_paused}},{key:"SetDensity",value:function(e){this.m_def.density=e,this.m_inverseDensity=1/this.m_def.density}},{key:"GetDensity",value:function(){return this.m_def.density}},{key:"SetGravityScale",value:function(e){this.m_def.gravityScale=e}},{key:"GetGravityScale",value:function(){return this.m_def.gravityScale}},{key:"SetDamping",value:function(e){this.m_def.dampingStrength=e}},{key:"GetDamping",value:function(){return this.m_def.dampingStrength}},{key:"SetStaticPressureIterations",value:function(e){this.m_def.staticPressureIterations=e}},{key:"GetStaticPressureIterations",value:function(){return this.m_def.staticPressureIterations}},{key:"SetRadius",value:function(e){this.m_particleDiameter=2*e,this.m_squaredDiameter=this.m_particleDiameter*this.m_particleDiameter,this.m_inverseDiameter=1/this.m_particleDiameter}},{key:"GetRadius",value:function(){return this.m_particleDiameter/2}},{key:"GetPositionBuffer",value:function(){if(!this.m_positionBuffer.data)throw new Error;return this.m_positionBuffer.data}},{key:"GetVelocityBuffer",value:function(){if(!this.m_velocityBuffer.data)throw new Error;return this.m_velocityBuffer.data}},{key:"GetColorBuffer",value:function(){return this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data}},{key:"GetGroupBuffer",value:function(){return this.m_groupBuffer}},{key:"GetWeightBuffer",value:function(){return this.m_weightBuffer}},{key:"GetUserDataBuffer",value:function(){return this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data}},{key:"GetFlagsBuffer",value:function(){if(!this.m_flagsBuffer.data)throw new Error;return this.m_flagsBuffer.data}},{key:"SetParticleFlags",value:function(t,i){if(!this.m_flagsBuffer.data)throw new Error;this.m_flagsBuffer.data[t]&~i&&(this.m_needsUpdateAllParticleFlags=!0),~this.m_allParticleFlags&i&&(i&e.b2ParticleFlag.b2_tensileParticle&&(this.m_accumulation2Buffer=this.RequestBuffer(this.m_accumulation2Buffer)),i&e.b2ParticleFlag.b2_colorMixingParticle&&(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data)),this.m_allParticleFlags|=i),this.m_flagsBuffer.data[t]=i}},{key:"GetParticleFlags",value:function(e){if(!this.m_flagsBuffer.data)throw new Error;return this.m_flagsBuffer.data[e]}},{key:"SetFlagsBuffer",value:function(e,t){this.SetUserOverridableBuffer(this.m_flagsBuffer,e,t)}},{key:"SetPositionBuffer",value:function(e,t){this.SetUserOverridableBuffer(this.m_positionBuffer,e,t)}},{key:"SetVelocityBuffer",value:function(e,t){this.SetUserOverridableBuffer(this.m_velocityBuffer,e,t)}},{key:"SetColorBuffer",value:function(e,t){this.SetUserOverridableBuffer(this.m_colorBuffer,e,t)}},{key:"SetUserDataBuffer",value:function(e,t){this.SetUserOverridableBuffer(this.m_userDataBuffer,e,t)}},{key:"GetContacts",value:function(){return this.m_contactBuffer.data}},{key:"GetContactCount",value:function(){return this.m_contactBuffer.count}},{key:"GetBodyContacts",value:function(){return this.m_bodyContactBuffer.data}},{key:"GetBodyContactCount",value:function(){return this.m_bodyContactBuffer.count}},{key:"GetPairs",value:function(){return this.m_pairBuffer.data}},{key:"GetPairCount",value:function(){return this.m_pairBuffer.count}},{key:"GetTriads",value:function(){return this.m_triadBuffer.data}},{key:"GetTriadCount",value:function(){return this.m_triadBuffer.count}},{key:"SetStuckThreshold",value:function(e){this.m_stuckThreshold=e,e>0&&(this.m_lastBodyContactStepBuffer.data=this.RequestBuffer(this.m_lastBodyContactStepBuffer.data),this.m_bodyContactCountBuffer.data=this.RequestBuffer(this.m_bodyContactCountBuffer.data),this.m_consecutiveContactStepsBuffer.data=this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data))}},{key:"GetStuckCandidates",value:function(){return this.m_stuckParticleBuffer.Data()}},{key:"GetStuckCandidateCount",value:function(){return this.m_stuckParticleBuffer.GetCount()}},{key:"ComputeCollisionEnergy",value:function(){if(!this.m_velocityBuffer.data)throw new Error;for(var e=t.ComputeCollisionEnergy_s_v,i=this.m_velocityBuffer.data,n=0,r=0;r<this.m_contactBuffer.count;r++){var s=this.m_contactBuffer.data[r],a=s.indexA,o=s.indexB,l=s.normal,u=ke.SubVV(i[o],i[a],e),h=ke.DotVV(u,l);h<0&&(n+=h*h)}return.5*this.GetParticleMass()*n}},{key:"SetStrictContactCheck",value:function(e){this.m_def.strictContactCheck=e}},{key:"GetStrictContactCheck",value:function(){return this.m_def.strictContactCheck}},{key:"SetParticleLifetime",value:function(e,t){var i=null===this.m_indexByExpirationTimeBuffer.data;if(this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),i)for(var n=this.GetParticleCount(),r=0;r<n;++r)this.m_indexByExpirationTimeBuffer.data[r]=r;var s=t/this.m_def.lifetimeGranularity,a=s>0?this.GetQuantizedTimeElapsed()+s:s;a!==this.m_expirationTimeBuffer.data[e]&&(this.m_expirationTimeBuffer.data[e]=a,this.m_expirationTimeBufferRequiresSorting=!0)}},{key:"GetParticleLifetime",value:function(e){return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[e])}},{key:"SetDestructionByAge",value:function(e){e&&this.GetExpirationTimeBuffer(),this.m_def.destroyByAge=e}},{key:"GetDestructionByAge",value:function(){return this.m_def.destroyByAge}},{key:"GetExpirationTimeBuffer",value:function(){return this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data),this.m_expirationTimeBuffer.data}},{key:"ExpirationTimeToLifetime",value:function(e){return(e>0?e-this.GetQuantizedTimeElapsed():e)*this.m_def.lifetimeGranularity}},{key:"GetIndexByExpirationTimeBuffer",value:function(){if(this.GetParticleCount()?this.SetParticleLifetime(0,this.GetParticleLifetime(0)):this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data),!this.m_indexByExpirationTimeBuffer.data)throw new Error;return this.m_indexByExpirationTimeBuffer.data}},{key:"ParticleApplyLinearImpulse",value:function(e,t){this.ApplyLinearImpulse(e,e+1,t)}},{key:"ApplyLinearImpulse",value:function(e,t,i){if(!this.m_velocityBuffer.data)throw new Error;for(var n=this.m_velocityBuffer.data,r=(t-e)*this.GetParticleMass(),s=(new ke).Copy(i).SelfMul(1/r),a=e;a<t;a++)n[a].SelfAdd(s)}},{key:"ParticleApplyForce",value:function(e,i){if(!this.m_flagsBuffer.data)throw new Error;t.IsSignificantForce(i)&&this.ForceCanBeApplied(this.m_flagsBuffer.data[e])&&(this.PrepareForceBuffer(),this.m_forceBuffer[e].SelfAdd(i))}},{key:"ApplyForce",value:function(e,i,n){var r=(new ke).Copy(n).SelfMul(1/(i-e));if(t.IsSignificantForce(r)){this.PrepareForceBuffer();for(var s=e;s<i;s++)this.m_forceBuffer[s].SelfAdd(r)}}},{key:"GetNext",value:function(){return this.m_next}},{key:"QueryAABB",value:function(e,i){if(0!==this.m_proxyBuffer.count){var n=0,r=this.m_proxyBuffer.count,s=zr(this.m_proxyBuffer.data,n,r,t.computeTag(this.m_inverseDiameter*i.lowerBound.x,this.m_inverseDiameter*i.lowerBound.y),t.Proxy.CompareProxyTag),a=Ur(this.m_proxyBuffer.data,s,r,t.computeTag(this.m_inverseDiameter*i.upperBound.x,this.m_inverseDiameter*i.upperBound.y),t.Proxy.CompareTagProxy);if(!this.m_positionBuffer.data)throw new Error;for(var o=this.m_positionBuffer.data,l=s;l<a;++l){var u=this.m_proxyBuffer.data[l].index,h=o[u];if(i.lowerBound.x<h.x&&h.x<i.upperBound.x&&i.lowerBound.y<h.y&&h.y<i.upperBound.y&&!e.ReportParticle(this,u))break}}}},{key:"QueryShapeAABB",value:function(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=t.QueryShapeAABB_s_aabb;i.ComputeAABB(s,n,r),this.QueryAABB(e,s)}},{key:"QueryPointAABB",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,r=t.QueryPointAABB_s_aabb;r.lowerBound.Set(i.x-n,i.y-n),r.upperBound.Set(i.x+n,i.y+n),this.QueryAABB(e,r)}},{key:"RayCast",value:function(e,i,n){var r=t.RayCast_s_aabb,s=t.RayCast_s_p,a=t.RayCast_s_v,o=t.RayCast_s_n,l=t.RayCast_s_point;if(0!==this.m_proxyBuffer.count){if(!this.m_positionBuffer.data)throw new Error;var u=this.m_positionBuffer.data,h=r;ke.MinV(i,n,h.lowerBound),ke.MaxV(i,n,h.upperBound);for(var c,f=1,d=ke.SubVV(n,i,a),m=ke.DotVV(d,d),_=this.GetInsideBoundsEnumerator(h);(c=_.GetNext())>=0;){var p=ke.SubVV(i,u[c],s),v=ke.DotVV(p,d),y=v*v-m*(ke.DotVV(p,p)-this.m_squaredDiameter);if(y>=0){var g=me(y),x=(-v-g)/m;if(x>f)continue;if(x<0&&((x=(-v+g)/m)<0||x>f))continue;var b=ke.AddVMulSV(p,x,d,o);b.Normalize();var w=e.ReportParticle(this,c,ke.AddVMulSV(i,x,d,l),b,x);if((f=oe(f,w))<=0)break}}}}},{key:"ComputeAABB",value:function(e){var t=this.GetParticleCount();if(e.lowerBound.x=+h,e.lowerBound.y=+h,e.upperBound.x=-h,e.upperBound.y=-h,!this.m_positionBuffer.data)throw new Error;for(var i=this.m_positionBuffer.data,n=0;n<t;n++){var r=i[n];ke.MinV(e.lowerBound,r,e.lowerBound),ke.MaxV(e.upperBound,r,e.upperBound)}e.lowerBound.x-=this.m_particleDiameter,e.lowerBound.y-=this.m_particleDiameter,e.upperBound.x+=this.m_particleDiameter,e.upperBound.y+=this.m_particleDiameter}},{key:"FreeBuffer",value:function(e,t){null!==e&&(e.length=0)}},{key:"FreeUserOverridableBuffer",value:function(e){0===e.userSuppliedCapacity&&this.FreeBuffer(e.data,this.m_internalAllocatedCapacity)}},{key:"ReallocateBuffer3",value:function(e,t,i){if(i<=t)throw new Error;var n=e?e.slice():[];return n.length=i,n}},{key:"ReallocateBuffer5",value:function(e,t,i,n,r){if(n<=i)throw new Error;if(t&&!(n<=t))throw new Error;return r&&!e||t||(e=this.ReallocateBuffer3(e,i,n)),e}},{key:"ReallocateBuffer4",value:function(e,t,i,n){return this.ReallocateBuffer5(e.data,e.userSuppliedCapacity,t,i,n)}},{key:"RequestBuffer",value:function(e){return e||(0===this.m_internalAllocatedCapacity&&this.ReallocateInternalAllocatedBuffers(N),(e=[]).length=this.m_internalAllocatedCapacity),e}},{key:"ReallocateHandleBuffers",value:function(e){this.m_handleIndexBuffer.data=this.ReallocateBuffer4(this.m_handleIndexBuffer,this.m_internalAllocatedCapacity,e,!0)}},{key:"ReallocateInternalAllocatedBuffers",value:function(e){function t(e,t){return t&&e>t?t:e}if(e=t(e,this.m_def.maxCount),e=t(e,this.m_flagsBuffer.userSuppliedCapacity),e=t(e,this.m_positionBuffer.userSuppliedCapacity),e=t(e,this.m_velocityBuffer.userSuppliedCapacity),e=t(e,this.m_colorBuffer.userSuppliedCapacity),e=t(e,this.m_userDataBuffer.userSuppliedCapacity),this.m_internalAllocatedCapacity<e){this.ReallocateHandleBuffers(e),this.m_flagsBuffer.data=this.ReallocateBuffer4(this.m_flagsBuffer,this.m_internalAllocatedCapacity,e,!1);var i=this.m_stuckThreshold>0;this.m_lastBodyContactStepBuffer.data=this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer,this.m_internalAllocatedCapacity,e,i),this.m_bodyContactCountBuffer.data=this.ReallocateBuffer4(this.m_bodyContactCountBuffer,this.m_internalAllocatedCapacity,e,i),this.m_consecutiveContactStepsBuffer.data=this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer,this.m_internalAllocatedCapacity,e,i),this.m_positionBuffer.data=this.ReallocateBuffer4(this.m_positionBuffer,this.m_internalAllocatedCapacity,e,!1),this.m_velocityBuffer.data=this.ReallocateBuffer4(this.m_velocityBuffer,this.m_internalAllocatedCapacity,e,!1),this.m_forceBuffer=this.ReallocateBuffer5(this.m_forceBuffer,0,this.m_internalAllocatedCapacity,e,!1),this.m_weightBuffer=this.ReallocateBuffer5(this.m_weightBuffer,0,this.m_internalAllocatedCapacity,e,!1),this.m_staticPressureBuffer=this.ReallocateBuffer5(this.m_staticPressureBuffer,0,this.m_internalAllocatedCapacity,e,!0),this.m_accumulationBuffer=this.ReallocateBuffer5(this.m_accumulationBuffer,0,this.m_internalAllocatedCapacity,e,!1),this.m_accumulation2Buffer=this.ReallocateBuffer5(this.m_accumulation2Buffer,0,this.m_internalAllocatedCapacity,e,!0),this.m_depthBuffer=this.ReallocateBuffer5(this.m_depthBuffer,0,this.m_internalAllocatedCapacity,e,!0),this.m_colorBuffer.data=this.ReallocateBuffer4(this.m_colorBuffer,this.m_internalAllocatedCapacity,e,!0),this.m_groupBuffer=this.ReallocateBuffer5(this.m_groupBuffer,0,this.m_internalAllocatedCapacity,e,!1),this.m_userDataBuffer.data=this.ReallocateBuffer4(this.m_userDataBuffer,this.m_internalAllocatedCapacity,e,!0),this.m_expirationTimeBuffer.data=this.ReallocateBuffer4(this.m_expirationTimeBuffer,this.m_internalAllocatedCapacity,e,!0),this.m_indexByExpirationTimeBuffer.data=this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer,this.m_internalAllocatedCapacity,e,!1),this.m_internalAllocatedCapacity=e}}},{key:"CreateParticleForGroup",value:function(e,t,n){var r=new Br;r.flags=i(e.flags,0),Ee.MulXV(t,n,r.position),ke.AddVV(i(e.linearVelocity,ke.ZERO),ke.CrossSV(i(e.angularVelocity,0),ke.SubVV(r.position,i(e.position,ke.ZERO),ke.s_t0),ke.s_t0),r.velocity),r.color.Copy(i(e.color,Fe.ZERO)),r.lifetime=i(e.lifetime,0),r.userData=e.userData,this.CreateParticle(r)}},{key:"CreateParticlesStrokeShapeForGroup",value:function(n,r,s){var a=t.CreateParticlesStrokeShapeForGroup_s_edge,o=t.CreateParticlesStrokeShapeForGroup_s_d,l=t.CreateParticlesStrokeShapeForGroup_s_p,u=i(r.stride,0);0===u&&(u=this.GetParticleStride());for(var h=0,c=n.GetChildCount(),f=0;f<c;f++){var d=null;n.GetType()===e.b2ShapeType.e_edgeShape?d=n:(d=a,n.GetChildEdge(d,f));for(var m=ke.SubVV(d.m_vertex2,d.m_vertex1,o),_=m.Length();h<_;){var p=ke.AddVMulSV(d.m_vertex1,h/_,m,l);this.CreateParticleForGroup(r,s,p),h+=u}h-=_}}},{key:"CreateParticlesFillShapeForGroup",value:function(e,n,r){var s=t.CreateParticlesFillShapeForGroup_s_aabb,a=t.CreateParticlesFillShapeForGroup_s_p,o=i(n.stride,0);0===o&&(o=this.GetParticleStride());var l=Ee.IDENTITY,u=s;e.ComputeAABB(u,l,0);for(var h=Math.floor(u.lowerBound.y/o)*o;h<u.upperBound.y;h+=o)for(var c=Math.floor(u.lowerBound.x/o)*o;c<u.upperBound.x;c+=o){var f=a.Set(c,h);e.TestPoint(l,f)&&this.CreateParticleForGroup(n,r,f)}}},{key:"CreateParticlesWithShapeForGroup",value:function(t,i,n){switch(t.GetType()){case e.b2ShapeType.e_edgeShape:case e.b2ShapeType.e_chainShape:this.CreateParticlesStrokeShapeForGroup(t,i,n);break;case e.b2ShapeType.e_polygonShape:case e.b2ShapeType.e_circleShape:this.CreateParticlesFillShapeForGroup(t,i,n)}}},{key:"CreateParticlesWithShapesForGroup",value:function(e,i,n,r){var s=new t.CompositeShape(e,i);this.CreateParticlesFillShapeForGroup(s,n,r)}},{key:"CloneParticle",value:function(e,t){var i=new Br;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;i.flags=this.m_flagsBuffer.data[e],i.position.Copy(this.m_positionBuffer.data[e]),i.velocity.Copy(this.m_velocityBuffer.data[e]),this.m_colorBuffer.data&&i.color.Copy(this.m_colorBuffer.data[e]),this.m_userDataBuffer.data&&(i.userData=this.m_userDataBuffer.data[e]),i.group=t;var n=this.CreateParticle(i);if(this.m_handleIndexBuffer.data){var r=this.m_handleIndexBuffer.data[e];r&&r.SetIndex(n),this.m_handleIndexBuffer.data[n]=r,this.m_handleIndexBuffer.data[e]=null}return this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[n]=this.m_lastBodyContactStepBuffer.data[e]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[n]=this.m_bodyContactCountBuffer.data[e]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[n]=this.m_consecutiveContactStepsBuffer.data[e]),this.m_hasForce&&this.m_forceBuffer[n].Copy(this.m_forceBuffer[e]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[n]=this.m_staticPressureBuffer[e]),this.m_depthBuffer&&(this.m_depthBuffer[n]=this.m_depthBuffer[e]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[n]=this.m_expirationTimeBuffer.data[e]),n}},{key:"DestroyParticlesInGroup",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.m_firstIndex;i<e.m_lastIndex;i++)this.DestroyParticle(i,t)}},{key:"DestroyParticleGroup",value:function(e){this.m_world.m_destructionListener&&this.m_world.m_destructionListener.SayGoodbyeParticleGroup(e),this.SetGroupFlags(e,0);for(var t=e.m_firstIndex;t<e.m_lastIndex;t++)this.m_groupBuffer[t]=null;e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_groupList&&(this.m_groupList=e.m_next),--this.m_groupCount}},{key:"UpdatePairsAndTriads",value:function(i,n,r){var s=t.UpdatePairsAndTriads_s_dab,a=t.UpdatePairsAndTriads_s_dbc,o=t.UpdatePairsAndTriads_s_dca;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var l=this.m_positionBuffer.data,u=0,h=i;h<n;h++)u|=this.m_flagsBuffer.data[h];if(u&t.k_pairFlags)for(var c=0;c<this.m_contactBuffer.count;c++){var f=this.m_contactBuffer.data[c],d=f.indexA,m=f.indexB,_=this.m_flagsBuffer.data[d],p=this.m_flagsBuffer.data[m],v=this.m_groupBuffer[d],y=this.m_groupBuffer[m];if(d>=i&&d<n&&m>=i&&m<n&&!((_|p)&e.b2ParticleFlag.b2_zombieParticle)&&(_|p)&t.k_pairFlags&&(r.IsNecessary(d)||r.IsNecessary(m))&&t.ParticleCanBeConnected(_,v)&&t.ParticleCanBeConnected(p,y)&&r.ShouldCreatePair(d,m)){var g=this.m_pairBuffer.data[this.m_pairBuffer.Append()];g.indexA=d,g.indexB=m,g.flags=f.flags,g.strength=oe(v?v.m_strength:1,y?y.m_strength:1),g.distance=ke.DistanceVV(l[d],l[m])}Or(this.m_pairBuffer.data,0,this.m_pairBuffer.count,t.ComparePairIndices),this.m_pairBuffer.Unique(t.MatchPairIndices)}if(u&t.k_triadFlags){for(var x=new Rr(n-i),b=i;b<n;b++){var w=this.m_flagsBuffer.data[b],A=this.m_groupBuffer[b];w&e.b2ParticleFlag.b2_zombieParticle||!t.ParticleCanBeConnected(w,A)||x.AddGenerator(l[b],b,r.IsNecessary(b))}var S=this.GetParticleStride();x.Generate(S/2,2*S);var M=this,C=function(e,i,n){if(!M.m_flagsBuffer.data)throw new Error;var u=M.m_flagsBuffer.data[e],h=M.m_flagsBuffer.data[i],c=M.m_flagsBuffer.data[n];if((u|h|c)&t.k_triadFlags&&r.ShouldCreateTriad(e,i,n)){var f=l[e],d=l[i],m=l[n],_=ke.SubVV(f,d,s),p=ke.SubVV(d,m,a),v=ke.SubVV(m,f,o),y=O*M.m_squaredDiameter;if(ke.DotVV(_,_)>y||ke.DotVV(p,p)>y||ke.DotVV(v,v)>y)return;var g=M.m_groupBuffer[e],x=M.m_groupBuffer[i],b=M.m_groupBuffer[n],w=M.m_triadBuffer.data[M.m_triadBuffer.Append()];w.indexA=e,w.indexB=i,w.indexC=n,w.flags=u|h|c,w.strength=oe(oe(g?g.m_strength:1,x?x.m_strength:1),b?b.m_strength:1);var A=(f.x+d.x+m.x)/3,S=(f.y+d.y+m.y)/3;w.pa.x=f.x-A,w.pa.y=f.y-S,w.pb.x=d.x-A,w.pb.y=d.y-S,w.pc.x=m.x-A,w.pc.y=m.y-S,w.ka=-ke.DotVV(v,_),w.kb=-ke.DotVV(_,p),w.kc=-ke.DotVV(p,v),w.s=ke.CrossVV(f,d)+ke.CrossVV(d,m)+ke.CrossVV(m,f)}};x.GetNodes(C),Or(this.m_triadBuffer.data,0,this.m_triadBuffer.count,t.CompareTriadIndices),this.m_triadBuffer.Unique(t.MatchTriadIndices)}}},{key:"UpdatePairsAndTriadsWithReactiveParticles",value:function(){var i=new t.ReactiveFilter(this.m_flagsBuffer);if(this.UpdatePairsAndTriads(0,this.m_count,i),!this.m_flagsBuffer.data)throw new Error;for(var n=0;n<this.m_count;n++)this.m_flagsBuffer.data[n]&=~e.b2ParticleFlag.b2_reactiveParticle;this.m_allParticleFlags&=~e.b2ParticleFlag.b2_reactiveParticle}},{key:"MergeParticleListsInContact",value:function(e,i){for(var n=e.GetBufferIndex(),r=0;r<this.m_contactBuffer.count;r++){var s=this.m_contactBuffer.data[r],a=s.indexA,o=s.indexB;if(e.ContainsParticle(a)&&e.ContainsParticle(o)){var l=i[a-n].list,u=i[o-n].list;if(l!==u){if(l.count<u.count){var h=l;l=u,u=h}t.MergeParticleLists(l,u)}}}}},{key:"MergeZombieParticleListNodes",value:function(i,n,r){if(!this.m_flagsBuffer.data)throw new Error;for(var s=i.GetParticleCount(),a=0;a<s;a++){var o=n[a];o!==r&&this.m_flagsBuffer.data[o.index]&e.b2ParticleFlag.b2_zombieParticle&&t.MergeParticleListAndNode(r,o)}}},{key:"CreateParticleGroupsFromParticleList",value:function(t,i,n){if(!this.m_flagsBuffer.data)throw new Error;var r=t.GetParticleCount(),s=new Lr;s.groupFlags=t.GetGroupFlags(),s.userData=t.GetUserData();for(var a=0;a<r;a++){var o=i[a];if(o.count&&o!==n)for(var l=this.CreateParticleGroup(s),u=o;u;u=u.next){var h=u.index,c=this.CloneParticle(h,l);this.m_flagsBuffer.data[h]|=e.b2ParticleFlag.b2_zombieParticle,u.index=c}}}},{key:"UpdatePairsAndTriadsWithParticleList",value:function(e,t){for(var i=e.GetBufferIndex(),n=0;n<this.m_pairBuffer.count;n++){var r=this.m_pairBuffer.data[n],s=r.indexA,a=r.indexB;e.ContainsParticle(s)&&(r.indexA=t[s-i].index),e.ContainsParticle(a)&&(r.indexB=t[a-i].index)}for(var o=0;o<this.m_triadBuffer.count;o++){var l=this.m_triadBuffer.data[o],u=l.indexA,h=l.indexB,c=l.indexC;e.ContainsParticle(u)&&(l.indexA=t[u-i].index),e.ContainsParticle(h)&&(l.indexB=t[h-i].index),e.ContainsParticle(c)&&(l.indexC=t[c-i].index)}}},{key:"ComputeDepth",value:function(){for(var t=[],i=0,n=0;n<this.m_contactBuffer.count;n++){var r=this.m_contactBuffer.data[n],s=r.indexA,a=r.indexB,o=this.m_groupBuffer[s],l=this.m_groupBuffer[a];o&&o===l&&o.m_groupFlags&e.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&(t[i++]=r)}for(var u=[],c=0,f=this.m_groupList;f;f=f.GetNext())if(f.m_groupFlags&e.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth){u[c++]=f,this.SetGroupFlags(f,f.m_groupFlags&~e.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);for(var d=f.m_firstIndex;d<f.m_lastIndex;d++)this.m_accumulationBuffer[d]=0}for(var m=0;m<i;m++){var _=t[m],p=_.indexA,v=_.indexB,y=_.weight;this.m_accumulationBuffer[p]+=y,this.m_accumulationBuffer[v]+=y}for(var g=0;g<c;g++)for(var x=u[g],b=x.m_firstIndex;b<x.m_lastIndex;b++){var w=this.m_accumulationBuffer[b];this.m_depthBuffer[b]=w<.8?0:h}for(var A=me(this.m_count)>>0,S=0;S<A;S++){for(var M=!1,C=0;C<i;C++){var k=t[C],B=k.indexA,V=k.indexB,T=1-k.weight,P=this.m_depthBuffer[B],L=this.m_depthBuffer[V],E=L+T,I=P+T;P>E&&(this.m_depthBuffer[B]=E,M=!0),L>I&&(this.m_depthBuffer[V]=I,M=!0)}if(!M)break}for(var R=0;R<c;R++)for(var F=u[R],G=F.m_firstIndex;G<F.m_lastIndex;G++)this.m_depthBuffer[G]<h?this.m_depthBuffer[G]*=this.m_particleDiameter:this.m_depthBuffer[G]=0}},{key:"GetInsideBoundsEnumerator",value:function(e){var i=t.computeTag(this.m_inverseDiameter*e.lowerBound.x-1,this.m_inverseDiameter*e.lowerBound.y-1),n=t.computeTag(this.m_inverseDiameter*e.upperBound.x+1,this.m_inverseDiameter*e.upperBound.y+1),r=0,s=this.m_proxyBuffer.count,a=zr(this.m_proxyBuffer.data,r,s,i,t.Proxy.CompareProxyTag),o=Ur(this.m_proxyBuffer.data,r,s,n,t.Proxy.CompareTagProxy);return new t.InsideBoundsEnumerator(this,i,n,a,o)}},{key:"UpdateAllParticleFlags",value:function(){if(!this.m_flagsBuffer.data)throw new Error;this.m_allParticleFlags=0;for(var e=0;e<this.m_count;e++)this.m_allParticleFlags|=this.m_flagsBuffer.data[e];this.m_needsUpdateAllParticleFlags=!1}},{key:"UpdateAllGroupFlags",value:function(){this.m_allGroupFlags=0;for(var e=this.m_groupList;e;e=e.GetNext())this.m_allGroupFlags|=e.m_groupFlags;this.m_needsUpdateAllGroupFlags=!1}},{key:"AddContact",value:function(e,i,n){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;var r=t.AddContact_s_d,s=this.m_positionBuffer.data,a=ke.SubVV(s[i],s[e],r),o=ke.DotVV(a,a);if(o<this.m_squaredDiameter){var l=de(o);isFinite(l)||(l=198177537e11);var u=this.m_contactBuffer.data[this.m_contactBuffer.Append()];u.indexA=e,u.indexB=i,u.flags=this.m_flagsBuffer.data[e]|this.m_flagsBuffer.data[i],u.weight=1-o*l*this.m_inverseDiameter,ke.MulSV(l,a,u.normal)}}},{key:"FindContacts_Reference",value:function(e){var i=0,n=this.m_proxyBuffer.count;this.m_contactBuffer.count=0;for(var r=i,s=i;r<n;r++){for(var a=t.computeRelativeTag(this.m_proxyBuffer.data[r].tag,1,0),o=r+1;o<n&&!(a<this.m_proxyBuffer.data[o].tag);o++)this.AddContact(this.m_proxyBuffer.data[r].index,this.m_proxyBuffer.data[o].index,this.m_contactBuffer);for(var l=t.computeRelativeTag(this.m_proxyBuffer.data[r].tag,-1,1);s<n&&!(l<=this.m_proxyBuffer.data[s].tag);s++);for(var u=t.computeRelativeTag(this.m_proxyBuffer.data[r].tag,1,1),h=s;h<n&&!(u<this.m_proxyBuffer.data[h].tag);h++)this.AddContact(this.m_proxyBuffer.data[r].index,this.m_proxyBuffer.data[h].index,this.m_contactBuffer)}}},{key:"FindContacts",value:function(e){this.FindContacts_Reference(e)}},{key:"UpdateProxies_Reference",value:function(e){if(!this.m_positionBuffer.data)throw new Error;for(var i=this.m_positionBuffer.data,n=this.m_inverseDiameter,r=0;r<this.m_proxyBuffer.count;++r){var s=this.m_proxyBuffer.data[r],a=i[s.index];s.tag=t.computeTag(n*a.x,n*a.y)}}},{key:"UpdateProxies",value:function(e){this.UpdateProxies_Reference(e)}},{key:"SortProxies",value:function(e){Dr(this.m_proxyBuffer.data,0,this.m_proxyBuffer.count,t.Proxy.CompareProxyProxy)}},{key:"FilterContacts",value:function(t){var i=this.GetParticleContactFilter();if(null!==i){var n=this,r=function(t){return 0!==(t.flags&e.b2ParticleFlag.b2_particleContactFilterParticle)&&!i.ShouldCollideParticleParticle(n,t.indexA,t.indexB)};this.m_contactBuffer.RemoveIf(r)}}},{key:"NotifyContactListenerPreContact",value:function(e){if(null!==this.GetParticleContactListener())throw e.Initialize(this.m_contactBuffer,this.m_flagsBuffer),new Error}},{key:"NotifyContactListenerPostContact",value:function(e){var t=this.GetParticleContactListener();if(null!==t){for(var i=0;i<this.m_contactBuffer.count;++i){var n=this.m_contactBuffer.data[i];t.BeginContactParticleParticle(this,n)}throw new Error}}},{key:"UpdateContacts",value:function(e){this.UpdateProxies(this.m_proxyBuffer),this.SortProxies(this.m_proxyBuffer);var i=new t.b2ParticlePairSet;this.NotifyContactListenerPreContact(i),this.FindContacts(this.m_contactBuffer),this.FilterContacts(this.m_contactBuffer),this.NotifyContactListenerPostContact(i),e&&this.m_contactBuffer.RemoveIf(t.b2ParticleContactIsZombie)}},{key:"NotifyBodyContactListenerPreContact",value:function(e){if(null!==this.GetFixtureContactListener())throw e.Initialize(this.m_bodyContactBuffer,this.m_flagsBuffer),new Error}},{key:"NotifyBodyContactListenerPostContact",value:function(e){var t=this.GetFixtureContactListener();if(null!==t){for(var i=0;i<this.m_bodyContactBuffer.count;i++){var n=this.m_bodyContactBuffer.data[i];t.BeginContactFixtureParticle(this,n)}throw new Error}}},{key:"UpdateBodyContacts",value:function(){var e=t.UpdateBodyContacts_s_aabb,i=new t.FixtureParticleSet;if(this.NotifyBodyContactListenerPreContact(i),this.m_stuckThreshold>0){if(!this.m_bodyContactCountBuffer.data)throw new Error;if(!this.m_lastBodyContactStepBuffer.data)throw new Error;if(!this.m_consecutiveContactStepsBuffer.data)throw new Error;for(var n=this.GetParticleCount(),r=0;r<n;r++)this.m_bodyContactCountBuffer.data[r]=0,this.m_timestamp>this.m_lastBodyContactStepBuffer.data[r]+1&&(this.m_consecutiveContactStepsBuffer.data[r]=0)}this.m_bodyContactBuffer.SetCount(0),this.m_stuckParticleBuffer.SetCount(0);var s=e;this.ComputeAABB(s);var a=new t.UpdateBodyContactsCallback(this,this.GetFixtureContactFilter());this.m_world.QueryAABB(a,s),this.m_def.strictContactCheck&&this.RemoveSpuriousBodyContacts(),this.NotifyBodyContactListenerPostContact(i)}},{key:"Solve",value:function(i){var n=t.Solve_s_subStep;if(0!==this.m_count&&(this.m_expirationTimeBuffer.data&&this.SolveLifetimes(i),this.m_allParticleFlags&e.b2ParticleFlag.b2_zombieParticle&&this.SolveZombie(),this.m_needsUpdateAllParticleFlags&&this.UpdateAllParticleFlags(),this.m_needsUpdateAllGroupFlags&&this.UpdateAllGroupFlags(),!this.m_paused))for(this.m_iterationIndex=0;this.m_iterationIndex<i.particleIterations;this.m_iterationIndex++){++this.m_timestamp;var r=n.Copy(i);if(r.dt/=i.particleIterations,r.inv_dt*=i.particleIterations,this.UpdateContacts(!1),this.UpdateBodyContacts(),this.ComputeWeight(),this.m_allGroupFlags&e.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&this.ComputeDepth(),this.m_allParticleFlags&e.b2ParticleFlag.b2_reactiveParticle&&this.UpdatePairsAndTriadsWithReactiveParticles(),this.m_hasForce&&this.SolveForce(r),this.m_allParticleFlags&e.b2ParticleFlag.b2_viscousParticle&&this.SolveViscous(),this.m_allParticleFlags&e.b2ParticleFlag.b2_repulsiveParticle&&this.SolveRepulsive(r),this.m_allParticleFlags&e.b2ParticleFlag.b2_powderParticle&&this.SolvePowder(r),this.m_allParticleFlags&e.b2ParticleFlag.b2_tensileParticle&&this.SolveTensile(r),this.m_allGroupFlags&e.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SolveSolid(r),this.m_allParticleFlags&e.b2ParticleFlag.b2_colorMixingParticle&&this.SolveColorMixing(),this.SolveGravity(r),this.m_allParticleFlags&e.b2ParticleFlag.b2_staticPressureParticle&&this.SolveStaticPressure(r),this.SolvePressure(r),this.SolveDamping(r),this.m_allParticleFlags&t.k_extraDampingFlags&&this.SolveExtraDamping(),this.m_allParticleFlags&e.b2ParticleFlag.b2_elasticParticle&&this.SolveElastic(r),this.m_allParticleFlags&e.b2ParticleFlag.b2_springParticle&&this.SolveSpring(r),this.LimitVelocity(r),this.m_allGroupFlags&e.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigidDamping(),this.m_allParticleFlags&e.b2ParticleFlag.b2_barrierParticle&&this.SolveBarrier(r),this.SolveCollision(r),this.m_allGroupFlags&e.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigid(r),this.m_allParticleFlags&e.b2ParticleFlag.b2_wallParticle&&this.SolveWall(),!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var s=0;s<this.m_count;s++)this.m_positionBuffer.data[s].SelfMulAdd(r.dt,this.m_velocityBuffer.data[s])}}},{key:"SolveCollision",value:function(e){var i=t.SolveCollision_s_aabb;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;var n=this.m_positionBuffer.data,r=this.m_velocityBuffer.data,s=i;s.lowerBound.x=+h,s.lowerBound.y=+h,s.upperBound.x=-h,s.upperBound.y=-h;for(var a=0;a<this.m_count;a++){var o=r[a],l=n[a],u=l.x+e.dt*o.x,c=l.y+e.dt*o.y;s.lowerBound.x=oe(s.lowerBound.x,oe(l.x,u)),s.lowerBound.y=oe(s.lowerBound.y,oe(l.y,c)),s.upperBound.x=le(s.upperBound.x,le(l.x,u)),s.upperBound.y=le(s.upperBound.y,le(l.y,c))}var f=new t.SolveCollisionCallback(this,e);this.m_world.QueryAABB(f,s)}},{key:"LimitVelocity",value:function(e){if(!this.m_velocityBuffer.data)throw new Error;for(var t=this.m_velocityBuffer.data,i=this.GetCriticalVelocitySquared(e),n=0;n<this.m_count;n++){var r=t[n],s=ke.DotVV(r,r);s>i&&r.SelfMul(me(i/s))}}},{key:"SolveGravity",value:function(e){if(!this.m_velocityBuffer.data)throw new Error;for(var i=t.SolveGravity_s_gravity,n=this.m_velocityBuffer.data,r=ke.MulSV(e.dt*this.m_def.gravityScale,this.m_world.GetGravity(),i),s=0;s<this.m_count;s++)n[s].SelfAdd(r)}},{key:"SolveBarrier",value:function(i){var n=t.SolveBarrier_s_aabb,r=t.SolveBarrier_s_va,s=t.SolveBarrier_s_vb,a=t.SolveBarrier_s_pba,o=t.SolveBarrier_s_vba,l=t.SolveBarrier_s_vc,u=t.SolveBarrier_s_pca,h=t.SolveBarrier_s_vca,c=t.SolveBarrier_s_qba,f=t.SolveBarrier_s_qca,d=t.SolveBarrier_s_dv,m=t.SolveBarrier_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var _=this.m_positionBuffer.data,p=this.m_velocityBuffer.data,v=0;v<this.m_count;v++)0!==(this.m_flagsBuffer.data[v]&t.k_barrierWallFlags)&&p[v].SetZero();for(var y=z*i.dt,g=this.GetParticleMass(),x=0;x<this.m_pairBuffer.count;x++){var b=this.m_pairBuffer.data[x];if(b.flags&e.b2ParticleFlag.b2_barrierParticle){var w=b.indexA,A=b.indexB,S=_[w],M=_[A],C=n;ke.MinV(S,M,C.lowerBound),ke.MaxV(S,M,C.upperBound);for(var k=this.m_groupBuffer[w],B=this.m_groupBuffer[A],V=this.GetLinearVelocity(k,w,S,r),T=this.GetLinearVelocity(B,A,M,s),P=ke.SubVV(M,S,a),L=ke.SubVV(T,V,o),E=this.GetInsideBoundsEnumerator(C),I=void 0;(I=E.GetNext())>=0;){var R=_[I],F=this.m_groupBuffer[I];if(k!==F&&B!==F){var G=this.GetLinearVelocity(F,I,R,l),D=ke.SubVV(R,S,u),O=ke.SubVV(G,V,h),N=ke.CrossVV(L,O),U=ke.CrossVV(P,O)-ke.CrossVV(D,L),j=ke.CrossVV(P,D),W=void 0,q=void 0,H=c,X=f;if(0===N){if(0===U)continue;if(!((q=-j/U)>=0&&q<y))continue;if(ke.AddVMulSV(P,q,L,H),ke.AddVMulSV(D,q,O,X),!((W=ke.DotVV(H,X)/ke.DotVV(H,H))>=0&&W<=1))continue}else{var J=U*U-4*j*N;if(J<0)continue;var Y=me(J),Z=(-U-Y)/(2*N),Q=(-U+Y)/(2*N);if(Z>Q){var K=Z;Z=Q,Q=K}if(q=Z,ke.AddVMulSV(P,q,L,H),ke.AddVMulSV(D,q,O,X),W=ke.DotVV(H,X)/ke.DotVV(H,H),!(q>=0&&q<y&&W>=0&&W<=1)){if(!((q=Q)>=0&&q<y))continue;if(ke.AddVMulSV(P,q,L,H),ke.AddVMulSV(D,q,O,X),!((W=ke.DotVV(H,X)/ke.DotVV(H,H))>=0&&W<=1))continue}}var $=d;$.x=V.x+W*L.x-G.x,$.y=V.y+W*L.y-G.y;var ee=ke.MulSV(g,$,m);if(F&&this.IsRigidGroup(F)){var te=F.GetMass(),ie=F.GetInertia();te>0&&F.m_linearVelocity.SelfMulAdd(1/te,ee),ie>0&&(F.m_angularVelocity+=ke.CrossVV(ke.SubVV(R,F.GetCenter(),ke.s_t0),ee)/ie)}else p[I].SelfAdd($);this.ParticleApplyForce(I,ee.SelfMul(-i.inv_dt))}}}}}},{key:"SolveStaticPressure",value:function(t){if(!this.m_flagsBuffer.data)throw new Error;this.m_staticPressureBuffer=this.RequestBuffer(this.m_staticPressureBuffer);for(var i=this.GetCriticalPressure(t),n=this.m_def.staticPressureStrength*i,r=F*i,s=this.m_def.staticPressureRelaxation,a=0;a<this.m_def.staticPressureIterations;a++){for(var o=0;o<this.m_count;o++)this.m_accumulationBuffer[o]=0;for(var l=0;l<this.m_contactBuffer.count;l++){var u=this.m_contactBuffer.data[l];if(u.flags&e.b2ParticleFlag.b2_staticPressureParticle){var h=u.indexA,c=u.indexB,f=u.weight;this.m_accumulationBuffer[h]+=f*this.m_staticPressureBuffer[c],this.m_accumulationBuffer[c]+=f*this.m_staticPressureBuffer[h]}}for(var d=0;d<this.m_count;d++){var m=this.m_weightBuffer[d];if(this.m_flagsBuffer.data[d]&e.b2ParticleFlag.b2_staticPressureParticle){var _=(this.m_accumulationBuffer[d]+n*(m-R))/(m+s);this.m_staticPressureBuffer[d]=ue(_,0,r)}else this.m_staticPressureBuffer[d]=0}}}},{key:"ComputeWeight",value:function(){for(var e=0;e<this.m_count;e++)this.m_weightBuffer[e]=0;for(var t=0;t<this.m_bodyContactBuffer.count;t++){var i=this.m_bodyContactBuffer.data[t],n=i.index,r=i.weight;this.m_weightBuffer[n]+=r}for(var s=0;s<this.m_contactBuffer.count;s++){var a=this.m_contactBuffer.data[s],o=a.indexA,l=a.indexB,u=a.weight;this.m_weightBuffer[o]+=u,this.m_weightBuffer[l]+=u}}},{key:"SolvePressure",value:function(i){var n=t.SolvePressure_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var r=this.m_positionBuffer.data,s=this.m_velocityBuffer.data,a=this.GetCriticalPressure(i),o=this.m_def.pressureStrength*a,l=F*a,u=0;u<this.m_count;u++){var h=this.m_weightBuffer[u],c=o*le(0,h-R);this.m_accumulationBuffer[u]=oe(c,l)}if(this.m_allParticleFlags&t.k_noPressureFlags)for(var f=0;f<this.m_count;f++)this.m_flagsBuffer.data[f]&t.k_noPressureFlags&&(this.m_accumulationBuffer[f]=0);if(this.m_allParticleFlags&e.b2ParticleFlag.b2_staticPressureParticle)for(var d=0;d<this.m_count;d++)this.m_flagsBuffer.data[d]&e.b2ParticleFlag.b2_staticPressureParticle&&(this.m_accumulationBuffer[d]+=this.m_staticPressureBuffer[d]);for(var m=i.dt/(this.m_def.density*this.m_particleDiameter),_=this.GetParticleInvMass(),p=0;p<this.m_bodyContactBuffer.count;p++){var v=this.m_bodyContactBuffer.data[p],y=v.index,g=v.body,x=v.weight,b=v.mass,w=v.normal,A=r[y],S=this.m_accumulationBuffer[y]+o*x,M=ke.MulSV(m*x*b*S,w,n);s[y].SelfMulSub(_,M),g.ApplyLinearImpulse(M,A,!0)}for(var C=0;C<this.m_contactBuffer.count;C++){var k=this.m_contactBuffer.data[C],B=k.indexA,V=k.indexB,T=k.weight,P=k.normal,L=this.m_accumulationBuffer[B]+this.m_accumulationBuffer[V],E=ke.MulSV(m*T*L,P,n);s[B].SelfSub(E),s[V].SelfAdd(E)}}},{key:"SolveDamping",value:function(e){var i=t.SolveDamping_s_v,n=t.SolveDamping_s_f;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var r=this.m_positionBuffer.data,s=this.m_velocityBuffer.data,a=this.m_def.dampingStrength,o=1/this.GetCriticalVelocity(e),l=this.GetParticleInvMass(),u=0;u<this.m_bodyContactBuffer.count;u++){var h=this.m_bodyContactBuffer.data[u],c=h.index,f=h.body,d=h.weight,m=h.mass,_=h.normal,p=r[c],v=ke.SubVV(f.GetLinearVelocityFromWorldPoint(p,ke.s_t0),s[c],i),y=ke.DotVV(v,_);if(y<0){var g=le(a*d,oe(-o*y,.5)),x=ke.MulSV(g*m*y,_,n);s[c].SelfMulAdd(l,x),f.ApplyLinearImpulse(x.SelfNeg(),p,!0)}}for(var b=0;b<this.m_contactBuffer.count;b++){var w=this.m_contactBuffer.data[b],A=w.indexA,S=w.indexB,M=w.weight,C=w.normal,k=ke.SubVV(s[S],s[A],i),B=ke.DotVV(k,C);if(B<0){var V=le(a*M,oe(-o*B,.5)),T=ke.MulSV(V*B,C,n);s[A].SelfAdd(T),s[S].SelfSub(T)}}}},{key:"SolveRigidDamping",value:function(){var e=t.SolveRigidDamping_s_t0,i=t.SolveRigidDamping_s_t1,n=t.SolveRigidDamping_s_p,r=t.SolveRigidDamping_s_v,s=[0],a=[0],o=[0],l=[0],u=[0],h=[0];if(!this.m_positionBuffer.data)throw new Error;for(var c=this.m_positionBuffer.data,f=this.m_def.dampingStrength,d=0;d<this.m_bodyContactBuffer.count;d++){var m=this.m_bodyContactBuffer.data[d],_=m.index,p=this.m_groupBuffer[_];if(p&&this.IsRigidGroup(p)){var v=m.body,y=m.normal,g=m.weight,x=c[_],b=ke.SubVV(v.GetLinearVelocityFromWorldPoint(x,e),p.GetLinearVelocityFromWorldPoint(x,i),r),w=ke.DotVV(b,y);if(w<0){this.InitDampingParameterWithRigidGroupOrParticle(s,a,o,!0,p,_,x,y),this.InitDampingParameter(l,u,h,v.GetMass(),v.GetInertia()-v.GetMass()*v.GetLocalCenter().LengthSquared(),v.GetWorldCenter(),x,y);var A=f*oe(g,1)*this.ComputeDampingImpulse(s[0],a[0],o[0],l[0],u[0],h[0],w);this.ApplyDamping(s[0],a[0],o[0],!0,p,_,A,y),v.ApplyLinearImpulse(ke.MulSV(-A,y,ke.s_t0),x,!0)}}}for(var S=0;S<this.m_contactBuffer.count;S++){var M=this.m_contactBuffer.data[S],C=M.indexA,k=M.indexB,B=M.normal,V=M.weight,T=this.m_groupBuffer[C],P=this.m_groupBuffer[k],L=this.IsRigidGroup(T),E=this.IsRigidGroup(P);if(T!==P&&(L||E)){var I=ke.MidVV(c[C],c[k],n),R=ke.SubVV(this.GetLinearVelocity(P,k,I,e),this.GetLinearVelocity(T,C,I,i),r),F=ke.DotVV(R,B);if(F<0){this.InitDampingParameterWithRigidGroupOrParticle(s,a,o,L,T,C,I,B),this.InitDampingParameterWithRigidGroupOrParticle(l,u,h,E,P,k,I,B);var G=f*V*this.ComputeDampingImpulse(s[0],a[0],o[0],l[0],u[0],h[0],F);this.ApplyDamping(s[0],a[0],o[0],L,T,C,G,B),this.ApplyDamping(l[0],u[0],h[0],E,P,k,-G,B)}}}}},{key:"SolveExtraDamping",value:function(){var e=t.SolveExtraDamping_s_v,i=t.SolveExtraDamping_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var n=this.m_velocityBuffer.data,r=this.m_positionBuffer.data,s=this.GetParticleInvMass(),a=0;a<this.m_bodyContactBuffer.count;a++){var o=this.m_bodyContactBuffer.data[a],l=o.index;if(this.m_flagsBuffer.data[l]&t.k_extraDampingFlags){var u=o.body,h=o.mass,c=o.normal,f=r[l],d=ke.SubVV(u.GetLinearVelocityFromWorldPoint(f,ke.s_t0),n[l],e),m=ke.DotVV(d,c);if(m<0){var _=ke.MulSV(.5*h*m,c,i);n[l].SelfMulAdd(s,_),u.ApplyLinearImpulse(_.SelfNeg(),f,!0)}}}}},{key:"SolveWall",value:function(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var t=this.m_velocityBuffer.data,i=0;i<this.m_count;i++)this.m_flagsBuffer.data[i]&e.b2ParticleFlag.b2_wallParticle&&t[i].SetZero()}},{key:"SolveRigid",value:function(i){var n=t.SolveRigid_s_position,r=t.SolveRigid_s_rotation,s=t.SolveRigid_s_transform,a=t.SolveRigid_s_velocityTransform;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var o=this.m_positionBuffer.data,l=this.m_velocityBuffer.data,u=this.m_groupList;u;u=u.GetNext())if(u.m_groupFlags&e.b2ParticleGroupFlag.b2_rigidParticleGroup){u.UpdateStatistics();var h=r;h.SetAngle(i.dt*u.m_angularVelocity);var c=ke.AddVV(u.m_center,ke.SubVV(ke.MulSV(i.dt,u.m_linearVelocity,ke.s_t0),Le.MulRV(h,u.m_center,ke.s_t1),ke.s_t0),n),f=s;f.SetPositionRotation(c,h),Ee.MulXX(f,u.m_transform,u.m_transform);var d=a;d.p.x=i.inv_dt*f.p.x,d.p.y=i.inv_dt*f.p.y,d.q.s=i.inv_dt*f.q.s,d.q.c=i.inv_dt*(f.q.c-1);for(var m=u.m_firstIndex;m<u.m_lastIndex;m++)Ee.MulXV(d,o[m],l[m])}}},{key:"SolveElastic",value:function(i){var n=t.SolveElastic_s_pa,r=t.SolveElastic_s_pb,s=t.SolveElastic_s_pc,a=t.SolveElastic_s_r,o=t.SolveElastic_s_t0;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var l=this.m_positionBuffer.data,u=this.m_velocityBuffer.data,h=i.inv_dt*this.m_def.elasticStrength,c=0;c<this.m_triadBuffer.count;c++){var f=this.m_triadBuffer.data[c];if(f.flags&e.b2ParticleFlag.b2_elasticParticle){var d=f.indexA,m=f.indexB,_=f.indexC,p=f.pa,v=f.pb,y=f.pc,g=n.Copy(l[d]),x=r.Copy(l[m]),b=s.Copy(l[_]),w=u[d],A=u[m],S=u[_];g.SelfMulAdd(i.dt,w),x.SelfMulAdd(i.dt,A),b.SelfMulAdd(i.dt,S);var M=(g.x+x.x+b.x)/3,C=(g.y+x.y+b.y)/3;g.x-=M,g.y-=C,x.x-=M,x.y-=C,b.x-=M,b.y-=C;var k=a;k.s=ke.CrossVV(p,g)+ke.CrossVV(v,x)+ke.CrossVV(y,b),k.c=ke.DotVV(p,g)+ke.DotVV(v,x)+ke.DotVV(y,b);var B=de(k.s*k.s+k.c*k.c);isFinite(B)||(B=198177537e11),k.s*=B,k.c*=B;var V=h*f.strength;Le.MulRV(k,p,o),ke.SubVV(o,g,o),ke.MulSV(V,o,o),w.SelfAdd(o),Le.MulRV(k,v,o),ke.SubVV(o,x,o),ke.MulSV(V,o,o),A.SelfAdd(o),Le.MulRV(k,y,o),ke.SubVV(o,b,o),ke.MulSV(V,o,o),S.SelfAdd(o)}}}},{key:"SolveSpring",value:function(i){var n=t.SolveSpring_s_pa,r=t.SolveSpring_s_pb,s=t.SolveSpring_s_d,a=t.SolveSpring_s_f;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var o=this.m_positionBuffer.data,l=this.m_velocityBuffer.data,u=i.inv_dt*this.m_def.springStrength,h=0;h<this.m_pairBuffer.count;h++){var c=this.m_pairBuffer.data[h];if(c.flags&e.b2ParticleFlag.b2_springParticle){var f=c.indexA,d=c.indexB,m=n.Copy(o[f]),_=r.Copy(o[d]),p=l[f],v=l[d];m.SelfMulAdd(i.dt,p),_.SelfMulAdd(i.dt,v);var y=ke.SubVV(_,m,s),g=c.distance,x=y.Length(),b=u*c.strength,w=ke.MulSV(b*(g-x)/x,y,a);p.SelfSub(w),v.SelfAdd(w)}}}},{key:"SolveTensile",value:function(i){var n=t.SolveTensile_s_weightedNormal,r=t.SolveTensile_s_s,s=t.SolveTensile_s_f;if(!this.m_velocityBuffer.data)throw new Error;for(var a=this.m_velocityBuffer.data,o=0;o<this.m_count;o++)this.m_accumulation2Buffer[o]=new ke,this.m_accumulation2Buffer[o].SetZero();for(var l=0;l<this.m_contactBuffer.count;l++){var u=this.m_contactBuffer.data[l];if(u.flags&e.b2ParticleFlag.b2_tensileParticle){var h=u.indexA,c=u.indexB,f=u.weight,d=u.normal,m=ke.MulSV((1-f)*f,d,n);this.m_accumulation2Buffer[h].SelfSub(m),this.m_accumulation2Buffer[c].SelfAdd(m)}}for(var _=this.GetCriticalVelocity(i),p=this.m_def.surfaceTensionPressureStrength*_,v=this.m_def.surfaceTensionNormalStrength*_,y=G*_,g=0;g<this.m_contactBuffer.count;g++){var x=this.m_contactBuffer.data[g];if(x.flags&e.b2ParticleFlag.b2_tensileParticle){var b=x.indexA,w=x.indexB,A=x.weight,S=x.normal,M=this.m_weightBuffer[b]+this.m_weightBuffer[w],C=ke.SubVV(this.m_accumulation2Buffer[w],this.m_accumulation2Buffer[b],r),k=oe(p*(M-2)+v*ke.DotVV(C,S),y)*A,B=ke.MulSV(k,S,s);a[b].SelfSub(B),a[w].SelfAdd(B)}}}},{key:"SolveViscous",value:function(){var i=t.SolveViscous_s_v,n=t.SolveViscous_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var r=this.m_positionBuffer.data,s=this.m_velocityBuffer.data,a=this.m_def.viscousStrength,o=this.GetParticleInvMass(),l=0;l<this.m_bodyContactBuffer.count;l++){var u=this.m_bodyContactBuffer.data[l],h=u.index;if(this.m_flagsBuffer.data[h]&e.b2ParticleFlag.b2_viscousParticle){var c=u.body,f=u.weight,d=u.mass,m=r[h],_=ke.SubVV(c.GetLinearVelocityFromWorldPoint(m,ke.s_t0),s[h],i),p=ke.MulSV(a*d*f,_,n);s[h].SelfMulAdd(o,p),c.ApplyLinearImpulse(p.SelfNeg(),m,!0)}}for(var v=0;v<this.m_contactBuffer.count;v++){var y=this.m_contactBuffer.data[v];if(y.flags&e.b2ParticleFlag.b2_viscousParticle){var g=y.indexA,x=y.indexB,b=y.weight,w=ke.SubVV(s[x],s[g],i),A=ke.MulSV(a*b,w,n);s[g].SelfAdd(A),s[x].SelfSub(A)}}}},{key:"SolveRepulsive",value:function(i){var n=t.SolveRepulsive_s_f;if(!this.m_velocityBuffer.data)throw new Error;for(var r=this.m_velocityBuffer.data,s=this.m_def.repulsiveStrength*this.GetCriticalVelocity(i),a=0;a<this.m_contactBuffer.count;a++){var o=this.m_contactBuffer.data[a];if(o.flags&e.b2ParticleFlag.b2_repulsiveParticle){var l=o.indexA,u=o.indexB;if(this.m_groupBuffer[l]!==this.m_groupBuffer[u]){var h=o.weight,c=o.normal,f=ke.MulSV(s*h,c,n);r[l].SelfSub(f),r[u].SelfAdd(f)}}}}},{key:"SolvePowder",value:function(i){var n=t.SolvePowder_s_f;if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var r=this.m_positionBuffer.data,s=this.m_velocityBuffer.data,a=this.m_def.powderStrength*this.GetCriticalVelocity(i),o=1-I,l=this.GetParticleInvMass(),u=0;u<this.m_bodyContactBuffer.count;u++){var h=this.m_bodyContactBuffer.data[u],c=h.index;if(this.m_flagsBuffer.data[c]&e.b2ParticleFlag.b2_powderParticle){var f=h.weight;if(f>o){var d=h.body,m=h.mass,_=r[c],p=h.normal,v=ke.MulSV(a*m*(f-o),p,n);s[c].SelfMulSub(l,v),d.ApplyLinearImpulse(v,_,!0)}}}for(var y=0;y<this.m_contactBuffer.count;y++){var g=this.m_contactBuffer.data[y];if(g.flags&e.b2ParticleFlag.b2_powderParticle){var x=g.weight;if(x>o){var b=g.indexA,w=g.indexB,A=g.normal,S=ke.MulSV(a*(x-o),A,n);s[b].SelfSub(S),s[w].SelfAdd(S)}}}}},{key:"SolveSolid",value:function(e){var i=t.SolveSolid_s_f;if(!this.m_velocityBuffer.data)throw new Error;var n=this.m_velocityBuffer.data;this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer);for(var r=e.inv_dt*this.m_def.ejectionStrength,s=0;s<this.m_contactBuffer.count;s++){var a=this.m_contactBuffer.data[s],o=a.indexA,l=a.indexB;if(this.m_groupBuffer[o]!==this.m_groupBuffer[l]){var u=a.weight,h=a.normal,c=this.m_depthBuffer[o]+this.m_depthBuffer[l],f=ke.MulSV(r*c*u,h,i);n[o].SelfSub(f),n[l].SelfAdd(f)}}}},{key:"SolveForce",value:function(e){if(!this.m_velocityBuffer.data)throw new Error;for(var t=this.m_velocityBuffer.data,i=e.dt*this.GetParticleInvMass(),n=0;n<this.m_count;n++)t[n].SelfMulAdd(i,this.m_forceBuffer[n]);this.m_hasForce=!1}},{key:"SolveColorMixing",value:function(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_colorBuffer.data)throw new Error;var t=.5*this.m_def.colorMixingStrength;if(t)for(var i=0;i<this.m_contactBuffer.count;i++){var n=this.m_contactBuffer.data[i],r=n.indexA,s=n.indexB;if(this.m_flagsBuffer.data[r]&this.m_flagsBuffer.data[s]&e.b2ParticleFlag.b2_colorMixingParticle){var a=this.m_colorBuffer.data[r],o=this.m_colorBuffer.data[s];Fe.MixColors(a,o,t)}}}},{key:"SolveZombie",value:function(){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;for(var t=0,i=[],n=0;n<this.m_count;n++)i[n]=L;for(var r=0,s=0;s<this.m_count;s++){var a=this.m_flagsBuffer.data[s];if(a&e.b2ParticleFlag.b2_zombieParticle){var o=this.m_world.m_destructionListener;if(a&e.b2ParticleFlag.b2_destructionListenerParticle&&o&&o.SayGoodbyeParticle(this,s),this.m_handleIndexBuffer.data){var l=this.m_handleIndexBuffer.data[s];l&&(l.SetIndex(L),this.m_handleIndexBuffer.data[s]=null)}i[s]=L}else{if(i[s]=t,s!==t){if(this.m_handleIndexBuffer.data){var u=this.m_handleIndexBuffer.data[s];u&&u.SetIndex(t),this.m_handleIndexBuffer.data[t]=u}this.m_flagsBuffer.data[t]=this.m_flagsBuffer.data[s],this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[t]=this.m_lastBodyContactStepBuffer.data[s]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[t]=this.m_bodyContactCountBuffer.data[s]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[t]=this.m_consecutiveContactStepsBuffer.data[s]),this.m_positionBuffer.data[t].Copy(this.m_positionBuffer.data[s]),this.m_velocityBuffer.data[t].Copy(this.m_velocityBuffer.data[s]),this.m_groupBuffer[t]=this.m_groupBuffer[s],this.m_hasForce&&this.m_forceBuffer[t].Copy(this.m_forceBuffer[s]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[t]=this.m_staticPressureBuffer[s]),this.m_depthBuffer&&(this.m_depthBuffer[t]=this.m_depthBuffer[s]),this.m_colorBuffer.data&&this.m_colorBuffer.data[t].Copy(this.m_colorBuffer.data[s]),this.m_userDataBuffer.data&&(this.m_userDataBuffer.data[t]=this.m_userDataBuffer.data[s]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[t]=this.m_expirationTimeBuffer.data[s])}t++,r|=a}}for(var h={IsProxyInvalid:function(e){return e.index<0},IsContactInvalid:function(e){return e.indexA<0||e.indexB<0},IsBodyContactInvalid:function(e){return e.index<0},IsPairInvalid:function(e){return e.indexA<0||e.indexB<0},IsTriadInvalid:function(e){return e.indexA<0||e.indexB<0||e.indexC<0}},c=0;c<this.m_proxyBuffer.count;c++){var f=this.m_proxyBuffer.data[c];f.index=i[f.index]}this.m_proxyBuffer.RemoveIf(h.IsProxyInvalid);for(var d=0;d<this.m_contactBuffer.count;d++){var m=this.m_contactBuffer.data[d];m.indexA=i[m.indexA],m.indexB=i[m.indexB]}this.m_contactBuffer.RemoveIf(h.IsContactInvalid);for(var _=0;_<this.m_bodyContactBuffer.count;_++){var p=this.m_bodyContactBuffer.data[_];p.index=i[p.index]}this.m_bodyContactBuffer.RemoveIf(h.IsBodyContactInvalid);for(var v=0;v<this.m_pairBuffer.count;v++){var y=this.m_pairBuffer.data[v];y.indexA=i[y.indexA],y.indexB=i[y.indexB]}this.m_pairBuffer.RemoveIf(h.IsPairInvalid);for(var g=0;g<this.m_triadBuffer.count;g++){var x=this.m_triadBuffer.data[g];x.indexA=i[x.indexA],x.indexB=i[x.indexB],x.indexC=i[x.indexC]}if(this.m_triadBuffer.RemoveIf(h.IsTriadInvalid),this.m_indexByExpirationTimeBuffer.data)for(var b=0,w=0;w<this.m_count;w++){var A=i[this.m_indexByExpirationTimeBuffer.data[w]];A!==L&&(this.m_indexByExpirationTimeBuffer.data[b++]=A)}for(var S=this.m_groupList;S;S=S.GetNext()){for(var M=t,C=0,k=!1,B=S.m_firstIndex;B<S.m_lastIndex;B++){var V=i[B];V>=0?(M=oe(M,V),C=le(C,V+1)):k=!0}M<C?(S.m_firstIndex=M,S.m_lastIndex=C,k&&S.m_groupFlags&e.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SetGroupFlags(S,S.m_groupFlags|e.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)):(S.m_firstIndex=0,S.m_lastIndex=0,S.m_groupFlags&e.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty||this.SetGroupFlags(S,S.m_groupFlags|e.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed))}this.m_count=t,this.m_allParticleFlags=r,this.m_needsUpdateAllParticleFlags=!1;for(var T=this.m_groupList;T;){var P=T.GetNext();T.m_groupFlags&e.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed&&this.DestroyParticleGroup(T),T=P}}},{key:"SolveLifetimes",value:function(e){if(!this.m_expirationTimeBuffer.data)throw new Error;if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;this.m_timeElapsed=this.LifetimeToExpirationTime(e.dt);var t=this.GetQuantizedTimeElapsed(),i=this.m_expirationTimeBuffer.data,n=this.m_indexByExpirationTimeBuffer.data,r=this.GetParticleCount();this.m_expirationTimeBufferRequiresSorting&&(Dr(n,0,r,(function(e,t){var n=i[e],r=i[t],s=n<=0;return s===r<=0?n>r:s})),this.m_expirationTimeBufferRequiresSorting=!1);for(var s=r-1;s>=0;--s){var a=n[s],o=i[a];if(t<o||o<=0)break;this.DestroyParticle(a)}}},{key:"RotateBuffer",value:function(e,t,i){if(e!==t&&t!==i){if(!this.m_flagsBuffer.data)throw new Error;if(!this.m_positionBuffer.data)throw new Error;if(!this.m_velocityBuffer.data)throw new Error;if(jr(this.m_flagsBuffer.data,e,t,i),this.m_lastBodyContactStepBuffer.data&&jr(this.m_lastBodyContactStepBuffer.data,e,t,i),this.m_bodyContactCountBuffer.data&&jr(this.m_bodyContactCountBuffer.data,e,t,i),this.m_consecutiveContactStepsBuffer.data&&jr(this.m_consecutiveContactStepsBuffer.data,e,t,i),jr(this.m_positionBuffer.data,e,t,i),jr(this.m_velocityBuffer.data,e,t,i),jr(this.m_groupBuffer,e,t,i),this.m_hasForce&&jr(this.m_forceBuffer,e,t,i),this.m_staticPressureBuffer&&jr(this.m_staticPressureBuffer,e,t,i),this.m_depthBuffer&&jr(this.m_depthBuffer,e,t,i),this.m_colorBuffer.data&&jr(this.m_colorBuffer.data,e,t,i),this.m_userDataBuffer.data&&jr(this.m_userDataBuffer.data,e,t,i),this.m_handleIndexBuffer.data){jr(this.m_handleIndexBuffer.data,e,t,i);for(var n=e;n<i;++n){var r=this.m_handleIndexBuffer.data[n];r&&r.SetIndex(g(r.GetIndex()))}}if(this.m_expirationTimeBuffer.data){jr(this.m_expirationTimeBuffer.data,e,t,i);var s=this.GetParticleCount();if(!this.m_indexByExpirationTimeBuffer.data)throw new Error;for(var a=this.m_indexByExpirationTimeBuffer.data,o=0;o<s;++o)a[o]=g(a[o])}for(var l=0;l<this.m_proxyBuffer.count;l++){var u=this.m_proxyBuffer.data[l];u.index=g(u.index)}for(var h=0;h<this.m_contactBuffer.count;h++){var c=this.m_contactBuffer.data[h];c.indexA=g(c.indexA),c.indexB=g(c.indexB)}for(var f=0;f<this.m_bodyContactBuffer.count;f++){var d=this.m_bodyContactBuffer.data[f];d.index=g(d.index)}for(var m=0;m<this.m_pairBuffer.count;m++){var _=this.m_pairBuffer.data[m];_.indexA=g(_.indexA),_.indexB=g(_.indexB)}for(var p=0;p<this.m_triadBuffer.count;p++){var v=this.m_triadBuffer.data[p];v.indexA=g(v.indexA),v.indexB=g(v.indexB),v.indexC=g(v.indexC)}for(var y=this.m_groupList;y;y=y.GetNext())y.m_firstIndex=g(y.m_firstIndex),y.m_lastIndex=g(y.m_lastIndex-1)+1}function g(n){return n<e?n:n<t?n+i-t:n<i?n+e-t:n}}},{key:"GetCriticalVelocity",value:function(e){return this.m_particleDiameter*e.inv_dt}},{key:"GetCriticalVelocitySquared",value:function(e){var t=this.GetCriticalVelocity(e);return t*t}},{key:"GetCriticalPressure",value:function(e){return this.m_def.density*this.GetCriticalVelocitySquared(e)}},{key:"GetParticleStride",value:function(){return I*this.m_particleDiameter}},{key:"GetParticleMass",value:function(){var e=this.GetParticleStride();return this.m_def.density*e*e}},{key:"GetParticleInvMass",value:function(){var e=this.m_inverseDiameter*(1/I);return this.m_inverseDensity*e*e}},{key:"GetFixtureContactFilter",value:function(){return this.m_allParticleFlags&e.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null}},{key:"GetParticleContactFilter",value:function(){return this.m_allParticleFlags&e.b2ParticleFlag.b2_particleContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null}},{key:"GetFixtureContactListener",value:function(){return this.m_allParticleFlags&e.b2ParticleFlag.b2_fixtureContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null}},{key:"GetParticleContactListener",value:function(){return this.m_allParticleFlags&e.b2ParticleFlag.b2_particleContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null}},{key:"SetUserOverridableBuffer",value:function(e,t,i){e.data=t,e.userSuppliedCapacity=i}},{key:"SetGroupFlags",value:function(t,i){var n=t.m_groupFlags;(n^i)&e.b2ParticleGroupFlag.b2_solidParticleGroup&&(i|=e.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth),n&~i&&(this.m_needsUpdateAllGroupFlags=!0),~this.m_allGroupFlags&i&&(i&e.b2ParticleGroupFlag.b2_solidParticleGroup&&(this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer)),this.m_allGroupFlags|=i),t.m_groupFlags=i}},{key:"RemoveSpuriousBodyContacts",value:function(){Dr(this.m_bodyContactBuffer.data,0,this.m_bodyContactBuffer.count,t.BodyContactCompare);var e=t.RemoveSpuriousBodyContacts_s_n,i=t.RemoveSpuriousBodyContacts_s_pos,n=t.RemoveSpuriousBodyContacts_s_normal,r=3,s=this,a=-1,o=0,l=function(t){if(t.index!==a&&(o=0,a=t.index),o++>r)return!0;var l=e.Copy(t.normal);if(l.SelfMul(s.m_particleDiameter*(1-t.weight)),!s.m_positionBuffer.data)throw new Error;var u=ke.AddVV(s.m_positionBuffer.data[t.index],l,i);if(!t.fixture.TestPoint(u)){for(var h=t.fixture.GetShape().GetChildCount(),c=0;c<h;c++){var f=n;if(t.fixture.ComputeDistance(u,f,c)<y)return!1}return!0}return!1};this.m_bodyContactBuffer.count=Nr(this.m_bodyContactBuffer.data,l,this.m_bodyContactBuffer.count)}},{key:"DetectStuckParticle",value:function(e){if(!(this.m_stuckThreshold<=0)){if(!this.m_bodyContactCountBuffer.data)throw new Error;if(!this.m_consecutiveContactStepsBuffer.data)throw new Error;if(!this.m_lastBodyContactStepBuffer.data)throw new Error;++this.m_bodyContactCountBuffer.data[e],2===this.m_bodyContactCountBuffer.data[e]&&(++this.m_consecutiveContactStepsBuffer.data[e],this.m_consecutiveContactStepsBuffer.data[e]>this.m_stuckThreshold&&(this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()]=e)),this.m_lastBodyContactStepBuffer.data[e]=this.m_timestamp}}},{key:"ValidateParticleIndex",value:function(e){return e>=0&&e<this.GetParticleCount()&&e!==L}},{key:"GetQuantizedTimeElapsed",value:function(){return Math.floor(this.m_timeElapsed/4294967296)}},{key:"LifetimeToExpirationTime",value:function(e){return this.m_timeElapsed+Math.floor(e/this.m_def.lifetimeGranularity*4294967296)}},{key:"ForceCanBeApplied",value:function(t){return!(t&e.b2ParticleFlag.b2_wallParticle)}},{key:"PrepareForceBuffer",value:function(){if(!this.m_hasForce){for(var e=0;e<this.m_count;e++)this.m_forceBuffer[e].SetZero();this.m_hasForce=!0}}},{key:"IsRigidGroup",value:function(t){return null!==t&&0!==(t.m_groupFlags&e.b2ParticleGroupFlag.b2_rigidParticleGroup)}},{key:"GetLinearVelocity",value:function(e,t,i,n){if(e&&this.IsRigidGroup(e))return e.GetLinearVelocityFromWorldPoint(i,n);if(!this.m_velocityBuffer.data)throw new Error;return n.Copy(this.m_velocityBuffer.data[t])}},{key:"InitDampingParameter",value:function(e,t,i,n,r,s,a,o){e[0]=n>0?1/n:0,t[0]=r>0?1/r:0,i[0]=ke.CrossVV(ke.SubVV(a,s,ke.s_t0),o)}},{key:"InitDampingParameterWithRigidGroupOrParticle",value:function(t,i,n,r,s,a,o,l){if(s&&r)this.InitDampingParameter(t,i,n,s.GetMass(),s.GetInertia(),s.GetCenter(),o,l);else{if(!this.m_flagsBuffer.data)throw new Error;var u=this.m_flagsBuffer.data[a];this.InitDampingParameter(t,i,n,u&e.b2ParticleFlag.b2_wallParticle?0:this.GetParticleMass(),0,o,o,l)}}},{key:"ComputeDampingImpulse",value:function(e,t,i,n,r,s,a){var o=e+t*i*i+n+r*s*s;return o>0?a/o:0}},{key:"ApplyDamping",value:function(e,t,i,n,r,s,a,o){if(r&&n)r.m_linearVelocity.SelfMulAdd(a*e,o),r.m_angularVelocity+=a*i*t;else{if(!this.m_velocityBuffer.data)throw new Error;this.m_velocityBuffer.data[s].SelfMulAdd(a*e,o)}}}],[{key:"computeTag",value:function(e,i){return(i+t.yOffset>>>0<<t.yShift)+(t.xScale*e+t.xOffset>>>0)>>>0}},{key:"computeRelativeTag",value:function(e,i,n){return e+(n<<t.yShift)+(i<<t.xShift)>>>0}},{key:"IsSignificantForce",value:function(e){return 0!==e.x||0!==e.y}},{key:"ParticleCanBeConnected",value:function(t,i){return 0!==(t&(e.b2ParticleFlag.b2_wallParticle|e.b2ParticleFlag.b2_springParticle|e.b2ParticleFlag.b2_elasticParticle))||null!==i&&0!==(i.GetGroupFlags()&e.b2ParticleGroupFlag.b2_rigidParticleGroup)}},{key:"ComparePairIndices",value:function(e,t){var i=e.indexA-t.indexA;return 0!==i?i<0:e.indexB<t.indexB}},{key:"MatchPairIndices",value:function(e,t){return e.indexA===t.indexA&&e.indexB===t.indexB}},{key:"CompareTriadIndices",value:function(e,t){var i=e.indexA-t.indexA;if(0!==i)return i<0;var n=e.indexB-t.indexB;return 0!==n?n<0:e.indexC<t.indexC}},{key:"MatchTriadIndices",value:function(e,t){return e.indexA===t.indexA&&e.indexB===t.indexB&&e.indexC===t.indexC}},{key:"InitializeParticleLists",value:function(e,t){for(var i=e.GetBufferIndex(),n=e.GetParticleCount(),r=0;r<n;r++){var s=t[r];s.list=s,s.next=null,s.count=1,s.index=r+i}}},{key:"MergeParticleLists",value:function(e,t){for(var i=t;;){i.list=e;var n=i.next;if(!n){i.next=e.next;break}i=n}e.next=t,e.count+=t.count,t.count=0}},{key:"FindLongestParticleList",value:function(e,t){for(var i=e.GetParticleCount(),n=t[0],r=0;r<i;r++){var s=t[r];n.count<s.count&&(n=s)}return n}},{key:"MergeParticleListAndNode",value:function(e,t){t.list=e,t.next=e.next,e.next=t,e.count++,t.count=0}},{key:"b2ParticleContactIsZombie",value:function(t){return(t.flags&e.b2ParticleFlag.b2_zombieParticle)===e.b2ParticleFlag.b2_zombieParticle}},{key:"BodyContactCompare",value:function(e,t){return e.index===t.index?e.weight>t.weight:e.index<t.index}}]),t}();Kr.xTruncBits=12,Kr.yTruncBits=12,Kr.tagBits=32,Kr.yOffset=1<<Kr.yTruncBits-1,Kr.yShift=Kr.tagBits-Kr.yTruncBits,Kr.xShift=Kr.tagBits-Kr.yTruncBits-Kr.xTruncBits,Kr.xScale=1<<Kr.xShift,Kr.xOffset=Kr.xScale*(1<<Kr.xTruncBits-1),Kr.yMask=(1<<Kr.yTruncBits)-1<<Kr.yShift,Kr.xMask=~Kr.yMask,Kr.DestroyParticlesInShape_s_aabb=new Bt,Kr.CreateParticleGroup_s_transform=new Ee,Kr.ComputeCollisionEnergy_s_v=new ke,Kr.QueryShapeAABB_s_aabb=new Bt,Kr.QueryPointAABB_s_aabb=new Bt,Kr.RayCast_s_aabb=new Bt,Kr.RayCast_s_p=new ke,Kr.RayCast_s_v=new ke,Kr.RayCast_s_n=new ke,Kr.RayCast_s_point=new ke,Kr.k_pairFlags=e.b2ParticleFlag.b2_springParticle,Kr.k_triadFlags=e.b2ParticleFlag.b2_elasticParticle,Kr.k_noPressureFlags=e.b2ParticleFlag.b2_powderParticle|e.b2ParticleFlag.b2_tensileParticle,Kr.k_extraDampingFlags=e.b2ParticleFlag.b2_staticPressureParticle,Kr.k_barrierWallFlags=e.b2ParticleFlag.b2_barrierParticle|e.b2ParticleFlag.b2_wallParticle,Kr.CreateParticlesStrokeShapeForGroup_s_edge=new ln,Kr.CreateParticlesStrokeShapeForGroup_s_d=new ke,Kr.CreateParticlesStrokeShapeForGroup_s_p=new ke,Kr.CreateParticlesFillShapeForGroup_s_aabb=new Bt,Kr.CreateParticlesFillShapeForGroup_s_p=new ke,Kr.UpdatePairsAndTriads_s_dab=new ke,Kr.UpdatePairsAndTriads_s_dbc=new ke,Kr.UpdatePairsAndTriads_s_dca=new ke,Kr.AddContact_s_d=new ke,Kr.UpdateBodyContacts_s_aabb=new Bt,Kr.Solve_s_subStep=new _r,Kr.SolveCollision_s_aabb=new Bt,Kr.SolveGravity_s_gravity=new ke,Kr.SolveBarrier_s_aabb=new Bt,Kr.SolveBarrier_s_va=new ke,Kr.SolveBarrier_s_vb=new ke,Kr.SolveBarrier_s_pba=new ke,Kr.SolveBarrier_s_vba=new ke,Kr.SolveBarrier_s_vc=new ke,Kr.SolveBarrier_s_pca=new ke,Kr.SolveBarrier_s_vca=new ke,Kr.SolveBarrier_s_qba=new ke,Kr.SolveBarrier_s_qca=new ke,Kr.SolveBarrier_s_dv=new ke,Kr.SolveBarrier_s_f=new ke,Kr.SolvePressure_s_f=new ke,Kr.SolveDamping_s_v=new ke,Kr.SolveDamping_s_f=new ke,Kr.SolveRigidDamping_s_t0=new ke,Kr.SolveRigidDamping_s_t1=new ke,Kr.SolveRigidDamping_s_p=new ke,Kr.SolveRigidDamping_s_v=new ke,Kr.SolveExtraDamping_s_v=new ke,Kr.SolveExtraDamping_s_f=new ke,Kr.SolveRigid_s_position=new ke,Kr.SolveRigid_s_rotation=new Le,Kr.SolveRigid_s_transform=new Ee,Kr.SolveRigid_s_velocityTransform=new Ee,Kr.SolveElastic_s_pa=new ke,Kr.SolveElastic_s_pb=new ke,Kr.SolveElastic_s_pc=new ke,Kr.SolveElastic_s_r=new Le,Kr.SolveElastic_s_t0=new ke,Kr.SolveSpring_s_pa=new ke,Kr.SolveSpring_s_pb=new ke,Kr.SolveSpring_s_d=new ke,Kr.SolveSpring_s_f=new ke,Kr.SolveTensile_s_weightedNormal=new ke,Kr.SolveTensile_s_s=new ke,Kr.SolveTensile_s_f=new ke,Kr.SolveViscous_s_v=new ke,Kr.SolveViscous_s_f=new ke,Kr.SolveRepulsive_s_f=new ke,Kr.SolvePowder_s_f=new ke,Kr.SolveSolid_s_f=new ke,Kr.RemoveSpuriousBodyContacts_s_n=new ke,Kr.RemoveSpuriousBodyContacts_s_pos=new ke,Kr.RemoveSpuriousBodyContacts_s_normal=new ke,function(t){var i=l((function e(){o(this,e),this.data=null,this.userSuppliedCapacity=0}));t.UserOverridableBuffer=i;var n=function(){function e(){o(this,e),this.index=L,this.tag=0}return l(e,null,[{key:"CompareProxyProxy",value:function(e,t){return e.tag<t.tag}},{key:"CompareTagProxy",value:function(e,t){return e<t.tag}},{key:"CompareProxyTag",value:function(e,t){return e.tag<t}}]),e}();t.Proxy=n;var r=function(){function e(i,n,r,s,a){o(this,e),this.m_system=i,this.m_xLower=(n&t.xMask)>>>0,this.m_xUpper=(r&t.xMask)>>>0,this.m_yLower=(n&t.yMask)>>>0,this.m_yUpper=(r&t.yMask)>>>0,this.m_first=s,this.m_last=a}return l(e,[{key:"GetNext",value:function(){for(;this.m_first<this.m_last;){var e=(this.m_system.m_proxyBuffer.data[this.m_first].tag&t.xMask)>>>0;if(e>=this.m_xLower&&e<=this.m_xUpper)return this.m_system.m_proxyBuffer.data[this.m_first++].index;this.m_first++}return L}}]),e}();t.InsideBoundsEnumerator=r;var u=l((function e(){o(this,e),this.next=null,this.count=0,this.index=0}));t.ParticleListNode=u;var c=function(){function e(){o(this,e)}return l(e,[{key:"Allocate",value:function(e,t){return t}},{key:"Clear",value:function(){}},{key:"GetCount",value:function(){return 0}},{key:"Invalidate",value:function(e){}},{key:"GetValidBuffer",value:function(){return[]}},{key:"GetBuffer",value:function(){return[]}},{key:"SetCount",value:function(e){}}]),e}();t.FixedSetAllocator=c;var f=l((function e(t,i){o(this,e),this.second=L,this.first=t,this.second=i}));t.FixtureParticle=f;var d=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.apply(this,arguments)}return l(i,[{key:"Initialize",value:function(e,t){}},{key:"Find",value:function(e){return L}}]),i}(t.FixedSetAllocator);t.FixtureParticleSet=d;var m=l((function e(t,i){o(this,e),this.first=L,this.second=L,this.first=t,this.second=i}));t.ParticlePair=m;var _=function(e){s(i,e);var t=a(i);function i(){return o(this,i),t.apply(this,arguments)}return l(i,[{key:"Initialize",value:function(e,t){}},{key:"Find",value:function(e){return L}}]),i}(t.FixedSetAllocator);t.b2ParticlePairSet=_;var p=function(){function e(){o(this,e)}return l(e,[{key:"IsNecessary",value:function(e){return!0}},{key:"ShouldCreatePair",value:function(e,t){return!0}},{key:"ShouldCreateTriad",value:function(e,t,i){return!0}}]),e}();t.ConnectionFilter=p;var v=function(e){s(i,e);var t=a(i);function i(e,n,r,s){var a;return o(this,i),(a=t.call(this)).m_callDestructionListener=!1,a.m_destroyed=0,a.m_system=e,a.m_shape=n,a.m_xf=r,a.m_callDestructionListener=s,a.m_destroyed=0,a}return l(i,[{key:"ReportFixture",value:function(e){return!1}},{key:"ReportParticle",value:function(e,t){if(e!==this.m_system)return!1;if(!this.m_system.m_positionBuffer.data)throw new Error;return this.m_shape.TestPoint(this.m_xf,this.m_system.m_positionBuffer.data[t])&&(this.m_system.DestroyParticle(t,this.m_callDestructionListener),this.m_destroyed++),!0}},{key:"Destroyed",value:function(){return this.m_destroyed}}]),i}(cr);t.DestroyParticlesInShapeCallback=v;var g=function(e){s(i,e);var t=a(i);function i(e){var n;return o(this,i),(n=t.call(this)).m_threshold=0,n.m_threshold=e,n}return l(i,[{key:"ShouldCreatePair",value:function(e,t){return e<this.m_threshold&&this.m_threshold<=t||t<this.m_threshold&&this.m_threshold<=e}},{key:"ShouldCreateTriad",value:function(e,t,i){return(e<this.m_threshold||t<this.m_threshold||i<this.m_threshold)&&(this.m_threshold<=e||this.m_threshold<=t||this.m_threshold<=i)}}]),i}(t.ConnectionFilter);t.JoinParticleGroupsFilter=g;var x=function(t){s(n,t);var i=a(n);function n(t){var r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;return o(this,n),(r=i.call(this,e.b2ShapeType.e_unknown,0)).m_shapeCount=0,r.m_shapes=t,r.m_shapeCount=s,r}return l(n,[{key:"Clone",value:function(){throw new Error}},{key:"GetChildCount",value:function(){return 1}},{key:"TestPoint",value:function(e,t){for(var i=0;i<this.m_shapeCount;i++)if(this.m_shapes[i].TestPoint(e,t))return!0;return!1}},{key:"ComputeDistance",value:function(e,t,i,n){return 0}},{key:"RayCast",value:function(e,t,i,n){return!1}},{key:"ComputeAABB",value:function(e,t,i){var n=new Bt;e.lowerBound.x=+h,e.lowerBound.y=+h,e.upperBound.x=-h,e.upperBound.y=-h;for(var r=0;r<this.m_shapeCount;r++)for(var s=this.m_shapes[r].GetChildCount(),a=0;a<s;a++){var o=n;this.m_shapes[r].ComputeAABB(o,t,a),e.Combine1(o)}}},{key:"ComputeMass",value:function(e,t){}},{key:"SetupDistanceProxy",value:function(e,t){}},{key:"ComputeSubmergedArea",value:function(e,t,i,n){return 0}},{key:"Dump",value:function(e){}}]),n}(sn);t.CompositeShape=x;var b=function(t){s(n,t);var i=a(n);function n(e){var t;return o(this,n),(t=i.call(this)).m_flagsBuffer=e,t}return l(n,[{key:"IsNecessary",value:function(t){if(!this.m_flagsBuffer.data)throw new Error;return 0!==(this.m_flagsBuffer.data[t]&e.b2ParticleFlag.b2_reactiveParticle)}}]),n}(t.ConnectionFilter);t.ReactiveFilter=b;var w=function(i){s(r,i);var n=a(r);function r(e,t){var i;return o(this,r),(i=n.call(this,e)).m_contactFilter=t,i}return l(r,[{key:"ShouldCollideFixtureParticle",value:function(t,i,n){return!(this.m_contactFilter&&this.m_system.GetFlagsBuffer()[n]&e.b2ParticleFlag.b2_fixtureContactFilterParticle)||this.m_contactFilter.ShouldCollideFixtureParticle(t,this.m_system,n)}},{key:"ReportFixtureAndParticle",value:function(i,n,r){var s=t.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_n,a=t.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_rp;if(!this.m_system.m_flagsBuffer.data)throw new Error;if(!this.m_system.m_positionBuffer.data)throw new Error;var o=this.m_system.m_positionBuffer.data[r],l=s,u=i.ComputeDistance(o,l,n);if(u<this.m_system.m_particleDiameter&&this.ShouldCollideFixtureParticle(i,this.m_system,r)){var h=i.GetBody(),c=h.GetWorldCenter(),f=h.GetMass(),d=h.GetInertia()-f*h.GetLocalCenter().LengthSquared(),m=f>0?1/f:0,_=d>0?1/d:0,p=this.m_system.m_flagsBuffer.data[r]&e.b2ParticleFlag.b2_wallParticle?0:this.m_system.GetParticleInvMass(),v=ke.SubVV(o,c,a),y=ke.CrossVV(v,l),g=p+m+_*y*y,x=this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];x.index=r,x.body=h,x.fixture=i,x.weight=1-u*this.m_system.m_inverseDiameter,x.normal.Copy(l.SelfNeg()),x.mass=g>0?1/g:0,this.m_system.DetectStuckParticle(r)}}}]),r}(Hr);w.ReportFixtureAndParticle_s_n=new ke,w.ReportFixtureAndParticle_s_rp=new ke,t.UpdateBodyContactsCallback=w;var A=function(i){s(r,i);var n=a(r);function r(e,t){var i;return o(this,r),(i=n.call(this,e)).m_step=t,i}return l(r,[{key:"ReportFixtureAndParticle",value:function(i,n,r){var s=t.SolveCollisionCallback.ReportFixtureAndParticle_s_p1,a=t.SolveCollisionCallback.ReportFixtureAndParticle_s_output,o=t.SolveCollisionCallback.ReportFixtureAndParticle_s_input,l=t.SolveCollisionCallback.ReportFixtureAndParticle_s_p,u=t.SolveCollisionCallback.ReportFixtureAndParticle_s_v,h=t.SolveCollisionCallback.ReportFixtureAndParticle_s_f,c=i.GetBody();if(!this.m_system.m_positionBuffer.data)throw new Error;if(!this.m_system.m_velocityBuffer.data)throw new Error;var f=this.m_system.m_positionBuffer.data[r],d=this.m_system.m_velocityBuffer.data[r],m=a,_=o;if(0===this.m_system.m_iterationIndex){var p=Ee.MulTXV(c.m_xf0,f,s);i.GetShape().GetType()===e.b2ShapeType.e_circleShape&&(p.SelfSub(c.GetLocalCenter()),Le.MulRV(c.m_xf0.q,p,p),Le.MulTRV(c.m_xf.q,p,p),p.SelfAdd(c.GetLocalCenter())),Ee.MulXV(c.m_xf,p,_.p1)}else _.p1.Copy(f);if(ke.AddVMulSV(f,this.m_step.dt,d,_.p2),_.maxFraction=1,i.RayCast(m,_,n)){var v=m.normal,g=l;g.x=(1-m.fraction)*_.p1.x+m.fraction*_.p2.x+y*v.x,g.y=(1-m.fraction)*_.p1.y+m.fraction*_.p2.y+y*v.y;var x=u;x.x=this.m_step.inv_dt*(g.x-f.x),x.y=this.m_step.inv_dt*(g.y-f.y),this.m_system.m_velocityBuffer.data[r].Copy(x);var b=h;b.x=this.m_step.inv_dt*this.m_system.GetParticleMass()*(d.x-x.x),b.y=this.m_step.inv_dt*this.m_system.GetParticleMass()*(d.y-x.y),this.m_system.ParticleApplyForce(r,b)}}},{key:"ReportParticle",value:function(e,t){return!1}}]),r}(Hr);A.ReportFixtureAndParticle_s_p1=new ke,A.ReportFixtureAndParticle_s_output=new kt,A.ReportFixtureAndParticle_s_input=new Ct,A.ReportFixtureAndParticle_s_p=new ke,A.ReportFixtureAndParticle_s_v=new ke,A.ReportFixtureAndParticle_s_f=new ke,t.SolveCollisionCallback=A}(Kr||(Kr={}));var $r=function(){function t(e){o(this,t),this.m_newFixture=!1,this.m_locked=!1,this.m_clearForces=!0,this.m_contactManager=new dr,this.m_bodyList=null,this.m_jointList=null,this.m_particleSystemList=null,this.m_bodyCount=0,this.m_jointCount=0,this.m_gravity=new ke,this.m_allowSleep=!0,this.m_destructionListener=null,this.m_debugDraw=null,this.m_inv_dt0=0,this.m_warmStarting=!0,this.m_continuousPhysics=!0,this.m_subStepping=!1,this.m_stepComplete=!0,this.m_profile=new mr,this.m_island=new kr,this.s_stack=[],this.m_controllerList=null,this.m_controllerCount=0,this.m_gravity.Copy(e)}return l(t,[{key:"SetDestructionListener",value:function(e){this.m_destructionListener=e}},{key:"SetContactFilter",value:function(e){this.m_contactManager.m_contactFilter=e}},{key:"SetContactListener",value:function(e){this.m_contactManager.m_contactListener=e}},{key:"SetDebugDraw",value:function(e){this.m_debugDraw=e}},{key:"CreateBody",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.IsLocked())throw new Error;var t=new yn(e,this);return t.m_prev=null,t.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount,t}},{key:"DestroyBody",value:function(e){if(this.IsLocked())throw new Error;for(var t=e.m_jointList;t;){var i=t;t=t.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint),e.m_jointList=t}e.m_jointList=null;for(var n=e.m_controllerList;n;){var r=n;n=n.nextController,r.controller.RemoveBody(e)}for(var s=e.m_contactList;s;){var a=s;s=s.next,this.m_contactManager.Destroy(a.contact)}e.m_contactList=null;for(var o=e.m_fixtureList;o;){var l=o;o=o.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxies(),l.Destroy(),e.m_fixtureList=o,e.m_fixtureCount-=1}e.m_fixtureList=null,e.m_fixtureCount=0,e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_bodyList&&(this.m_bodyList=e.m_next),--this.m_bodyCount}},{key:"CreateJoint",value:function(e){if(this.IsLocked())throw new Error;var i=t._Joint_Create(e,null);i.m_prev=null,i.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=i),this.m_jointList=i,++this.m_jointCount,i.m_edgeA.prev=null,i.m_edgeA.next=i.m_bodyA.m_jointList,i.m_bodyA.m_jointList&&(i.m_bodyA.m_jointList.prev=i.m_edgeA),i.m_bodyA.m_jointList=i.m_edgeA,i.m_edgeB.prev=null,i.m_edgeB.next=i.m_bodyB.m_jointList,i.m_bodyB.m_jointList&&(i.m_bodyB.m_jointList.prev=i.m_edgeB),i.m_bodyB.m_jointList=i.m_edgeB;var n=e.bodyA,r=e.bodyB;if(!e.collideConnected)for(var s=r.GetContactList();s;)s.other===n&&s.contact.FlagForFiltering(),s=s.next;return i}},{key:"DestroyJoint",value:function(e){if(this.IsLocked())throw new Error;var i=e.m_collideConnected;e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_jointList&&(this.m_jointList=e.m_next);var n=e.m_bodyA,r=e.m_bodyB;if(n.SetAwake(!0),r.SetAwake(!0),e.m_edgeA.prev&&(e.m_edgeA.prev.next=e.m_edgeA.next),e.m_edgeA.next&&(e.m_edgeA.next.prev=e.m_edgeA.prev),e.m_edgeA===n.m_jointList&&(n.m_jointList=e.m_edgeA.next),e.m_edgeA.prev=null,e.m_edgeA.next=null,e.m_edgeB.prev&&(e.m_edgeB.prev.next=e.m_edgeB.next),e.m_edgeB.next&&(e.m_edgeB.next.prev=e.m_edgeB.prev),e.m_edgeB===r.m_jointList&&(r.m_jointList=e.m_edgeB.next),e.m_edgeB.prev=null,e.m_edgeB.next=null,t._Joint_Destroy(e,null),--this.m_jointCount,!i)for(var s=r.GetContactList();s;)s.other===n&&s.contact.FlagForFiltering(),s=s.next}},{key:"CreateParticleSystem",value:function(e){if(this.IsLocked())throw new Error;var t=new Kr(e,this);return t.m_prev=null,t.m_next=this.m_particleSystemList,this.m_particleSystemList&&(this.m_particleSystemList.m_prev=t),this.m_particleSystemList=t,t}},{key:"DestroyParticleSystem",value:function(e){if(this.IsLocked())throw new Error;e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_particleSystemList&&(this.m_particleSystemList=e.m_next)}},{key:"CalculateReasonableParticleIterations",value:function(e){if(null===this.m_particleSystemList)return 1;function t(e){for(var t=h,i=e.GetParticleSystemList();null!==i;i=i.m_next)t=oe(t,i.GetRadius());return t}return Vr(this.m_gravity.Length(),t(this),e)}},{key:"Step",value:function(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.CalculateReasonableParticleIterations(e),s=t.Step_s_stepTimer.Reset();this.m_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_newFixture=!1),this.m_locked=!0;var a=t.Step_s_step;a.dt=e,a.velocityIterations=i,a.positionIterations=n,a.particleIterations=r,a.inv_dt=e>0?1/e:0,a.dtRatio=this.m_inv_dt0*e,a.warmStarting=this.m_warmStarting;var o=t.Step_s_timer.Reset();if(this.m_contactManager.Collide(),this.m_profile.collide=o.GetMilliseconds(),this.m_stepComplete&&a.dt>0){for(var l=t.Step_s_timer.Reset(),u=this.m_particleSystemList;u;u=u.m_next)u.Solve(a);this.Solve(a),this.m_profile.solve=l.GetMilliseconds()}if(this.m_continuousPhysics&&a.dt>0){var h=t.Step_s_timer.Reset();this.SolveTOI(a),this.m_profile.solveTOI=h.GetMilliseconds()}a.dt>0&&(this.m_inv_dt0=a.inv_dt),this.m_clearForces&&this.ClearForces(),this.m_locked=!1,this.m_profile.step=s.GetMilliseconds()}},{key:"ClearForces",value:function(){for(var e=this.m_bodyList;e;e=e.m_next)e.m_force.SetZero(),e.m_torque=0}},{key:"DrawParticleSystem",value:function(e){if(null!==this.m_debugDraw){var t=e.GetParticleCount();if(t){var i=e.GetRadius(),n=e.GetPositionBuffer();if(e.m_colorBuffer.data){var r=e.GetColorBuffer();this.m_debugDraw.DrawParticles(n,i,r,t)}else this.m_debugDraw.DrawParticles(n,i,null,t)}}}},{key:"DrawDebugData",value:function(){if(null!==this.m_debugDraw){var i=this.m_debugDraw.GetFlags(),n=t.DrawDebugData_s_color.SetRGB(0,0,0);if(i&e.b2DrawFlags.e_shapeBit)for(var r=this.m_bodyList;r;r=r.m_next){var s=r.m_xf;this.m_debugDraw.PushTransform(s);for(var a=r.GetFixtureList();a;a=a.m_next)r.IsActive()?r.GetType()===e.b2BodyType.b2_staticBody?(n.SetRGB(.5,.9,.5),this.DrawShape(a,n)):r.GetType()===e.b2BodyType.b2_kinematicBody?(n.SetRGB(.5,.5,.9),this.DrawShape(a,n)):r.IsAwake()?(n.SetRGB(.9,.7,.7),this.DrawShape(a,n)):(n.SetRGB(.6,.6,.6),this.DrawShape(a,n)):(n.SetRGB(.5,.5,.3),this.DrawShape(a,n));this.m_debugDraw.PopTransform(s)}if(i&e.b2DrawFlags.e_particleBit)for(var o=this.m_particleSystemList;o;o=o.m_next)this.DrawParticleSystem(o);if(i&e.b2DrawFlags.e_jointBit)for(var l=this.m_jointList;l;l=l.m_next)this.DrawJoint(l);if(i&e.b2DrawFlags.e_aabbBit){n.SetRGB(.9,.3,.9);for(var u=t.DrawDebugData_s_vs,h=this.m_bodyList;h;h=h.m_next)if(h.IsActive())for(var c=h.GetFixtureList();c;c=c.m_next)for(var f=0;f<c.m_proxyCount;++f){var d=c.m_proxies[f].treeNode.aabb;u[0].Set(d.lowerBound.x,d.lowerBound.y),u[1].Set(d.upperBound.x,d.lowerBound.y),u[2].Set(d.upperBound.x,d.upperBound.y),u[3].Set(d.lowerBound.x,d.upperBound.y),this.m_debugDraw.DrawPolygon(u,4,n)}}if(i&e.b2DrawFlags.e_centerOfMassBit)for(var m=this.m_bodyList;m;m=m.m_next){var _=t.DrawDebugData_s_xf;_.q.Copy(m.m_xf.q),_.p.Copy(m.GetWorldCenter()),this.m_debugDraw.DrawTransform(_)}if(i&e.b2DrawFlags.e_controllerBit)for(var p=this.m_controllerList;p;p=p.m_next)p.Draw(this.m_debugDraw)}}},{key:"QueryAABB",value:function(e,t,i){if(this.m_contactManager.m_broadPhase.Query(t,(function(t){var n=t.userData.fixture;return e?e.ReportFixture(n):!i||i(n)})),e instanceof cr)for(var n=this.m_particleSystemList;n;n=n.m_next)e.ShouldQueryParticleSystem(n)&&n.QueryAABB(e,t)}},{key:"QueryAllAABB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.QueryAABB(null,e,(function(e){return t.push(e),!0})),t}},{key:"QueryPointAABB",value:function(e,t,i){if(this.m_contactManager.m_broadPhase.QueryPoint(t,(function(t){var n=t.userData.fixture;return e?e.ReportFixture(n):!i||i(n)})),e instanceof cr)for(var n=this.m_particleSystemList;n;n=n.m_next)e.ShouldQueryParticleSystem(n)&&n.QueryPointAABB(e,t)}},{key:"QueryAllPointAABB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.QueryPointAABB(null,e,(function(e){return t.push(e),!0})),t}},{key:"QueryFixtureShape",value:function(e,i,n,r,s){var a=t.QueryFixtureShape_s_aabb;if(i.ComputeAABB(a,r,n),this.m_contactManager.m_broadPhase.Query(a,(function(t){var a=t.userData,o=a.fixture;if(It(i,n,o.GetShape(),a.childIndex,r,o.GetBody().GetTransform())){if(e)return e.ReportFixture(o);if(s)return s(o)}return!0})),e instanceof cr)for(var o=this.m_particleSystemList;o;o=o.m_next)e.ShouldQueryParticleSystem(o)&&o.QueryAABB(e,a)}},{key:"QueryAllFixtureShape",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return this.QueryFixtureShape(null,e,t,i,(function(e){return n.push(e),!0})),n}},{key:"QueryFixturePoint",value:function(e,t,i){if(this.m_contactManager.m_broadPhase.QueryPoint(t,(function(n){var r=n.userData.fixture;if(r.TestPoint(t)){if(e)return e.ReportFixture(r);if(i)return i(r)}return!0})),e)for(var n=this.m_particleSystemList;n;n=n.m_next)e.ShouldQueryParticleSystem(n)&&n.QueryPointAABB(e,t)}},{key:"QueryAllFixturePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.QueryFixturePoint(null,e,(function(e){return t.push(e),!0})),t}},{key:"RayCast",value:function(e,i,n,r){var s=t.RayCast_s_input;if(s.maxFraction=1,s.p1.Copy(i),s.p2.Copy(n),this.m_contactManager.m_broadPhase.RayCast(s,(function(s,a){var o=a.userData,l=o.fixture,u=o.childIndex,h=t.RayCast_s_output;if(l.RayCast(h,s,u)){var c=h.fraction,f=t.RayCast_s_point;if(f.Set((1-c)*i.x+c*n.x,(1-c)*i.y+c*n.y),e)return e.ReportFixture(l,f,h.normal,c);if(r)return r(l,f,h.normal,c)}return s.maxFraction})),e)for(var a=this.m_particleSystemList;a;a=a.m_next)e.ShouldQueryParticleSystem(a)&&a.RayCast(e,i,n)}},{key:"RayCastOne",value:function(e,t){var i=null,n=1;return this.RayCast(null,e,t,(function(e,t,r,s){return s<n&&(n=s,i=e),n})),i}},{key:"RayCastAll",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.RayCast(null,e,t,(function(e,t,n,r){return i.push(e),1})),i}},{key:"GetBodyList",value:function(){return this.m_bodyList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetParticleSystemList",value:function(){return this.m_particleSystemList}},{key:"GetContactList",value:function(){return this.m_contactManager.m_contactList}},{key:"SetAllowSleeping",value:function(e){if(e!==this.m_allowSleep&&(this.m_allowSleep=e,!this.m_allowSleep))for(var t=this.m_bodyList;t;t=t.m_next)t.SetAwake(!0)}},{key:"GetAllowSleeping",value:function(){return this.m_allowSleep}},{key:"SetWarmStarting",value:function(e){this.m_warmStarting=e}},{key:"GetWarmStarting",value:function(){return this.m_warmStarting}},{key:"SetContinuousPhysics",value:function(e){this.m_continuousPhysics=e}},{key:"GetContinuousPhysics",value:function(){return this.m_continuousPhysics}},{key:"SetSubStepping",value:function(e){this.m_subStepping=e}},{key:"GetSubStepping",value:function(){return this.m_subStepping}},{key:"GetProxyCount",value:function(){return this.m_contactManager.m_broadPhase.GetProxyCount()}},{key:"GetBodyCount",value:function(){return this.m_bodyCount}},{key:"GetJointCount",value:function(){return this.m_jointCount}},{key:"GetContactCount",value:function(){return this.m_contactManager.m_contactCount}},{key:"GetTreeHeight",value:function(){return this.m_contactManager.m_broadPhase.GetTreeHeight()}},{key:"GetTreeBalance",value:function(){return this.m_contactManager.m_broadPhase.GetTreeBalance()}},{key:"GetTreeQuality",value:function(){return this.m_contactManager.m_broadPhase.GetTreeQuality()}},{key:"SetGravity",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!ke.IsEqualToV(this.m_gravity,e)&&(this.m_gravity.Copy(e),t))for(var i=this.m_bodyList;i;i=i.m_next)i.SetAwake(!0)}},{key:"GetGravity",value:function(){return this.m_gravity}},{key:"IsLocked",value:function(){return this.m_locked}},{key:"SetAutoClearForces",value:function(e){this.m_clearForces=e}},{key:"GetAutoClearForces",value:function(){return this.m_clearForces}},{key:"ShiftOrigin",value:function(e){if(this.IsLocked())throw new Error;for(var t=this.m_bodyList;t;t=t.m_next)t.m_xf.p.SelfSub(e),t.m_sweep.c0.SelfSub(e),t.m_sweep.c.SelfSub(e);for(var i=this.m_jointList;i;i=i.m_next)i.ShiftOrigin(e);this.m_contactManager.m_broadPhase.ShiftOrigin(e)}},{key:"GetContactManager",value:function(){return this.m_contactManager}},{key:"GetProfile",value:function(){return this.m_profile}},{key:"Dump",value:function(t){if(!this.m_locked){t("const g: b2Vec2 = new b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y),t("this.m_world.SetGravity(g);\n"),t("const bodies: b2Body[] = [];\n"),t("const joints: b2Joint[] = [];\n");for(var i=0,n=this.m_bodyList;n;n=n.m_next)n.m_islandIndex=i,n.Dump(t),++i;i=0;for(var r=this.m_jointList;r;r=r.m_next)r.m_index=i,++i;for(var s=this.m_jointList;s;s=s.m_next)s.m_type!==e.b2JointType.e_gearJoint&&(t("{\n"),s.Dump(t),t("}\n"));for(var a=this.m_jointList;a;a=a.m_next)a.m_type===e.b2JointType.e_gearJoint&&(t("{\n"),a.Dump(t),t("}\n"))}}},{key:"DrawJoint",value:function(i){if(null!==this.m_debugDraw){var n=i.GetBodyA(),r=i.GetBodyB(),s=n.m_xf,a=r.m_xf,o=s.p,l=a.p,u=i.GetAnchorA(t.DrawJoint_s_p1),h=i.GetAnchorB(t.DrawJoint_s_p2),c=t.DrawJoint_s_color.SetRGB(.5,.8,.8);switch(i.m_type){case e.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(u,h,c);break;case e.b2JointType.e_pulleyJoint:var f=i,d=f.GetGroundAnchorA(),m=f.GetGroundAnchorB();this.m_debugDraw.DrawSegment(d,u,c),this.m_debugDraw.DrawSegment(m,h,c),this.m_debugDraw.DrawSegment(d,m,c);break;case e.b2JointType.e_mouseJoint:var _=t.DrawJoint_s_c;_.Set(0,1,0),this.m_debugDraw.DrawPoint(u,4,_),this.m_debugDraw.DrawPoint(h,4,_),_.Set(.8,.8,.8),this.m_debugDraw.DrawSegment(u,h,_);break;default:this.m_debugDraw.DrawSegment(o,u,c),this.m_debugDraw.DrawSegment(u,h,c),this.m_debugDraw.DrawSegment(l,h,c)}}}},{key:"DrawShape",value:function(i,n){if(null!==this.m_debugDraw){var r=i.GetShape();switch(r.m_type){case e.b2ShapeType.e_circleShape:var s=r,a=s.m_p,o=s.m_radius,l=ke.UNITX;this.m_debugDraw.DrawSolidCircle(a,o,l,n);break;case e.b2ShapeType.e_edgeShape:var u=r,h=u.m_vertex1,c=u.m_vertex2;this.m_debugDraw.DrawSegment(h,c,n);break;case e.b2ShapeType.e_chainShape:var f=r,d=f.m_count,m=f.m_vertices,_=t.DrawShape_s_ghostColor.SetRGBA(.75*n.r,.75*n.g,.75*n.b,n.a),p=m[0];if(this.m_debugDraw.DrawPoint(p,4,n),f.m_hasPrevVertex){var v=f.m_prevVertex;this.m_debugDraw.DrawSegment(v,p,_),this.m_debugDraw.DrawCircle(v,.1,_)}for(var y=1;y<d;++y){var g=m[y];this.m_debugDraw.DrawSegment(p,g,n),this.m_debugDraw.DrawPoint(g,4,n),p=g}if(f.m_hasNextVertex){var x=f.m_nextVertex;this.m_debugDraw.DrawSegment(x,p,_),this.m_debugDraw.DrawCircle(x,.1,_)}break;case e.b2ShapeType.e_polygonShape:var b=r,w=b.m_count,A=b.m_vertices;this.m_debugDraw.DrawSolidPolygon(A,w,n)}}}},{key:"Solve",value:function(t){for(var i=this.m_bodyList;i;i=i.m_next)i.m_xf0.Copy(i.m_xf);for(var n=this.m_controllerList;n;n=n.m_next)n.Step(t);this.m_profile.solveInit=0,this.m_profile.solveVelocity=0,this.m_profile.solvePosition=0;var r=this.m_island;r.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener);for(var s=this.m_bodyList;s;s=s.m_next)s.m_islandFlag=!1;for(var a=this.m_contactManager.m_contactList;a;a=a.m_next)a.m_islandFlag=!1;for(var o=this.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var l=this.s_stack,u=this.m_bodyList;u;u=u.m_next)if(!u.m_islandFlag&&u.IsAwake()&&u.IsActive()&&u.GetType()!==e.b2BodyType.b2_staticBody){r.Clear();var h=0;for(l[h++]=u,u.m_islandFlag=!0;h>0;){var c=l[--h];if(!c)throw new Error;if(r.AddBody(c),c.m_awakeFlag=!0,c.GetType()!==e.b2BodyType.b2_staticBody){for(var f=c.m_contactList;f;f=f.next){var d=f.contact;if(!d.m_islandFlag&&d.IsEnabled()&&d.IsTouching()){var m=d.m_fixtureA.m_isSensor,_=d.m_fixtureB.m_isSensor;if(!m&&!_){r.AddContact(d),d.m_islandFlag=!0;var p=f.other;if(!p)throw new Error;p.m_islandFlag||(l[h++]=p,p.m_islandFlag=!0)}}}for(var v=c.m_jointList;v;v=v.next)if(!v.joint.m_islandFlag){var y=v.other;y.IsActive()&&(r.AddJoint(v.joint),v.joint.m_islandFlag=!0,y.m_islandFlag||(l[h++]=y,y.m_islandFlag=!0))}}}var g=new mr;r.Solve(g,t,this.m_gravity,this.m_allowSleep),this.m_profile.solveInit+=g.solveInit,this.m_profile.solveVelocity+=g.solveVelocity,this.m_profile.solvePosition+=g.solvePosition;for(var x=0;x<r.m_bodyCount;++x){var b=r.m_bodies[x];b.GetType()===e.b2BodyType.b2_staticBody&&(b.m_islandFlag=!1)}}for(var w=0;w<l.length&&l[w];++w)l[w]=null;for(var A=new De,S=this.m_bodyList;S;S=S.m_next)S.m_islandFlag&&S.GetType()!==e.b2BodyType.b2_staticBody&&S.SynchronizeFixtures();this.m_contactManager.FindNewContacts(),this.m_profile.broadphase=A.GetMilliseconds()}},{key:"SolveTOI",value:function(i){var n=this.m_island;if(n.Initialize(2*w,w,0,null,this.m_contactManager.m_contactListener),this.m_stepComplete){for(var r=this.m_bodyList;r;r=r.m_next)r.m_islandFlag=!1,r.m_sweep.alpha0=0;for(var s=this.m_contactManager.m_contactList;s;s=s.m_next)s.m_toiFlag=!1,s.m_islandFlag=!1,s.m_toiCount=0,s.m_toi=1}for(;;){for(var a=null,o=1,l=this.m_contactManager.m_contactList;l;l=l.m_next)if(l.IsEnabled()&&!(l.m_toiCount>b)){var u=1;if(l.m_toiFlag)u=l.m_toi;else{var h=l.GetFixtureA(),f=l.GetFixtureB();if(h.IsSensor()||f.IsSensor())continue;var d=h.GetBody(),m=f.GetBody(),_=d.m_type,p=m.m_type,v=d.IsAwake()&&_!==e.b2BodyType.b2_staticBody,y=m.IsAwake()&&p!==e.b2BodyType.b2_staticBody;if(!v&&!y)continue;var g=d.IsBullet()||_!==e.b2BodyType.b2_dynamicBody,x=m.IsBullet()||p!==e.b2BodyType.b2_dynamicBody;if(!g&&!x)continue;var A=d.m_sweep.alpha0;d.m_sweep.alpha0<m.m_sweep.alpha0?(A=m.m_sweep.alpha0,d.m_sweep.Advance(A)):m.m_sweep.alpha0<d.m_sweep.alpha0&&(A=d.m_sweep.alpha0,m.m_sweep.Advance(A));var S=l.GetChildIndexA(),M=l.GetChildIndexB(),C=t.SolveTOI_s_toi_input;C.proxyA.SetShape(h.GetShape(),S),C.proxyB.SetShape(f.GetShape(),M),C.sweepA.Copy(d.m_sweep),C.sweepB.Copy(m.m_sweep),C.tMax=1;var k=t.SolveTOI_s_toi_output;ui(k,C);var B=k.t;u=k.state===e.b2TOIOutputState.e_touching?oe(A+(1-A)*B,1):1,l.m_toi=u,l.m_toiFlag=!0}u<o&&(a=l,o=u)}if(null===a||1-10*c<o){this.m_stepComplete=!0;break}var V=a.GetFixtureA(),T=a.GetFixtureB(),P=V.GetBody(),L=T.GetBody(),E=t.SolveTOI_s_backup1.Copy(P.m_sweep),I=t.SolveTOI_s_backup2.Copy(L.m_sweep);if(P.Advance(o),L.Advance(o),a.Update(this.m_contactManager.m_contactListener),a.m_toiFlag=!1,++a.m_toiCount,a.IsEnabled()&&a.IsTouching()){P.SetAwake(!0),L.SetAwake(!0),n.Clear(),n.AddBody(P),n.AddBody(L),n.AddContact(a),P.m_islandFlag=!0,L.m_islandFlag=!0,a.m_islandFlag=!0;for(var R=0;R<2;++R){var F=0===R?P:L;if(F.m_type===e.b2BodyType.b2_dynamicBody)for(var G=F.m_contactList;G&&n.m_bodyCount!==n.m_bodyCapacity&&n.m_contactCount!==n.m_contactCapacity;G=G.next){var D=G.contact;if(!D.m_islandFlag){var O=G.other;if(O.m_type!==e.b2BodyType.b2_dynamicBody||F.IsBullet()||O.IsBullet()){var N=D.m_fixtureA.m_isSensor,z=D.m_fixtureB.m_isSensor;if(!N&&!z){var U=t.SolveTOI_s_backup.Copy(O.m_sweep);O.m_islandFlag||O.Advance(o),D.Update(this.m_contactManager.m_contactListener),D.IsEnabled()&&D.IsTouching()?(D.m_islandFlag=!0,n.AddContact(D),O.m_islandFlag||(O.m_islandFlag=!0,O.m_type!==e.b2BodyType.b2_staticBody&&O.SetAwake(!0),n.AddBody(O))):(O.m_sweep.Copy(U),O.SynchronizeTransform())}}}}}var j=t.SolveTOI_s_subStep;j.dt=(1-o)*i.dt,j.inv_dt=1/j.dt,j.dtRatio=1,j.positionIterations=20,j.velocityIterations=i.velocityIterations,j.particleIterations=i.particleIterations,j.warmStarting=!1,n.SolveTOI(j,P.m_islandIndex,L.m_islandIndex);for(var W=0;W<n.m_bodyCount;++W){var q=n.m_bodies[W];if(q.m_islandFlag=!1,q.m_type===e.b2BodyType.b2_dynamicBody){q.SynchronizeFixtures();for(var H=q.m_contactList;H;H=H.next)H.contact.m_toiFlag=!1,H.contact.m_islandFlag=!1}}if(this.m_contactManager.FindNewContacts(),this.m_subStepping){this.m_stepComplete=!1;break}}else a.SetEnabled(!1),P.m_sweep.Copy(E),L.m_sweep.Copy(I),P.SynchronizeTransform(),L.SynchronizeTransform()}}},{key:"AddController",value:function(e){return e.m_next=this.m_controllerList,e.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=e),this.m_controllerList=e,++this.m_controllerCount,e}},{key:"RemoveController",value:function(e){return e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),this.m_controllerList===e&&(this.m_controllerList=e.m_next),--this.m_controllerCount,e.m_prev=null,e.m_next=null,e}}],[{key:"_Joint_Create",value:function(t,i){switch(t.type){case e.b2JointType.e_distanceJoint:return new Sn(t);case e.b2JointType.e_mouseJoint:return new In(t);case e.b2JointType.e_prismaticJoint:return new Fn(t);case e.b2JointType.e_revoluteJoint:return new zn(t);case e.b2JointType.e_pulleyJoint:return new On(t);case e.b2JointType.e_gearJoint:return new Tn(t);case e.b2JointType.e_wheelJoint:return new Xn(t);case e.b2JointType.e_weldJoint:return new qn(t);case e.b2JointType.e_frictionJoint:return new Bn(t);case e.b2JointType.e_ropeJoint:return new jn(t);case e.b2JointType.e_motorJoint:return new Ln(t);case e.b2JointType.e_areaJoint:return new Cn(t)}throw new Error}},{key:"_Joint_Destroy",value:function(e,t){}}]),t}();$r.Step_s_step=new _r,$r.Step_s_stepTimer=new De,$r.Step_s_timer=new De,$r.DrawDebugData_s_color=new Fe(0,0,0),$r.DrawDebugData_s_vs=ke.MakeArray(4),$r.DrawDebugData_s_xf=new Ee,$r.QueryFixtureShape_s_aabb=new Bt,$r.RayCast_s_input=new Ct,$r.RayCast_s_output=new kt,$r.RayCast_s_point=new ke,$r.DrawJoint_s_p1=new ke,$r.DrawJoint_s_p2=new ke,$r.DrawJoint_s_color=new Fe(.5,.8,.8),$r.DrawJoint_s_c=new Fe,$r.DrawShape_s_ghostColor=new Fe,$r.SolveTOI_s_subStep=new _r,$r.SolveTOI_s_backup=new Re,$r.SolveTOI_s_backup1=new Re,$r.SolveTOI_s_backup2=new Re,$r.SolveTOI_s_toi_input=new Zt,$r.SolveTOI_s_toi_output=new Kt;var es=l((function e(t,i){o(this,e),this.prevBody=null,this.nextBody=null,this.prevController=null,this.nextController=null,this.controller=t,this.body=i})),ts=function(){function e(){o(this,e),this.m_bodyList=null,this.m_bodyCount=0,this.m_prev=null,this.m_next=null}return l(e,[{key:"GetNext",value:function(){return this.m_next}},{key:"GetPrev",value:function(){return this.m_prev}},{key:"GetBodyList",value:function(){return this.m_bodyList}},{key:"AddBody",value:function(e){var t=new es(this,e);t.nextBody=this.m_bodyList,t.prevBody=null,this.m_bodyList&&(this.m_bodyList.prevBody=t),this.m_bodyList=t,++this.m_bodyCount,t.nextController=e.m_controllerList,t.prevController=null,e.m_controllerList&&(e.m_controllerList.prevController=t),e.m_controllerList=t,++e.m_controllerCount}},{key:"RemoveBody",value:function(e){if(this.m_bodyCount<=0)throw new Error;for(var t=this.m_bodyList;t&&t.body!==e;)t=t.nextBody;if(null===t)throw new Error;t.prevBody&&(t.prevBody.nextBody=t.nextBody),t.nextBody&&(t.nextBody.prevBody=t.prevBody),this.m_bodyList===t&&(this.m_bodyList=t.nextBody),--this.m_bodyCount,t.nextController&&(t.nextController.prevController=t.prevController),t.prevController&&(t.prevController.nextController=t.nextController),e.m_controllerList===t&&(e.m_controllerList=t.nextController),--e.m_controllerCount}},{key:"Clear",value:function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0}}]),e}(),is=function(e){s(i,e);var t=a(i);function i(){var e;return o(this,i),(e=t.apply(this,arguments)).normal=new ke(0,1),e.offset=0,e.density=0,e.velocity=new ke(0,0),e.linearDrag=0,e.angularDrag=0,e.useDensity=!1,e.useWorldGravity=!0,e.gravity=new ke(0,0),e}return l(i,[{key:"Step",value:function(e){if(this.m_bodyList){this.useWorldGravity&&this.gravity.Copy(this.m_bodyList.body.GetWorld().GetGravity());for(var t=this.m_bodyList;t;t=t.nextBody){var i=t.body;if(i.IsAwake()){for(var n=new ke,r=new ke,s=0,a=0,o=i.GetFixtureList();o;o=o.m_next){var l=new ke,u=o.GetShape().ComputeSubmergedArea(this.normal,this.offset,i.GetTransform(),l);s+=u,n.x+=u*l.x,n.y+=u*l.y;var h=0;a+=u*(h=this.useDensity?o.GetDensity():1),r.x+=u*l.x*h,r.y+=u*l.y*h}if(n.x/=s,n.y/=s,r.x/=a,r.y/=a,!(s<c)){var f=this.gravity.Clone().SelfNeg();f.SelfMul(this.density*s),i.ApplyForce(f,r);var d=i.GetLinearVelocityFromWorldPoint(n,new ke);d.SelfSub(this.velocity),d.SelfMul(-this.linearDrag*s),i.ApplyForce(d,n),i.ApplyTorque(-i.GetInertia()/i.GetMass()*s*i.GetAngularVelocity()*this.angularDrag)}}}}}},{key:"Draw",value:function(e){var t=100,i=new ke,n=new ke;i.x=this.normal.x*this.offset+this.normal.y*t,i.y=this.normal.y*this.offset-this.normal.x*t,n.x=this.normal.x*this.offset-this.normal.y*t,n.y=this.normal.y*this.offset+this.normal.x*t;var r=new Fe(0,0,.8);e.DrawSegment(i,n,r)}}]),i}(ts),ns=function(e){s(i,e);var t=a(i);function i(){var e;return o(this,i),(e=t.apply(this,arguments)).A=new ke(0,0),e}return l(i,[{key:"Step",value:function(e){for(var t=ke.MulSV(e.dt,this.A,i.Step_s_dtA),n=this.m_bodyList;n;n=n.nextBody){var r=n.body;r.IsAwake()&&r.SetLinearVelocity(ke.AddVV(r.GetLinearVelocity(),t,ke.s_t0))}}},{key:"Draw",value:function(e){}}]),i}(ts);ns.Step_s_dtA=new ke;var rs=function(e){s(i,e);var t=a(i);function i(){var e;return o(this,i),(e=t.apply(this,arguments)).F=new ke(0,0),e}return l(i,[{key:"Step",value:function(e){for(var t=this.m_bodyList;t;t=t.nextBody){var i=t.body;i.IsAwake()&&i.ApplyForce(this.F,i.GetWorldCenter())}}},{key:"Draw",value:function(e){}}]),i}(ts),ss=function(e){s(i,e);var t=a(i);function i(){var e;return o(this,i),(e=t.apply(this,arguments)).G=1,e.invSqr=!0,e}return l(i,[{key:"Step",value:function(e){if(this.invSqr)for(var t=this.m_bodyList;t;t=t.nextBody)for(var n=t.body,r=n.GetWorldCenter(),s=n.GetMass(),a=this.m_bodyList;a&&a!==t;a=a.nextBody){var o=a.body,l=o.GetWorldCenter(),u=o.GetMass(),h=l.x-r.x,f=l.y-r.y,d=h*h+f*f;if(!(d<c)){var m=i.Step_s_f.Set(h,f);m.SelfMul(this.G/d/me(d)*s*u),n.IsAwake()&&n.ApplyForce(m,r),o.IsAwake()&&o.ApplyForce(m.SelfMul(-1),l)}}else for(var _=this.m_bodyList;_;_=_.nextBody)for(var p=_.body,v=p.GetWorldCenter(),y=p.GetMass(),g=this.m_bodyList;g&&g!==_;g=g.nextBody){var x=g.body,b=x.GetWorldCenter(),w=x.GetMass(),A=b.x-v.x,S=b.y-v.y,M=A*A+S*S;if(!(M<c)){var C=i.Step_s_f.Set(A,S);C.SelfMul(this.G/M*y*w),p.IsAwake()&&p.ApplyForce(C,v),x.IsAwake()&&x.ApplyForce(C.SelfMul(-1),b)}}}},{key:"Draw",value:function(e){}}]),i}(ts);ss.Step_s_f=new ke;var as=function(e){s(i,e);var t=a(i);function i(){var e;return o(this,i),(e=t.apply(this,arguments)).T=new Te,e.maxTimestep=0,e}return l(i,[{key:"Step",value:function(e){var t=e.dt;if(!(t<=c)){t>this.maxTimestep&&this.maxTimestep>0&&(t=this.maxTimestep);for(var n=this.m_bodyList;n;n=n.nextBody){var r=n.body;if(r.IsAwake()){var s=r.GetWorldVector(Te.MulMV(this.T,r.GetLocalVector(r.GetLinearVelocity(),ke.s_t0),ke.s_t1),i.Step_s_damping);r.SetLinearVelocity(ke.AddVV(r.GetLinearVelocity(),ke.MulSV(t,s,ke.s_t0),ke.s_t1))}}}}},{key:"Draw",value:function(e){}},{key:"SetAxisAligned",value:function(e,t){this.T.ex.x=-e,this.T.ex.y=0,this.T.ey.x=0,this.T.ey.y=-t,this.maxTimestep=e>0||t>0?1/le(e,t):0}}]),i}(ts);as.Step_s_damping=new ke;var os=l((function e(){o(this,e),this.vertices=[],this.count=0,this.masses=[],this.gravity=new ke(0,0),this.damping=.1,this.k2=.9,this.k3=.1})),ls=function(){function e(){o(this,e),this.m_count=0,this.m_ps=[],this.m_p0s=[],this.m_vs=[],this.m_ims=[],this.m_Ls=[],this.m_as=[],this.m_gravity=new ke,this.m_damping=0,this.m_k2=1,this.m_k3=.1}return l(e,[{key:"GetVertexCount",value:function(){return this.m_count}},{key:"GetVertices",value:function(){return this.m_ps}},{key:"Initialize",value:function(e){this.m_count=e.count,this.m_ps=ke.MakeArray(this.m_count),this.m_p0s=ke.MakeArray(this.m_count),this.m_vs=ke.MakeArray(this.m_count),this.m_ims=ie(this.m_count);for(var t=0;t<this.m_count;++t){this.m_ps[t].Copy(e.vertices[t]),this.m_p0s[t].Copy(e.vertices[t]),this.m_vs[t].SetZero();var i=e.masses[t];this.m_ims[t]=i>0?1/i:0}var n=this.m_count-1,r=this.m_count-2;this.m_Ls=ie(n),this.m_as=ie(r);for(var s=0;s<n;++s){var a=this.m_ps[s],o=this.m_ps[s+1];this.m_Ls[s]=ke.DistanceVV(a,o)}for(var l=0;l<r;++l){var u=this.m_ps[l],h=this.m_ps[l+1],c=this.m_ps[l+2],f=ke.SubVV(h,u,ke.s_t0),d=ke.SubVV(c,h,ke.s_t1),m=ke.CrossVV(f,d),_=ke.DotVV(f,d);this.m_as[l]=we(m,_)}this.m_gravity.Copy(e.gravity),this.m_damping=e.damping,this.m_k2=e.k2,this.m_k3=e.k3}},{key:"Step",value:function(e,t){if(0!==e){for(var i=Math.exp(-e*this.m_damping),n=0;n<this.m_count;++n)this.m_p0s[n].Copy(this.m_ps[n]),this.m_ims[n]>0&&this.m_vs[n].SelfMulAdd(e,this.m_gravity),this.m_vs[n].SelfMul(i),this.m_ps[n].SelfMulAdd(e,this.m_vs[n]);for(var r=0;r<t;++r)this.SolveC2(),this.SolveC3(),this.SolveC2();for(var s=1/e,a=0;a<this.m_count;++a)ke.MulSV(s,ke.SubVV(this.m_ps[a],this.m_p0s[a],ke.s_t0),this.m_vs[a])}}},{key:"SolveC2",value:function(){for(var t=this.m_count-1,i=0;i<t;++i){var n=this.m_ps[i],r=this.m_ps[i+1],s=ke.SubVV(r,n,e.s_d),a=s.Normalize(),o=this.m_ims[i],l=this.m_ims[i+1];if(o+l!==0){var u=o/(o+l),h=l/(o+l);n.SelfMulSub(this.m_k2*u*(this.m_Ls[i]-a),s),r.SelfMulAdd(this.m_k2*h*(this.m_Ls[i]-a),s)}}}},{key:"SetAngle",value:function(e){for(var t=this.m_count-2,i=0;i<t;++i)this.m_as[i]=e}},{key:"SolveC3",value:function(){for(var t=this.m_count-2,i=0;i<t;++i){var n=this.m_ps[i],r=this.m_ps[i+1],s=this.m_ps[i+2],a=this.m_ims[i],o=this.m_ims[i+1],l=this.m_ims[i+2],u=ke.SubVV(r,n,e.s_d1),h=ke.SubVV(s,r,e.s_d2),c=u.LengthSquared(),f=h.LengthSquared();if(c*f!==0){var m=ke.CrossVV(u,h),_=ke.DotVV(u,h),p=we(m,_),v=ke.MulSV(-1/c,u.SelfSkew(),e.s_Jd1),y=ke.MulSV(1/f,h.SelfSkew(),e.s_Jd2),g=ke.NegV(v,e.s_J1),x=ke.SubVV(v,y,e.s_J2),b=y,w=a*ke.DotVV(g,g)+o*ke.DotVV(x,x)+l*ke.DotVV(b,b);if(0!==w){w=1/w;for(var A=p-this.m_as[i];A>d;)A=(p-=2*d)-this.m_as[i];for(;A<-d;)A=(p+=2*d)-this.m_as[i];var S=-this.m_k3*w*A;n.SelfMulAdd(a*S,g),r.SelfMulAdd(o*S,x),s.SelfMulAdd(l*S,b)}}}}},{key:"Draw",value:function(e){for(var t=new Fe(.4,.5,.7),i=0;i<this.m_count-1;++i)e.DrawSegment(this.m_ps[i],this.m_ps[i+1],t)}}]),e}();ls.s_d=new ke,ls.s_d1=new ke,ls.s_d2=new ke,ls.s_Jd1=new ke,ls.s_Jd2=new ke,ls.s_J1=new ke,ls.s_J2=new ke,e.b2Assert=t,e.b2Maybe=i,e.b2_maxFloat=h,e.b2_epsilon=c,e.b2_epsilon_sq=f,e.b2_pi=d,e.b2_maxManifoldPoints=m,e.b2_maxPolygonVertices=_,e.b2_aabbExtension=p,e.b2_aabbMultiplier=v,e.b2_linearSlop=y,e.b2_angularSlop=g,e.b2_polygonRadius=x,e.b2_maxSubSteps=b,e.b2_maxTOIContacts=w,e.b2_velocityThreshold=A,e.b2_maxLinearCorrection=S,e.b2_maxAngularCorrection=M,e.b2_maxTranslation=C,e.b2_maxTranslationSquared=k,e.b2_maxRotation=B,e.b2_maxRotationSquared=V,e.b2_baumgarte=T,e.b2_toiBaumgarte=P,e.b2_invalidParticleIndex=L,e.b2_maxParticleIndex=E,e.b2_particleStride=I,e.b2_minParticleWeight=R,e.b2_maxParticlePressure=F,e.b2_maxParticleForce=G,e.b2_maxTriadDistance=D,e.b2_maxTriadDistanceSquared=O,e.b2_minParticleSystemBufferCapacity=N,e.b2_barrierCollisionTime=z,e.b2_timeToSleep=U,e.b2_linearSleepTolerance=j,e.b2_angularSleepTolerance=W,e.b2Alloc=q,e.b2Free=H,e.b2Log=X,e.b2Version=J,e.b2_version=Y,e.b2_branch=Z,e.b2_commit=Q,e.b2ParseInt=K,e.b2ParseUInt=$,e.b2MakeArray=ee,e.b2MakeNullArray=te,e.b2MakeNumberArray=ie,e.b2_pi_over_180=ne,e.b2_180_over_pi=re,e.b2_two_pi=se,e.b2Abs=ae,e.b2Min=oe,e.b2Max=le,e.b2Clamp=ue,e.b2Swap=he,e.b2IsValid=ce,e.b2Sq=fe,e.b2InvSqrt=de,e.b2Sqrt=me,e.b2Pow=_e,e.b2DegToRad=pe,e.b2RadToDeg=ve,e.b2Cos=ye,e.b2Sin=ge,e.b2Acos=xe,e.b2Asin=be,e.b2Atan2=we,e.b2NextPowerOfTwo=Ae,e.b2IsPowerOfTwo=Se,e.b2Random=Me,e.b2RandomRange=Ce,e.b2Vec2=ke,e.b2Vec2_zero=Be,e.b2Vec3=Ve,e.b2Mat22=Te,e.b2Mat33=Pe,e.b2Rot=Le,e.b2Transform=Ee,e.b2Sweep=Re,e.b2Color=Fe,e.b2Draw=Ge,e.b2Timer=De,e.b2Counter=Oe,e.b2GrowableStack=Ne,e.b2BlockAllocator=ze,e.b2StackAllocator=Ue,e.b2ContactFeature=yt,e.b2ContactID=gt,e.b2ManifoldPoint=xt,e.b2Manifold=wt,e.b2WorldManifold=At,e.b2GetPointStates=St,e.b2ClipVertex=Mt,e.b2RayCastInput=Ct,e.b2RayCastOutput=kt,e.b2AABB=Bt,e.b2TestOverlapAABB=Vt,e.b2ClipSegmentToLine=Tt,e.b2TestOverlapShape=It,e.b2DistanceProxy=je,e.b2SimplexCache=We,e.b2DistanceInput=qe,e.b2DistanceOutput=He,e.b2ShapeCastInput=Xe,e.b2ShapeCastOutput=Je,e.b2_gjk_reset=Ye,e.b2SimplexVertex=Ze,e.b2Simplex=Qe,e.b2Distance=at,e.b2ShapeCast=pt,e.b2Pair=Dt,e.b2BroadPhase=Ot,e.b2PairLessThan=Nt,e.b2TreeNode=Ft,e.b2DynamicTree=Gt,e.b2_toi_reset=zt,e.b2TOIInput=Zt,e.b2TOIOutput=Kt,e.b2SeparationFunction=$t,e.b2TimeOfImpact=ui,e.b2CollideCircles=fi,e.b2CollidePolygonAndCircle=pi,e.b2CollidePolygons=Ni,e.b2CollideEdgeAndCircle=Yi,e.b2CollideEdgeAndPolygon=tn,e.b2MassData=rn,e.b2Shape=sn,e.b2CircleShape=an,e.b2PolygonShape=on,e.b2EdgeShape=ln,e.b2ChainShape=un,e.b2Filter=hn,e.b2FixtureDef=fn,e.b2FixtureProxy=dn,e.b2Fixture=mn,e.b2BodyDef=vn,e.b2Body=yn,e.b2World=$r,e.b2DestructionListener=or,e.b2ContactFilter=lr,e.b2ContactImpulse=ur,e.b2ContactListener=hr,e.b2QueryCallback=cr,e.b2RayCastCallback=fr,e.b2Island=kr,e.b2Profile=mr,e.b2TimeStep=_r,e.b2Position=pr,e.b2Velocity=vr,e.b2SolverData=yr,e.b2ContactManager=dr,e.b2MixFriction=Jn,e.b2MixRestitution=Yn,e.b2ContactEdge=Zn,e.b2Contact=Qn,e.b2ContactRegister=sr,e.b2ContactFactory=ar,e.g_blockSolve=gr,e.b2VelocityConstraintPoint=xr,e.b2ContactVelocityConstraint=br,e.b2ContactPositionConstraint=wr,e.b2ContactSolverDef=Ar,e.b2PositionSolverManifold=Sr,e.b2ContactSolver=Mr,e.b2CircleContact=Kn,e.b2PolygonContact=$n,e.b2PolygonAndCircleContact=er,e.b2EdgeAndCircleContact=tr,e.b2EdgeAndPolygonContact=ir,e.b2ChainAndCircleContact=nr,e.b2ChainAndPolygonContact=rr,e.b2Jacobian=gn,e.b2JointEdge=xn,e.b2JointDef=bn,e.b2Joint=wn,e.b2AreaJointDef=Mn,e.b2AreaJoint=Cn,e.b2DistanceJointDef=An,e.b2DistanceJoint=Sn,e.b2FrictionJointDef=kn,e.b2FrictionJoint=Bn,e.b2GearJointDef=Vn,e.b2GearJoint=Tn,e.b2MotorJointDef=Pn,e.b2MotorJoint=Ln,e.b2MouseJointDef=En,e.b2MouseJoint=In,e.b2PrismaticJointDef=Rn,e.b2PrismaticJoint=Fn,e.b2_minPulleyLength=Gn,e.b2PulleyJointDef=Dn,e.b2PulleyJoint=On,e.b2RevoluteJointDef=Nn,e.b2RevoluteJoint=zn,e.b2RopeJointDef=Un,e.b2RopeJoint=jn,e.b2WeldJointDef=Wn,e.b2WeldJoint=qn,e.b2WheelJointDef=Hn,e.b2WheelJoint=Xn,e.b2ControllerEdge=es,e.b2Controller=ts,e.b2BuoyancyController=is,e.b2ConstantAccelController=ns,e.b2ConstantForceController=rs,e.b2GravityController=ss,e.b2TensorDampingController=as,e.b2ParticleDef=Br,e.b2CalculateParticleIterations=Vr,e.b2ParticleHandle=Pr,e.b2ParticleGroupDef=Lr,e.b2ParticleGroup=Er,e.b2GrowableBuffer=qr,e.b2FixtureParticleQueryCallback=Hr,e.b2ParticleContact=Xr,e.b2ParticleBodyContact=Jr,e.b2ParticlePair=Yr,e.b2ParticleTriad=Zr,e.b2ParticleSystemDef=Qr,e.b2ParticleSystem=Kr,e.b2RopeDef=os,e.b2Rope=ls,Object.defineProperty(e,"__esModule",{value:!0})}(t)},8041:function(e){"use strict";var t,i="object"===typeof Reflect?Reflect:null,n=i&&"function"===typeof i.apply?i.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};t=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!==e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(i,n){function r(i){e.removeListener(t,s),n(i)}function s(){"function"===typeof e.removeListener&&e.removeListener("error",r),i([].slice.call(arguments))}_(e,t,s,{once:!0}),"error"!==t&&function(e,t,i){"function"===typeof e.on&&_(e,"error",t,i)}(e,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,i,n){var r,s,a,u;if(o(i),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),s=e._events),a=s[t]),void 0===a)a=s[t]=i,++e._eventsCount;else if("function"===typeof a?a=s[t]=n?[i,a]:[a,i]:n?a.unshift(i):a.push(i),(r=l(e))>0&&a.length>r&&!a.warned){a.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=a.length,u=h,console&&console.warn&&console.warn(u)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=h.bind(n);return r.listener=i,n.wrapFn=r,r}function f(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"===typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):m(r,r.length)}function d(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"===typeof i)return 1;if(void 0!==i)return i.length}return 0}function m(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function _(e,t,i,n){if("function"===typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(s){n.once&&e.removeEventListener(t,r),i(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var l=s[e];if(void 0===l)return!1;if("function"===typeof l)n(l,this,t);else{var u=l.length,h=m(l,u);for(i=0;i<u;++i)n(h[i],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){return o(t),this.on(e,c(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,c(this,e,t)),this},s.prototype.removeListener=function(e,t){var i,n,r,s,a;if(o(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!==typeof i){for(r=-1,s=i.length-1;s>=0;s--)if(i[s]===t||i[s].listener===t){a=i[s].listener,r=s;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9434:function(e,t,i){"use strict";var n=i(4704).default;function r(e){if(this.words=[],null!=(s=e)&&void 0!==s[Symbol.iterator]){var t,i=n(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.add(r)}}catch(a){i.e(a)}finally{i.f()}}var s}r.prototype.add=function(e){this.resize(e),this.words[e>>>5]|=1<<e},r.prototype.flip=function(e){this.resize(e),this.words[e>>>5]^=1<<e},r.prototype.clear=function(){this.words=[]},r.prototype.remove=function(e){this.resize(e),this.words[e>>>5]&=~(1<<e)},r.prototype.isEmpty=function(e){for(var t=this.words.length,i=0;i<t;i++)if(0!==this.words[i])return!1;return!0},r.prototype.has=function(e){return 0!==(this.words[e>>>5]&1<<e)},r.prototype.checkedAdd=function(e){this.resize(e);var t=this.words[e>>>5],i=t|1<<e;return this.words[e>>>5]=i,(i^t)>>>e},r.prototype.trim=function(e){for(var t=this.words.length;t>0&&0===this.words[t-1];)t--;this.words=this.words.slice(0,t)},r.prototype.resize=function(e){for(var t=e+32>>>5,i=this.words.length;i<t;i++)this.words[i]=0},r.prototype.hammingWeight=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},r.prototype.hammingWeight4=function(e,t,i,n){return 16843009*((e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)+(t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)+(i=(i=(858993459&(i-=i>>>1&1431655765))+(i>>>2&858993459))+(i>>>4)&252645135)+(n=(n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135))>>>24},r.prototype.size=function(){for(var e=0,t=this.words.length,i=this.words,n=0;n<t;n++)e+=this.hammingWeight(i[n]);return e},r.prototype.array=function(){for(var e=new Array(this.size()),t=0,i=this.words.length,n=0;n<i;++n)for(var r=this.words[n];0!=r;){var s=r&-r;e[t++]=(n<<5)+this.hammingWeight(s-1|0),r^=s}return e},r.prototype.forEach=function(e){for(var t=this.words.length,i=0;i<t;++i)for(var n=this.words[i];0!=n;){var r=n&-n;e((i<<5)+this.hammingWeight(r-1|0)),n^=r}},r.prototype.clone=function(){var e=Object.create(r.prototype);return e.words=this.words.slice(),e},r.prototype.intersects=function(e){for(var t=Math.min(this.words.length,e.words.length),i=0;i<t;++i)if(0!==(this.words[i]&e.words[i]))return!0;return!1},r.prototype.intersection=function(e){for(var t=Math.min(this.words.length,e.words.length),i=0;i+7<t;i+=8)this.words[i]&=e.words[i],this.words[i+1]&=e.words[i+1],this.words[i+2]&=e.words[i+2],this.words[i+3]&=e.words[i+3],this.words[i+4]&=e.words[i+4],this.words[i+5]&=e.words[i+5],this.words[i+6]&=e.words[i+6],this.words[i+7]&=e.words[i+7];for(;i<t;++i)this.words[i]&=e.words[i];var n=this.words.length;for(i=t;i<n;++i)this.words[i]=0;return this},r.prototype.intersection_size=function(e){for(var t=Math.min(this.words.length,e.words.length),i=0,n=0;n<t;++n)i+=this.hammingWeight(this.words[n]&e.words[n]);return i},r.prototype.new_intersection=function(e){var t=Object.create(r.prototype),i=Math.min(this.words.length,e.words.length);t.words=new Array(i);for(var n=i,s=0;s+7<n;s+=8)t.words[s]=this.words[s]&e.words[s],t.words[s+1]=this.words[s+1]&e.words[s+1],t.words[s+2]=this.words[s+2]&e.words[s+2],t.words[s+3]=this.words[s+3]&e.words[s+3],t.words[s+4]=this.words[s+4]&e.words[s+4],t.words[s+5]=this.words[s+5]&e.words[s+5],t.words[s+6]=this.words[s+6]&e.words[s+6],t.words[s+7]=this.words[s+7]&e.words[s+7];for(;s<n;++s)t.words[s]=this.words[s]&e.words[s];return t},r.prototype.equals=function(e){for(var t=Math.min(this.words.length,e.words.length),i=0;i<t;++i)if(this.words[i]!=e.words[i])return!1;if(this.words.length<e.words.length){var n=e.words.length;for(i=this.words.length;i<n;++i)if(0!=e.words[i])return!1}else if(e.words.length<this.words.length)for(n=this.words.length,i=e.words.length;i<n;++i)if(0!=this.words[i])return!1;return!0},r.prototype.difference=function(e){for(var t=Math.min(this.words.length,e.words.length),i=0;i+7<t;i+=8)this.words[i]&=~e.words[i],this.words[i+1]&=~e.words[i+1],this.words[i+2]&=~e.words[i+2],this.words[i+3]&=~e.words[i+3],this.words[i+4]&=~e.words[i+4],this.words[i+5]&=~e.words[i+5],this.words[i+6]&=~e.words[i+6],this.words[i+7]&=~e.words[i+7];for(;i<t;++i)this.words[i]&=~e.words[i];return this},r.prototype.difference_size=function(e){for(var t=Math.min(this.words.length,e.words.length),i=0,n=0;n<t;++n)i+=this.hammingWeight(this.words[n]&~e.words[n]);for(var r=this.words.length;n<r;++n)i+=this.hammingWeight(this.words[n]);return i},r.prototype.toString=function(){return"{"+this.array().join(",")+"}"},r.prototype.union=function(e){for(var t=Math.min(this.words.length,e.words.length),i=0;i+7<t;i+=8)this.words[i]|=e.words[i],this.words[i+1]|=e.words[i+1],this.words[i+2]|=e.words[i+2],this.words[i+3]|=e.words[i+3],this.words[i+4]|=e.words[i+4],this.words[i+5]|=e.words[i+5],this.words[i+6]|=e.words[i+6],this.words[i+7]|=e.words[i+7];for(;i<t;++i)this.words[i]|=e.words[i];if(this.words.length<e.words.length){this.resize((e.words.length<<5)-1);var n=e.words.length;for(i=t;i<n;++i)this.words[i]=e.words[i]}return this},r.prototype.new_union=function(e){var t=Object.create(r.prototype),i=Math.max(this.words.length,e.words.length);t.words=new Array(i);for(var n=Math.min(this.words.length,e.words.length),s=0;s+7<n;s+=8)t.words[s]=this.words[s]|e.words[s],t.words[s+1]=this.words[s+1]|e.words[s+1],t.words[s+2]=this.words[s+2]|e.words[s+2],t.words[s+3]=this.words[s+3]|e.words[s+3],t.words[s+4]=this.words[s+4]|e.words[s+4],t.words[s+5]=this.words[s+5]|e.words[s+5],t.words[s+6]=this.words[s+6]|e.words[s+6],t.words[s+7]=this.words[s+7]|e.words[s+7];for(;s<n;++s)t.words[s]=this.words[s]|e.words[s];var a=this.words.length;for(s=n;s<a;++s)t.words[s]=this.words[s];var o=e.words.length;for(s=n;s<o;++s)t.words[s]=e.words[s];return t},r.prototype.new_difference=function(e){return this.clone().difference(e)},r.prototype.union_size=function(e){for(var t=Math.min(this.words.length,e.words.length),i=0,n=0;n<t;++n)i+=this.hammingWeight(this.words[n]|e.words[n]);if(this.words.length<e.words.length){var r=e.words.length;for(n=this.words.length;n<r;++n)i+=this.hammingWeight(0|e.words[n])}else for(r=this.words.length,n=e.words.length;n<r;++n)i+=this.hammingWeight(0|this.words[n]);return i},e.exports=r},1281:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default,s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Archetype=void 0;var a=s(i(9434)),o=n((function e(t){r(this,e),this.componentBits=new a.default,this.componentBitsInitialized=!1,this.componentTypes=t}));t.Archetype=o},3713:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var s=n((function e(){r(this,e)}));t.Component=s},9179:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentMapper=void 0;var s=function(){function e(){n(this,e),this.data=[]}return r(e,[{key:"add",value:function(e,t){this.data[e]=t}},{key:"get",value:function(e){return this.data[e]}},{key:"remove",value:function(e){delete this.data[e]}}]),e}();t.ComponentMapper=s},1218:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=i(1588).default,o=i(3808).default,l=i(1655).default,u=i(6389).default,h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EntityIteratingSystem=void 0;var c=i(4905),f=h(i(9434)),d=function(e){l(i,e);var t=u(i);function i(e){var n;return r(this,i),(n=t.call(this)).componentBits=new f.default,n.types=e,n}return s(i,[{key:"setWorld",value:function(e){a(o(i.prototype),"setWorld",this).call(this,e);var t,r=n(this.types);try{for(r.s();!(t=r.n()).done;){var s=t.value;this.componentBits.add(e.getComponentIndex(s))}}catch(l){r.e(l)}finally{r.f()}}},{key:"process",value:function(){this.begin(),this.world.getEntities(this.componentBits,this.processEntity.bind(this)),this.end()}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),i}(c.System);t.EntityIteratingSystem=d},2645:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.EntitySystem=void 0;var o=function(e){s(i,e);var t=a(i);function i(){var e;return n(this,i),(e=t.apply(this,arguments)).entities=[],e}return r(i,[{key:"process",value:function(){this.entities.length=0,this.begin(),this.world.getEntities(this.componentBits,this.processEntity.bind(this)),this.processEntities(this.entities),this.end()}},{key:"processEntity",value:function(e){this.entities.push(e)}}]),i}(i(1218).EntityIteratingSystem);t.EntitySystem=o},6310:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Inject=void 0,t.Inject=function(e){return function(t,i){var n=t.constructor;n.hasOwnProperty("__inject__")||(n.__inject__={}),n.__inject__[i]=e}}},1185:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InjectMapper=void 0,t.InjectMapper=function(e){return function(t,i){var n=t.constructor;n.hasOwnProperty("__injectMapper__")||(n.__injectMapper__={}),n.__injectMapper__[i]=e}}},4905:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.System=void 0;var s=function(){function e(){n(this,e)}return r(e,[{key:"setWorld",value:function(e){this.world=e}},{key:"initialized",value:function(){}},{key:"dispose",value:function(){}}]),e}();t.System=s},8293:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(i(9434)),l=i(9179),u=function(){function e(){r(this,e),this.index=0,this.mappers={},this.componentBitsMap=[],this.componentIndices=new Map,this.currentComponentIndex=0,this.activeSystems=[],this.passiveSystems=[],this.injectionRegistry={},this.delta=0}return s(e,[{key:"getNewId",value:function(){return this.index++}},{key:"createEntity",value:function(){return this.getNewId()}},{key:"getComponentBits",value:function(e){return this.componentBitsMap[e]||(this.componentBitsMap[e]=new o.default),this.componentBitsMap[e]}},{key:"getMapper",value:function(e){var t=this.getComponentIndex(e);return this.getMapperByIndex(t)}},{key:"getMapperByIndex",value:function(e){return this.mappers[e]||(this.mappers[e]=new l.ComponentMapper),this.mappers[e]}},{key:"getComponentIndex",value:function(e){var t=this.componentIndices.get(e);return void 0===t&&(t=this.currentComponentIndex++,this.componentIndices.set(e,t)),t}},{key:"createEntityByArchetype",value:function(e){var t=this,i=this.getNewId();return e.componentTypes.forEach((function(n){var r=new n;e.componentBitsInitialized||e.componentBits.add(t.getComponentIndex(n)),t.addComponent(i,r,!1)})),this.componentBitsMap[i]=e.componentBits,i}},{key:"addComponent",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getComponentIndex(t.constructor),r=this.getMapperByIndex(n);return r.add(e,t),i&&this.getComponentBits(e).add(n),t}},{key:"getComponent",value:function(e,t){return this.getMapper(t).get(e)}},{key:"getEntities",value:function(e,t){for(var i=0;i<this.componentBitsMap.length;i++)if(this.componentBitsMap[i]){var n=this.componentBitsMap[i];e.union_size(n)===n.size()&&t(i)}}},{key:"addSystem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.activeSystems.push(e):this.passiveSystems.push(e),e.setWorld(this),this.injectMapper(e),this.inject(e),e.initialized()}},{key:"injectMapper",value:function(e){var t=e.constructor.__injectMapper__||{};for(var i in t){var n=t[i];e[i]=this.getMapper(n)}}},{key:"register",value:function(e,t){this.injectionRegistry[e]=t}},{key:"inject",value:function(e){var t=e.constructor.__inject__||{};for(var i in t){var n=t[i];e[i]=this.injectionRegistry[n]}}},{key:"dispose",value:function(){var e,t=n(this.activeSystems);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(s){t.e(s)}finally{t.f()}var i,r=n(this.passiveSystems);try{for(r.s();!(i=r.n()).done;){i.value.dispose()}}catch(s){r.e(s)}finally{r.f()}}},{key:"setDelta",value:function(e){this.delta=e}},{key:"processActiveSystem",value:function(){var e,t=n(this.activeSystems);try{for(t.s();!(e=t.n()).done;){e.value.process()}}catch(i){t.e(i)}finally{t.f()}}},{key:"processPassiveSystem",value:function(){var e,t=n(this.passiveSystems);try{for(t.s();!(e=t.n()).done;){e.value.process()}}catch(i){t.e(i)}finally{t.f()}}},{key:"deleteEntity",value:function(e){for(var t in this.mappers)this.mappers[t].remove(e);delete this.componentBitsMap[e]}},{key:"isEntityActive",value:function(e){return!!this.componentBitsMap[e]}}]),e}();t.default=u},9997:function(e,t,i){"use strict";var n=i(8293);Object.defineProperty(t,"q3",{enumerable:!0,get:function(){return n.default}});var r=i(1281);var s=i(3713);var a=i(9179);var o=i(1218);var l=i(2645);var u=i(4905);Object.defineProperty(t,"xP",{enumerable:!0,get:function(){return u.System}});var h=i(1185);var c=i(6310);Object.defineProperty(t,"tB",{enumerable:!0,get:function(){return c.Inject}})},2695:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultRenderableSorter=void 0;var s=i(7811),a=i(847),o=function(){function e(){n(this,e),this.tmpV1=new s.Vector3,this.tmpV2=new s.Vector3}return r(e,[{key:"sort",value:function(e,t){this.camera=e}},{key:"getTranslation",value:function(e,t,i){return t.isZero()?e.getTranslation(i):e.hasRotationOrScaling()?i.set(t.x,t.y,t.z).multiply(e):e.getTranslation(i).add(t),i}},{key:"compare",value:function(e,t){var i=e.material.has(a.BlendingAttribute.Type)&&e.material.get(a.BlendingAttribute.Type).blended;if(i!==(t.material.has(a.BlendingAttribute.Type)&&t.material.get(a.BlendingAttribute.Type).blended))return i?1:-1;this.getTranslation(e.worldTransform,e.meshPart.center,this.tmpV1),this.getTranslation(t.worldTransform,t.meshPart.center,this.tmpV2);var n=1e3*this.camera.position.dst2(this.tmpV1)-1e3*this.camera.position.dst2(this.tmpV2),r=n<0?-1:n>0?1:0;return i?-r:r}}]),e}();t.DefaultRenderableSorter=o},1341:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultShaderProvider=void 0;var a=i(616),o=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";r(this,e),this.gl=t,this.shaders=[],this.config=i||new a.Config(n,s)}return s(e,[{key:"dispose",value:function(){}},{key:"getShader",value:function(e){var t=e.shader;if(t&&t.canRender(e))return t;var i,r=n(this.shaders);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(s.canRender(e))return s}}catch(o){r.e(o)}finally{r.f()}var a=this.createShader(this.gl,e);if(!a.canRender(e))throw new Error("unable to provide a shader for this renderable");return a.init(),this.shaders.push(a),a}},{key:"createShader",value:function(e,t){return new a.DefaultShader(e,t,this.config)}}]),e}();t.DefaultShaderProvider=o},5394:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTextureBinder=void 0;var s=i(7139),a=function(){function e(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;n(this,e),this.reuseCount=0,this.bindCount=0,this.currentTexture=0,e.gl=t;var a=Math.min(e.getMaxTextureUnits(),e.MAX_GLES_UNITS);if(s<0&&(s=a-r),r<0||s<0||r+s>a)throw new Error("Illegal arguments");this.method=i,this.offset=r,this.count=s,this.textures=new Array(s),this.unitsLRU=i===e.LRU?new Array(s):null}return r(e,[{key:"begin",value:function(){for(var e=0;e<this.count;e++)this.textures[e]=null,null!=this.unitsLRU&&(this.unitsLRU[e]=e)}},{key:"end",value:function(){e.gl.activeTexture(e.gl.TEXTURE0)}},{key:"bindTexture",value:function(t){var i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(this.reused=!1,this.method){case e.ROUNDROBIN:i=this.offset+this.bindTextureRoundRobin(t);break;case e.LRU:i=this.offset+this.bindTextureLRU(t);break;default:return-1}return this.reused?(this.reuseCount++,n?t.bind(i):e.gl.activeTexture(e.gl.TEXTURE0+i)):this.bindCount++,t.setWraps(s.TextureWrap.Repeat,s.TextureWrap.Repeat),t.setFilters(s.TextureFilter.Linear,s.TextureFilter.Linear),i}},{key:"bindTextureRoundRobin",value:function(e){for(var t=0;t<this.count;t++){var i=(this.currentTexture+t)%this.count;if(this.textures[i]===e)return this.reused=!0,i}return this.currentTexture=(this.currentTexture+1)%this.count,this.textures[this.currentTexture]=e,e.bind(this.offset+this.currentTexture),this.currentTexture}},{key:"bindTextureLRU",value:function(e){var t;for(t=0;t<this.count;t++){var i=this.unitsLRU[t];if(this.textures[i]===e){this.reused=!0;break}if(!this.textures[i])break}t>=this.count&&(t=this.count-1);for(var n=this.unitsLRU[t];t>0;)this.unitsLRU[t]=this.unitsLRU[t-1],t--;return this.unitsLRU[0]=n,this.reused||(this.textures[n]=e,e.bind(this.offset+n)),n}},{key:"getBindCount",value:function(){return this.bindCount}},{key:"getReuseCount",value:function(){return this.reuseCount}},{key:"resetCounts",value:function(){this.bindCount=this.reuseCount=0}}],[{key:"getMaxTextureUnits",value:function(){return this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)}}]),e}();t.DefaultTextureBinder=a,a.ROUNDROBIN=0,a.LRU=1,a.MAX_GLES_UNITS=32},8552:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.GL20=void 0;var s=n((function e(){r(this,e)}));t.GL20=s,s.GL_ES_VERSION_2_0=1,s.GL_DEPTH_BUFFER_BIT=256,s.GL_STENCIL_BUFFER_BIT=1024,s.GL_COLOR_BUFFER_BIT=16384,s.GL_FALSE=0,s.GL_TRUE=1,s.GL_POINTS=0,s.GL_LINES=1,s.GL_LINE_LOOP=2,s.GL_LINE_STRIP=3,s.GL_TRIANGLES=4,s.GL_TRIANGLE_STRIP=5,s.GL_TRIANGLE_FAN=6,s.GL_ZERO=0,s.GL_ONE=1,s.GL_SRC_COLOR=768,s.GL_ONE_MINUS_SRC_COLOR=769,s.GL_SRC_ALPHA=770,s.GL_ONE_MINUS_SRC_ALPHA=771,s.GL_DST_ALPHA=772,s.GL_ONE_MINUS_DST_ALPHA=773,s.GL_DST_COLOR=774,s.GL_ONE_MINUS_DST_COLOR=775,s.GL_SRC_ALPHA_SATURATE=776,s.GL_FUNC_ADD=32774,s.GL_BLEND_EQUATION=32777,s.GL_BLEND_EQUATION_RGB=32777,s.GL_BLEND_EQUATION_ALPHA=34877,s.GL_FUNC_SUBTRACT=32778,s.GL_FUNC_REVERSE_SUBTRACT=32779,s.GL_BLEND_DST_RGB=32968,s.GL_BLEND_SRC_RGB=32969,s.GL_BLEND_DST_ALPHA=32970,s.GL_BLEND_SRC_ALPHA=32971,s.GL_CONSTANT_COLOR=32769,s.GL_ONE_MINUS_CONSTANT_COLOR=32770,s.GL_CONSTANT_ALPHA=32771,s.GL_ONE_MINUS_CONSTANT_ALPHA=32772,s.GL_BLEND_COLOR=32773,s.GL_ARRAY_BUFFER=34962,s.GL_ELEMENT_ARRAY_BUFFER=34963,s.GL_ARRAY_BUFFER_BINDING=34964,s.GL_ELEMENT_ARRAY_BUFFER_BINDING=34965,s.GL_STREAM_DRAW=35040,s.GL_STATIC_DRAW=35044,s.GL_DYNAMIC_DRAW=35048,s.GL_BUFFER_SIZE=34660,s.GL_BUFFER_USAGE=34661,s.GL_CURRENT_VERTEX_ATTRIB=34342,s.GL_FRONT=1028,s.GL_BACK=1029,s.GL_FRONT_AND_BACK=1032,s.GL_TEXTURE_2D=3553,s.GL_CULL_FACE=2884,s.GL_BLEND=3042,s.GL_DITHER=3024,s.GL_STENCIL_TEST=2960,s.GL_DEPTH_TEST=2929,s.GL_SCISSOR_TEST=3089,s.GL_POLYGON_OFFSET_FILL=32823,s.GL_SAMPLE_ALPHA_TO_COVERAGE=32926,s.GL_SAMPLE_COVERAGE=32928,s.GL_NO_ERROR=0,s.GL_INVALID_ENUM=1280,s.GL_INVALID_VALUE=1281,s.GL_INVALID_OPERATION=1282,s.GL_OUT_OF_MEMORY=1285,s.GL_CW=2304,s.GL_CCW=2305,s.GL_LINE_WIDTH=2849,s.GL_ALIASED_POINT_SIZE_RANGE=33901,s.GL_ALIASED_LINE_WIDTH_RANGE=33902,s.GL_CULL_FACE_MODE=2885,s.GL_FRONT_FACE=2886,s.GL_DEPTH_RANGE=2928,s.GL_DEPTH_WRITEMASK=2930,s.GL_DEPTH_CLEAR_VALUE=2931,s.GL_DEPTH_FUNC=2932,s.GL_STENCIL_CLEAR_VALUE=2961,s.GL_STENCIL_FUNC=2962,s.GL_STENCIL_FAIL=2964,s.GL_STENCIL_PASS_DEPTH_FAIL=2965,s.GL_STENCIL_PASS_DEPTH_PASS=2966,s.GL_STENCIL_REF=2967,s.GL_STENCIL_VALUE_MASK=2963,s.GL_STENCIL_WRITEMASK=2968,s.GL_STENCIL_BACK_FUNC=34816,s.GL_STENCIL_BACK_FAIL=34817,s.GL_STENCIL_BACK_PASS_DEPTH_FAIL=34818,s.GL_STENCIL_BACK_PASS_DEPTH_PASS=34819,s.GL_STENCIL_BACK_REF=36003,s.GL_STENCIL_BACK_VALUE_MASK=36004,s.GL_STENCIL_BACK_WRITEMASK=36005,s.GL_VIEWPORT=2978,s.GL_SCISSOR_BOX=3088,s.GL_COLOR_CLEAR_VALUE=3106,s.GL_COLOR_WRITEMASK=3107,s.GL_UNPACK_ALIGNMENT=3317,s.GL_PACK_ALIGNMENT=3333,s.GL_MAX_TEXTURE_SIZE=3379,s.GL_MAX_TEXTURE_UNITS=34018,s.GL_MAX_VIEWPORT_DIMS=3386,s.GL_SUBPIXEL_BITS=3408,s.GL_RED_BITS=3410,s.GL_GREEN_BITS=3411,s.GL_BLUE_BITS=3412,s.GL_ALPHA_BITS=3413,s.GL_DEPTH_BITS=3414,s.GL_STENCIL_BITS=3415,s.GL_POLYGON_OFFSET_UNITS=10752,s.GL_POLYGON_OFFSET_FACTOR=32824,s.GL_TEXTURE_BINDING_2D=32873,s.GL_SAMPLE_BUFFERS=32936,s.GL_SAMPLES=32937,s.GL_SAMPLE_COVERAGE_VALUE=32938,s.GL_SAMPLE_COVERAGE_INVERT=32939,s.GL_NUM_COMPRESSED_TEXTURE_FORMATS=34466,s.GL_COMPRESSED_TEXTURE_FORMATS=34467,s.GL_DONT_CARE=4352,s.GL_FASTEST=4353,s.GL_NICEST=4354,s.GL_GENERATE_MIPMAP=33169,s.GL_GENERATE_MIPMAP_HINT=33170,s.GL_BYTE=5120,s.GL_UNSIGNED_BYTE=5121,s.GL_SHORT=5122,s.GL_UNSIGNED_SHORT=5123,s.GL_INT=5124,s.GL_UNSIGNED_INT=5125,s.GL_FLOAT=5126,s.GL_FIXED=5132,s.GL_DEPTH_COMPONENT=6402,s.GL_ALPHA=6406,s.GL_RGB=6407,s.GL_RGBA=6408,s.GL_LUMINANCE=6409,s.GL_LUMINANCE_ALPHA=6410,s.GL_UNSIGNED_SHORT_4_4_4_4=32819,s.GL_UNSIGNED_SHORT_5_5_5_1=32820,s.GL_UNSIGNED_SHORT_5_6_5=33635,s.GL_FRAGMENT_SHADER=35632,s.GL_VERTEX_SHADER=35633,s.GL_MAX_VERTEX_ATTRIBS=34921,s.GL_MAX_VERTEX_UNIFORM_VECTORS=36347,s.GL_MAX_VARYING_VECTORS=36348,s.GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,s.GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,s.GL_MAX_TEXTURE_IMAGE_UNITS=34930,s.GL_MAX_FRAGMENT_UNIFORM_VECTORS=36349,s.GL_SHADER_TYPE=35663,s.GL_DELETE_STATUS=35712,s.GL_LINK_STATUS=35714,s.GL_VALIDATE_STATUS=35715,s.GL_ATTACHED_SHADERS=35717,s.GL_ACTIVE_UNIFORMS=35718,s.GL_ACTIVE_UNIFORM_MAX_LENGTH=35719,s.GL_ACTIVE_ATTRIBUTES=35721,s.GL_ACTIVE_ATTRIBUTE_MAX_LENGTH=35722,s.GL_SHADING_LANGUAGE_VERSION=35724,s.GL_CURRENT_PROGRAM=35725,s.GL_NEVER=512,s.GL_LESS=513,s.GL_EQUAL=514,s.GL_LEQUAL=515,s.GL_GREATER=516,s.GL_NOTEQUAL=517,s.GL_GEQUAL=518,s.GL_ALWAYS=519,s.GL_KEEP=7680,s.GL_REPLACE=7681,s.GL_INCR=7682,s.GL_DECR=7683,s.GL_INVERT=5386,s.GL_INCR_WRAP=34055,s.GL_DECR_WRAP=34056,s.GL_VENDOR=7936,s.GL_RENDERER=7937,s.GL_VERSION=7938,s.GL_EXTENSIONS=7939,s.GL_NEAREST=9728,s.GL_LINEAR=9729,s.GL_NEAREST_MIPMAP_NEAREST=9984,s.GL_LINEAR_MIPMAP_NEAREST=9985,s.GL_NEAREST_MIPMAP_LINEAR=9986,s.GL_LINEAR_MIPMAP_LINEAR=9987,s.GL_TEXTURE_MAG_FILTER=10240,s.GL_TEXTURE_MIN_FILTER=10241,s.GL_TEXTURE_WRAP_S=10242,s.GL_TEXTURE_WRAP_T=10243,s.GL_TEXTURE=5890,s.GL_TEXTURE_CUBE_MAP=34067,s.GL_TEXTURE_BINDING_CUBE_MAP=34068,s.GL_TEXTURE_CUBE_MAP_POSITIVE_X=34069,s.GL_TEXTURE_CUBE_MAP_NEGATIVE_X=34070,s.GL_TEXTURE_CUBE_MAP_POSITIVE_Y=34071,s.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,s.GL_TEXTURE_CUBE_MAP_POSITIVE_Z=34073,s.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,s.GL_MAX_CUBE_MAP_TEXTURE_SIZE=34076,s.GL_TEXTURE0=33984,s.GL_TEXTURE1=33985,s.GL_TEXTURE2=33986,s.GL_TEXTURE3=33987,s.GL_TEXTURE4=33988,s.GL_TEXTURE5=33989,s.GL_TEXTURE6=33990,s.GL_TEXTURE7=33991,s.GL_TEXTURE8=33992,s.GL_TEXTURE9=33993,s.GL_TEXTURE10=33994,s.GL_TEXTURE11=33995,s.GL_TEXTURE12=33996,s.GL_TEXTURE13=33997,s.GL_TEXTURE14=33998,s.GL_TEXTURE15=33999,s.GL_TEXTURE16=34e3,s.GL_TEXTURE17=34001,s.GL_TEXTURE18=34002,s.GL_TEXTURE19=34003,s.GL_TEXTURE20=34004,s.GL_TEXTURE21=34005,s.GL_TEXTURE22=34006,s.GL_TEXTURE23=34007,s.GL_TEXTURE24=34008,s.GL_TEXTURE25=34009,s.GL_TEXTURE26=34010,s.GL_TEXTURE27=34011,s.GL_TEXTURE28=34012,s.GL_TEXTURE29=34013,s.GL_TEXTURE30=34014,s.GL_TEXTURE31=34015,s.GL_ACTIVE_TEXTURE=34016,s.GL_REPEAT=10497,s.GL_CLAMP_TO_EDGE=33071,s.GL_MIRRORED_REPEAT=33648,s.GL_FLOAT_VEC2=35664,s.GL_FLOAT_VEC3=35665,s.GL_FLOAT_VEC4=35666,s.GL_INT_VEC2=35667,s.GL_INT_VEC3=35668,s.GL_INT_VEC4=35669,s.GL_BOOL=35670,s.GL_BOOL_VEC2=35671,s.GL_BOOL_VEC3=35672,s.GL_BOOL_VEC4=35673,s.GL_FLOAT_MAT2=35674,s.GL_FLOAT_MAT3=35675,s.GL_FLOAT_MAT4=35676,s.GL_SAMPLER_2D=35678,s.GL_SAMPLER_CUBE=35680,s.GL_VERTEX_ATTRIB_ARRAY_ENABLED=34338,s.GL_VERTEX_ATTRIB_ARRAY_SIZE=34339,s.GL_VERTEX_ATTRIB_ARRAY_STRIDE=34340,s.GL_VERTEX_ATTRIB_ARRAY_TYPE=34341,s.GL_VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,s.GL_VERTEX_ATTRIB_ARRAY_POINTER=34373,s.GL_VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,s.GL_IMPLEMENTATION_COLOR_READ_TYPE=35738,s.GL_IMPLEMENTATION_COLOR_READ_FORMAT=35739,s.GL_COMPILE_STATUS=35713,s.GL_INFO_LOG_LENGTH=35716,s.GL_SHADER_SOURCE_LENGTH=35720,s.GL_SHADER_COMPILER=36346,s.GL_SHADER_BINARY_FORMATS=36344,s.GL_NUM_SHADER_BINARY_FORMATS=36345,s.GL_LOW_FLOAT=36336,s.GL_MEDIUM_FLOAT=36337,s.GL_HIGH_FLOAT=36338,s.GL_LOW_INT=36339,s.GL_MEDIUM_INT=36340,s.GL_HIGH_INT=36341,s.GL_FRAMEBUFFER=36160,s.GL_RENDERBUFFER=36161,s.GL_RGBA4=32854,s.GL_RGB5_A1=32855,s.GL_RGB565=36194,s.GL_DEPTH_COMPONENT16=33189,s.GL_STENCIL_INDEX=6401,s.GL_STENCIL_INDEX8=36168,s.GL_RENDERBUFFER_WIDTH=36162,s.GL_RENDERBUFFER_HEIGHT=36163,s.GL_RENDERBUFFER_INTERNAL_FORMAT=36164,s.GL_RENDERBUFFER_RED_SIZE=36176,s.GL_RENDERBUFFER_GREEN_SIZE=36177,s.GL_RENDERBUFFER_BLUE_SIZE=36178,s.GL_RENDERBUFFER_ALPHA_SIZE=36179,s.GL_RENDERBUFFER_DEPTH_SIZE=36180,s.GL_RENDERBUFFER_STENCIL_SIZE=36181,s.GL_FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,s.GL_FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,s.GL_FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,s.GL_FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,s.GL_COLOR_ATTACHMENT0=36064,s.GL_DEPTH_ATTACHMENT=36096,s.GL_STENCIL_ATTACHMENT=36128,s.GL_NONE=0,s.GL_FRAMEBUFFER_COMPLETE=36053,s.GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,s.GL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,s.GL_FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,s.GL_FRAMEBUFFER_UNSUPPORTED=36061,s.GL_FRAMEBUFFER_BINDING=36006,s.GL_RENDERBUFFER_BINDING=36007,s.GL_MAX_RENDERBUFFER_SIZE=34024,s.GL_INVALID_FRAMEBUFFER_OPERATION=1286,s.GL_VERTEX_PROGRAM_POINT_SIZE=34370,s.GL_COVERAGE_BUFFER_BIT_NV=32768,s.GL_TEXTURE_MAX_ANISOTROPY_EXT=34046,s.GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047},4023:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=i(1588).default,o=i(3808).default,l=i(1655).default,u=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0;var h=function(e){l(i,e);var t=u(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return r(this,i),(e=t.call(this)).id=n||"mtl"+ ++i.counter,e}return s(i,[{key:"equals",value:function(e){return e&&(e===this||e.id===this.id&&a(o(i.prototype),"equals",this).call(this,e))}},{key:"copy",value:function(){var e=new i;e.id=this.id;var t,r=n(this.attributes);try{for(r.s();!(t=r.n()).done;){var s=t.value;e.set(s.copy())}}catch(a){r.e(a)}finally{r.f()}return e}}]),i}(i(2802).Attributes);t.Material=h,h.counter=0},5766:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Mesh3D=t.VertexDataType=void 0;var s=i(5477),a=i(2283),o=i(7811),l=i(8633),u=i(427),h=i(8552),c=i(5223),f=i(9131);!function(e){e[e.VertexArray=0]="VertexArray",e[e.VertexBufferObject=1]="VertexBufferObject",e[e.VertexBufferObjectSubData=2]="VertexBufferObjectSubData",e[e.VertexBufferObjectWithVAO=3]="VertexBufferObjectWithVAO"}(t.VertexDataType||(t.VertexDataType={}));var d=function(){function e(t,i,r,s,a,l){n(this,e),this.gl=t,this.autoBind=!0,this.isInstanced=!1,this.tmpV=new o.Vector3,this.vertices=this.makeVertexBuffer(i,s,l),this.indices=new c.IndexBufferObject(t,a,r),this.isVertexArray=!1,e.addManagedMesh(this)}return r(e,[{key:"Mesh",value:function(t,i,n){this.vertices=t,this.indices=i,this.isVertexArray=n,e.addManagedMesh(this)}},{key:"makeVertexBuffer",value:function(e,t,i){return new f.VertexBufferObject(this.gl,e,t,i)}},{key:"setVertices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return i<0&&(i=e.length),this.vertices.setVertices(e,t,e.length),this}},{key:"updateVertices",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return n<0&&(n=t.length),this.vertices.updateVertices(e,t,i,n),this}},{key:"getVertices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.getNumVertices()*this.getVertexSize()/4;if(-1===i&&(i=r-t)>e.length-n&&(i=e.length-n),t<0||i<=0||t+i>r||n<0||n>=e.length)throw new Error("index out of bound");if(e.length-n<i)throw new Error("not enough room in vertices array, has "+e.length+" floats, needs "+i);for(var s=this.vertices.getBuffer(),a=t;a<i;a++)e[a]=s.at(a-t+n);return e}},{key:"setIndices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;return this.indices.setIndices(e,t,i),this}},{key:"getIndices",value:function(e,t,i,n){var r=this.getNumIndices();if(t<0&&(t=r-e),e<0||e>=r||e+t>r)throw new Error("Invalid range specified, offset: "+e+", count: "+t+", max: "+r);if(i.length-n<t)throw new Error("not enough room in indices array, has "+i.length+" shorts, needs "+t);for(var s=this.indices.getBuffer(),a=e;a<t;a++)i[a]=s.at(a-e+n)}},{key:"getNumIndices",value:function(){return this.indices.getNumIndices()}},{key:"getNumVertices",value:function(){return this.vertices.getNumVertices()}},{key:"getMaxVertices",value:function(){return this.vertices.getNumMaxVertices()}},{key:"getMaxIndices",value:function(){return this.indices.getNumMaxIndices()}},{key:"getVertexSize",value:function(){return this.vertices.getAttributes().vertexSize}},{key:"setAutoBind",value:function(e){this.autoBind=e}},{key:"bind",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.vertices.bind(e,t),this.indices.getNumIndices()>0&&this.indices.bind()}},{key:"unbind",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.vertices.unbind(e,t),this.indices.getNumIndices()>0&&this.indices.unbind()}},{key:"render",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.autoBind;if(n<0&&(n=this.indices.getNumMaxIndices()>0?this.getNumIndices():this.getNumVertices()),0!==n){if(r&&this.bind(e),this.isVertexArray)this.indices.getNumIndices()>0?this.gl.drawElements(t,n,h.GL20.GL_UNSIGNED_SHORT,2*i):this.gl.drawArrays(t,i,n);else if(this.indices.getNumIndices()>0){if(n+i>this.indices.getNumMaxIndices())throw new Error("Mesh attempting to access memory outside of the index buffer (count: "+n+", offset: "+i+", max: "+this.indices.getNumMaxIndices()+")");this.gl.drawElements(t,n,h.GL20.GL_UNSIGNED_SHORT,2*i)}else this.gl.drawArrays(t,i,n);r&&this.unbind(e)}}},{key:"dispose",value:function(){var t=e.meshes.indexOf(this);t>-1&&e.meshes.splice(t,1),this.vertices.dispose(),this.indices.dispose()}},{key:"getVertexAttribute",value:function(e){for(var t=this.vertices.getAttributes(),i=t.size(),n=0;n<i;n++)if(t.get(n).usage===e)return t.get(n);return null}},{key:"getVertexAttributes",value:function(){return this.vertices.getAttributes()}},{key:"getVerticesBuffer",value:function(){return this.vertices.getBuffer()}},{key:"calculateBoundingBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=new s.BoundingBox);var t=this.getNumVertices();if(0===t)throw new Error("No vertices defined");var i=this.vertices.getBuffer();e.inf();var n=this.getVertexAttribute(l.Usage.Position),r=n.offset/4,a=this.vertices.getAttributes().vertexSize/4,o=r;switch(n.numComponents){case 1:for(var u=0;u<t;u++)e.ext(i[o],0,0),o+=a;break;case 2:for(var h=0;h<t;h++)e.ext(i[o],i[o+1],0),o+=a;break;case 3:for(var c=0;c<t;c++)e.ext(i[o],i[o+1],i[o+2]),o+=a}}},{key:"extendBoundingBox",value:function(e,t,i,n){var r=this.getNumIndices(),s=this.getNumVertices(),a=0===r?s:r;if(t<0||i<1||t+i>a)throw new Error("Invalid part specified ( offset="+t+", count="+i+", max="+a+" )");var o=this.vertices.getBuffer(),u=this.indices.getBuffer(),h=this.getVertexAttribute(l.Usage.Position),c=h.offset/4,f=this.vertices.getAttributes().vertexSize/4,d=t+i;switch(h.numComponents){case 1:if(r>0)for(var m=t;m<d;m++){var _=(65535&u[m])*f+c;this.tmpV.set(o[_],0,0),n&&this.tmpV.multiply(n),e.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}else for(var p=t;p<d;p++){var v=p*f+c;this.tmpV.set(o[v],0,0),n&&this.tmpV.multiply(n),e.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}break;case 2:if(r>0)for(var y=t;y<d;y++){var g=(65535&u[y])*f+c;this.tmpV.set(o[g],o[g+1],0),n&&this.tmpV.multiply(n),e.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}else for(var x=t;x<d;x++){var b=x*f+c;this.tmpV.set(o[b],o[b+1],0),n&&this.tmpV.multiply(n),e.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}break;case 3:if(r>0)for(var w=t;w<d;w++){var A=(65535&u[w])*f+c;this.tmpV.set(o[A],o[A+1],o[A+2]),n&&this.tmpV.multiply(n),e.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}else for(var S=t;S<d;S++){var M=S*f+c;this.tmpV.set(o[M],o[M+1],o[M+2]),n&&this.tmpV.multiply(n),e.ext(this.tmpV.x,this.tmpV.y,this.tmpV.z)}}return e}},{key:"calculateRadiusSquared",value:function(e,t,i,n,r,s){var a=this.getNumIndices();if(n<0||r<1||n+r>a)throw new Error("Not enough indices");var u=this.vertices.getBuffer(),h=this.indices.getBuffer(),c=this.getVertexAttribute(l.Usage.Position),f=c.offset/4,d=this.vertices.getAttributes().vertexSize/4,m=n+r,_=0;switch(c.numComponents){case 1:for(var p=n;p<m;p++){var v=(65535&h[p])*d+f;this.tmpV.set(u[v],0,0),s&&this.tmpV.multiply(s);var y=this.tmpV.sub(new o.Vector3(e,t,i)).length2();y>_&&(_=y)}break;case 2:for(var g=n;g<m;g++){var x=(65535&h[g])*d+f;this.tmpV.set(u[g],u[x+1],0),s&&this.tmpV.multiply(s);var b=this.tmpV.sub(new o.Vector3(e,t,i)).length2();b>_&&(_=b)}break;case 3:for(var w=n;w<m;w++){var A=(65535&h[w])*d+f;this.tmpV.set(u[w],u[A+1],u[A+2]),s&&this.tmpV.multiply(s);var S=this.tmpV.sub(new o.Vector3(e,t,i)).length2();S>_&&(_=S)}}return _}},{key:"calculateRadius",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getNumIndices(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return Math.sqrt(this.calculateRadiusSquared(e,t,i,n,r,s))}},{key:"getIndicesBuffer",value:function(){return this.indices.getBuffer()}},{key:"scale",value:function(e,t,i){var n=this.getVertexAttribute(l.Usage.Position),r=n.offset/4,s=n.numComponents,a=this.getNumVertices(),o=this.getVertexSize()/4,u=new Array(a*o);this.getVertices(u);var h=r;switch(s){case 1:for(var c=0;c<a;c++)u[h]*=e,h+=o;break;case 2:for(var f=0;f<a;f++)u[h]*=e,u[h+1]*=t,h+=o;break;case 3:for(var d=0;d<a;d++)u[h]*=e,u[h+1]*=t,u[h+2]*=i,h+=o}this.setVertices(u)}},{key:"transform",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getNumIndices(),r=this.getVertexAttribute(l.Usage.Position),s=r.offset/4,a=this.getVertexSize()/4,o=r.numComponents,u=new Array(n*a);this.getVertices(u,i*a,n*a),e.transform(t,u,a,s,o,0,n),this.updateVertices(i*a,u)}},{key:"transformUV",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getNumVertices(),r=this.getVertexAttribute(l.Usage.TextureCoordinates),s=r.offset/4,a=this.getVertexSize()/4,o=this.getNumVertices(),u=new Array(o*a);this.getVertices(u,0,u.length),e.transformUV(t,u,a,s,i,n),this.setVertices(u,0,u.length)}},{key:"copy",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getVertexSize()/4,s=this.getNumVertices(),a=new Array(s*r);this.getVertices(a,0,a.length);var o=null,l=null,h=0;if(n){for(var c=0,f=0,d=0;d<n.length;d++)this.getVertexAttribute(n[d])&&(c+=this.getVertexAttribute(n[d]).numComponents,f++);if(c>0){l=new Array(f),o=new Array(c);for(var m=-1,_=-1,p=0;p<n.length;p++){var v=this.getVertexAttribute(n[p]);if(v){for(var y=0;y<v.numComponents;y++)o[++m]=v.offset+y;l[++_]=v.copy(),h+=v.numComponents}}}}if(!o){o=new Array(r);for(var g=0;g<r;g++)o[g]=g;h=r}var x,b=this.getNumIndices(),w=null;if(b>0&&(w=new Array(b),this.getIndices(0,-1,w,0),i||h!==r)){for(var A=new Array(a.length),S=0,M=0;M<b;M++){var C=w[M]*r,k=-1;if(i)for(var B=0;B<S&&k<0;B++){for(var V=B*h,T=!0,P=0;P<o.length&&T;P++)A[V+P]!==a[C+o[P]]&&(T=!1);T&&(k=B)}if(k>0)w[M]=k;else{for(var L=S*h,E=0;E<o.length;E++)A[L+E]=a[C+o[E]];w[M]=S,S++}}a=A,s=S}return(x=new e(this.gl,t,t,s,w?w.length:0,l?new u.VertexAttributes(l):this.getVertexAttributes())).setVertices(a,0,s*h),w&&x.setIndices(w),x}}],[{key:"addManagedMesh",value:function(t){e.meshes||(e.meshes=new Array),e.meshes.push(t)}},{key:"invalidateAllMeshes",value:function(){if(e.meshes)for(var t=0;t<e.meshes.length;t++)e.meshes[t].vertices.invalidate(),e.meshes[t].indices.invalidate()}},{key:"clearAllMeshes",value:function(){e.meshes.length=0}},{key:"transform",value:function(e,t,i,n,r,s,a){if(n<0||r<1||n+r>i)throw new Error;if(s<0||a<1||(s+a)*i>t.length)throw new Error("start = "+s+", count = "+a+", vertexSize = "+i+", length = "+t.length);var l=new o.Vector3,u=n+s*i;switch(r){case 1:for(var h=0;h<a;h++)l.set(t[u],0,0).multiply(e),t[u]=l.x,u+=i;break;case 2:for(var c=0;c<a;c++)l.set(t[u],t[u+1],0).multiply(e),t[u]=l.x,t[u+1]=l.y,u+=i;break;case 3:for(var f=0;f<a;f++)l.set(t[u],t[u+1],t[u+2]).multiply(e),t[u]=l.x,t[u+1]=l.y,t[u+2]=l.z,u+=i}}},{key:"transformUV",value:function(e,t,i,n,r,s){if(r<0||s<1||(r+s)*i>t.length)throw new Error("start = "+r+", count = "+s+", vertexSize = "+i+", length = "+t.length);for(var o=new a.Vector2,l=n+r*i,u=0;u<s;u++)o.set(t[l],t[l+1]).mul(e),t[l]=o.x,t[l+1]=o.y,l+=i}}]),e}();t.Mesh3D=d,d.meshes=[]},7893:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1588).default,a=i(3808).default,o=i(1655).default,l=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelBatch=void 0;var u=i(8606),h=i(2695),c=i(1341),f=i(5394),d=i(2289),m=i(5596),_=function(e){o(i,e);var t=l(i);function i(){return n(this,i),t.apply(this,arguments)}return r(i,[{key:"obtain",value:function(){var e=s(a(i.prototype),"obtain",this).call(this);return e.environment=null,e.material=null,e.meshPart.set("",null,0,0,0),e.shader=null,e}}]),i}(u.FlushablePool),p=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n(this,e),this.camera=null,this.renderablesPool=new _((function(){return new d.Renderable})),this.renderables=[],this.context=null,this.shaderProvider=null,this.sorter=null,this.sorter=r||new h.DefaultRenderableSorter,this.ownContext=!i,this.context=i||new m.RenderContext(new f.DefaultTextureBinder(t,f.DefaultTextureBinder.LRU,1)),this.shaderProvider=this.shaderProvider?this.shaderProvider:new c.DefaultShaderProvider(t)}return r(e,[{key:"dispose",value:function(){this.shaderProvider.dispose()}},{key:"begin",value:function(e){if(this.camera)throw new Error("Call end() first.");this.camera=e,this.ownContext&&this.context.begin()}},{key:"setCamera",value:function(e){if(!this.camera)throw new Error("Call begin() first.");this.renderables.length>0&&this.flush(),this.camera=e}},{key:"getCamera",value:function(){return this.camera}},{key:"ownsRenderContext",value:function(){return this.ownContext}},{key:"getRenderContext",value:function(){return this.context}},{key:"getRenderableSorter",value:function(){return this.sorter}},{key:"flush",value:function(){this.sorter.sort(this.camera,this.renderables);for(var e=null,t=0;t<this.renderables.length;t++){var i=this.renderables[t];e!==i.shader&&(e&&e.end(),(e=i.shader).begin(this.camera,this.context)),e.render(i)}e&&e.end(),this.renderablesPool.flush(),this.renderables.length=0}},{key:"end",value:function(){this.flush(),this.ownContext&&this.context.end(),this.camera=null}},{key:"renderWithRenderable",value:function(e){e.shader=this.shaderProvider.getShader(e),this.renderables.push(e)}},{key:"render",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.renderables.length;e.getRenderables(this.renderables,this.renderablesPool);for(var n=i;n<this.renderables.length;n++){var r=this.renderables[n];t&&(r.environment=t),r.shader=this.shaderProvider.getShader(r)}}}]),e}();t.ModelBatch=p},5920:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelInstance=void 0;var a=i(4995),o=i(8235),l=i(1960),u=i(5388),h=i(5904),c=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r(this,e),this.materials=[],this.nodes=[],this.animations=[],this.model=t,this.transform=i||new a.Matrix4,n?this.copyNodes(t.nodes,n):this.copyNodes(t.nodes),this.copyAnimations(t.animations,e.defaultShareKeyframes),this.calculateTransforms()}return s(e,[{key:"copyNodes",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=0,r=e.length;i<r;++i){var s=e[i];if(t){var a,o=n(t);try{for(o.s();!(a=o.n()).done;){var l=a.value;if(l===s.id){this.nodes.push(s.copy());break}}}catch(u){o.e(u)}finally{o.f()}}else this.nodes.push(s.copy())}this.invalidate()}},{key:"invalidateNode",value:function(e){for(var t=this,i=function(i,n){var r=e.parts[i],s=r.invBoneBindTransforms;if(s)for(var a=0;a<s.size;++a)s.keys[a]=t.getNode(s.keys[a].id);if(!t.materials.includes(r.material)){var o=t.materials.findIndex((function(e){return e.id===r.material.id}));o<0?t.materials.push(r.material=r.material.copy()):r.material=t.materials[o]}},n=0,r=e.parts.length;n<r;++n)i(n);for(var s=0,a=e.getChildCount();s<a;++s)this.invalidateNode(e.getChildByIndex(s))}},{key:"getNode",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return l.Node.getNode(this.nodes,e,t,i)}},{key:"invalidate",value:function(){for(var e=0,t=this.nodes.length;e<t;++e)this.invalidateNode(this.nodes[e])}},{key:"copyAnimations",value:function(e,t){var i,r=n(e);try{for(r.s();!(i=r.n()).done;){var s=i.value;this.copyAnimation(s,t)}}catch(a){r.e(a)}finally{r.f()}}},{key:"copyAnimation",value:function(e,t){var i=new o.Animation3D;i.id=e.id,i.duration=e.duration;var r,s=n(e.nodeAnimations);try{for(s.s();!(r=s.n()).done;){var a=r.value,l=this.getNode(a.node.id);if(l){var c=new u.NodeAnimation;if(c.node=l,t)c.translation=a.translation,c.rotation=a.rotation,c.scaling=a.scaling;else{if(a.translation){c.translation=new Array;var f,d=n(a.translation);try{for(d.s();!(f=d.n()).done;){var m=f.value;c.translation.push(new h.NodeKeyframe(m.keytime,m.value))}}catch(b){d.e(b)}finally{d.f()}}if(a.rotation){c.rotation=new Array;var _,p=n(a.rotation);try{for(p.s();!(_=p.n()).done;){var v=_.value;c.rotation.push(new h.NodeKeyframe(v.keytime,v.value))}}catch(b){p.e(b)}finally{p.f()}}if(a.scaling){c.scaling=new Array;var y,g=n(a.scaling);try{for(g.s();!(y=g.n()).done;){var x=y.value;c.scaling.push(new h.NodeKeyframe(x.keytime,x.value))}}catch(b){g.e(b)}finally{g.f()}}}(c.translation||c.rotation||c.scaling)&&i.nodeAnimations.push(c)}}}catch(b){s.e(b)}finally{s.f()}i.nodeAnimations.length>0&&this.animations.push(i)}},{key:"getRenderable",value:function(e,t,i){return i.setRenderable(e),!i.bones&&this.transform?e.worldTransform.set(this.transform.values).multiply(t.globalTransform):this.transform?e.worldTransform.set(this.transform.values):e.worldTransform.idt(),e}},{key:"getRenderables",value:function(e,t){var i,r=n(this.nodes);try{for(r.s();!(i=r.n()).done;){var s=i.value;this.getRenderablesWithNode(s,e,t)}}catch(a){r.e(a)}finally{r.f()}}},{key:"getRenderablesWithNode",value:function(e,t,i){if(e.parts.length>0){var r,s=n(e.parts);try{for(s.s();!(r=s.n()).done;){var a=r.value;a.enabled&&t.push(this.getRenderable(i.obtain(),e,a))}}catch(h){s.e(h)}finally{s.f()}}var o,l=n(e.getChildren());try{for(l.s();!(o=l.n()).done;){var u=o.value;this.getRenderablesWithNode(u,t,i)}}catch(h){l.e(h)}finally{l.f()}}},{key:"calculateTransforms",value:function(){for(var e=this.nodes.length,t=0;t<e;t++)this.nodes[t].calculateTransforms(!0);for(var i=0;i<e;i++)this.nodes[i].calculateBoneTransforms(!0)}},{key:"calculateBoundingBox",value:function(e){return e.inf(),this.extendBoundingBox(e)}},{key:"extendBoundingBox",value:function(e){for(var t=this.nodes.length,i=0;i<t;i++)this.nodes[i].extendBoundingBox(e);return e}},{key:"getAnimation",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.animations.length;if(i){for(var r=0;r<n;r++)if((t=this.animations[r]).id.toUpperCase()===e.toUpperCase())return t}else for(var s=0;s<n;s++)if((t=this.animations[s]).id===e)return t;return null}},{key:"getMaterial",value:function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.materials.length;if(i){for(var r=0;r<n;r++)if((t=this.materials[r]).id.toUpperCase()===e.toUpperCase())return t}else for(var s=0;s<n;s++)if((t=this.materials[s]).id===e)return t;return null}}]),e}();t.ModelInstance=c,c.defaultShareKeyframes=!0},2596:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.PerspectiveCamera=void 0;var s=i(4995),a=i(7811),o=i(4178),l=function(){function e(t,i,r){n(this,e),this.far=100,this.near=1,this.fieldOfView=67,this.viewportWidth=0,this.viewportHeight=0,this.up=new a.Vector3(0,1,0),this.position=new a.Vector3(0,0,0),this.direction=new a.Vector3(0,0,-1),this.view=new s.Matrix4,this.combined=new s.Matrix4,this.projection=new s.Matrix4,this.invProjectionView=new s.Matrix4,this.frustum=new o.Frustum,this.tmp=new a.Vector3,this.tmpVec=new a.Vector3,this.fieldOfView=t,this.viewportWidth=i,this.viewportHeight=r,this.update()}return r(e,[{key:"update",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.viewportWidth/this.viewportHeight;this.projection.projection(Math.abs(this.near),Math.abs(this.far),this.fieldOfView,t),this.tmp.set(this.position.x,this.position.y,this.position.z),this.tmp.add(this.direction),this.view.setToLookAt(this.position,this.tmp,this.up),this.combined.set(this.projection.values),this.combined.multiply(this.view),e&&(this.invProjectionView.set(this.combined.values),this.invProjectionView.invert(),this.frustum.update(this.invProjectionView))}},{key:"lookAt",value:function(e,t,i){if(this.tmpVec.set(e,t,i).sub(this.position).normalize(),!this.tmpVec.isZero()){var n=this.tmpVec.dot(this.up);Math.abs(n-1)<1e-9?this.up.set(this.direction.x,this.direction.y,this.direction.z).scale(-1):Math.abs(n+1)<1e-9&&this.up.set(this.direction.x,this.direction.y,this.direction.z),this.direction.set(this.tmpVec.x,this.tmpVec.y,this.tmpVec.z),this.normalizeUp()}}},{key:"normalizeUp",value:function(){this.tmpVec.set(this.direction.x,this.direction.y,this.direction.z).cross(this.up),this.up.set(this.tmpVec.x,this.tmpVec.y,this.tmpVec.z).cross(this.direction).normalize()}},{key:"translate",value:function(e){this.position.add(e)}},{key:"rotate",value:function(e,t){this.direction.rotate(e,t),this.up.rotate(e,t)}},{key:"rotateAround",value:function(e,t,i){this.tmpVec.set(e.x,e.y,e.z),this.tmpVec.sub(this.position),this.translate(this.tmpVec),this.rotate(t,i),this.tmpVec.rotate(t,i),this.translate(new a.Vector3(-this.tmpVec.x,-this.tmpVec.y,-this.tmpVec.z)),this.update()}}]),e}();t.PerspectiveCamera=l},5596:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RenderContext=void 0;var s=i(5394),a=function(){function e(t){n(this,e),this.textureBinder=t,this.gl=s.DefaultTextureBinder.gl}return r(e,[{key:"begin",value:function(){this.gl.disable(this.gl.DEPTH_TEST),this.depthFunc=0,this.gl.depthMask(!0),this.depthMask=!0,this.gl.disable(this.gl.BLEND),this.blending=!1,this.gl.disable(this.gl.CULL_FACE),this.cullFace=this.blendSFactor=this.blendDFactor=0,this.textureBinder.begin()}},{key:"end",value:function(){0!==this.depthFunc&&this.gl.disable(this.gl.DEPTH_TEST),this.depthMask||this.gl.depthMask(!0),this.blending&&this.gl.disable(this.gl.BLEND),this.cullFace>0&&this.gl.disable(this.gl.CULL_FACE),this.textureBinder.end()}},{key:"setDepthMask",value:function(e){this.depthMask!==e&&this.gl.depthMask(this.depthMask=e)}},{key:"setDepthTest",value:function(e,t,i){var n=0!==this.depthFunc,r=0!==e;this.depthFunc!==e&&(this.depthFunc=e,r?(this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(e)):this.gl.disable(this.gl.DEPTH_TEST)),r&&(n&&this.depthFunc===e||this.gl.depthFunc(this.depthFunc=e),n&&this.depthRangeNear===t&&this.depthRangeFar===i||this.gl.depthRange(this.depthRangeNear=t,this.depthRangeFar=i))}},{key:"setBlending",value:function(e,t,i){e!==this.blending&&(this.blending=e,e?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND)),!e||this.blendSFactor===t&&this.blendDFactor===i||(this.gl.blendFunc(t,i),this.blendSFactor=t,this.blendDFactor=i)}},{key:"setCullFace",value:function(e){e!==this.cullFace&&(this.cullFace=e,e===this.gl.FRONT||e===this.gl.BACK||e===this.gl.FRONT_AND_BACK?(this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(e)):this.gl.disable(this.gl.CULL_FACE))}}]),e}();t.RenderContext=a},2289:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Renderable=void 0;var s=i(4995),a=i(3627),o=function(){function e(){n(this,e),this.worldTransform=new s.Matrix4,this.meshPart=new a.MeshPart,this.bones=null}return r(e,[{key:"set",value:function(e){return this.worldTransform.set(e.worldTransform.values),this.material=e.material,this.meshPart.setByMeshPart(e.meshPart),this.bones=e.bones,this.environment=e.environment,this.shader=e.shader,this}}]),e}();t.Renderable=o},557:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Attribute=void 0;var s=function(){function e(){n(this,e)}return r(e,[{key:"setType",value:function(e){this.type=e,this.typeBit=this.numberOfTrailingZeros(e)}},{key:"hashCode",value:function(){return 7489*this.typeBit}},{key:"equals",value:function(e){return!!e&&(e===this||!!e&&(this.type===e.type&&e.hashCode()===this.hashCode()))}},{key:"numberOfTrailingZeros",value:function(e){var t,i;if(0===e)return 64;var n=63;return 0!==(i=e)?(n-=32,t=i):t=e>>>32,0!==(i=t<<16)&&(n-=16,t=i),0!==(i=t<<8)&&(n-=8,t=i),0!==(i=t<<4)&&(n-=4,t=i),0!==(i=t<<2)&&(n-=2,t=i),n-(t<<1>>>31)}},{key:"toString",value:function(){return e.getAttributeAlias(this.type)}},{key:"copy",value:function(){return new e}}],[{key:"getAttributeType",value:function(t){for(var i=0;i<e.types.length;i++)if(e.types[i]===t)return 1<<i;return 0}},{key:"getAttributeAlias",value:function(t){for(var i=-1;0!==t&&++i<63&&0===(t>>i&1););return i>=0&&i<e.types.length?e.types[i]:null}},{key:"register",value:function(t){var i=this.getAttributeType(t);return i>0?i:(e.types.push(t),1<<e.types.length-1)}}]),e}();t.Attribute=s,s.types=[]},2802:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Attributes=void 0;var a=function(){function e(){r(this,e),this.attributes=[],this.sorted=!0}return s(e,[{key:"getMask",value:function(){return this.mask}},{key:"get",value:function(e){var t,i=n(this.attributes);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.type===e)return r}}catch(s){i.e(s)}finally{i.f()}return null}},{key:"getArrayAttribute",value:function(e,t){var i,r=n(this.attributes);try{for(r.s();!(i=r.n()).done;){var s=i.value;s.type===t&&e.push(s)}}catch(a){r.e(a)}finally{r.f()}return e}},{key:"clear",value:function(){this.mask=0,this.attributes=[]}},{key:"size",value:function(){return this.attributes.length}},{key:"enable",value:function(e){this.mask|=e}},{key:"disable",value:function(e){this.mask&=~e}},{key:"set",value:function(e){var t=this.indexOf(e.type);t<0?(this.enable(e.type),this.attributes.push(e),this.sorted=!1):this.attributes[t]=e}},{key:"getAttributes",value:function(){return this.attributes}},{key:"setAttributes",value:function(e){var t,i=n(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.set(r)}}catch(s){i.e(s)}finally{i.f()}}},{key:"has",value:function(e){return 0!==e&&(this.mask&e)===e}},{key:"indexOf",value:function(e){if(this.has(e))for(var t=0;t<this.attributes.length;t++)if(this.attributes[t].type===e)return t;return-1}},{key:"set2Attributes",value:function(e,t){this.set(e),this.set(t)}},{key:"set3Attributes",value:function(e,t,i){this.set(e),this.set(t),this.set(i)}},{key:"set4Attributes",value:function(e,t,i,n){this.set(e),this.set(t),this.set(i),this.set(n)}},{key:"setArrayAttribute",value:function(e){var t,i=n(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.set(r)}}catch(s){i.e(s)}finally{i.f()}}},{key:"setAttribute",value:function(e){this.set(e)}},{key:"remove",value:function(e){for(var t=this.attributes.length-1;t>=0;t--){var i=this.attributes[t].type;(e&i)===i&&(this.attributes.splice(t,1),this.disable(i),this.sorted=!1)}}},{key:"compare",value:function(e,t){return e.type-t.type}},{key:"same",value:function(e,t){if(e===this)return!0;if(!e||this.mask!==e.mask)return!1;if(!t)return!0;for(var i=0;i<this.attributes.length;i++)if(!this.attributes[i].equals(e.attributes[i]))return!1;return!0}},{key:"equals",value:function(e){return!!e&&(e===this||this.same(e,!0))}}]),e}();t.Attributes=a},847:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BlendingAttribute=void 0;var l=i(8552),u=function(e){a(i,e);var t=o(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.GL20.GL_SRC_ALPHA,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.GL20.GL_ONE_MINUS_SRC_ALPHA,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return r(this,i),(e=t.call(this)).opacity=1,e.setType(e.type),e.blended=a,e.sourceFunction=n,e.destFunction=s,e.opacity=o,e}return s(i,[{key:"set",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.GL20.GL_SRC_ALPHA,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.GL20.GL_ONE_MINUS_SRC_ALPHA,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.type=i.Type,this.typeBit=this.numberOfTrailingZeros(this.type),this.blended=e,this.sourceFunction=t,this.destFunction=n,this.opacity=r}}],[{key:"is",value:function(e){return(e&this.Type)===e}}]),i}(i(557).Attribute);t.BlendingAttribute=u,n=u,u.Alias="blended",u.Type=n.register(n.Alias)},1733:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ColorAttribute3D=void 0;var l=i(8606),u=function(e){a(i,e);var t=o(i);function i(e,n){var s;return r(this,i),(s=t.call(this)).color=new l.Color,s.setType(e),n&&s.color.set(n.r,n.g,n.b,n.a),s}return s(i,[{key:"copy",value:function(){return new i(this.type,this.color)}}],[{key:"is",value:function(e){return 0!==(e&this.Mask)}},{key:"createAmbient",value:function(e){return new i(i.Ambient,e)}},{key:"createDiffuse",value:function(e){return new i(i.Diffuse,e)}},{key:"createSpecular",value:function(e){return new i(i.Specular,e)}},{key:"createReflection",value:function(e){return new i(i.Reflection,e)}},{key:"createEmissive",value:function(e){return new i(i.Emissive,e)}},{key:"createAmbientLight",value:function(e){return new i(i.AmbientLight,e)}},{key:"createFog",value:function(e){return new i(i.Fog,e)}}]),i}(i(557).Attribute);t.ColorAttribute3D=u,n=u,u.DiffuseAlias="diffuseColor",u.Diffuse=n.register(u.DiffuseAlias),u.SpecularAlias="specularColor",u.Specular=n.register(u.SpecularAlias),u.AmbientAlias="ambientColor",u.Ambient=n.register(u.AmbientAlias),u.EmissiveAlias="emissiveColor",u.Emissive=n.register(u.EmissiveAlias),u.ReflectionAlias="reflectionColor",u.Reflection=n.register(u.ReflectionAlias),u.AmbientLightAlias="ambientLightColor",u.AmbientLight=n.register(u.AmbientLightAlias),u.FogAlias="fogColor",u.Fog=n.register(u.FogAlias),u.Mask=n.Ambient|n.Diffuse|n.Specular|n.Emissive|n.Reflection|n.AmbientLight|n.Fog},9693:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DirectionalLightsAttribute=void 0;var l=function(e){a(i,e);var t=o(i);function i(){var e;return r(this,i),(e=t.call(this)).setType(i.Type),e.lights=new Array,e}return s(i,[{key:"set",value:function(e){for(var t=0;t<e.lights.length;t++)this.lights[t]=e.lights[t]}},{key:"copy",value:function(){var e=new i;return e.set(this),e}},{key:"compareTo",value:function(e){return this.type!==e.type?this.type<e.type?-1:1:0}}],[{key:"is",value:function(e){return(e&i.Type)===e}}]),i}(i(557).Attribute);t.DirectionalLightsAttribute=l,n=l,l.Alias="directionalLights",l.Type=n.register(l.Alias)},5412:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FloatAttribute=void 0;var l=function(e){a(i,e);var t=o(i);function i(e,n){var s;return r(this,i),(s=t.call(this)).setType(e),s.value=n,s}return s(i,[{key:"copy",value:function(){return new i(this.type,this.value)}}],[{key:"createShininess",value:function(e){return new i(i.Shininess,e)}},{key:"createAlphaTest",value:function(e){return new i(i.AlphaTest,e)}}]),i}(i(557).Attribute);t.FloatAttribute=l,n=l,l.ShininessAlias="shininess",l.Shininess=n.register(n.ShininessAlias),l.AlphaTestAlias="alphaTest",l.AlphaTest=n.register(l.AlphaTestAlias)},603:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.IntAttribute=void 0;var l=function(e){a(i,e);var t=o(i);function i(e){var n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r(this,i),(n=t.call(this)).setType(e),n.value=s,n}return s(i,[{key:"copy",value:function(){return new i(this.type,this.value)}}],[{key:"createCullFace",value:function(e){return new i(i.CullFace,e)}}]),i}(i(557).Attribute);t.IntAttribute=l,n=l,l.CullFaceAlias="cullface",l.CullFace=n.register(l.CullFaceAlias)},4836:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.PointLightsAttribute=void 0;var l=function(e){a(i,e);var t=o(i);function i(){var e;return r(this,i),(e=t.call(this)).setType(i.Type),e.lights=new Array,e}return s(i,[{key:"set",value:function(e){for(var t=0;t<e.lights.length;t++)this.lights[t]=e.lights[t]}},{key:"copy",value:function(){var e=new i;return e.set(this),e}},{key:"compareTo",value:function(e){return this.type!==e.type?this.type<e.type?-1:1:0}}],[{key:"is",value:function(e){return(e&i.Type)===e}}]),i}(i(557).Attribute);t.PointLightsAttribute=l,n=l,l.Alias="pointLights",l.Type=n.register(l.Alias)},1148:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SpotLightsAttribute=void 0;var l=function(e){a(i,e);var t=o(i);function i(){var e;return r(this,i),(e=t.call(this)).setType(i.Type),e.lights=new Array,e}return s(i,[{key:"set",value:function(e){for(var t=0;t<e.lights.length;t++)this.lights[t]=e.lights[t]}},{key:"copy",value:function(){var e=new i;return e.set(this),e}},{key:"compareTo",value:function(e){return this.type!==e.type?this.type<e.type?-1:1:0}}],[{key:"is",value:function(e){return(e&i.Type)===e}}]),i}(i(557).Attribute);t.SpotLightsAttribute=l,n=l,l.Alias="spotLights",l.Type=n.register(l.Alias)},2398:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAttribute=void 0;var l=function(e){a(i,e);var t=o(i);function i(e){var n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return r(this,i),(n=t.call(this)).offsetU=0,n.offsetV=0,n.scaleU=1,n.scaleV=1,n.uvIndex=0,n.offsetU=s,n.offsetV=a,n.scaleU=o,n.scaleV=l,n.setType(e),n}return s(i,[{key:"setTextureRegion",value:function(e){this.texture=e.texture,this.offsetU=e.u,this.offsetV=e.v,this.scaleU=e.u2-this.offsetU,this.scaleV=e.v2-this.offsetV}},{key:"setTexture",value:function(e){this.texture=e}},{key:"setOffset",value:function(e,t){this.offsetU=e,this.offsetV=t}},{key:"setScale",value:function(e,t){this.scaleU=e,this.scaleV=t}},{key:"copy",value:function(){var e=new i(this.type);return e.offsetU=this.offsetU,e.offsetV=this.offsetV,e.scaleU=this.scaleU,e.scaleV=this.scaleV,e.uvIndex=this.uvIndex,e.texture=this.texture,e}}],[{key:"is",value:function(e){return 0!==(e&i.Mask)}},{key:"createDiffuse",value:function(e){var t=new i(i.Diffuse);return t.setTextureRegion(e),t}},{key:"createSpecular",value:function(e){var t=new i(i.Specular);return t.setTextureRegion(e),t}},{key:"createNormal",value:function(e){var t=new i(i.Normal);return t.setTextureRegion(e),t}},{key:"createBump",value:function(e){var t=new i(i.Bump);return t.setTextureRegion(e),t}},{key:"createAmbient",value:function(e){var t=new i(i.Ambient);return t.setTextureRegion(e),t}},{key:"createEmissive",value:function(e){var t=new i(i.Emissive);return t.setTextureRegion(e),t}},{key:"createReflection",value:function(e){var t=new i(i.Reflection);return t.setTextureRegion(e),t}}]),i}(i(557).Attribute);t.TextureAttribute=l,n=l,l.DiffuseAlias="diffuseTexture",l.Diffuse=n.register(l.DiffuseAlias),l.SpecularAlias="specularTexture",l.Specular=n.register(l.SpecularAlias),l.BumpAlias="bumpTexture",l.Bump=n.register(l.BumpAlias),l.NormalAlias="normalTexture",l.Normal=n.register(l.NormalAlias),l.AmbientAlias="ambientTexture",l.Ambient=n.register(l.AmbientAlias),l.EmissiveAlias="emissiveTexture",l.Emissive=n.register(l.EmissiveAlias),l.ReflectionAlias="reflectionTexture",l.Reflection=n.register(l.ReflectionAlias),l.Mask=n.Diffuse|n.Specular|n.Bump|n.Normal|n.Ambient|n.Emissive|n.Reflection},8633:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.VertexAttribute3D=t.Usage=void 0;var s=i(1858),a=i(8552),o=n((function e(){r(this,e)}));t.Usage=o,o.Position=1,o.ColorUnpacked=2,o.ColorPacked=4,o.Normal=8,o.TextureCoordinates=16,o.Generic=32,o.BoneWeight=64,o.Tangent=128,o.BiNormal=256;var l=function(){function e(t,i,n,s,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;r(this,e),this.usage=t,this.numComponents=i,this.type=n,this.normalized=s,this.alias=a,this.unit=o,this.usageIndex=this.numberOfTrailingZeros(t)}return n(e,[{key:"copy",value:function(){return new e(this.usage,this.numComponents,this.type,this.normalized,this.alias,this.unit)}},{key:"getKey",value:function(){return(this.usageIndex<<8)+(255&this.unit)}},{key:"numberOfTrailingZeros",value:function(e){for(var t=0,i=5;i<=e;i+=5)for(var n=i;n%5===0;)n/=5,t++;return t}},{key:"getSizeInBytes",value:function(){switch(this.type){case a.GL20.GL_FLOAT:case a.GL20.GL_FIXED:return 4*this.numComponents;case a.GL20.GL_UNSIGNED_BYTE:case a.GL20.GL_BYTE:return this.numComponents;case a.GL20.GL_UNSIGNED_SHORT:case a.GL20.GL_SHORT:return 2*this.numComponents}return 0}},{key:"equals",value:function(e){return!!e&&this.usage===e.usage&&this.numComponents===e.numComponents&&this.type===e.type&&this.normalized===e.normalized&&this.alias===e.alias&&this.unit===e.unit}}],[{key:"Position",value:function(){return new e(o.Position,3,a.GL20.GL_FLOAT,!1,s.Shader.POSITION,0)}},{key:"TexCoords",value:function(t){return new e(o.TextureCoordinates,2,a.GL20.GL_FLOAT,!1,s.Shader.TEXCOORDS+t,t)}},{key:"Normal",value:function(){return new e(o.Normal,3,a.GL20.GL_FLOAT,!1,s.Shader.NORMAL)}},{key:"ColorPacked",value:function(){return new e(o.ColorPacked,4,a.GL20.GL_UNSIGNED_BYTE,!0,s.Shader.COLOR)}},{key:"ColorUnpacked",value:function(){return new e(o.ColorUnpacked,4,a.GL20.GL_FLOAT,!1,s.Shader.COLOR)}},{key:"Tangent",value:function(){return new e(o.Tangent,3,a.GL20.GL_FLOAT,!1,s.Shader.TANGENT)}},{key:"Binormal",value:function(){return new e(o.BiNormal,3,a.GL20.GL_FLOAT,!1,s.Shader.BINORMAL)}},{key:"BoneWeight",value:function(t){return new e(o.BoneWeight,2,a.GL20.GL_FLOAT,!1,s.Shader.BONEWEIGHT+t,t)}}]),e}();t.VertexAttribute3D=l},427:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.VertexAttributes=void 0;var a=function(){function e(t){if(r(this,e),this.mask=-1,0===t.length)throw new Error("attributes must be >= 1");for(var i=[],n=0;n<t.length;n++)i[n]=t[n];this.attributes=i,this.vertexSize=this.calculateOffsets()}return s(e,[{key:"getOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.findByUsage(e);return i?i.offset/4:t}},{key:"findByUsage",value:function(e){var t,i=n(this.attributes);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.usage===e)return r}}catch(s){i.e(s)}finally{i.f()}return null}},{key:"calculateOffsets",value:function(){for(var e=0,t=0;t<this.attributes.length;t++)this.attributes[t].offset=e,e+=this.attributes[t].getSizeInBytes();return e}},{key:"size",value:function(){return this.attributes.length}},{key:"get",value:function(e){return this.attributes[e]}},{key:"toString",value:function(){for(var e="[",t=0;t<this.attributes.length;t++)e+="(",e+=this.attributes[t].alias,e+=", ",e+=this.attributes[t].usage,e+=", ",e+=this.attributes[t].numComponents,e+=", ",e+=this.attributes[t].offset,e+=")",e+="\n";return e+="]"}},{key:"equals",value:function(e){if(e===this)return!0;if(this.attributes.length!==e.attributes.length)return!1;for(var t=0;t<this.attributes.length;t++)if(!this.attributes[t].equals(e.attributes[t]))return!1;return!0}},{key:"getMask",value:function(){if(-1===this.mask){for(var e=0,t=0;t<this.attributes.length;t++)e|=this.attributes[t].usage;this.mask=e}return this.mask}},{key:"getMaskWithSizePacked",value:function(){return this.getMask()|this.attributes.length<<32}}]),e}();t.VertexAttributes=a},7316:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(557),t),r(i(2802),t),r(i(847),t),r(i(1733),t),r(i(9693),t),r(i(5412),t),r(i(603),t),r(i(4836),t),r(i(1148),t),r(i(2398),t),r(i(8633),t),r(i(427),t)},7299:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.AmbientCubemap=void 0;var s=i(8606),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(n(this,e),t){if(t.length!==e.NUM_VALUES)throw new Error("Incorrect array size");this.data=new Array(t.length),s.Utils.arrayCopy(t,0,this.data,0,this.data.length)}else this.data=new Array(e.NUM_VALUES)}return r(e,[{key:"setData",value:function(e){for(var t=0;t<this.data.length;t++)this.data[t]=e[t];return this}},{key:"setColor",value:function(t,i,n){for(var r=0;r<e.NUM_VALUES;)this.data[r]=t,this.data[r+1]=i,this.data[r+2]=n,r+=3;return this}},{key:"getColor",value:function(e,t){return t*=3,e.set(this.data[t],this.data[t+1],this.data[t+2],1)}},{key:"clear",value:function(){for(var e=0;e<this.data.length;e++)this.data[e]=0;return this}},{key:"clamp",value:function(){for(var t=0;t<this.data.length;t++)this.data[t]=e.clamp(this.data[t]);return this}},{key:"addColor",value:function(e,t,i){for(var n=0;n<this.data.length;)this.data[n++]+=e,this.data[n++]+=t,this.data[n++]+=i;return this}},{key:"add",value:function(e,t,i,n,r,s){var a=n*n,o=r*r,l=s*s,u=a+o+l;if(0===u)return this;var h=e*(u=1/u*(u+1)),c=t*u,f=i*u,d=n>0?0:3;return this.data[d]+=a*h,this.data[d+1]+=a*c,this.data[d+2]+=a*f,d=r>0?6:9,this.data[d]+=o*h,this.data[d+1]+=o*c,this.data[d+2]+=o*f,d=s>0?12:15,this.data[d]+=l*h,this.data[d+1]+=l*c,this.data[d+2]+=l*f,this}},{key:"addWithColorAndDirection",value:function(e,t){return this.add(e.r,e.g,e.b,t.x,t.y,t.z)}},{key:"addWithPointTarget",value:function(e,t,i){return this.add(e.r,e.g,e.b,i.x-t.x,i.y-t.y,i.z-t.z)}},{key:"addWithPointTargetIntensity",value:function(e,t,i,n){var r=n/(1+i.distance(t));return this.add(e.r*r,e.g*r,e.b*r,i.x-t.x,i.y-t.y,i.z-t.z)}},{key:"toString",value:function(){for(var e="",t=0;t<this.data.length;t+=3)e+=this.data[t]+", "+this.data[t+1]+", "+this.data[t+2]+"\n";return e}}],[{key:"clamp",value:function(e){return e<0?0:e>1?1:e}}]),e}();t.AmbientCubemap=a,a.NUM_VALUES=18},5847:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BaseLight=void 0;var s=i(8606),a=function(){function e(){n(this,e),this.color=new s.Color(0,0,0,1)}return r(e,[{key:"setColor",value:function(e,t,i,n){return this.color.set(e,t,i,n),this}}]),e}();t.BaseLight=a},1843:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DirectionalLight=void 0;var o=i(7811),l=function(e){s(i,e);var t=a(i);function i(){var e;return n(this,i),(e=t.apply(this,arguments)).direction=new o.Vector3,e}return r(i,[{key:"setDirection",value:function(e,t,i){return this.direction.set(e,t,i),this}},{key:"setFrom",value:function(e,t){return e&&this.color.set(e.r,e.g,e.b,e.a),t&&this.direction.setFrom(t).normalize(),this}},{key:"set",value:function(e,t,i,n,r,s){return this.color.set(e,t,i,1),this.direction.set(n,r,s).normalize(),this}},{key:"equals",value:function(e){return!!e&&(e===this||this.color.equals(e.color)&&this.direction.equals(e.direction))}}]),i}(i(5847).BaseLight);t.DirectionalLight=l},8798:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=i(1655).default,o=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Environment=void 0;var l=i(2802),u=i(9693),h=i(4836),c=i(1148),f=i(1843),d=i(1139),m=i(2036),_=function(e){a(i,e);var t=o(i);function i(){return r(this,i),t.apply(this,arguments)}return s(i,[{key:"addLights",value:function(e){var t,i=n(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.addLight(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"addLight",value:function(e){if(e instanceof f.DirectionalLight)this.addDirectionalLight(e);else if(e instanceof d.PointLight)this.addPointLight(e);else{if(!(e instanceof m.SpotLight))throw new Error("Unknown light type");this.addSpotLight(e)}return this}},{key:"addDirectionalLight",value:function(e){var t=this.get(u.DirectionalLightsAttribute.Type);return t||this.set(t=new u.DirectionalLightsAttribute),t.lights.push(e),this}},{key:"addPointLight",value:function(e){var t=this.get(h.PointLightsAttribute.Type);return t||this.set(t=new h.PointLightsAttribute),t.lights.push(e),this}},{key:"addSpotLight",value:function(e){var t=this.get(c.SpotLightsAttribute.Type);return t||this.set(t=new c.SpotLightsAttribute),t.lights.push(e),this}},{key:"removeLights",value:function(e){var t,i=n(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.removeLight(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"removeLight",value:function(e){if(e instanceof f.DirectionalLight)this.removeDirectionalLight(e);else if(e instanceof d.PointLight)this.removePointLight(e);else{if(!(e instanceof m.SpotLight))throw new Error("Unknown light type");this.removeSpotLight(e)}return this}},{key:"removeDirectionalLight",value:function(e){if(this.has(u.DirectionalLightsAttribute.Type)){var t=this.get(u.DirectionalLightsAttribute.Type),i=t.lights.indexOf(e,0);i>-1&&t.lights.splice(i,1),0===t.lights.length&&this.remove(u.DirectionalLightsAttribute.Type)}return this}},{key:"removePointLight",value:function(e){if(this.has(h.PointLightsAttribute.Type)){var t=this.get(h.PointLightsAttribute.Type),i=t.lights.indexOf(e,0);i>-1&&t.lights.splice(i,1),0===t.lights.length&&this.remove(h.PointLightsAttribute.Type)}return this}},{key:"removeSpotLight",value:function(e){if(this.has(c.SpotLightsAttribute.Type)){var t=this.get(c.SpotLightsAttribute.Type),i=t.lights.indexOf(e,0);i>-1&&t.lights.splice(i,1),0===t.lights.length&&this.remove(c.SpotLightsAttribute.Type)}return this}}]),i}(l.Attributes);t.Environment=_},1139:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.PointLight=void 0;var o=i(7811),l=function(e){s(i,e);var t=a(i);function i(){var e;return n(this,i),(e=t.apply(this,arguments)).position=new o.Vector3,e}return r(i,[{key:"setPosition",value:function(e,t,i){return this.position.set(e,t,i),this}},{key:"setIntensity",value:function(e){return this.intensity=e,this}},{key:"setFrom",value:function(e){return this.set(e.color,e.position,e.intensity)}},{key:"set",value:function(e,t,i){return e&&this.color.setFromColor(e),t&&this.position.setFrom(t),this.intensity=i,this}},{key:"setFromValue",value:function(e,t,i,n,r,s,a){return this.color.set(e,t,i,1),this.position.set(n,r,s),this.intensity=a,this}},{key:"equals",value:function(e){return!!e&&(e===this||this.color.equals(e.color)&&this.position.equals(e.position)&&this.intensity===e.intensity)}}]),i}(i(5847).BaseLight);t.PointLight=l},2036:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SpotLight=void 0;var o=i(8606),l=i(7811),u=function(e){s(i,e);var t=a(i);function i(){var e;return n(this,i),(e=t.apply(this,arguments)).position=new l.Vector3,e.direction=new l.Vector3,e}return r(i,[{key:"setPosition",value:function(e,t,i){return this.position.set(e,t,i),this}},{key:"setDirection",value:function(e,t,i){return this.direction.set(e,t,i),this}},{key:"setIntensity",value:function(e){return this.intensity=e,this}},{key:"setCutoffAngle",value:function(e){return this.cutoffAngle=e,this}},{key:"setExponent",value:function(e){return this.exponent=e,this}},{key:"set",value:function(e,t,i,n,r,s){return e&&this.color.setFromColor(e),t&&this.position.setFrom(t),i&&this.direction.setFrom(i).normalize(),this.intensity=n,this.cutoffAngle=r,this.exponent=s,this}},{key:"setFromValue",value:function(e,t,i,n,r,s,a,o,l,u,h,c){return this.color.set(e,t,i,1),this.position.set(n,r,s),this.direction.set(a,o,l).normalize(),this.intensity=u,this.cutoffAngle=h,this.exponent=c,this}},{key:"setFrom",value:function(e){return this.set(e.color,e.position,e.direction,e.intensity,e.cutoffAngle,e.exponent)}},{key:"setTarget",value:function(e){return this.direction.set(e.x,e.y,e.z).sub(this.position).normalize(),this}},{key:"equals",value:function(e){return!!e&&(e===this||this.color.equals(e.color)&&this.position.equals(e.position)&&this.direction.equals(e.direction)&&o.MathUtils.isEqual(this.intensity,e.intensity)&&o.MathUtils.isEqual(this.cutoffAngle,e.cutoffAngle)&&o.MathUtils.isEqual(this.exponent,e.exponent))}}]),i}(i(5847).BaseLight);t.SpotLight=u},3954:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(7299),t),r(i(5847),t),r(i(1843),t),r(i(8798),t),r(i(1139),t),r(i(2036),t)},6893:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(7316),t),r(i(2695),t),r(i(1341),t),r(i(5394),t),r(i(3954),t),r(i(8552),t),r(i(1055),t),r(i(4023),t),r(i(4286),t),r(i(5766),t),r(i(4501),t),r(i(7893),t),r(i(5920),t),r(i(2596),t),r(i(2289),t),r(i(5596),t),r(i(7452),t),r(i(3975),t)},8395:function(e,t,i){"use strict";var n=i(4704).default,r=i(7061).default,s=i(6690).default,a=i(9728).default,o=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function a(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.G3dModelLoader=void 0;var l=i(4995),u=i(5122),h=i(8606),c=i(2283),f=i(7811),d=i(8633),m=i(8552),_=i(129),p=i(8896),v=i(798),y=i(779),g=i(3710),x=i(4610),b=i(7416),w=i(707),A=i(3309),S=i(9373),M=i(663),C=i(6764),k=function(){function e(){s(this,e),this.tempQ=new u.Quaternion,this.reader=new C.UBJsonReader}return a(e,[{key:"load",value:function(e,t){return o(this,void 0,void 0,r().mark((function i(){var n,s,a,o;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=t.split(".").pop(),s="g3db"===n,i.next=4,this.parseModel(t,s);case 4:return a=i.sent,o=new M.Model(e),i.next=8,o.load(a);case 8:return i.abrupt("return",o);case 9:case"end":return i.stop()}}),i,this)})))}},{key:"parseModel",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return o(this,void 0,void 0,r().mark((function n(){var s,a,o,l,u,h;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=t.substring(0,t.lastIndexOf("/")),!i){n.next=8;break}return n.next=4,fetch(t).then((function(e){return e.arrayBuffer()}));case 4:o=n.sent,a=this.reader.parse(o),n.next=12;break;case 8:return n.next=10,fetch(t).then((function(e){return e.text()}));case 10:l=n.sent,a=JSON.parse(l);case 12:if(u=new p.ModelData,h=a.version,u.version[0]=h[0],u.version[1]=h[1],u.version[0]===e.VERSION_HI&&u.version[1]===e.VERSION_LO){n.next=18;break}throw new Error("Model version not supported");case 18:return u.id=this.getString(a.id,""),this.parseMeshes(u,a),this.parseMaterials(u,a,s),this.parseNodes(u,a),this.parseAnimations(u,a),n.abrupt("return",u);case 24:case"end":return n.stop()}}),n,this)})))}},{key:"parseMeshes",value:function(e,t){var i=t.meshes;if(void 0!==i){var r,s=n(i);try{for(s.s();!(r=s.n()).done;){var a=r.value,o=new y.ModelMesh,l=this.getString(a.id,"");o.id=l;var u=a.attributes;o.attributes=this.parseAttributes(u),o.vertices=a.vertices;var h,c=a.parts,f=new Array,d=n(c);try{for(d.s();!(h=d.n()).done;){var m=h.value,_=new g.ModelMeshPart,p=this.getString(m.id,null);if(!p)throw new Error("Not id given for mesh part");var v,x=n(f);try{for(x.s();!(v=x.n()).done;){if(v.value.id===p)throw new Error("Mesh part with id '"+p+"' already in defined")}}catch(w){x.e(w)}finally{x.f()}_.id=p;var b=this.getString(m.type,null);if(!b)throw new Error("No primitive type given for mesh part '"+p+"'");_.primitiveType=this.parseType(b),_.indices=m.indices,f.push(_)}}catch(w){d.e(w)}finally{d.f()}o.parts=f,e.meshes.push(o)}}catch(w){s.e(w)}finally{s.f()}}}},{key:"parseType",value:function(e){if("TRIANGLES"===e)return m.GL20.GL_TRIANGLES;if("LINES"===e)return m.GL20.GL_LINES;if("POINTS"===e)return m.GL20.GL_POINTS;if("TRIANGLE_STRIP"===e)return m.GL20.GL_TRIANGLE_STRIP;if("LINE_STRIP"===e)return m.GL20.GL_LINE_STRIP;throw new Error("Unknown primitive type '"+e+"', should be one of triangle, trianglestrip, line, linestrip, lineloop or point")}},{key:"parseAttributes",value:function(e){var t,i=new Array,r=0,s=0,a=n(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if("POSITION"===o)i.push(d.VertexAttribute3D.Position());else if("NORMAL"===o)i.push(d.VertexAttribute3D.Normal());else if("COLOR"===o)i.push(d.VertexAttribute3D.ColorUnpacked());else{if("COLORPACKED"===o)throw Error("ColorPacked currently not supported");if("TANGENT"===o)i.push(d.VertexAttribute3D.Tangent());else if("BINORMAL"===o)i.push(d.VertexAttribute3D.Binormal());else if(o.startsWith("TEXCOORD"))i.push(d.VertexAttribute3D.TexCoords(r++));else{if(!o.startsWith("BLENDWEIGHT"))throw new Error("Unknown vertex attribute '"+o+"', should be one of position, normal, uv, tangent or binormal");i.push(d.VertexAttribute3D.BoneWeight(s++))}}}}catch(l){a.e(l)}finally{a.f()}return i}},{key:"parseMaterials",value:function(e,t,i){var r=t.materials;if(void 0!==r){var s,a=n(r);try{for(a.s();!(s=a.n()).done;){var o=s.value,l=new v.ModelMaterial,u=this.getString(o.id,null);if(!u)throw new Error("Material needs an id.");l.id=u;var h=o.diffuse;void 0!==h&&(l.diffuse=this.parseColor(h));var c=o.ambient;void 0!==c&&(l.ambient=this.parseColor(c));var f=o.emissive;void 0!==f&&(l.emissive=this.parseColor(f));var d=o.specular;void 0!==d&&(l.specular=this.parseColor(d));var m=o.reflection;void 0!==m&&(l.reflection=this.parseColor(m)),l.shininess=this.getFloat(o.shininess,0),l.opacity=this.getFloat(o.opacity,1);var _=o.textures;if(void 0!==_){var p,y=n(_);try{for(y.s();!(p=y.n()).done;){var g=p.value,x=new S.ModelTexture,b=this.getString(g.id,null);if(!b)throw new Error("Texture has no id.");x.id=b;var w=this.getString(g.filename,null);if(!w)throw new Error("Texture needs filename.");x.fileName=i+(0===i.length||i.endsWith("/")?"":"/")+w,x.uvTranslation=this.readVector2(g.uvTranslation,0,0),x.uvScaling=this.readVector2(g.uvScaling,1,1);var A=this.getString(g.type,null);if(void 0===A)throw new Error("Texture needs type.");x.usage=this.parseTextureUsage(A),void 0===l.textures&&(l.textures=new Array),l.textures.push(x)}}catch(M){y.e(M)}finally{y.f()}}e.materials.push(l)}}catch(M){a.e(M)}finally{a.f()}}}},{key:"parseTextureUsage",value:function(e){return"AMBIENT"===e.toUpperCase()?S.ModelTexture.USAGE_AMBIENT:"BUMP"===e.toUpperCase()?S.ModelTexture.USAGE_BUMP:"DIFFUSE"===e.toUpperCase()?S.ModelTexture.USAGE_DIFFUSE:"EMISSIVE"===e.toUpperCase()?S.ModelTexture.USAGE_EMISSIVE:"NONE"===e.toUpperCase()?S.ModelTexture.USAGE_NONE:"NORMAL"===e.toUpperCase()?S.ModelTexture.USAGE_NORMAL:"REFLECTION"===e.toUpperCase()?S.ModelTexture.USAGE_REFLECTION:"SHININESS"===e.toUpperCase()?S.ModelTexture.USAGE_SHININESS:"SPECULAR"===e.toUpperCase()?S.ModelTexture.USAGE_SPECULAR:"TRANSPARENCY"===e.toUpperCase()?S.ModelTexture.USAGE_TRANSPARENCY:S.ModelTexture.USAGE_UNKNOWN}},{key:"parseColor",value:function(e){if(e.length>=3)return new h.Color(e[0],e[1],e[2],1);throw new Error("Expected Color values <> than three.")}},{key:"readVector2",value:function(e,t,i){if(void 0===e)return new c.Vector2(t,i);if(2===e.length)return new c.Vector2(e[0],e[1]);throw new Error("Expected Vector2 values <> than two.")}},{key:"parseNodes",value:function(e,t){var i=t.nodes;if(void 0!==i){var r,s=n(i);try{for(s.s();!(r=s.n()).done;){var a=r.value;e.nodes.push(this.parseNodesRecursively(a))}}catch(o){s.e(o)}finally{s.f()}}return e.nodes}},{key:"parseNodesRecursively",value:function(e){var t=new x.ModelNode,i=this.getString(e.id,null);if(!i)throw new Error("Node id missing.");t.id=i;var r=e.translation;if(void 0!==r&&3!==r.length)throw new Error("Node translation incomplete");t.translation=void 0===r?null:new f.Vector3(r[0],r[1],r[2]);var s=e.rotation;if(void 0!==s&&4!==s.length)throw new Error("Node rotation incomplete");t.rotation=void 0===s?null:new u.Quaternion(s[0],s[1],s[2],s[3]);var a=e.scale;if(void 0!==a&&3!==a.length)throw new Error("Node scale incomplete");t.scale=void 0===a?null:new f.Vector3(a[0],a[1],a[2]);var o=this.getString(e.mesh,null);o&&(t.meshId=o);var c=e.parts;if(void 0!==c){t.parts=new Array;var d,m=0,_=n(c);try{for(_.s();!(d=_.n()).done;){var p=d.value,v=new A.ModelNodePart,y=this.getString(p.meshpartid,null),g=this.getString(p.materialid,null);if(!y||!g)throw new Error("Node "+i+" part is missing meshPartId or materialId");v.materialId=g,v.meshPartId=y;var b=p.bones;if(void 0!==b){v.bones=new h.ArrayMap;var w,S=n(b);try{for(S.s();!(w=S.n()).done;){var M=w.value,C=this.getString(M.node,null);if(!C)throw new Error("Bone node ID missing");var k=new l.Matrix4,B=M.translation;B&&B.length>=3&&k.translate(B[0],B[1],B[2]),(B=M.rotation)&&B.length>=4&&k.rotate(this.tempQ.set(B[0],B[1],B[2],B[3])),(B=M.scale)&&B.length>=3&&k.scale(B[0],B[1],B[2]),v.bones.set(C,k)}}catch(I){S.e(I)}finally{S.f()}}t.parts[m]=v,m++}}catch(I){_.e(I)}finally{_.f()}}var V=e.children;if(void 0!==V){t.children=new Array;var T,P=0,L=n(V);try{for(L.s();!(T=L.n()).done;){var E=T.value;t.children[P]=this.parseNodesRecursively(E),P++}}catch(I){L.e(I)}finally{L.f()}}return t}},{key:"parseAnimations",value:function(e,t){var i=t.animations;if(i){var r,s=n(i);try{for(s.s();!(r=s.n()).done;){var a=r.value,o=a.bones;if(void 0!==o){var l=new _.ModelAnimation;e.animations.push(l),l.id=a.id;var h,c=n(o);try{for(c.s();!(h=c.n()).done;){var d=h.value,m=new b.ModelNodeAnimation;l.nodeAnimations.push(m),m.nodeId=d.boneId;var p=d.keyframes;if(void 0!==p&&Array.isArray(p)){var v,y=n(p);try{for(y.s();!(v=y.n()).done;){var g=v.value,x=this.getFloat(g.keytime,0)/1e3,A=g.translation;if(void 0!==A&&3===A.length){m.translation||(m.translation=new Array);var S=new w.ModelNodeKeyframe;S.keytime=x,S.value=new f.Vector3(A[0],A[1],A[2]),m.translation.push(S)}var M=g.rotation;if(void 0!==M&&4===M.length){m.rotation||(m.rotation=new Array);var C=new w.ModelNodeKeyframe;C.keytime=x,C.value=new u.Quaternion(M[0],M[1],M[2],M[3]),m.rotation.push(C)}var k=g.scale;if(void 0!==k&&3===k.length){m.scaling||(m.scaling=new Array);var B=new w.ModelNodeKeyframe;B.keytime=x,B.value=new f.Vector3(k[0],k[1],k[2]),m.scaling.push(B)}}}catch(X){y.e(X)}finally{y.f()}}else{var V=d.translation;if(void 0!==V&&Array.isArray(V)){m.translation=new Array;var T,P=n(V);try{for(P.s();!(T=P.n()).done;){var L=T.value,E=new w.ModelNodeKeyframe;m.translation.push(E),E.keytime=this.getFloat(L.keytime,0)/1e3;var I=L.value;void 0!==I&&I.length>=3&&(E.value=new f.Vector3(I[0],I[1],I[2]))}}catch(X){P.e(X)}finally{P.f()}}var R=d.rotation;if(R&&Array.isArray(R)){m.rotation=new Array;var F,G=n(R);try{for(G.s();!(F=G.n()).done;){var D=F.value,O=new w.ModelNodeKeyframe;m.rotation.push(O),O.keytime=this.getFloat(D.keytime,0)/1e3;var N=D.value;void 0!==N&&N.length>=4&&(O.value=new u.Quaternion(N[0],N[1],N[2],N[3]))}}catch(X){G.e(X)}finally{G.f()}}var z=d.scaling;if(z&&Array.isArray(z)){m.scaling=new Array;var U,j=n(z);try{for(j.s();!(U=j.n()).done;){var W=U.value,q=new w.ModelNodeKeyframe;m.scaling.push(q),q.keytime=this.getFloat(W.keytime,0)/1e3;var H=W.value;void 0!==H&&H.length>=3&&(q.value=new f.Vector3(H[0],H[1],H[2]))}}catch(X){j.e(X)}finally{j.f()}}}}}catch(X){c.e(X)}finally{c.f()}}}}catch(X){s.e(X)}finally{s.f()}}}},{key:"getString",value:function(e,t){return void 0!==e?e:t}},{key:"getFloat",value:function(e,t){return void 0!==e?e:t}}]),e}();t.G3dModelLoader=k,k.VERSION_HI=0,k.VERSION_LO=1},7503:function(e,t,i){"use strict";var n=i(4704).default,r=i(7061).default,s=i(9728).default,a=i(6690).default,o=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function a(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ObjLoader=t.MtlLoader=t.ObjMaterial=void 0;var l=i(5122),u=i(1858),h=i(8606),c=i(7811),f=i(8633),d=i(8552),m=i(4023),_=i(8896),p=i(798),v=i(779),y=i(3710),g=i(4610),x=i(3309),b=i(9373),w=i(663),A=s((function e(t){a(this,e),this.name=t,this.faces=[],this.numFaces=0,this.mat=new m.Material(""),this.materialName="default"})),S=function(){function e(){a(this,e),this.materialName="default",this.reset()}return s(e,[{key:"build",value:function(){var e=new p.ModelMaterial;return e.id=this.materialName,e.ambient=this.ambientColor?new h.Color(this.ambientColor.r,this.ambientColor.g,this.ambientColor.b,this.ambientColor.a):null,e.diffuse=new h.Color(this.diffuseColor.r,this.diffuseColor.g,this.diffuseColor.b,this.diffuseColor.a),e.specular=new h.Color(this.specularColor.r,this.specularColor.g,this.specularColor.b,this.specularColor.a),e.opacity=this.opacity,e.shininess=this.shininess,this.addTexture(e,this.alphaTexFilename,b.ModelTexture.USAGE_TRANSPARENCY),this.addTexture(e,this.ambientTexFilename,b.ModelTexture.USAGE_AMBIENT),this.addTexture(e,this.diffuseTexFilename,b.ModelTexture.USAGE_DIFFUSE),this.addTexture(e,this.specularTexFilename,b.ModelTexture.USAGE_SPECULAR),this.addTexture(e,this.shininessTexFilename,b.ModelTexture.USAGE_SHININESS),e}},{key:"addTexture",value:function(e,t,i){if(t){var n=new b.ModelTexture;n.usage=i,n.fileName=t,void 0===e.textures&&(e.textures=new Array),e.textures.push(n)}}},{key:"reset",value:function(){this.ambientColor=null,this.diffuseColor=h.Color.WHITE,this.specularColor=h.Color.WHITE,this.opacity=1,this.shininess=0,this.alphaTexFilename=null,this.ambientTexFilename=null,this.diffuseTexFilename=null,this.shininessTexFilename=null,this.specularTexFilename=null}}]),e}();t.ObjMaterial=S;var M=function(){function e(){a(this,e),this.materials=new Array}return s(e,[{key:"load",value:function(e){return o(this,void 0,void 0,r().mark((function t(){var i,n,s,a,o,l,u,h,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new S,0!==e.length){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,fetch(e);case 5:if((a=t.sent).ok){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,a.text();case 10:o=t.sent,l=o.split("\n").map((function(e){return e.trim()})),u=0,t.prev=13;case 14:if(void 0===(i=l[u])){t.next=30;break}if(u++,i.length>0&&"\t"===i.charAt(0)&&(i=i.substring(1).trim()),0!==(n=i.split(" "))[0].length){t.next=22;break}return t.abrupt("continue",14);case 22:if("#"!==n[0].charAt(0)){t.next=26;break}return t.abrupt("continue",14);case 26:"newmtl"===(h=n[0].toLowerCase())?(c=s.build(),this.materials.push(c),n.length>1?(s.materialName=n[1],s.materialName=s.materialName.replace(".","_")):s.materialName="default",s.reset()):"ka"===h?s.ambientColor=this.parseColor(n):"kd"===h?s.diffuseColor=this.parseColor(n):"ks"===h?s.specularColor=this.parseColor(n):"tr"===h||"d"===h?s.opacity=parseFloat(n[1]):"ns"===h?s.shininess=parseFloat(n[1]):"map_d"===h?s.alphaTexFilename=n[1]:"map_ka"===h?s.ambientTexFilename=n[1]:"map_kd"===h?s.diffuseTexFilename=n[1]:"map_ks"===h?s.specularTexFilename=n[1]:"map_ns"===h&&(s.shininessTexFilename=n[1]);case 28:t.next=14;break;case 30:t.next=35;break;case 32:t.prev=32,t.t0=t.catch(13),console.error(t.t0);case 35:return f=s.build(),this.materials.push(f),t.abrupt("return");case 38:case"end":return t.stop()}}),t,this,[[13,32]])})))}},{key:"parseColor",value:function(e){var t=parseFloat(e[1]),i=parseFloat(e[2]),n=parseFloat(e[3]),r=1;return e.length>4&&(r=parseFloat(e[4])),new h.Color(t,i,n,r)}},{key:"getMaterial",value:function(e){var t,i=n(this.materials);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.id===e)return r}}catch(a){i.e(a)}finally{i.f()}var s=new p.ModelMaterial;return s.id=e,s.diffuse=new h.Color(1,1,1,1),this.materials.push(s),s}}]),e}();t.MtlLoader=M;var C=function(){function e(){a(this,e),this.verts=[],this.norms=[],this.uvs=[],this.groups=[]}return s(e,[{key:"load",value:function(e,t){return o(this,void 0,void 0,r().mark((function i(){var n,s;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.loadModelData(t);case 2:return n=i.sent,s=new w.Model(e),i.next=6,s.load(n);case 6:return i.abrupt("return",s);case 7:case"end":return i.stop()}}),i,this)})))}},{key:"loadModelData",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return o(this,void 0,void 0,r().mark((function n(){var s,a,o,h,m,p,b,w,S,C,k,B,V,T,P,L,E,I,R,F,G,D,O,N,z,U,j,W,q,H,X,J,Y,Z,Q,K,$,ee,te,ie,ne,re;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.logWarning){n.next=2;break}throw Error("Wavefront (OBJ) is not fully supported, consult the documentation for more information");case 2:return h=new M,m=new A("default"),this.groups.push(m),n.next=7,fetch(t);case 7:if((p=n.sent).ok){n.next=10;break}return n.abrupt("return");case 10:return n.next=12,p.text();case 12:b=n.sent,w=b.split("\n").map((function(e){return e.trim()})),S=0,C=0,n.prev=16;case 17:if(void 0===(s=w[S])){n.next=52;break}if(S++,!((a=s.split(" ")).length<1)){n.next=22;break}return n.abrupt("break",52);case 22:if(0!==a[0].length){n.next=26;break}return n.abrupt("continue",17);case 26:if("#"!==(o=a[0].toLowerCase().charAt(0))){n.next=30;break}return n.abrupt("continue",17);case 30:if("v"!==o){n.next=34;break}1===a[0].length?(this.verts.push(parseFloat(a[1])),this.verts.push(parseFloat(a[2])),this.verts.push(parseFloat(a[3]))):"n"===a[0].charAt(1)?(this.norms.push(parseFloat(a[1])),this.norms.push(parseFloat(a[2])),this.norms.push(parseFloat(a[3]))):"t"===a[0].charAt(1)&&(this.uvs.push(parseFloat(a[1])),this.uvs.push(i?1-parseFloat(a[2]):parseFloat(a[2]))),n.next=50;break;case 34:if("f"!==o){n.next=40;break}for(k=void 0,B=m.faces,V=1;V<a.length-2;V--)k=a[1].split("/"),B.push(this.getIndex(k[0],this.verts.length)),k.length>2&&(1===V&&(m.hasNorms=!0),B.push(this.getIndex(k[2],this.norms.length))),k.length>1&&k[1].length>0&&(1===V&&(m.hasUVs=!0),B.push(this.getIndex(k[1],this.uvs.length))),k=a[++V].split("/"),B.push(this.getIndex(k[0],this.verts.length)),k.length>2&&B.push(this.getIndex(k[2],this.norms.length)),k.length>1&&k[1].length>0&&B.push(this.getIndex(k[1],this.uvs.length)),k=a[++V].split("/"),B.push(this.getIndex(k[0],this.verts.length)),k.length>2&&B.push(this.getIndex(k[2],this.norms.length)),k.length>1&&k[1].length>0&&B.push(this.getIndex(k[1],this.uvs.length)),m.numFaces++;n.next=50;break;case 40:if("o"!==o&&"g"!==o){n.next=44;break}m=a.length>1?this.setActiveGroup(a[1]):this.setActiveGroup("default"),n.next=50;break;case 44:if("mtllib"!==a[0]){n.next=49;break}return n.next=47,h.load(a[1]);case 47:n.next=50;break;case 49:"usemtl"===a[0]&&(1===a.length?m.materialName="default":m.materialName=a[1].replace(".","_"));case 50:n.next=17;break;case 52:n.next=57;break;case 54:n.prev=54,n.t0=n.catch(16),console.error(n.t0);case 57:for(T=0;T<this.groups.length;T++)this.groups[T].numFaces<1&&(this.groups.splice(T,1),T--);if(!(this.groups.length<1)){n.next=60;break}return n.abrupt("return",null);case 60:for(P=this.groups.length,L=new _.ModelData,E=0;E<P;E++){for(I=this.groups[E],R=I.faces,F=R.length,G=I.numFaces,D=I.hasNorms,O=I.hasUVs,N=[],z=0,U=0;z<F;)j=3*R[z++],N[U++]=this.verts[j++],N[U++]=this.verts[j++],N[U++]=this.verts[j],D&&(W=3*R[z++],N[U++]=this.norms[W++],N[U++]=this.norms[W++],N[U++]=this.norms[W]),O&&(q=2*R[z++],N[U++]=this.uvs[q++],N[U++]=this.uvs[q]);if(X=[],(H=3*G>=32767?0:3*G)>0)for(J=0;J<H;J++)X[J]=J;(Y=new Array).push(new f.VertexAttribute3D(f.Usage.Position,3,d.GL20.GL_FLOAT,!1,u.Shader.POSITION)),D&&Y.push(new f.VertexAttribute3D(f.Usage.Normal,3,d.GL20.GL_FLOAT,!1,u.Shader.NORMAL)),O&&Y.push(new f.VertexAttribute3D(f.Usage.TextureCoordinates,2,d.GL20.GL_FLOAT,!1,u.Shader.TEXCOORDS+"0")),Z=(++C).toString(),Q="default"===I.name?"node"+Z:I.name,K="default"===I.name?"mesh"+Z:I.name,$="default"===I.name?"part"+Z:I.name,(ee=new g.ModelNode).id=Q,ee.meshId=K,ee.scale=new c.Vector3(1,1,1),ee.translation=new c.Vector3,ee.rotation=new l.Quaternion,(te=new x.ModelNodePart).meshPartId=$,te.materialId=I.materialName,ee.parts=[te],(ie=new y.ModelMeshPart).id=$,ie.indices=X,ie.primitiveType=d.GL20.GL_TRIANGLES,(ne=new v.ModelMesh).id=K,ne.attributes=Y,ne.vertices=N,ne.parts=[ie],L.nodes.push(ee),L.meshes.push(ne),re=h.getMaterial(I.materialName),L.materials.push(re)}return this.verts.length>0&&(this.verts.length=0),this.norms.length>0&&(this.norms.length=0),this.uvs.length>0&&(this.uvs.length=0),this.groups.length>0&&(this.groups.length=0),n.abrupt("return",L);case 68:case"end":return n.stop()}}),n,this,[[16,54]])})))}},{key:"setActiveGroup",value:function(e){var t,i=n(this.groups);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.name===e)return r}}catch(a){i.e(a)}finally{i.f()}var s=new A(e);return this.groups.push(s),s}},{key:"getIndex",value:function(e,t){if(!e||0===e.length)return 0;var i=parseInt(e);return i<0?t+i:i-1}}]),e}();t.ObjLoader=C,C.logWarning=!1},6764:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryInput=t.UBJsonReader=void 0;var s=function(){function e(){n(this,e),this.oldFormat=!0}return r(e,[{key:"parse",value:function(e){var t=new a(e),i=t.readByte();return this.parseWithType(t,i)}},{key:"parseWithType",value:function(e,t){if(t==="[".charCodeAt(0))return this.parseArray(e);if(t==="{".charCodeAt(0))return this.parseObject(e);if(t==="Z".charCodeAt(0))return null;if(t==="T".charCodeAt(0))return!0;if(t==="F".charCodeAt(0))return!1;if(t==="B".charCodeAt(0))return this.readUChar(e);if(t==="U".charCodeAt(0))return this.readUChar(e);if(t==="i".charCodeAt(0))return this.oldFormat?e.readShort():e.readByte();if(t==="I".charCodeAt(0))return this.oldFormat?e.readInt(!0):e.readShort();if(t==="l".charCodeAt(0))return e.readInt(!0);if(t==="L".charCodeAt(0))return e.readLong();if(t==="d".charCodeAt(0))return e.readFloat();if(t==="D".charCodeAt(0))return e.readFloat();if(t==="s".charCodeAt(0)||t==="S".charCodeAt(0))return this.parseString(e,t);if(t==="a".charCodeAt(0)||t==="A".charCodeAt(0))return this.parseData(e,t);if(t==="C".charCodeAt(0))return e.readString();throw new Error("Unrecognized data type: "+t)}},{key:"parseObject",value:function(e){var t={},i=e.readByte(),n=0;i==="$".charCodeAt(0)&&(n=e.readByte(),i=e.readByte());var r=-1;if(i==="#".charCodeAt(0)){if((r=this.parseSize(e,e.readByte(),!1,-1))<0)throw new Error("Unrecognized data type: "+i);if(0===r)return t;i=e.readByte()}for(var s=0;i!=="}".charCodeAt(0);){var a=this.parseString(e,i,!0),o=this.parseWithType(e,0===n?e.readByte():n);if(t[a]=o,r>0&&++s>=r)break;i=e.readByte()}return t}},{key:"parseSize",value:function(e,t,i,n){if(t==="i".charCodeAt(0))return this.readUChar(e);if(t==="I".charCodeAt(0))return this.readUShort(e);if(t==="l".charCodeAt(0))return this.readUInt(e);if(t==="L".charCodeAt(0))return e.readLong();if(i){var r=(255&t)<<24;return r|=(255&e.readByte())<<16,r|=(255&e.readByte())<<8,r|=255&e.readByte()}return n}},{key:"parseArray",value:function(e){var t=[],i=e.readByte(),n=0;i==="$".charCodeAt(0)&&(n=e.readByte(),i=e.readByte());var r=-1;if(i==="#".charCodeAt(0)){if((r=this.parseSize(e,e.readByte(),!1,-1))<0)throw new Error("Unrecognized data type "+i);if(0===r)return t;i=0===n?e.readByte():n}for(var s=0;i!=="]".charCodeAt(0);){var a=this.parseWithType(e,i);if(t.push(a),r>0&&++s>=r)break;i=0===n?e.readByte():n}return t}},{key:"parseData",value:function(e,t){for(var i=e.readByte(),n=t==="A".charCodeAt(0)?this.readUInt(e):this.readUChar(e),r=[],s=0;s<n;s++){var a=this.parseWithType(e,i);r.push(a)}return r}},{key:"readUChar",value:function(e){return 255&e.readByte()}},{key:"parseString",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=-1;if(t==="S".charCodeAt(0)?n=this.parseSize(e,e.readByte(),!0,-1):t==="s".charCodeAt(0)?n=this.readUChar(e):i&&(n=this.parseSize(e,t,!1,-1)),n<0)throw new Error("Unrecognized data type: ".concat(t,", string expected"));return n>0?this.readString(e,n):""}},{key:"readUShort",value:function(e){return 65535&e.readShort()}},{key:"readUInt",value:function(e){return 4294967295&e.readInt(!0)}},{key:"readString",value:function(e,t){return e.readStringWithSize(t)}}]),e}();t.UBJsonReader=s;var a=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new DataView(t);n(this,e),this.strings=i,this.index=r,this.buffer=s}return r(e,[{key:"readByte",value:function(){return this.buffer.getInt8(this.index++)}},{key:"readUnsignedByte",value:function(){return this.buffer.getUint8(this.index++)}},{key:"readShort",value:function(){var e=this.buffer.getInt16(this.index);return this.index+=2,e}},{key:"readInt32",value:function(){var e=this.buffer.getInt32(this.index);return this.index+=4,e}},{key:"readLong",value:function(){var e=this.buffer.getInt32(this.index);return this.index+=8,e}},{key:"readInt",value:function(e){var t=(this.readUnsignedByte()<<24)+(this.readUnsignedByte()<<16)+(this.readUnsignedByte()<<8)+(this.readUnsignedByte()<<0);return e?t:t>>>1^-(1&t)}},{key:"readStringRef",value:function(){var e=this.readInt(!0);return 0===e?null:this.strings[e-1]}},{key:"readStringWithSize",value:function(e){switch(e){case 0:return null;case 1:return""}for(var t="",i=0;i<e;){var n=this.readUnsignedByte();switch(n>>4){case 12:case 13:t+=String.fromCharCode((31&n)<<6|63&this.readUnsignedByte()),i+=2;break;case 14:t+=String.fromCharCode((15&n)<<12|(63&this.readUnsignedByte())<<6|63&this.readUnsignedByte()),i+=3;break;default:t+=String.fromCharCode(n),i++}}return t}},{key:"readString",value:function(){var e=this.readInt(!0);switch(e){case 0:return null;case 1:return""}e--;for(var t="",i=0;i<e;){var n=this.readUnsignedByte();switch(n>>4){case 12:case 13:t+=String.fromCharCode((31&n)<<6|63&this.readUnsignedByte()),i+=2;break;case 14:t+=String.fromCharCode((15&n)<<12|(63&this.readUnsignedByte())<<6|63&this.readUnsignedByte()),i+=3;break;default:t+=String.fromCharCode(n),i++}}return t}},{key:"readFloat",value:function(){var e=this.buffer.getFloat32(this.index);return this.index+=4,e}},{key:"readBoolean",value:function(){return 0!==this.readByte()}}]),e}();t.BinaryInput=a},1055:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(8395),t),r(i(7503),t),r(i(6764),t)},4178:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Frustum=void 0;var a=i(4995),o=i(8606),l=i(7811),u=i(8845),h=function(){function e(){r(this,e),this.planes=new Array(6),this.planePoints=[new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3],this.planePointsArray=new Array(24);for(var t=0;t<6;t++)this.planes[t]=new u.Plane(new l.Vector3,0)}return s(e,[{key:"update",value:function(t){o.Utils.arrayCopy(e.clipSpacePlanePointsArray,0,this.planePointsArray,0,e.clipSpacePlanePointsArray.length),a.Matrix4.prj(t,this.planePointsArray,0,8,3);for(var i=0,n=0;i<8;i++){var r=this.planePoints[i];r.x=this.planePointsArray[n++],r.y=this.planePointsArray[n++],r.z=this.planePointsArray[n++]}this.planes[0].set(this.planePoints[1],this.planePoints[0],this.planePoints[2]),this.planes[1].set(this.planePoints[4],this.planePoints[5],this.planePoints[7]),this.planes[2].set(this.planePoints[0],this.planePoints[4],this.planePoints[3]),this.planes[3].set(this.planePoints[5],this.planePoints[1],this.planePoints[6]),this.planes[4].set(this.planePoints[2],this.planePoints[3],this.planePoints[6]),this.planes[5].set(this.planePoints[4],this.planePoints[0],this.planePoints[1])}},{key:"pointInFrustum",value:function(e){for(var t=0;t<this.planes.length;t++){if(this.planes[t].testPoint(e.x,e.y,e.z)===u.PlaneSide.Back)return!1}return!0}},{key:"sphereInFrustum",value:function(e,t){for(var i=0;i<6;i++)if(this.planes[i].normal.x*e.x+this.planes[i].normal.y*e.y+this.planes[i].normal.z*e.z<-t-this.planes[i].d)return!1;return!0}},{key:"sphereInFrustumWithoutNearFar",value:function(e,t){for(var i=2;i<6;i++)if(this.planes[i].normal.x*e.x+this.planes[i].normal.y*e.y+this.planes[i].normal.z*e.z<-t-this.planes[i].d)return!1;return!0}},{key:"boundsInFrustrum",value:function(e,t){for(var i=0,n=this.planes.length;i<n;i++)if(this.planes[i].testPoint(e.x+t.x/2,e.y+t.y/2,e.z+t.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(e.x+t.x/2,e.y+t.y/2,e.z-t.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(e.x+t.x/2,e.y-t.y/2,e.z+t.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(e.x+t.x/2,e.y-t.y/2,e.z-t.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(e.x-t.x/2,e.y+t.y/2,e.z+t.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(e.x-t.x/2,e.y+t.y/2,e.z-t.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(e.x-t.x/2,e.y-t.y/2,e.z+t.z/2)===u.PlaneSide.Back&&this.planes[i].testPoint(e.x-t.x/2,e.y-t.y/2,e.z-t.z/2)===u.PlaneSide.Back)return!1;return!0}}]),e}();t.Frustum=h,h.clipSpacePlanePoints=[new l.Vector3(-1,-1,-1),new l.Vector3(1,-1,-1),new l.Vector3(1,1,-1),new l.Vector3(-1,1,-1),new l.Vector3(-1,-1,1),new l.Vector3(1,-1,1),new l.Vector3(1,1,1),new l.Vector3(-1,1,1)],h.clipSpacePlanePointsArray=new Array(24),function(){var e,t=0,i=n(h.clipSpacePlanePoints);try{for(i.s();!(e=i.n()).done;){var r=e.value;h.clipSpacePlanePointsArray[t++]=r.x,h.clipSpacePlanePointsArray[t++]=r.y,h.clipSpacePlanePointsArray[t++]=r.z}}catch(s){i.e(s)}finally{i.f()}}(),h.tmpV=new l.Vector3},8845:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Plane=t.PlaneSide=void 0;var s,a=i(7811);!function(e){e[e.OnPlane=0]="OnPlane",e[e.Back=1]="Back",e[e.Front=2]="Front"}(s=t.PlaneSide||(t.PlaneSide={}));var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,e),this.normal=new a.Vector3,this.d=0,t&&(this.normal.setFrom(t).normalize(),this.d=i)}return r(e,[{key:"set",value:function(e,t,i){this.normal.set(e.x,e.y,e.z).sub(t).cross(new a.Vector3(t.x-i.x,t.y-i.y,t.z-i.z)).normalize(),this.d=-e.dot(this.normal)}},{key:"setByValue",value:function(e,t,i,n,r,s){this.normal.set(n,r,s),this.d=-(e*n+t*r+i*s)}},{key:"distance",value:function(e){return this.normal.dot(e)+this.d}},{key:"testPoint",value:function(e,t,i){var n=this.normal.dotWithValue(e,t,i)+this.d;return 0===n?s.OnPlane:n<0?s.Back:s.Front}},{key:"isFrontFacing",value:function(e){return this.normal.dot(e)<=0}},{key:"getNormal",value:function(){return this.normal}},{key:"getD",value:function(){return this.d}},{key:"setFromPlane",value:function(e){this.normal.setFrom(e.normal),this.d=e.d}},{key:"toString",value:function(){return this.normal.toString()+", "+this.d}}]),e}();t.Plane=o},4286:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(4178),t),r(i(8845),t)},8235:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Animation3D=void 0;var s=n((function e(){r(this,e),this.duration=0,this.nodeAnimations=[]}));t.Animation3D=s},3627:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MeshPart=void 0;var s=i(5477),a=i(7811),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n(this,e),this.id="",this.primitiveType=0,this.offset=0,this.size=0,this.mesh=null,this.center=new a.Vector3,this.halfExtents=new a.Vector3,this.radius=-1,this.bounds=new s.BoundingBox,t&&this.setByMeshPart(t)}return r(e,[{key:"dispose",value:function(){}},{key:"setByMeshPart",value:function(e){return this.id=e.id,this.mesh=e.mesh,this.offset=e.offset,this.size=e.size,this.primitiveType=e.primitiveType,this.center.set(e.center.x,e.center.y,e.center.z),this.halfExtents.set(e.halfExtents.x,e.halfExtents.y,e.halfExtents.z),this.radius=e.radius,this}},{key:"set",value:function(e,t,i,n,r){return this.id=e,this.mesh=t,this.offset=i,this.size=n,this.primitiveType=r,this.center.set(0,0,0),this.halfExtents.set(0,0,0),this.radius=-1,this}},{key:"update",value:function(){this.mesh.extendBoundingBox(this.bounds,this.offset,this.size,null),this.bounds.getCenter(this.center),this.bounds.getDimensions(this.halfExtents).scale(.5),this.radius=this.halfExtents.length()}},{key:"equals",value:function(e){return e===this||!!e&&e.mesh===this.mesh&&e.primitiveType===this.primitiveType&&e.offset===this.offset&&e.size===this.size}},{key:"render",value:function(e,t){this.mesh.render(e,this.primitiveType,this.offset,this.size,t)}}]),e}();t.MeshPart=o},663:function(e,t,i){"use strict";var n=i(7424).default,r=i(4704).default,s=i(7061).default,a=i(6690).default,o=i(9728).default,l=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function a(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var u=i(4995),h=i(5122),c=i(8606),f=i(7811),d=i(847),m=i(1733),_=i(5412),p=i(2398),v=i(427),y=i(8552),g=i(4023),x=i(5766),b=i(2668),w=i(8235),A=i(9373),S=i(3627),M=i(1960),C=i(5388),k=i(5904),B=i(5413),V=function(){function e(t){a(this,e),this.gl=t,this.materials=[],this.nodes=[],this.animations=[],this.meshes=[],this.meshParts=[],this.disposables=[],this.nodePartBones=new Map}return o(e,[{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new b.FileTextureProvider;return l(this,void 0,void 0,s().mark((function i(){return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.loadMeshes(e.meshes),i.next=3,this.loadMaterials(e.materials,t);case 3:this.loadNodes(e.nodes),this.loadAnimations(e.animations),this.calculateTransforms();case 6:case"end":return i.stop()}}),i,this)})))}},{key:"loadAnimations",value:function(e){var t,i=r(e);try{for(i.s();!(t=i.n()).done;){var n=t.value,s=new w.Animation3D;s.id=n.id;var a,o=r(n.nodeAnimations);try{for(o.s();!(a=o.n()).done;){var l=a.value,u=this.getNode(l.nodeId);if(u){var c=new C.NodeAnimation;if(c.node=u,l.translation){c.translation=new Array;var d,m=r(l.translation);try{for(m.s();!(d=m.n()).done;){var _=d.value;_.keytime>s.duration&&(s.duration=_.keytime),c.translation.push(new k.NodeKeyframe(_.keytime,(new f.Vector3).setFrom(_.value?_.value:u.translation)))}}catch(A){m.e(A)}finally{m.f()}}if(l.rotation){c.rotation=new Array;var p,v=r(l.rotation);try{for(v.s();!(p=v.n()).done;){var y=p.value;y.keytime>s.duration&&(s.duration=y.keytime),c.rotation.push(new k.NodeKeyframe(y.keytime,(new h.Quaternion).setFrom(y.value?y.value:u.rotation)))}}catch(A){v.e(A)}finally{v.f()}}if(l.scaling){c.scaling=new Array;var g,x=r(l.scaling);try{for(x.s();!(g=x.n()).done;){var b=g.value;b.keytime>s.duration&&(s.duration=b.keytime),c.scaling.push(new k.NodeKeyframe(b.keytime,(new f.Vector3).setFrom(b.value?b.value:u.scale)))}}catch(A){x.e(A)}finally{x.f()}}(c.translation&&c.translation.length>0||c.rotation&&c.rotation.length>0||c.scaling&&c.scaling.length>0)&&s.nodeAnimations.push(c)}}}catch(A){o.e(A)}finally{o.f()}s.nodeAnimations.length>0&&this.animations.push(s)}}catch(A){i.e(A)}finally{i.f()}}},{key:"loadNodes",value:function(e){this.nodePartBones.clear();var t,i=r(e);try{for(i.s();!(t=i.n()).done;){var s=t.value;this.nodes.push(this.loadNode(s))}}catch(p){i.e(p)}finally{i.f()}var a,o=r(this.nodePartBones);try{for(o.s();!(a=o.n()).done;){var l=n(a.value,2),h=l[0],f=l[1];h.invBoneBindTransforms||(h.invBoneBindTransforms=new c.ArrayMap),h.invBoneBindTransforms.clear();for(var d=0;d<f.size;d++){var m=f.keys[d],_=f.values[d];h.invBoneBindTransforms.set(this.getNode(m),(new u.Matrix4).set(_.values).invert())}}}catch(p){o.e(p)}finally{o.f()}}},{key:"loadNode",value:function(e){var t=new M.Node;if(t.id=e.id,e.translation&&t.translation.set(e.translation.x,e.translation.y,e.translation.z),e.rotation&&t.rotation.set(e.rotation.x,e.rotation.y,e.rotation.z,e.rotation.w),e.scale&&t.scale.set(e.scale.x,e.scale.y,e.scale.z),e.parts){var i,n=r(e.parts);try{for(n.s();!(i=n.n()).done;){var s=i.value,a=null,o=null;if(s.meshPartId){var l,u=r(this.meshParts);try{for(u.s();!(l=u.n()).done;){var h=l.value;if(s.meshPartId===h.id){a=h;break}}}catch(y){u.e(y)}finally{u.f()}}if(s.materialId){var c,f=r(this.materials);try{for(f.s();!(c=f.n()).done;){var d=c.value;if(s.materialId===d.id){o=d;break}}}catch(y){f.e(y)}finally{f.f()}}if(!a||!o)throw new Error("Invalid node: "+t.id);var m=new B.NodePart;m.meshPart=a,m.material=o,t.parts.push(m),s.bones&&this.nodePartBones.set(m,s.bones)}}catch(y){n.e(y)}finally{n.f()}}if(e.children){var _,p=r(e.children);try{for(p.s();!(_=p.n()).done;){var v=_.value;t.addChild(this.loadNode(v))}}catch(y){p.e(y)}finally{p.f()}}return t}},{key:"loadMeshes",value:function(e){var t,i=r(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.convertMesh(n)}}catch(s){i.e(s)}finally{i.f()}}},{key:"convertMesh",value:function(e){var t,i=0,n=r(e.parts);try{for(n.s();!(t=n.n()).done;){i+=t.value.indices.length}}catch(y){n.e(y)}finally{n.f()}var s=i>0,a=new v.VertexAttributes(e.attributes),o=e.vertices.length/(a.vertexSize/4),l=new x.Mesh3D(this.gl,!0,!0,o,i,a);this.meshes.push(l),this.disposables.push(l),l.vertices.updateVertices(0,e.vertices,0,e.vertices.length);var u,h=0,c=0,f=r(e.parts);try{for(f.s();!(u=f.n()).done;){var d=u.value,m=new S.MeshPart;m.id=d.id,m.primitiveType=d.primitiveType,m.offset=h,m.size=s?d.indices.length:o,m.mesh=l,s&&(l.indices.updateIndices(c,d.indices,0,d.indices.length),c+=d.indices.length),h+=m.size,this.meshParts.push(m)}}catch(y){f.e(y)}finally{f.f()}var _,p=r(this.meshParts);try{for(p.s();!(_=p.n()).done;){_.value.update()}}catch(y){p.e(y)}finally{p.f()}}},{key:"loadMaterials",value:function(e,t){return l(this,void 0,void 0,s().mark((function i(){var n,a,o;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=r(e),i.prev=1,n.s();case 3:if((a=n.n()).done){i.next=12;break}return o=a.value,i.t0=this.materials,i.next=8,this.convertMaterial(o,t);case 8:i.t1=i.sent,i.t0.push.call(i.t0,i.t1);case 10:i.next=3;break;case 12:i.next=17;break;case 14:i.prev=14,i.t2=i.catch(1),n.e(i.t2);case 17:return i.prev=17,n.f(),i.finish(17);case 20:case"end":return i.stop()}}),i,this,[[1,14,17,20]])})))}},{key:"convertMaterial",value:function(e,t){return l(this,void 0,void 0,s().mark((function i(){var n,a,o,l,u,h,c,f,v,x,b;return s().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((n=new g.Material).id=e.id,void 0!==e.ambient&&n.set(new m.ColorAttribute3D(m.ColorAttribute3D.Ambient,e.ambient)),void 0!==e.diffuse&&n.set(new m.ColorAttribute3D(m.ColorAttribute3D.Diffuse,e.diffuse)),void 0!==e.specular&&n.set(new m.ColorAttribute3D(m.ColorAttribute3D.Specular,e.specular)),void 0!==e.emissive&&n.set(new m.ColorAttribute3D(m.ColorAttribute3D.Emissive,e.emissive)),void 0!==e.reflection&&n.set(new m.ColorAttribute3D(m.ColorAttribute3D.Reflection,e.reflection)),e.shininess>0&&n.set(new _.FloatAttribute(_.FloatAttribute.Shininess,e.shininess)),1!==e.opacity&&n.set(new d.BlendingAttribute(y.GL20.GL_SRC_ALPHA,y.GL20.GL_ONE_MINUS_SRC_ALPHA,!0,e.opacity)),a=new Map,void 0===e.textures){i.next=62;break}o=r(e.textures),i.prev=12,o.s();case 14:if((l=o.n()).done){i.next=54;break}if(u=l.value,h=void 0,!a.has(u.fileName)){i.next=21;break}h=a.get(u.fileName),i.next=26;break;case 21:return i.next=23,t.load(this.gl,u.fileName);case 23:h=i.sent,a.set(u.fileName,h),this.disposables.push(h);case 26:c=u.uvTranslation?u.uvTranslation.x:0,f=u.uvTranslation?u.uvTranslation.y:0,v=u.uvScaling?u.uvScaling.x:1,x=u.uvScaling?u.uvScaling.y:1,b=void 0,i.t0=u.usage,i.next=i.t0===A.ModelTexture.USAGE_DIFFUSE?34:i.t0===A.ModelTexture.USAGE_SPECULAR?36:i.t0===A.ModelTexture.USAGE_BUMP?38:i.t0===A.ModelTexture.USAGE_NORMAL?40:i.t0===A.ModelTexture.USAGE_AMBIENT?42:i.t0===A.ModelTexture.USAGE_EMISSIVE?44:i.t0===A.ModelTexture.USAGE_REFLECTION?46:48;break;case 34:return b=new p.TextureAttribute(p.TextureAttribute.Diffuse,c,f,v,x),i.abrupt("break",48);case 36:return b=new p.TextureAttribute(p.TextureAttribute.Specular,c,f,v,x),i.abrupt("break",48);case 38:return b=new p.TextureAttribute(p.TextureAttribute.Bump,c,f,v,x),i.abrupt("break",48);case 40:return b=new p.TextureAttribute(p.TextureAttribute.Normal,c,f,v,x),i.abrupt("break",48);case 42:return b=new p.TextureAttribute(p.TextureAttribute.Ambient,c,f,v,x),i.abrupt("break",48);case 44:return b=new p.TextureAttribute(p.TextureAttribute.Emissive,c,f,v,x),i.abrupt("break",48);case 46:return b=new p.TextureAttribute(p.TextureAttribute.Reflection,c,f,v,x),i.abrupt("break",48);case 48:b.setTexture(h),b.setOffset(c,f),b.setScale(v,x),n.set(b);case 52:i.next=14;break;case 54:i.next=59;break;case 56:i.prev=56,i.t1=i.catch(12),o.e(i.t1);case 59:return i.prev=59,o.f(),i.finish(59);case 62:return i.abrupt("return",n);case 63:case"end":return i.stop()}}),i,this,[[12,56,59,62]])})))}},{key:"manageDisposable",value:function(e){this.disposables.indexOf(e)<0&&this.disposables.push(e)}},{key:"getManagedDisposables",value:function(){return this.disposables}},{key:"dispose",value:function(){var e,t=r(this.disposables);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(i){t.e(i)}finally{t.f()}}},{key:"calculateTransforms",value:function(){for(var e=this.nodes.length,t=0;t<e;t++)this.nodes[t].calculateTransforms(!0);for(var i=0;i<e;i++)this.nodes[i].calculateBoneTransforms(!0)}},{key:"calculateBoundingBox",value:function(e){return e.inf(),this.extendBoundingBox(e)}},{key:"extendBoundingBox",value:function(e){for(var t=this.nodes.length,i=0;i<t;i++)this.nodes[i].extendBoundingBox(e);return e}},{key:"getAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.animations.length;if(t){for(var n=0;n<i;n++)if(this.animations[n].id.toUpperCase()===e.toUpperCase())return this.animations[n]}else for(var r=0;r<i;r++)if(this.animations[r].id===e)return this.animations[r];return null}},{key:"getMaterial",value:function(e){var t,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.materials.length;if(i){for(var r=0;r<n;r++)if((t=this.materials[r]).id.toUpperCase()===e.toUpperCase())return t}else for(var s=0;s<n;s++)if((t=this.materials[s]).id===e)return t;return null}},{key:"getNode",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return M.Node.getNode(this.nodes,e,t,i)}}]),e}();t.Model=V},1960:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;var a=i(4995),o=i(5122),l=i(7811),u=function(){function e(){r(this,e),this.inheritTransform=!0,this.isAnimated=!1,this.translation=new l.Vector3,this.rotation=new o.Quaternion(0,0,0,1),this.scale=new l.Vector3(1,1,1),this.localTransform=new a.Matrix4,this.globalTransform=new a.Matrix4,this.parts=new Array,this.parent=null,this.children=new Array}return s(e,[{key:"calculateLocalTransform",value:function(){return this.isAnimated||this.localTransform.setFromTranslationRotation(this.translation,this.rotation,this.scale),this.localTransform}},{key:"calculateWorldTransform",value:function(){return this.inheritTransform&&this.parent?this.globalTransform.set(this.parent.globalTransform.values).multiply(this.localTransform):this.globalTransform.set(this.localTransform.values),this.globalTransform}},{key:"calculateTransforms",value:function(e){if(this.calculateLocalTransform(),this.calculateWorldTransform(),e){var t,i=n(this.children);try{for(i.s();!(t=i.n()).done;){t.value.calculateTransforms(!0)}}catch(r){i.e(r)}finally{i.f()}}}},{key:"calculateBoneTransforms",value:function(e){var t,i=n(this.parts);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.invBoneBindTransforms&&r.bones&&r.invBoneBindTransforms.size===r.bones.length)for(var s=0;s<r.invBoneBindTransforms.size;s++)r.bones[s].set(r.invBoneBindTransforms.keys[s].globalTransform.values).multiply(r.invBoneBindTransforms.values[s])}}catch(l){i.e(l)}finally{i.f()}if(e){var a,o=n(this.children);try{for(o.s();!(a=o.n()).done;){a.value.calculateBoneTransforms(!0)}}catch(l){o.e(l)}finally{o.f()}}}},{key:"calculateBoundingBox",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.inf(),this.extendBoundingBox(e,t)}},{key:"extendBoundingBox",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.parts.length,n=0;n<i;n++){var r=this.parts[n];if(r.enabled){var s=r.meshPart;t?s.mesh.extendBoundingBox(e,s.offset,s.size,this.globalTransform):s.mesh.extendBoundingBox(e,s.offset,s.size,null)}}for(var a=this.children.length,o=0;o<a;o++)this.children[o].extendBoundingBox(e);return e}},{key:"attachTo",value:function(e){e.addChild(this)}},{key:"detach",value:function(){this.parent&&(this.parent.removeChild(this),this.parent=null)}},{key:"hasChildren",value:function(){return!!this.children&&this.children.length>0}},{key:"getChildCount",value:function(){return this.children.length}},{key:"getChildByIndex",value:function(e){return this.children[e]}},{key:"getChild",value:function(t,i,n){return e.getNode(this.children,t,i,n)}},{key:"addChild",value:function(e){return this.insertChild(-1,e)}},{key:"insertChild",value:function(e,t){for(var i=this;i;i=i.getParent())if(i===t)throw new Error("Cannot add a parent as a child");var n=t.getParent();if(n&&!n.removeChild(t))throw new Error("Could not remove child from its current parent");return e<0||e>=this.children.length?(e=this.children.length,this.children.push(t)):this.children.splice(e,0,t),t.parent=this,e}},{key:"removeChild",value:function(e){var t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),!0)}},{key:"getChildren",value:function(){return this.children}},{key:"getParent",value:function(){return this.parent}},{key:"hasParent",value:function(){return!!this.parent}},{key:"copy",value:function(){return(new e).set(this)}},{key:"set",value:function(e){this.detach(),this.id=e.id,this.isAnimated=e.isAnimated,this.inheritTransform=e.inheritTransform,this.translation.setFrom(e.translation),this.rotation.setFrom(e.rotation),this.scale.setFrom(e.scale),this.localTransform.set(e.localTransform.values),this.globalTransform.set(e.globalTransform.values),this.parts.length=0;var t,i=n(e.parts);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.parts.push(r.copy())}}catch(l){i.e(l)}finally{i.f()}this.children.length=0;var s,a=n(e.getChildren());try{for(a.s();!(s=a.n()).done;){var o=s.value;this.addChild(o.copy())}}catch(l){a.e(l)}finally{a.f()}return this}}],[{key:"getNode",value:function(e,t,i,n){var r,s=e.length;if(n){for(var a=0;a<s;a++)if((r=e[a]).id.toUpperCase()===t.toUpperCase())return r}else for(var o=0;o<s;o++)if((r=e[o]).id===t)return r;if(i)for(var l=0;l<s;l++)if(r=this.getNode(e[l].children,t,!0,n))return r;return null}}]),e}();t.Node=u},5388:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.NodeAnimation=void 0;var s=n((function e(){r(this,e),this.translation=null,this.rotation=null,this.scaling=null}));t.NodeAnimation=s},5904:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.NodeKeyframe=void 0;var s=n((function e(t,i){r(this,e),this.value=null,this.keytime=t,this.value=i}));t.NodeKeyframe=s},5413:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.NodePart=void 0;var s=i(4995),a=i(8606),o=i(3627),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n(this,e),this.invBoneBindTransforms=null,this.bones=null,this.enabled=!0,this.meshPart=t,this.material=i}return r(e,[{key:"copy",value:function(){return(new e).set(this)}},{key:"setRenderable",value:function(e){return e.material=this.material,e.meshPart.setByMeshPart(this.meshPart),e.bones=this.bones,e}},{key:"set",value:function(e){if(this.meshPart=new o.MeshPart(e.meshPart),this.material=e.material,this.enabled=e.enabled,e.invBoneBindTransforms){this.invBoneBindTransforms||(this.invBoneBindTransforms=new a.ArrayMap),this.invBoneBindTransforms.clear();for(var t=0;t<e.invBoneBindTransforms.size;t++)this.invBoneBindTransforms.set(e.invBoneBindTransforms.keys[t],e.invBoneBindTransforms.values[t]);this.bones&&this.bones.length===this.invBoneBindTransforms.size||(this.bones=new Array);for(var i=0;i<this.invBoneBindTransforms.size;i++)void 0===this.bones[i]&&(this.bones[i]=new s.Matrix4)}else this.invBoneBindTransforms=null,this.bones=null;return this}}]),e}();t.NodePart=l},129:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelAnimation=void 0;var s=n((function e(){r(this,e),this.nodeAnimations=[]}));t.ModelAnimation=s},8896:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelData=void 0;var a=function(){function e(){r(this,e),this.version=[],this.meshes=[],this.materials=[],this.nodes=[],this.animations=[]}return s(e,[{key:"addMesh",value:function(e){var t,i=n(this.meshes);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.id===e.id)throw new Error("Mesh with id '"+r.id+"' already in model")}}catch(s){i.e(s)}finally{i.f()}this.meshes.push(e)}}]),e}();t.ModelData=a},798:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelMaterial=t.MaterialType=void 0,function(e){e[e.Lambert=0]="Lambert",e[e.Phong=1]="Phong"}(t.MaterialType||(t.MaterialType={}));var s=n((function e(){r(this,e),this.opacity=1}));t.ModelMaterial=s},779:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelMesh=void 0;var s=n((function e(){r(this,e)}));t.ModelMesh=s},3710:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelMeshPart=void 0;var s=n((function e(){r(this,e)}));t.ModelMeshPart=s},4610:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelNode=void 0;var s=n((function e(){r(this,e)}));t.ModelNode=s},7416:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelNodeAnimation=void 0;var s=n((function e(){r(this,e),this.translation=null,this.rotation=null,this.scaling=null}));t.ModelNodeAnimation=s},707:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelNodeKeyframe=void 0;var s=n((function e(){r(this,e),this.value=null}));t.ModelNodeKeyframe=s},3309:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelNodePart=void 0;var s=n((function e(){r(this,e)}));t.ModelNodePart=s},9373:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelTexture=void 0;var s=n((function e(){r(this,e)}));t.ModelTexture=s,s.USAGE_UNKNOWN=0,s.USAGE_NONE=1,s.USAGE_DIFFUSE=2,s.USAGE_EMISSIVE=3,s.USAGE_AMBIENT=4,s.USAGE_SPECULAR=5,s.USAGE_SHININESS=6,s.USAGE_NORMAL=7,s.USAGE_BUMP=8,s.USAGE_TRANSPARENCY=9,s.USAGE_REFLECTION=10},6357:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(129),t),r(i(8896),t),r(i(798),t),r(i(779),t),r(i(3710),t),r(i(4610),t),r(i(7416),t),r(i(707),t),r(i(3309),t),r(i(9373),t)},4501:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(8235),t),r(i(6357),t),r(i(3627),t),r(i(663),t),r(i(1960),t),r(i(5388),t),r(i(5904),t),r(i(5413),t)},4678:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BaseShader=t.Uniform=t.LocalSetter=t.GlobalSetter=void 0;var s=i(2802),a=function(){function e(){n(this,e)}return r(e,[{key:"isGlobal",value:function(e,t){return!0}}]),e}();t.GlobalSetter=a;var o=function(){function e(){n(this,e)}return r(e,[{key:"isGlobal",value:function(e,t){return!1}}]),e}();t.LocalSetter=o;var l=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(this,e),this.alias=t,this.materialMask=i,this.environmentMask=r,this.overallMask=s}return r(e,[{key:"validate",value:function(e,t,i){var n=i&&i.material?i.material.getMask():0,r=i&&i.environment?i.environment.getMask():0;return(n&this.materialMask)===this.materialMask&&(r&this.environmentMask)===this.environmentMask&&((n|r)&this.overallMask)===this.overallMask}}]),e}();t.Uniform=l;var u=function(){function e(){n(this,e),this.uniforms=[],this.validators=[],this.setters=[],this.globalUniforms=[],this.localUniforms=[],this.attributes=new Map,this.combinedAttributes=new s.Attributes,this.tempArray=[]}return r(e,[{key:"canRender",value:function(e){return!0}},{key:"init",value:function(){}},{key:"compareTo",value:function(e){}},{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.getUniformID(e);return n>=0?(this.validators.splice(n,0,t),this.setters.splice(n,0,i),n):(this.uniforms.push(e),this.validators.push(t),this.setters.push(i),this.uniforms.length-1)}},{key:"getUniformID",value:function(e){for(var t=this.uniforms.length,i=0;i<t;i++)if(this.uniforms[i]===e)return i;return-1}},{key:"getUniformAlias",value:function(e){return this.uniforms[e]}},{key:"initWithVariables",value:function(e,t){if(this.locations)throw new Error("Already initialized");this.program=e;var i=this.uniforms.length;this.locations=new Array(i);for(var n=0;n<i;n++){var r=this.uniforms[n],s=this.validators[n],a=this.setters[n];s&&!s.validate(this,n,t)?this.locations[n]=null:(this.locations[n]=e.getUniformLocation(r,!1),this.locations[n]&&a&&(a.isGlobal(this,n)?this.globalUniforms.push(n):this.localUniforms.push(n))),this.locations[n]||this.validators.splice(n,0,null)}if(t)for(var o=t.meshPart.mesh.getVertexAttributes(),l=o.size(),u=0;u<l;u++){var h=o.get(u),c=e.getAttributeLocation(h.alias);c>=0&&this.attributes.set(h.getKey(),c)}}},{key:"begin",value:function(e,t){this.camera=e,this.context=t,this.program.bind(),this.currentMesh=null;for(var i=0;i<this.globalUniforms.length;++i){var n=this.globalUniforms[i];this.setters[n]&&this.setters[n].set(this,n,null,null)}}},{key:"render",value:function(e){0!==e.worldTransform.det3x3()&&(this.combinedAttributes.clear(),e.environment&&this.combinedAttributes.setAttributes(e.environment.getAttributes()),e.material&&this.combinedAttributes.setAttributes(e.material.getAttributes()),this.renderWithCombinedAttributes(e,this.combinedAttributes))}},{key:"renderWithCombinedAttributes",value:function(e,t){for(var i,n=0;n<this.localUniforms.length;++n)this.setters[i=this.localUniforms[n]]&&this.setters[i].set(this,i,e,t);this.currentMesh!==e.meshPart.mesh&&(this.currentMesh&&this.currentMesh.unbind(this.program),this.currentMesh=e.meshPart.mesh,this.currentMesh.bind(this.program,this.getAttributeLocations(e.meshPart.mesh.getVertexAttributes()))),e.meshPart.render(this.program,!1)}},{key:"getAttributeLocations",value:function(e){this.tempArray.length=0;for(var t=e.size(),i=0;i<t;i++){var n=this.attributes.get(e.get(i).getKey());void 0!==n&&null!==n||(n=-1),this.tempArray.push(n)}return this.tempArray}},{key:"end",value:function(){this.currentMesh&&(this.currentMesh.unbind(this.program),this.currentMesh=null)}},{key:"dispose",value:function(){this.program=null,this.uniforms.length=0,this.validators.length=0,this.setters.length=0,this.localUniforms.length=0,this.globalUniforms.length=0,this.locations=null}},{key:"has",value:function(e){return e>=0&&e<this.locations.length&&!!this.locations[e]}},{key:"loc",value:function(e){return e>=0&&e<this.locations.length?this.locations[e]:null}},{key:"setMatrix4",value:function(e,t){return!!this.uniforms[e]&&(this.program.setUniform4x4f(this.uniforms[e],t.values),!0)}},{key:"setMatrix3",value:function(e,t){return!!this.uniforms[e]&&(this.program.setUniform3x3f(this.uniforms[e],t.getValues()),!0)}},{key:"setVector3",value:function(e,t){return!!this.uniforms[e]&&(this.program.setUniform3f(this.uniforms[e],t.x,t.y,t.z),!0)}},{key:"setVector2",value:function(e,t){return!!this.uniforms[e]&&(this.program.setUniform2f(this.uniforms[e],t.x,t.y),!0)}},{key:"setColor",value:function(e,t){return!!this.uniforms[e]&&(this.program.setUniform4f(this.uniforms[e],t.r,t.g,t.b,t.a),!0)}},{key:"setF",value:function(e,t){return!!this.uniforms[e]&&(this.program.setUniformf(this.uniforms[e],t),!0)}},{key:"set2f",value:function(e,t,i){return!!this.uniforms[e]&&(this.program.setUniform2f(this.uniforms[e],t,i),!0)}},{key:"set3f",value:function(e,t,i,n){return!!this.uniforms[e]&&(this.program.setUniform3f(this.uniforms[e],t,i,n),!0)}},{key:"set4f",value:function(e,t,i,n,r){return!!this.uniforms[e]&&(this.program.setUniform4f(this.uniforms[e],t,i,n,r),!0)}},{key:"setI",value:function(e,t){return!!this.uniforms[e]&&(this.program.setUniformi(this.uniforms[e],t),!0)}},{key:"setTexture",value:function(e,t){return!!this.uniforms[e]&&(this.program.setUniformi(this.uniforms[e],this.context.textureBinder.bindTexture(t)),!0)}}]),e}();t.BaseShader=u},616:function(e,t,i){"use strict";var n=i(4704).default,r=i(1588).default,s=i(3808).default,a=i(1655).default,o=i(6389).default,l=i(9728).default,u=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultShader=t.Setters=t.Inputs=t.Bones=t.ACubemap=t.Config=void 0;var h=i(6239),c=i(4995),f=i(1858),d=i(8606),m=i(7811),_=i(2802),p=i(847),v=i(1733),y=i(9693),g=i(5412),x=i(603),b=i(4836),w=i(1148),A=i(2398),S=i(8633),M=i(7299),C=i(1843),k=i(1139),B=i(2036),V=i(8552),T=i(4678),P=l((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";u(this,e),this.vertexShader=null,this.fragmentShader=null,this.numDirectionalLights=2,this.numPointLights=5,this.numSpotLights=0,this.numBones=12,this.ignoreUnimplemented=!0,this.defaultCullFace=-1,this.defaultDepthFunc=-1,this.vertexShader=t,this.fragmentShader=i}));t.Config=P;var L=function(e){a(i,e);var t=o(i);function i(e,n){var r;return u(this,i),(r=t.call(this)).cacheAmbientCubemap=new M.AmbientCubemap,r.dirLightsOffset=e,r.pointLightsOffset=n,r}return l(i,[{key:"set",value:function(e,t,n,r){if(n.environment){if(n.worldTransform.getTranslation(i.tmpV1),r.has(v.ColorAttribute3D.AmbientLight)){var s=r.get(v.ColorAttribute3D.AmbientLight).color;this.cacheAmbientCubemap.setColor(s.r,s.g,s.b)}if(r.has(y.DirectionalLightsAttribute.Type))for(var a=r.get(y.DirectionalLightsAttribute.Type).lights,o=this.dirLightsOffset;o<a.length;o++)this.cacheAmbientCubemap.addWithColorAndDirection(a[o].color,a[o].direction);this.cacheAmbientCubemap.clamp(),e.program.setUniform3fv(e.getUniformAlias(t),this.cacheAmbientCubemap.data)}else e.program.setUniform3fv(e.getUniformAlias(t),i.ones)}}]),i}(T.LocalSetter);t.ACubemap=L,L.ones=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],L.tmpV1=new m.Vector3;var E=function(e){a(i,e);var t=o(i);function i(e){var n;return u(this,i),(n=t.call(this)).bones=new Array(16*e),n}return l(i,[{key:"set",value:function(e,t,n,r){for(var s=0;s<this.bones.length;s+=16){var a=s/16;!n.bones||a>=n.bones.length||!n.bones[a]?d.Utils.arrayCopy(i.idtMatrix.values,0,this.bones,s,16):d.Utils.arrayCopy(n.bones[a].values,0,this.bones,s,16)}e.program.setUniform4x4fWithLocation(e.loc(t),this.bones)}}]),i}(T.LocalSetter);t.Bones=E,E.idtMatrix=new c.Matrix4;var I=l((function e(){u(this,e)}));t.Inputs=I,I.projTrans=new T.Uniform("u_projTrans"),I.viewTrans=new T.Uniform("u_viewTrans"),I.projViewTrans=new T.Uniform("u_projViewTrans"),I.cameraPosition=new T.Uniform("u_cameraPosition"),I.cameraDirection=new T.Uniform("u_cameraDirection"),I.cameraUp=new T.Uniform("u_cameraUp"),I.cameraNearFar=new T.Uniform("u_cameraNearFar"),I.worldTrans=new T.Uniform("u_worldTrans"),I.viewWorldTrans=new T.Uniform("u_viewWorldTrans"),I.projViewWorldTrans=new T.Uniform("u_projViewWorldTrans"),I.normalMatrix=new T.Uniform("u_normalMatrix"),I.bones=new T.Uniform("u_bones"),I.shininess=new T.Uniform("u_shininess",g.FloatAttribute.Shininess),I.opacity=new T.Uniform("u_opacity",p.BlendingAttribute.Type),I.diffuseColor=new T.Uniform("u_diffuseColor",v.ColorAttribute3D.Diffuse),I.diffuseTexture=new T.Uniform("u_diffuseTexture",A.TextureAttribute.Diffuse),I.diffuseUVTransform=new T.Uniform("u_diffuseUVTransform",A.TextureAttribute.Diffuse),I.specularColor=new T.Uniform("u_specularColor",v.ColorAttribute3D.Specular),I.specularTexture=new T.Uniform("u_specularTexture",A.TextureAttribute.Specular),I.specularUVTransform=new T.Uniform("u_specularUVTransform",A.TextureAttribute.Specular),I.emissiveColor=new T.Uniform("u_emissiveColor",v.ColorAttribute3D.Emissive),I.emissiveTexture=new T.Uniform("u_emissiveTexture",A.TextureAttribute.Emissive),I.emissiveUVTransform=new T.Uniform("u_emissiveUVTransform",A.TextureAttribute.Emissive),I.reflectionColor=new T.Uniform("u_reflectionColor",v.ColorAttribute3D.Reflection),I.reflectionTexture=new T.Uniform("u_reflectionTexture",A.TextureAttribute.Reflection),I.reflectionUVTransform=new T.Uniform("u_reflectionUVTransform",A.TextureAttribute.Reflection),I.normalTexture=new T.Uniform("u_normalTexture",A.TextureAttribute.Normal),I.normalUVTransform=new T.Uniform("u_normalUVTransform",A.TextureAttribute.Normal),I.ambientTexture=new T.Uniform("u_ambientTexture",A.TextureAttribute.Ambient),I.ambientUVTransform=new T.Uniform("u_ambientUVTransform",A.TextureAttribute.Ambient),I.alphaTest=new T.Uniform("u_alphaTest"),I.ambientCube=new T.Uniform("u_ambientCubemap"),I.dirLights=new T.Uniform("u_dirLights"),I.pointLights=new T.Uniform("u_pointLights"),I.spotLights=new T.Uniform("u_spotLights"),I.environmentCubemap=new T.Uniform("u_environmentCubemap");var R=l((function e(){u(this,e)}));t.Setters=R,R.projTrans=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setMatrix4(t,e.camera.projection)}}]),i}(T.GlobalSetter)),R.viewTrans=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setMatrix4(t,e.camera.view)}}]),i}(T.GlobalSetter)),R.projViewTrans=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setMatrix4(t,e.camera.combined)}}]),i}(T.GlobalSetter)),R.cameraPosition=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.set4f(t,e.camera.position.x,e.camera.position.y,e.camera.position.y,1.1881/(e.camera.far*e.camera.far))}}]),i}(T.GlobalSetter)),R.cameraDirection=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setVector3(t,e.camera.direction)}}]),i}(T.GlobalSetter)),R.cameraUp=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setVector3(t,e.camera.up)}}]),i}(T.GlobalSetter)),R.cameraNearFar=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.set2f(t,e.camera.near,e.camera.far)}}]),i}(T.GlobalSetter)),R.worldTrans=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setMatrix4(t,i.worldTransform)}}]),i}(T.LocalSetter)),R.viewWorldTrans=new(function(e){a(i,e);var t=o(i);function i(){var e;return u(this,i),(e=t.apply(this,arguments)).temp=new c.Matrix4,e}return l(i,[{key:"set",value:function(e,t,i,n){e.setMatrix4(t,this.temp.set(e.camera.view.values).multiply(i.worldTransform))}}]),i}(T.LocalSetter)),R.projViewWorldTrans=new(function(e){a(i,e);var t=o(i);function i(){var e;return u(this,i),(e=t.apply(this,arguments)).temp=new c.Matrix4,e}return l(i,[{key:"set",value:function(e,t,i,n){e.setMatrix4(t,this.temp.set(e.camera.combined.values).multiply(i.worldTransform))}}]),i}(T.LocalSetter)),R.normalMatrix=new(function(e){a(i,e);var t=o(i);function i(){var e;return u(this,i),(e=t.apply(this,arguments)).tmpM=new h.Matrix3,e}return l(i,[{key:"set",value:function(e,t,i,n){e.setMatrix3(t,this.tmpM.setByMatrix4(i.worldTransform).inv().transpose())}}]),i}(T.LocalSetter)),R.shininess=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setF(t,n.get(g.FloatAttribute.Shininess).value)}}]),i}(T.LocalSetter)),R.diffuseColor=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setColor(t,n.get(v.ColorAttribute3D.Diffuse).color)}}]),i}(T.LocalSetter)),R.diffuseTexture=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=e.context.textureBinder.bindTexture(n.get(A.TextureAttribute.Diffuse).texture);e.setI(t,r)}}]),i}(T.LocalSetter)),R.diffuseUVTransform=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=n.get(A.TextureAttribute.Diffuse);e.set4f(t,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(T.LocalSetter)),R.specularColor=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setColor(t,n.get(v.ColorAttribute3D.Specular).color)}}]),i}(T.LocalSetter)),R.specularTexture=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=e.context.textureBinder.bindTexture(n.get(A.TextureAttribute.Specular).texture);e.setI(t,r)}}]),i}(T.LocalSetter)),R.specularUVTransform=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=n.get(A.TextureAttribute.Specular);e.set4f(t,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(T.LocalSetter)),R.emissiveColor=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setColor(t,n.get(v.ColorAttribute3D.Emissive).color)}}]),i}(T.LocalSetter)),R.emissiveTexture=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=e.context.textureBinder.bindTexture(n.get(A.TextureAttribute.Emissive).texture);e.setI(t,r)}}]),i}(T.LocalSetter)),R.emissiveUVTransform=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=n.get(A.TextureAttribute.Emissive);e.set4f(t,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(T.LocalSetter)),R.reflectionColor=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){e.setColor(t,n.get(v.ColorAttribute3D.Reflection).color)}}]),i}(T.LocalSetter)),R.reflectionTexture=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=e.context.textureBinder.bindTexture(n.get(A.TextureAttribute.Reflection).texture);e.setI(t,r)}}]),i}(T.LocalSetter)),R.reflectionUVTransform=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=n.get(A.TextureAttribute.Reflection);e.set4f(t,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(T.LocalSetter)),R.normalTexture=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=e.context.textureBinder.bindTexture(n.get(A.TextureAttribute.Normal).texture);e.setI(t,r)}}]),i}(T.LocalSetter)),R.normalUVTransform=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=n.get(A.TextureAttribute.Normal);e.set4f(t,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(T.LocalSetter)),R.ambientTexture=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=e.context.textureBinder.bindTexture(n.get(A.TextureAttribute.Ambient).texture);e.setI(t,r)}}]),i}(T.LocalSetter)),R.ambientUVTransform=new(function(e){a(i,e);var t=o(i);function i(){return u(this,i),t.apply(this,arguments)}return l(i,[{key:"set",value:function(e,t,i,n){var r=n.get(A.TextureAttribute.Ambient);e.set4f(t,r.offsetU,r.offsetV,r.scaleU,r.scaleV)}}]),i}(T.LocalSetter));var F=function(e){a(i,e);var t=o(i);function i(e,n){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return u(this,i),(r=t.call(this)).gl=e,r.u_dirLights0color=r.register("u_dirLights[0].color"),r.u_dirLights0direction=r.register("u_dirLights[0].direction"),r.u_dirLights1color=r.register("u_dirLights[1].color"),r.u_pointLights0color=r.register("u_pointLights[0].color"),r.u_pointLights0position=r.register("u_pointLights[0].position"),r.u_pointLights0intensity=r.register("u_pointLights[0].intensity"),r.u_pointLights1color=r.register("u_pointLights[1].color"),r.u_spotLights0color=r.register("u_spotLights[0].color"),r.u_spotLights0position=r.register("u_spotLights[0].position"),r.u_spotLights0intensity=r.register("u_spotLights[0].intensity"),r.u_spotLights0direction=r.register("u_spotLights[0].direction"),r.u_spotLights0cutoffAngle=r.register("u_spotLights[0].cutoffAngle"),r.u_spotLights0exponent=r.register("u_spotLights[0].exponent"),r.u_spotLights1color=r.register("u_spotLights[1].color"),r.u_fogColor=r.register("u_fogColor"),r.u_shadowMapProjViewTrans=r.register("u_shadowMapProjViewTrans"),r.u_shadowTexture=r.register("u_shadowTexture"),r.u_shadowPCFOffset=r.register("u_shadowPCFOffset"),r.lightLocs=new Array,r.ambientCubemap=new M.AmbientCubemap,r.tmpV1=new m.Vector3,0===o.length&&(o=i.defaultVertexShader),0===l.length&&(l=i.defaultFragmentShader),s?a=i.createPrefix(n,s):s=new P,r.createShader(n,s,new f.Shader(r.gl,a+o,a+l)),r}return l(i,[{key:"createShader",value:function(e,t,n){var r=i.combineAttributes(e);this.config=t,this.program=n,this.lighting=!!e.environment,this.environmentCubemap=!1,this.shadowMap=!1,this.renderable=e,this.attributesMask=r.getMask()|i.optionalAttributes,this.vertexMask=e.meshPart.mesh.getVertexAttributes().getMaskWithSizePacked(),this.directionalLights=new Array(this.lighting&&t.numDirectionalLights>0?t.numDirectionalLights:0);for(var s=0;s<this.directionalLights.length;s++)this.directionalLights[s]=new C.DirectionalLight;this.pointLights=new Array(this.lighting&&t.numPointLights>0?t.numPointLights:0);for(var a=0;a<this.pointLights.length;a++)this.pointLights[a]=new k.PointLight;this.spotLights=new Array(this.lighting&&t.numSpotLights>0?t.numSpotLights:0);for(var o=0;o<this.spotLights.length;o++)this.spotLights[o]=new B.SpotLight;if(!t.ignoreUnimplemented&&(i.implementedFlags&this.attributesMask)!==this.attributesMask)throw new Error("Some attributes not implemented yet ("+this.attributesMask+")");if(e.bones&&e.bones.length>t.numBones)throw new Error("too many bones: "+e.bones.length+", max configured: "+t.numBones);this.u_projTrans=this.register(I.projTrans.alias,null,R.projTrans),this.u_viewTrans=this.register(I.viewTrans.alias,null,R.viewTrans),this.u_projViewTrans=this.register(I.projViewTrans.alias,null,R.projViewTrans),this.u_cameraPosition=this.register(I.cameraPosition.alias,null,R.cameraPosition),this.u_cameraDirection=this.register(I.cameraDirection.alias,null,R.cameraDirection),this.u_cameraUp=this.register(I.cameraUp.alias,null,R.cameraUp),this.u_cameraNearFar=this.register(I.cameraNearFar.alias,null,R.cameraNearFar);var l=new T.Uniform("u_time");this.u_time=this.register(l.alias,l),this.u_worldTrans=this.register(I.worldTrans.alias,null,R.worldTrans),this.u_viewWorldTrans=this.register(I.viewWorldTrans.alias,null,R.viewWorldTrans),this.u_projViewWorldTrans=this.register(I.projViewWorldTrans.alias,null,R.projViewWorldTrans),this.u_normalMatrix=this.register(I.normalMatrix.alias,null,R.normalMatrix),this.u_bones=e.bones&&t.numBones>0?this.register(I.bones.alias,null,new E(t.numBones)):-1,this.u_shininess=this.register(I.shininess.alias,null,R.shininess),this.u_opacity=this.register(I.opacity.alias),this.u_diffuseColor=this.register(I.diffuseColor.alias,null,R.diffuseColor),this.u_diffuseTexture=this.register(I.diffuseTexture.alias,null,R.diffuseTexture),this.u_diffuseUVTransform=this.register(I.diffuseUVTransform.alias,null,R.diffuseUVTransform),this.u_specularColor=this.register(I.specularColor.alias,null,R.specularColor),this.u_specularTexture=this.register(I.specularTexture.alias,null,R.specularTexture),this.u_specularUVTransform=this.register(I.specularUVTransform.alias,null,R.specularUVTransform),this.u_emissiveColor=this.register(I.emissiveColor.alias,null,R.emissiveColor),this.u_emissiveTexture=this.register(I.emissiveTexture.alias,null,R.emissiveTexture),this.u_emissiveUVTransform=this.register(I.emissiveUVTransform.alias,null,R.emissiveUVTransform),this.u_reflectionColor=this.register(I.reflectionColor.alias,null,R.reflectionColor),this.u_reflectionTexture=this.register(I.reflectionTexture.alias,null,R.reflectionTexture),this.u_reflectionUVTransform=this.register(I.reflectionUVTransform.alias,null,R.reflectionUVTransform),this.u_normalTexture=this.register(I.normalTexture.alias,null,R.normalTexture),this.u_normalUVTransform=this.register(I.normalUVTransform.alias,null,R.normalUVTransform),this.u_ambientTexture=this.register(I.ambientTexture.alias,null,R.ambientTexture),this.u_ambientUVTransform=this.register(I.ambientUVTransform.alias,null,R.ambientUVTransform),this.u_alphaTest=this.register(I.alphaTest.alias),this.u_ambientCubemap=this.lighting?this.register(I.ambientCube.alias,null,new L(t.numDirectionalLights,t.numPointLights)):-1}},{key:"init",value:function(){var e=this.program;this.program=null,this.initWithVariables(e,this.renderable),this.renderable=null,this.dirLightsLoc=this.getLightLoc(this.u_dirLights0color),this.dirLightsColorOffset=this.getLightLoc(this.u_dirLights0color)-this.dirLightsLoc,this.dirLightsDirectionOffset=this.getLightLoc(this.u_dirLights0direction)-this.dirLightsLoc,this.dirLightsSize=this.getLightLoc(this.u_dirLights1color)-this.dirLightsLoc,this.dirLightsSize<0&&(this.dirLightsSize=0),this.pointLightsLoc=this.getLightLoc(this.u_pointLights0color),this.pointLightsColorOffset=this.getLightLoc(this.u_pointLights0color)-this.pointLightsLoc,this.pointLightsPositionOffset=this.getLightLoc(this.u_pointLights0position)-this.pointLightsLoc,this.pointLightsIntensityOffset=this.has(this.u_pointLights0intensity)?this.getLightLoc(this.u_pointLights0intensity)-this.pointLightsLoc:-1,this.pointLightsSize=this.getLightLoc(this.u_pointLights1color)-this.pointLightsLoc,this.pointLightsSize<0&&(this.pointLightsSize=0),this.spotLightsLoc=this.getLightLoc(this.u_spotLights0color),this.spotLightsColorOffset=this.getLightLoc(this.u_spotLights0color)-this.spotLightsLoc,this.spotLightsPositionOffset=this.getLightLoc(this.u_spotLights0position)-this.spotLightsLoc,this.spotLightsDirectionOffset=this.getLightLoc(this.u_spotLights0direction)-this.spotLightsLoc,this.spotLightsIntensityOffset=this.has(this.u_spotLights0intensity)?this.getLightLoc(this.u_spotLights0intensity)-this.spotLightsLoc:-1,this.spotLightsCutoffAngleOffset=this.getLightLoc(this.u_spotLights0cutoffAngle)-this.spotLightsLoc,this.spotLightsExponentOffset=this.getLightLoc(this.u_spotLights0exponent)-this.spotLightsLoc,this.spotLightsSize=this.getLightLoc(this.u_spotLights1color)-this.spotLightsLoc,this.spotLightsSize<0&&(this.spotLightsSize=0)}},{key:"canRender",value:function(e){if(e.bones&&e.bones.length>this.config.numBones)return!1;var t=i.combineAttributeMasks(e);return this.attributesMask===(t|i.optionalAttributes)&&this.vertexMask===e.meshPart.mesh.getVertexAttributes().getMaskWithSizePacked()&&!!e.environment===this.lighting}},{key:"begin",value:function(e,t){r(s(i.prototype),"begin",this).call(this,e,t);var a,o=n(this.directionalLights);try{for(o.s();!(a=o.n()).done;){a.value.set(0,0,0,0,-1,0)}}catch(f){o.e(f)}finally{o.f()}var l,u=n(this.pointLights);try{for(u.s();!(l=u.n()).done;){l.value.setFromValue(0,0,0,0,0,0,0)}}catch(f){u.e(f)}finally{u.f()}var h,c=n(this.spotLights);try{for(c.s();!(h=c.n()).done;){h.value.setFromValue(0,0,0,0,0,0,0,-1,0,0,1,0)}}catch(f){c.e(f)}finally{c.f()}this.lightsSet=!1}},{key:"renderWithCombinedAttributes",value:function(e,t){t.has(p.BlendingAttribute.Type)||this.context.setBlending(!1,V.GL20.GL_SRC_ALPHA,V.GL20.GL_ONE_MINUS_SRC_ALPHA),this.bindMaterial(t),this.lighting&&this.bindLights(e,t),r(s(i.prototype),"renderWithCombinedAttributes",this).call(this,e,t)}},{key:"end",value:function(){r(s(i.prototype),"end",this).call(this)}},{key:"bindMaterial",value:function(e){var t,r=-1===this.config.defaultCullFace?i.defaultCullFace:this.config.defaultCullFace,s=-1===this.config.defaultDepthFunc?i.defaultDepthFunc:this.config.defaultDepthFunc,a=n(e.getAttributes());try{for(a.s();!(t=a.n()).done;){var o=t.value,l=o.type;if(p.BlendingAttribute.is(l))this.context.setBlending(!0,o.sourceFunction,o.destFunction),this.setF(this.u_opacity,o.opacity);else if((l&x.IntAttribute.CullFace)===x.IntAttribute.CullFace)r=o.value;else if((l&g.FloatAttribute.AlphaTest)===g.FloatAttribute.AlphaTest)this.setF(this.u_alphaTest,o.value);else if(!this.config.ignoreUnimplemented)throw new Error("Unknown material attribute: "+o.toString())}}catch(u){a.e(u)}finally{a.f()}this.context.setCullFace(r),this.context.setDepthTest(s,0,1),this.context.setDepthMask(!0)}},{key:"bindLights",value:function(e,t){var i=t.get(y.DirectionalLightsAttribute.Type),n=i?i.lights:null,r=t.get(b.PointLightsAttribute.Type),s=r?r.lights:null,a=t.get(w.SpotLightsAttribute.Type),o=a?a.lights:null;if(this.dirLightsLoc>=0)for(var l=0;l<this.directionalLights.length;l++){if(!n||l>=n.length){if(this.lightsSet&&0===this.directionalLights[l].color.r&&0===this.directionalLights[l].color.g&&0===this.directionalLights[l].color.b)continue;this.directionalLights[l].color.set(0,0,0,1)}else{if(this.lightsSet&&this.directionalLights[l].equals(n[l]))continue;this.directionalLights[l].setFrom(n[l].color,n[l].direction)}var u=this.dirLightsLoc+l*this.dirLightsSize;if(this.program.setUniform3fWithLocation(this.lightLocs[u+this.dirLightsColorOffset],this.directionalLights[l].color.r,this.directionalLights[l].color.g,this.directionalLights[l].color.b),this.program.setUniform3fWithLocation(this.lightLocs[u+this.dirLightsDirectionOffset],this.directionalLights[l].direction.x,this.directionalLights[l].direction.y,this.directionalLights[l].direction.z),this.dirLightsSize<=0)break}if(this.pointLightsLoc>=0)for(var h=0;h<this.pointLights.length;h++){if(!s||h>=s.length){if(this.lightsSet&&0===this.pointLights[h].intensity)continue;this.pointLights[h].intensity=0}else{if(this.lightsSet&&this.pointLights[h].equals(s[h]))continue;this.pointLights[h].setFrom(s[h])}var c=this.pointLightsLoc+h*this.pointLightsSize;if(this.program.setUniform3fWithLocation(this.lightLocs[c+this.pointLightsColorOffset],this.pointLights[h].color.r*this.pointLights[h].intensity,this.pointLights[h].color.g*this.pointLights[h].intensity,this.pointLights[h].color.b*this.pointLights[h].intensity),this.program.setUniform3fWithLocation(this.lightLocs[c+this.pointLightsPositionOffset],this.pointLights[h].position.x,this.pointLights[h].position.y,this.pointLights[h].position.z),this.pointLightsIntensityOffset>=0&&this.program.setUniform1fWithLocation(this.lightLocs[c+this.pointLightsIntensityOffset],this.pointLights[h].intensity),this.pointLightsSize<=0)break}if(this.spotLightsLoc>=0)for(var f=0;f<this.spotLights.length;f++){if(!o||f>=o.length){if(this.lightsSet&&0===this.spotLights[f].intensity)continue;this.spotLights[f].intensity=0}else{if(this.lightsSet&&this.spotLights[f].equals(o[f]))continue;this.spotLights[f].setFrom(o[f])}var d=this.spotLightsLoc+f*this.spotLightsSize;if(this.program.setUniform3fWithLocation(this.lightLocs[d+this.spotLightsColorOffset],this.spotLights[f].color.r*this.spotLights[f].intensity,this.spotLights[f].color.g*this.spotLights[f].intensity,this.spotLights[f].color.b*this.spotLights[f].intensity),this.program.setUniform3fWithLocation(this.lightLocs[d+this.spotLightsPositionOffset],this.spotLights[f].position.x,this.spotLights[f].position.y,this.spotLights[f].position.z),this.program.setUniform3fWithLocation(this.lightLocs[d+this.spotLightsDirectionOffset],this.spotLights[f].direction.x,this.spotLights[f].direction.y,this.spotLights[f].direction.z),this.program.setUniform1fWithLocation(this.lightLocs[d+this.spotLightsCutoffAngleOffset],this.spotLights[f].cutoffAngle),this.program.setUniform1fWithLocation(this.lightLocs[d+this.spotLightsExponentOffset],this.spotLights[f].exponent),this.spotLightsIntensityOffset>=0&&this.program.setUniform1fWithLocation(this.lightLocs[d+this.spotLightsIntensityOffset],this.spotLights[f].intensity),this.spotLightsSize<=0)break}this.lightsSet=!0}},{key:"getLightLoc",value:function(e){var t=this.loc(e),i=this.lightLocs.indexOf(t);return t?i<0?(this.lightLocs.push(t),this.lightLocs.length-1):i:-1}},{key:"dispose",value:function(){this.program.dispose(),r(s(i.prototype),"dispose",this).call(this)}},{key:"getDefaultCullFace",value:function(){return-1===this.config.defaultCullFace?i.defaultCullFace:this.config.defaultCullFace}},{key:"setDefaultCullFace",value:function(e){this.config.defaultCullFace=e}},{key:"getDefaultDepthFunc",value:function(){return-1===this.config.defaultDepthFunc?i.defaultDepthFunc:this.config.defaultDepthFunc}},{key:"setDefaultDepthFunc",value:function(e){this.config.defaultDepthFunc=e}}],[{key:"and",value:function(e,t){return(e&t)===t}},{key:"or",value:function(e,t){return 0!==(e&t)}},{key:"combineAttributes",value:function(e){return this.tmpAttributes.clear(),e.environment&&this.tmpAttributes.setAttributes(e.environment.getAttributes()),e.material&&this.tmpAttributes.setAttributes(e.material.getAttributes()),this.tmpAttributes}},{key:"combineAttributeMasks",value:function(e){var t=0;return e.environment&&(t|=e.environment.getMask()),e.material&&(t|=e.material.getMask()),t}},{key:"createPrefix",value:function(e,t){var i=this.combineAttributes(e),n="",r=i.getMask(),s=e.meshPart.mesh.getVertexAttributes().getMask();this.and(s,S.Usage.Position)&&(n+="#define positionFlag\n"),this.or(s,S.Usage.ColorUnpacked|S.Usage.ColorPacked)&&(n+="#define colorFlag\n"),this.and(s,S.Usage.BiNormal)&&(n+="#define binormalFlag\n"),this.and(s,S.Usage.Tangent)&&(n+="#define tangentFlag\n"),this.and(s,S.Usage.Normal)&&(n+="#define normalFlag\n"),(this.and(s,S.Usage.Normal)||this.and(s,S.Usage.Tangent|S.Usage.BiNormal))&&e.environment&&(n+="#define lightingFlag\n",n+="#define ambientCubemapFlag\n",n+="#define numDirectionalLights "+t.numDirectionalLights+"\n",n+="#define numPointLights "+t.numPointLights+"\n",n+="#define numSpotLights "+t.numSpotLights+"\n",i.has(v.ColorAttribute3D.Fog)&&(n+="#define fogFlag\n"));for(var a=e.meshPart.mesh.getVertexAttributes().size(),o=0;o<a;o++){var l=e.meshPart.mesh.getVertexAttributes().get(o);l.usage===S.Usage.BoneWeight?n+="#define boneWeight"+l.unit+"Flag\n":l.usage===S.Usage.TextureCoordinates&&(n+="#define texCoords"+l.unit+"Flag\n")}return(r&p.BlendingAttribute.Type)===p.BlendingAttribute.Type&&(n+="#define "+p.BlendingAttribute.Alias+"Flag\n"),(r&A.TextureAttribute.Diffuse)===A.TextureAttribute.Diffuse&&(n+="#define "+A.TextureAttribute.DiffuseAlias+"Flag\n",n+="#define "+A.TextureAttribute.DiffuseAlias+"Coord texCoords0\n"),(r&A.TextureAttribute.Specular)===A.TextureAttribute.Specular&&(n+="#define "+A.TextureAttribute.SpecularAlias+"Flag\n",n+="#define "+A.TextureAttribute.SpecularAlias+"Coord texCoords0\n"),(r&A.TextureAttribute.Normal)===A.TextureAttribute.Normal&&(n+="#define "+A.TextureAttribute.NormalAlias+"Flag\n",n+="#define "+A.TextureAttribute.NormalAlias+"Coord texCoords0\n"),(r&A.TextureAttribute.Emissive)===A.TextureAttribute.Emissive&&(n+="#define "+A.TextureAttribute.EmissiveAlias+"Flag\n",n+="#define "+A.TextureAttribute.EmissiveAlias+"Coord texCoords0\n"),(r&A.TextureAttribute.Reflection)===A.TextureAttribute.Reflection&&(n+="#define "+A.TextureAttribute.ReflectionAlias+"Flag\n",n+="#define "+A.TextureAttribute.ReflectionAlias+"Coord texCoords0\n"),(r&A.TextureAttribute.Ambient)===A.TextureAttribute.Ambient&&(n+="#define "+A.TextureAttribute.AmbientAlias+"Flag\n",n+="#define "+A.TextureAttribute.AmbientAlias+"Coord texCoords0\n"),(r&v.ColorAttribute3D.Diffuse)===v.ColorAttribute3D.Diffuse&&(n+="#define "+v.ColorAttribute3D.DiffuseAlias+"Flag\n"),(r&v.ColorAttribute3D.Specular)===v.ColorAttribute3D.Specular&&(n+="#define "+v.ColorAttribute3D.SpecularAlias+"Flag\n"),(r&v.ColorAttribute3D.Emissive)===v.ColorAttribute3D.Emissive&&(n+="#define "+v.ColorAttribute3D.EmissiveAlias+"Flag\n"),(r&v.ColorAttribute3D.Reflection)===v.ColorAttribute3D.Reflection&&(n+="#define "+v.ColorAttribute3D.ReflectionAlias+"Flag\n"),(r&g.FloatAttribute.Shininess)===g.FloatAttribute.Shininess&&(n+="#define "+g.FloatAttribute.ShininessAlias+"Flag\n"),(r&g.FloatAttribute.AlphaTest)===g.FloatAttribute.AlphaTest&&(n+="#define "+g.FloatAttribute.AlphaTestAlias+"Flag\n"),e.bones&&t.numBones>0&&(n+="#define numBones "+t.numBones+"\n"),n}}]),i}(T.BaseShader);t.DefaultShader=F,F.defaultVertexShader="\n  #if defined(diffuseTextureFlag) || defined(specularTextureFlag) || defined(emissiveTextureFlag)\n  #define textureFlag\n  #endif\n\n  #if defined(specularTextureFlag) || defined(specularColorFlag)\n  #define specularFlag\n  #endif\n\n  #if defined(specularFlag) || defined(fogFlag)\n  #define cameraPositionFlag\n  #endif\n\n  attribute vec3 a_position;\n  uniform mat4 u_projViewTrans;\n\n  #if defined(colorFlag)\n  varying vec4 v_color;\n  attribute vec4 a_color;\n  #endif // colorFlag\n\n  #ifdef normalFlag\n  attribute vec3 a_normal;\n  uniform mat3 u_normalMatrix;\n  varying vec3 v_normal;\n  #endif // normalFlag\n\n  #ifdef textureFlag\n  attribute vec2 a_texCoords0;\n  #endif // textureFlag\n\n  #ifdef diffuseTextureFlag\n  uniform vec4 u_diffuseUVTransform;\n  varying vec2 v_diffuseUV;\n  #endif\n\n  #ifdef emissiveTextureFlag\n  uniform vec4 u_emissiveUVTransform;\n  varying vec2 v_emissiveUV;\n  #endif\n\n  #ifdef specularTextureFlag\n  uniform vec4 u_specularUVTransform;\n  varying vec2 v_specularUV;\n  #endif\n\n  #ifdef boneWeight0Flag\n  #define boneWeightsFlag\n  attribute vec2 a_boneWeight0;\n  #endif //boneWeight0Flag\n\n  #ifdef boneWeight1Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight1;\n  #endif //boneWeight1Flag\n\n  #ifdef boneWeight2Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight2;\n  #endif //boneWeight2Flag\n\n  #ifdef boneWeight3Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight3;\n  #endif //boneWeight3Flag\n\n  #ifdef boneWeight4Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight4;\n  #endif //boneWeight4Flag\n\n  #ifdef boneWeight5Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight5;\n  #endif //boneWeight5Flag\n\n  #ifdef boneWeight6Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight6;\n  #endif //boneWeight6Flag\n\n  #ifdef boneWeight7Flag\n  #ifndef boneWeightsFlag\n  #define boneWeightsFlag\n  #endif\n  attribute vec2 a_boneWeight7;\n  #endif //boneWeight7Flag\n\n  #if defined(numBones) && defined(boneWeightsFlag)\n  #if (numBones > 0) \n  #define skinningFlag\n  #endif\n  #endif\n\n  uniform mat4 u_worldTrans;\n\n  #if defined(numBones)\n  #if numBones > 0\n  uniform mat4 u_bones[numBones];\n  #endif //numBones\n  #endif\n\n  #ifdef shininessFlag\n  uniform float u_shininess;\n  #else\n  const float u_shininess = 20.0;\n  #endif // shininessFlag\n\n  #ifdef blendedFlag\n  uniform float u_opacity;\n  varying float v_opacity;\n\n  #ifdef alphaTestFlag\n  uniform float u_alphaTest;\n  varying float v_alphaTest;\n  #endif //alphaTestFlag\n  #endif // blendedFlag\n\n  #ifdef lightingFlag\n  varying vec3 v_lightDiffuse;\n\n  #ifdef ambientLightFlag\n  uniform vec3 u_ambientLight;\n  #endif // ambientLightFlag\n\n  #ifdef ambientCubemapFlag\n  uniform vec3 u_ambientCubemap[6];\n  #endif // ambientCubemapFlag \n\n  #ifdef sphericalHarmonicsFlag\n  uniform vec3 u_sphericalHarmonics[9];\n  #endif //sphericalHarmonicsFlag\n\n  #ifdef specularFlag\n  varying vec3 v_lightSpecular;\n  #endif // specularFlag\n\n  #ifdef cameraPositionFlag\n  uniform vec4 u_cameraPosition;\n  #endif // cameraPositionFlag\n\n  #ifdef fogFlag\n  varying float v_fog;\n  #endif // fogFlag\n\n\n  #if numDirectionalLights > 0\n  struct DirectionalLight\n  {\n    vec3 color;\n    vec3 direction;\n  };\n  uniform DirectionalLight u_dirLights[numDirectionalLights];\n  #endif // numDirectionalLights\n\n  #if numPointLights > 0\n  struct PointLight\n  {\n    vec3 color;\n    vec3 position;\n  };\n  uniform PointLight u_pointLights[numPointLights];\n  #endif // numPointLights\n\n  #if\tdefined(ambientLightFlag) || defined(ambientCubemapFlag) || defined(sphericalHarmonicsFlag)\n  #define ambientFlag\n  #endif //ambientFlag\n\n  #ifdef shadowMapFlag\n  uniform mat4 u_shadowMapProjViewTrans;\n  varying vec3 v_shadowMapUv;\n  #define separateAmbientFlag\n  #endif //shadowMapFlag\n\n  #if defined(ambientFlag) && defined(separateAmbientFlag)\n  varying vec3 v_ambientLight;\n  #endif //separateAmbientFlag\n\n  #endif // lightingFlag\n\n  void main() {\n    #ifdef diffuseTextureFlag\n      v_diffuseUV = u_diffuseUVTransform.xy + a_texCoords0 * u_diffuseUVTransform.zw;\n    #endif //diffuseTextureFlag\n    \n    #ifdef emissiveTextureFlag\n      v_emissiveUV = u_emissiveUVTransform.xy + a_texCoords0 * u_emissiveUVTransform.zw;\n    #endif //emissiveTextureFlag\n\n    #ifdef specularTextureFlag\n      v_specularUV = u_specularUVTransform.xy + a_texCoords0 * u_specularUVTransform.zw;\n    #endif //specularTextureFlag\n    \n    #if defined(colorFlag)\n      v_color = a_color;\n    #endif // colorFlag\n      \n    #ifdef blendedFlag\n      v_opacity = u_opacity;\n      #ifdef alphaTestFlag\n        v_alphaTest = u_alphaTest;\n      #endif //alphaTestFlag\n    #endif // blendedFlag\n    \n    #ifdef skinningFlag\n      mat4 skinning = mat4(0.0);\n      #ifdef boneWeight0Flag\n        skinning += (a_boneWeight0.y) * u_bones[int(a_boneWeight0.x)];\n      #endif //boneWeight0Flag\n      #ifdef boneWeight1Flag\t\t\t\t\n        skinning += (a_boneWeight1.y) * u_bones[int(a_boneWeight1.x)];\n      #endif //boneWeight1Flag\n      #ifdef boneWeight2Flag\t\t\n        skinning += (a_boneWeight2.y) * u_bones[int(a_boneWeight2.x)];\n      #endif //boneWeight2Flag\n      #ifdef boneWeight3Flag\n        skinning += (a_boneWeight3.y) * u_bones[int(a_boneWeight3.x)];\n      #endif //boneWeight3Flag\n      #ifdef boneWeight4Flag\n        skinning += (a_boneWeight4.y) * u_bones[int(a_boneWeight4.x)];\n      #endif //boneWeight4Flag\n      #ifdef boneWeight5Flag\n        skinning += (a_boneWeight5.y) * u_bones[int(a_boneWeight5.x)];\n      #endif //boneWeight5Flag\n      #ifdef boneWeight6Flag\n        skinning += (a_boneWeight6.y) * u_bones[int(a_boneWeight6.x)];\n      #endif //boneWeight6Flag\n      #ifdef boneWeight7Flag\n        skinning += (a_boneWeight7.y) * u_bones[int(a_boneWeight7.x)];\n      #endif //boneWeight7Flag\n    #endif //skinningFlag\n\n    #ifdef skinningFlag\n      vec4 pos = u_worldTrans * skinning * vec4(a_position, 1.0);\n    #else\n      vec4 pos = u_worldTrans * vec4(a_position, 1.0);\n    #endif\n      \n    gl_Position = u_projViewTrans * pos;\n      \n    #ifdef shadowMapFlag\n      vec4 spos = u_shadowMapProjViewTrans * pos;\n      v_shadowMapUv.xyz = (spos.xyz / spos.w) * 0.5 + 0.5;\n      v_shadowMapUv.z = min(v_shadowMapUv.z, 0.998);\n    #endif //shadowMapFlag\n    \n    #if defined(normalFlag)\n      #if defined(skinningFlag)\n        vec3 normal = normalize((u_worldTrans * skinning * vec4(a_normal, 0.0)).xyz);\n      #else\n        vec3 normal = normalize(u_normalMatrix * a_normal);\n      #endif\n      v_normal = normal;\n    #endif // normalFlag\n\n      #ifdef fogFlag\n          vec3 flen = u_cameraPosition.xyz - pos.xyz;\n          float fog = dot(flen, flen) * u_cameraPosition.w;\n          v_fog = min(fog, 1.0);\n      #endif\n\n    #ifdef lightingFlag\n      #if\tdefined(ambientLightFlag)\n            vec3 ambientLight = u_ambientLight;\n      #elif defined(ambientFlag)\n            vec3 ambientLight = vec3(0.0);\n      #endif\n        \n      #ifdef ambientCubemapFlag \t\t\n        vec3 squaredNormal = normal * normal;\n        vec3 isPositive  = step(0.0, normal);\n        ambientLight += squaredNormal.x * mix(u_ambientCubemap[0], u_ambientCubemap[1], isPositive.x) +\n            squaredNormal.y * mix(u_ambientCubemap[2], u_ambientCubemap[3], isPositive.y) +\n            squaredNormal.z * mix(u_ambientCubemap[4], u_ambientCubemap[5], isPositive.z);\n      #endif // ambientCubemapFlag\n\n      #ifdef sphericalHarmonicsFlag\n        ambientLight += u_sphericalHarmonics[0];\n        ambientLight += u_sphericalHarmonics[1] * normal.x;\n        ambientLight += u_sphericalHarmonics[2] * normal.y;\n        ambientLight += u_sphericalHarmonics[3] * normal.z;\n        ambientLight += u_sphericalHarmonics[4] * (normal.x * normal.z);\n        ambientLight += u_sphericalHarmonics[5] * (normal.z * normal.y);\n        ambientLight += u_sphericalHarmonics[6] * (normal.y * normal.x);\n        ambientLight += u_sphericalHarmonics[7] * (3.0 * normal.z * normal.z - 1.0);\n        ambientLight += u_sphericalHarmonics[8] * (normal.x * normal.x - normal.y * normal.y);\t\t\t\n      #endif // sphericalHarmonicsFlag\n\n      #ifdef ambientFlag\n        #ifdef separateAmbientFlag\n          v_ambientLight = ambientLight;\n          v_lightDiffuse = vec3(0.0);\n        #else\n          v_lightDiffuse = ambientLight;\n        #endif //separateAmbientFlag\n      #else\n            v_lightDiffuse = vec3(0.0);\n      #endif //ambientFlag\n\n        \n      #ifdef specularFlag\n        v_lightSpecular = vec3(0.0);\n        vec3 viewVec = normalize(u_cameraPosition.xyz - pos.xyz);\n      #endif // specularFlag\n        \n      #if (numDirectionalLights > 0) && defined(normalFlag)\n        for (int i = 0; i < numDirectionalLights; i++) {\n          vec3 lightDir = -u_dirLights[i].direction;\n          float NdotL = clamp(dot(normal, lightDir), 0.0, 1.0);\n          vec3 value = u_dirLights[i].color * NdotL;\n          v_lightDiffuse += value;\n          #ifdef specularFlag\n            float halfDotView = max(0.0, dot(normal, normalize(lightDir + viewVec)));\n            v_lightSpecular += value * pow(halfDotView, u_shininess);\n          #endif // specularFlag\n        }\n      #endif // numDirectionalLights\n\n      #if (numPointLights > 0) && defined(normalFlag)\n        for (int i = 0; i < numPointLights; i++) {\n          vec3 lightDir = u_pointLights[i].position - pos.xyz;\n          float dist2 = dot(lightDir, lightDir);\n          lightDir *= inversesqrt(dist2);\n          float NdotL = clamp(dot(normal, lightDir), 0.0, 1.0);\n          vec3 value = u_pointLights[i].color * (NdotL / (1.0 + dist2));\n          v_lightDiffuse += value;\n          #ifdef specularFlag\n            float halfDotView = max(0.0, dot(normal, normalize(lightDir + viewVec)));\n            v_lightSpecular += value * pow(halfDotView, u_shininess);\n          #endif // specularFlag\n        }\n      #endif // numPointLights\n    #endif // lightingFlag\n  }\n  ",F.defaultFragmentShader="\n  #ifdef GL_ES\n  #define LOWP lowp\n  #define MED mediump\n  #define HIGH highp\n  precision mediump float;\n  #else\n  #define MED\n  #define LOWP\n  #define HIGH\n  #endif\n\n  #if defined(specularTextureFlag) || defined(specularColorFlag)\n  #define specularFlag\n  #endif\n\n  #ifdef normalFlag\n  varying vec3 v_normal;\n  #endif //normalFlag\n\n  #if defined(colorFlag)\n  varying vec4 v_color;\n  #endif\n\n  #ifdef blendedFlag\n  varying float v_opacity;\n  #ifdef alphaTestFlag\n  varying float v_alphaTest;\n  #endif //alphaTestFlag\n  #endif //blendedFlag\n\n  #if defined(diffuseTextureFlag) || defined(specularTextureFlag) || defined(emissiveTextureFlag)\n  #define textureFlag\n  #endif\n\n  #ifdef diffuseTextureFlag\n  varying MED vec2 v_diffuseUV;\n  #endif\n\n  #ifdef specularTextureFlag\n  varying MED vec2 v_specularUV;\n  #endif\n\n  #ifdef emissiveTextureFlag\n  varying MED vec2 v_emissiveUV;\n  #endif\n\n  #ifdef diffuseColorFlag\n  uniform vec4 u_diffuseColor;\n  #endif\n\n  #ifdef diffuseTextureFlag\n  uniform sampler2D u_diffuseTexture;\n  #endif\n\n  #ifdef specularColorFlag\n  uniform vec4 u_specularColor;\n  #endif\n\n  #ifdef specularTextureFlag\n  uniform sampler2D u_specularTexture;\n  #endif\n\n  #ifdef normalTextureFlag\n  uniform sampler2D u_normalTexture;\n  #endif\n\n  #ifdef emissiveColorFlag\n  uniform vec4 u_emissiveColor;\n  #endif\n\n  #ifdef emissiveTextureFlag\n  uniform sampler2D u_emissiveTexture;\n  #endif\n\n  #ifdef lightingFlag\n  varying vec3 v_lightDiffuse;\n\n  #if\tdefined(ambientLightFlag) || defined(ambientCubemapFlag) || defined(sphericalHarmonicsFlag)\n  #define ambientFlag\n  #endif //ambientFlag\n\n  #ifdef specularFlag\n  varying vec3 v_lightSpecular;\n  #endif //specularFlag\n\n  #ifdef shadowMapFlag\n  uniform sampler2D u_shadowTexture;\n  uniform float u_shadowPCFOffset;\n  varying vec3 v_shadowMapUv;\n  #define separateAmbientFlag\n\n  float getShadowness(vec2 offset)\n  {\n      const vec4 bitShifts = vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0);\n      return step(v_shadowMapUv.z, dot(texture2D(u_shadowTexture, v_shadowMapUv.xy + offset), bitShifts));//+(1.0/255.0));\n  }\n\n  float getShadow()\n  {\n    return (//getShadowness(vec2(0,0)) +\n        getShadowness(vec2(u_shadowPCFOffset, u_shadowPCFOffset)) +\n        getShadowness(vec2(-u_shadowPCFOffset, u_shadowPCFOffset)) +\n        getShadowness(vec2(u_shadowPCFOffset, -u_shadowPCFOffset)) +\n        getShadowness(vec2(-u_shadowPCFOffset, -u_shadowPCFOffset))) * 0.25;\n  }\n  #endif //shadowMapFlag\n\n  #if defined(ambientFlag) && defined(separateAmbientFlag)\n  varying vec3 v_ambientLight;\n  #endif //separateAmbientFlag\n\n  #endif //lightingFlag\n\n  #ifdef fogFlag\n  uniform vec4 u_fogColor;\n  varying float v_fog;\n  #endif // fogFlag\n\n  void main() {\n    #if defined(normalFlag)\n      vec3 normal = v_normal;\n    #endif // normalFlag\n\n    #if defined(diffuseTextureFlag) && defined(diffuseColorFlag) && defined(colorFlag)\n      vec4 diffuse = texture2D(u_diffuseTexture, v_diffuseUV) * u_diffuseColor * v_color;\n    #elif defined(diffuseTextureFlag) && defined(diffuseColorFlag)\n      vec4 diffuse = texture2D(u_diffuseTexture, v_diffuseUV) * u_diffuseColor;\n    #elif defined(diffuseTextureFlag) && defined(colorFlag)\n      vec4 diffuse = texture2D(u_diffuseTexture, v_diffuseUV) * v_color;\n    #elif defined(diffuseTextureFlag)\n      vec4 diffuse = texture2D(u_diffuseTexture, v_diffuseUV);\n    #elif defined(diffuseColorFlag) && defined(colorFlag)\n      vec4 diffuse = u_diffuseColor * v_color;\n    #elif defined(diffuseColorFlag)\n      vec4 diffuse = u_diffuseColor;\n    #elif defined(colorFlag)\n      vec4 diffuse = v_color;\n    #else\n      vec4 diffuse = vec4(1.0);\n    #endif\n\n    #if defined(emissiveTextureFlag) && defined(emissiveColorFlag)\n      vec4 emissive = texture2D(u_emissiveTexture, v_emissiveUV) * u_emissiveColor;\n    #elif defined(emissiveTextureFlag)\n      vec4 emissive = texture2D(u_emissiveTexture, v_emissiveUV);\n    #elif defined(emissiveColorFlag)\n      vec4 emissive = u_emissiveColor;\n    #else\n      vec4 emissive = vec4(0.0);\n    #endif\n\n    #if (!defined(lightingFlag))\n      gl_FragColor.rgb = diffuse.rgb + emissive.rgb;\n    #elif (!defined(specularFlag))\n      #if defined(ambientFlag) && defined(separateAmbientFlag)\n        #ifdef shadowMapFlag\n          gl_FragColor.rgb = (diffuse.rgb * (v_ambientLight + getShadow() * v_lightDiffuse)) + emissive.rgb;\n          //gl_FragColor.rgb = texture2D(u_shadowTexture, v_shadowMapUv.xy);\n        #else\n          gl_FragColor.rgb = (diffuse.rgb * (v_ambientLight + v_lightDiffuse)) + emissive.rgb;\n        #endif //shadowMapFlag\n      #else\n        #ifdef shadowMapFlag\n          gl_FragColor.rgb = getShadow() * (diffuse.rgb * v_lightDiffuse) + emissive.rgb;\n        #else\n          gl_FragColor.rgb = (diffuse.rgb * v_lightDiffuse) + emissive.rgb;\n        #endif //shadowMapFlag\n      #endif\n    #else\n      #if defined(specularTextureFlag) && defined(specularColorFlag)\n        vec3 specular = texture2D(u_specularTexture, v_specularUV).rgb * u_specularColor.rgb * v_lightSpecular;\n      #elif defined(specularTextureFlag)\n        vec3 specular = texture2D(u_specularTexture, v_specularUV).rgb * v_lightSpecular;\n      #elif defined(specularColorFlag)\n        vec3 specular = u_specularColor.rgb * v_lightSpecular;\n      #else\n        vec3 specular = v_lightSpecular;\n      #endif\n\n      #if defined(ambientFlag) && defined(separateAmbientFlag)\n        #ifdef shadowMapFlag\n        gl_FragColor.rgb = (diffuse.rgb * (getShadow() * v_lightDiffuse + v_ambientLight)) + specular + emissive.rgb;\n          //gl_FragColor.rgb = texture2D(u_shadowTexture, v_shadowMapUv.xy);\n        #else\n          gl_FragColor.rgb = (diffuse.rgb * (v_lightDiffuse + v_ambientLight)) + specular + emissive.rgb;\n        #endif //shadowMapFlag\n      #else\n        #ifdef shadowMapFlag\n          gl_FragColor.rgb = getShadow() * ((diffuse.rgb * v_lightDiffuse) + specular) + emissive.rgb;\n        #else\n          gl_FragColor.rgb = (diffuse.rgb * v_lightDiffuse) + specular + emissive.rgb;\n        #endif //shadowMapFlag\n      #endif\n    #endif //lightingFlag\n\n    #ifdef fogFlag\n      gl_FragColor.rgb = mix(gl_FragColor.rgb, u_fogColor.rgb, v_fog);\n    #endif // end fogFlag\n\n    #ifdef blendedFlag\n      gl_FragColor.a = diffuse.a * v_opacity;\n      #ifdef alphaTestFlag\n        if (gl_FragColor.a <= v_alphaTest)\n          discard;\n      #endif\n    #else\n      gl_FragColor.a = 1.0;\n    #endif\n  }\n  ",F.implementedFlags=p.BlendingAttribute.Type|A.TextureAttribute.Diffuse|v.ColorAttribute3D.Diffuse|v.ColorAttribute3D.Specular|g.FloatAttribute.Shininess,F.defaultCullFace=V.GL20.GL_BACK,F.defaultDepthFunc=V.GL20.GL_LEQUAL,F.optionalAttributes=x.IntAttribute.CullFace,F.tmpAttributes=new _.Attributes},4954:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7452:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(4678),t),r(i(616),t),r(i(4954),t)},6425:function(e,t,i){"use strict";var n=i(1655).default,r=i(6389).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.AnimationController=t.AnimationDesc=void 0;var o=i(8606),l=i(4644),u=function(){function e(){s(this,e),this.listener=null,this.animation=null,this.speed=0,this.time=0,this.offset=0,this.duration=0,this.loopCount=0}return a(e,[{key:"update",value:function(e){if(0!==this.loopCount&&this.animation){var t,i=this.speed*e;if(o.MathUtils.isZero(this.duration))t=1;else if(this.time+=i,this.speed<0){var n=this.duration-this.time;t=Math.floor(Math.abs(n/this.duration)),n=Math.abs(n%this.duration),this.time=this.duration-n}else t=Math.floor(Math.abs(this.time/this.duration)),this.time=Math.abs(this.time%this.duration);for(var r=0;r<t;r++)if(this.loopCount>0&&this.loopCount--,0!==this.loopCount&&this.listener&&this.listener.onLoop(this),0===this.loopCount){var s=(t-1-r)*this.duration+(i<0?this.duration-this.time:this.time);return this.time=i<0?0:this.duration,this.listener&&this.listener.onEnd(this),s}return-1}return e}}]),e}();t.AnimationDesc=u;var h=function(e){n(i,e);var t=r(i);function i(){var e;return s(this,i),(e=t.apply(this,arguments)).animationPool=new o.Pool((function(){return new u})),e.current=null,e.queued=null,e.queuedTransitionTime=0,e.previous=null,e.transitionCurrentTime=0,e.transitionTargetTime=0,e.inAction=!1,e.paused=!1,e.allowSameAnimation=!1,e.justChangedAnimation=!1,e}return a(i,[{key:"obtainAnimation",value:function(e,t,i,n,r,s){if(!e)return null;var a=this.animationPool.obtain();return a.animation=e,a.listener=s,a.loopCount=n,a.speed=r,a.offset=t,a.duration=i<0?e.duration-t:i,a.time=r<0?a.duration:0,a}},{key:"obtain",value:function(e,t,i,n,r,s){if(!e)return null;var a=this.target.getAnimation(e);if(!a)throw new Error("Unknown animation: "+e);return this.obtainAnimation(a,t,i,n,r,s)}},{key:"obtainAnimationDesc",value:function(e){return this.obtainAnimation(e.animation,e.offset,e.duration,e.loopCount,e.speed,e.listener)}},{key:"update",value:function(e){if(!this.paused&&(this.previous&&(this.transitionCurrentTime+=e)>=this.transitionTargetTime&&(this.removeAnimation(this.previous.animation),this.justChangedAnimation=!0,this.animationPool.free(this.previous),this.previous=null),this.justChangedAnimation&&(this.target.calculateTransforms(),this.justChangedAnimation=!1),this.current&&0!==this.current.loopCount&&this.current.animation)){var t=this.current.update(e);if(t>=0&&this.queued)return this.inAction=!1,this.actionWithAnimationDesc(this.queued,this.queuedTransitionTime),this.queued=null,void(t>0&&this.update(t));this.previous?this.applyAnimations(this.previous.animation,this.previous.offset+this.previous.time,this.current.animation,this.current.offset+this.current.time,this.transitionCurrentTime/this.transitionTargetTime):this.applyAnimation(this.current.animation,this.current.offset+this.current.time)}}},{key:"setAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.setAnimationWithOffset(e,0,-1,t,i,n)}},{key:"setAnimationWithOffset",value:function(e,t,i,n,r,s){return this.setAnimationWithAnimationDesc(this.obtain(e,t,i,n,r,s))}},{key:"setAnimationWithAnimation",value:function(e,t,i,n,r,s){return this.setAnimationWithAnimationDesc(this.obtainAnimation(e,t,i,n,r,s))}},{key:"setAnimationWithAnimationDesc",value:function(e){return this.current?(!this.allowSameAnimation&&e&&this.current.animation===e.animation?e.time=this.current.time:this.removeAnimation(this.current.animation),this.animationPool.free(this.current),this.current=e):this.current=e,this.justChangedAnimation=!0,e}},{key:"animate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0;return this.animateWithOffset(e,0,-1,t,i,n,r)}},{key:"animateWithOffset",value:function(e,t,i,n,r,s,a){return this.animateWithAnimationDesc(this.obtain(e,t,i,n,r,s),a)}},{key:"animateWithAnimation",value:function(e,t,i,n,r,s,a){return this.animateWithAnimationDesc(this.obtainAnimation(e,t,i,n,r,s),a)}},{key:"animateWithAnimationDesc",value:function(e,t){return this.current&&0!==this.current.loopCount?this.inAction?this.queueWithAnimationDesc(e,t):!this.allowSameAnimation&&e&&this.current.animation===e.animation?(e.time=this.current.time,this.animationPool.free(this.current),this.current=e):(this.previous&&(this.removeAnimation(this.previous.animation),this.animationPool.free(this.previous)),this.previous=this.current,this.current=e,this.transitionCurrentTime=0,this.transitionTargetTime=t):this.current=e,e}},{key:"queue",value:function(e,t,i,n,r){return this.queueWithOffset(e,0,-1,t,i,n,r)}},{key:"queueWithOffset",value:function(e,t,i,n,r,s,a){return this.queueWithAnimationDesc(this.obtain(e,t,i,n,r,s),a)}},{key:"queueWithAnimation",value:function(e,t,i,n,r,s,a){return this.queueWithAnimationDesc(this.obtainAnimation(e,t,i,n,r,s),a)}},{key:"queueWithAnimationDesc",value:function(e,t){return this.current&&0!==this.current.loopCount?(this.queued&&this.animationPool.free(this.queued),this.queued=e,this.queuedTransitionTime=t,this.current.loopCount<0&&(this.current.loopCount=1)):this.animateWithAnimationDesc(e,t),e}},{key:"action",value:function(e,t,i,n,r){return this.actionWithOffset(e,0,-1,t,i,n,r)}},{key:"actionWithOffset",value:function(e,t,i,n,r,s,a){return this.actionWithAnimationDesc(this.obtain(e,t,i,n,r,s),a)}},{key:"actionWithAnimation",value:function(e,t,i,n,r,s,a){return this.actionWithAnimationDesc(this.obtainAnimation(e,t,i,n,r,s),a)}},{key:"actionWithAnimationDesc",value:function(e,t){if(e.loopCount<0)throw new Error("An action cannot be continuous");if(this.current&&0!==this.current.loopCount){var i=this.inAction?null:this.obtainAnimationDesc(this.current);this.inAction=!1,this.animateWithAnimationDesc(e,t),this.inAction=!0,i&&this.queueWithAnimationDesc(i,t)}else this.animateWithAnimationDesc(e,t);return e}}]),i}(l.BaseAnimationController);t.AnimationController=h},4644:function(e,t,i){"use strict";var n=i(7424).default,r=i(4704).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BaseAnimationController=t.Transform=void 0;var o=i(5122),l=i(8606),u=i(7811),h=function(){function e(){s(this,e),this.translation=new u.Vector3,this.rotation=new o.Quaternion,this.scale=new u.Vector3(1,1,1)}return a(e,[{key:"idt",value:function(){return this.translation.set(0,0,0),this.rotation.idt(),this.scale.set(1,1,1),this}},{key:"set",value:function(e,t,i){return this.translation.setFrom(e),this.rotation.setFrom(t),this.scale.setFrom(i),this}},{key:"setFrom",value:function(e){return this.set(e.translation,e.rotation,e.scale)}},{key:"lerpWithTranform",value:function(e,t){return this.lerp(e.translation,e.rotation,e.scale,t)}},{key:"lerp",value:function(e,t,i,n){return this.translation.lerp(e,n),this.rotation.slerp(t,n),this.scale.lerp(i,n),this}},{key:"toMatrix4",value:function(e){return e.setFromTranslationRotation(this.translation,this.rotation,this.scale)}},{key:"reset",value:function(){this.idt()}},{key:"toString",value:function(){return this.translation.toString()+" - "+this.rotation.toString()+" - "+this.scale.toString()}}]),e}();t.Transform=h;var c=function(){function e(t){s(this,e),this.transformPool=new l.Pool((function(){return new h})),this.applying=!1,this.target=t}return a(e,[{key:"begin",value:function(){if(this.applying)throw new Error("You must call end() after each call to being()");this.applying=!0}},{key:"apply",value:function(t,i,n){if(!this.applying)throw new Error("You must call begin() before adding an animation");e.applyAnimation(e.transforms,this.transformPool,n,t,i)}},{key:"end",value:function(){if(!this.applying)throw new Error("You must call begin() first");var t,i=r(e.transforms);try{for(i.s();!(t=i.n()).done;){var s=n(t.value,2),a=s[0],o=s[1];o.toMatrix4(a.localTransform),this.transformPool.free(o)}}catch(l){i.e(l)}finally{i.f()}e.transforms.clear(),this.target.calculateTransforms(),this.applying=!1}},{key:"applyAnimation",value:function(t,i){if(this.applying)throw new Error("Call end() first");e.applyAnimation(null,null,1,t,i),this.target.calculateTransforms()}},{key:"applyAnimations",value:function(e,t,i,n,r){if(i&&0!==r)if(e&&1!==r){if(this.applying)throw new Error("Call end() first");this.begin(),this.apply(e,t,1),this.apply(i,n,r),this.end()}else this.applyAnimation(i,n);else this.applyAnimation(e,t)}},{key:"removeAnimation",value:function(e){var t,i=r(e.nodeAnimations);try{for(i.s();!(t=i.n()).done;){t.value.node.isAnimated=!1}}catch(n){i.e(n)}finally{i.f()}}}],[{key:"getFirstKeyframeIndexAtTime",value:function(e,t){var i=e.length-1;if(i<=0||t<e[0].keytime||t>e[i].keytime)return 0;for(var n=0,r=i;n<r;){var s=Math.floor((n+r)/2);if(t>e[s+1].keytime)n=s+1;else{if(!(t<e[s].keytime))return s;r=s-1}}return n}},{key:"getTranslationAtTime",value:function(e,t,i){if(!e.translation)return i.setFrom(e.node.translation);if(1===e.translation.length)return i.setFrom(e.translation[0].value);var n=this.getFirstKeyframeIndexAtTime(e.translation,t),r=e.translation[n];if(i.setFrom(r.value),++n<e.translation.length){var s=e.translation[n],a=(t-r.keytime)/(s.keytime-r.keytime);i.lerp(s.value,a)}return i}},{key:"getRotationAtTime",value:function(e,t,i){if(!e.rotation)return i.setFrom(e.node.rotation);if(1===e.rotation.length)return i.setFrom(e.rotation[0].value);var n=this.getFirstKeyframeIndexAtTime(e.rotation,t),r=e.rotation[n];if(i.setFrom(r.value),++n<e.rotation.length){var s=e.rotation[n],a=(t-r.keytime)/(s.keytime-r.keytime);i.slerp(s.value,a)}return i}},{key:"getScalingAtTime",value:function(e,t,i){if(!e.scaling)return i.setFrom(e.node.scale);if(1===e.scaling.length)return i.setFrom(e.scaling[0].value);var n=this.getFirstKeyframeIndexAtTime(e.scaling,t),r=e.scaling[n];if(i.setFrom(r.value),++n<e.scaling.length){var s=e.scaling[n],a=(t-r.keytime)/(s.keytime-r.keytime);i.lerp(s.value,a)}return i}},{key:"getNodeAnimationTransform",value:function(e,t){var i=this.tmpT;return this.getTranslationAtTime(e,t,i.translation),this.getRotationAtTime(e,t,i.rotation),this.getScalingAtTime(e,t,i.scale),i}},{key:"applyNodeAnimationDirectly",value:function(e,t){var i=e.node;i.isAnimated=!0,this.getNodeAnimationTransform(e,t).toMatrix4(i.localTransform)}},{key:"applyNodeAnimationBlending",value:function(e,t,i,n,r){var s=e.node;s.isAnimated=!0;var a=this.getNodeAnimationTransform(e,r),o=t.get(s);o?n>.999999?o.setFrom(a):o.lerpWithTranform(a,n):n>.999999?t.set(s,i.obtain().setFrom(a)):t.set(s,i.obtain().set(s.translation,s.rotation,s.scale).lerpWithTranform(a,n))}},{key:"applyAnimation",value:function(e,t,i,n,s){if(e){var a,o=r(e.keys());try{for(o.s();!(a=o.n()).done;){a.value.isAnimated=!1}}catch(v){o.e(v)}finally{o.f()}var l,u=r(n.nodeAnimations);try{for(u.s();!(l=u.n()).done;){var h=l.value;this.applyNodeAnimationBlending(h,e,t,i,s)}}catch(v){u.e(v)}finally{u.f()}var c,f=r(e.entries());try{for(f.s();!(c=f.n()).done;){var d=c.value;d[0].isAnimated||(d[0].isAnimated=!0,d[1].lerp(d[0].translation,d[0].rotation,d[0].scale,i))}}catch(v){f.e(v)}finally{f.f()}}else{var m,_=r(n.nodeAnimations);try{for(_.s();!(m=_.n()).done;){var p=m.value;this.applyNodeAnimationDirectly(p,s)}}catch(v){_.e(v)}finally{_.f()}}}}]),e}();t.BaseAnimationController=c,c.transforms=new Map,c.tmpT=new h},7083:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BoxShapeBuilder=void 0;var s=i(8606),a=i(7811),o=i(6506),l=i(8552),u=i(8633),h=function(){function e(){n(this,e)}return r(e,null,[{key:"obtainV3",value:function(){return e.vectorPool.obtain()}},{key:"freeAll",value:function(){e.vectorPool.flush()}},{key:"buildWithWidthHeight",value:function(e,t,i,n){this.buildWithRect(e,0,0,0,t,i,n)}},{key:"buildWithVertexInfo",value:function(e,t,i,n,r,s,a,o,u){var h=e.vertex(t),c=e.vertex(n),f=e.vertex(r),d=e.vertex(i),m=e.vertex(s),_=e.vertex(o),p=e.vertex(a),v=e.vertex(u),y=e.getPrimitiveType();y===l.GL20.GL_LINES?(e.rect(h,c,f,d),e.rect(_,m,p,v),e.index8Values(h,m,d,p,f,v,c,_)):y===l.GL20.GL_POINTS?(e.rect(h,c,f,d),e.rect(_,m,p,v)):(e.rect(h,c,f,d),e.rect(_,m,p,v),e.rect(h,d,p,m),e.rect(_,v,f,c),e.rect(_,c,h,m),e.rect(f,v,p,d))}},{key:"buildWithVectorCorner",value:function(e,t,i,n,r,s,a,o,l){if(0===(e.getAttributes().getMask()&(u.Usage.Normal|u.Usage.BiNormal|u.Usage.Tangent|u.Usage.TextureCoordinates)))this.buildWithVertexInfo(e,this.vertTmp1.set(t,null,null,null),this.vertTmp2.set(i,null,null,null),this.vertTmp3.set(n,null,null,null),this.vertTmp4.set(r,null,null,null),this.vertTmp5.set(s,null,null,null),this.vertTmp6.set(a,null,null,null),this.vertTmp7.set(o,null,null,null),this.vertTmp8.set(l,null,null,null));else{var h=this.tmpV1.set(t.x,t.y,t.z).lerp(r,.5).sub(this.tmpV2.set(s.x,s.y,s.z).lerp(l,.5)).normalize();e.rectWithVectorCorner(t,i,r,n,h),e.rectWithVectorCorner(a,s,o,l,h.scale(-1)),h=this.tmpV1.set(t.x,t.y,t.z).lerp(o,.5).sub(this.tmpV2.set(i.x,i.y,i.z).lerp(l,.5)).normalize(),e.rectWithVectorCorner(s,t,n,o,h),e.rectWithVectorCorner(i,a,l,r,h.scale(-1)),h=this.tmpV1.set(t.x,t.y,t.z).lerp(a,.5).sub(this.tmpV2.set(n.x,n.y,n.z).lerp(l,.5)).normalize(),e.rectWithVectorCorner(s,a,i,t,h),e.rectWithVectorCorner(n,r,l,o,h.scale(-1))}}},{key:"buildWithRect",value:function(e,t,i,n,r,s,a){var o=.5*r,l=.5*s,u=.5*a,h=t-o,c=i-l,f=n-u,d=t+o,m=i+l,_=n+u;this.buildWithVectorCorner(e,this.obtainV3().set(h,c,f),this.obtainV3().set(h,m,f),this.obtainV3().set(d,c,f),this.obtainV3().set(d,m,f),this.obtainV3().set(h,c,_),this.obtainV3().set(h,m,_),this.obtainV3().set(d,c,_),this.obtainV3().set(d,m,_)),this.freeAll()}}]),e}();t.BoxShapeBuilder=h,h.tmpV0=new a.Vector3,h.tmpV1=new a.Vector3,h.tmpV2=new a.Vector3,h.tmpV3=new a.Vector3,h.tmpV4=new a.Vector3,h.tmpV5=new a.Vector3,h.tmpV6=new a.Vector3,h.tmpV7=new a.Vector3,h.vertTmp0=new o.VertexInfo,h.vertTmp1=new o.VertexInfo,h.vertTmp2=new o.VertexInfo,h.vertTmp3=new o.VertexInfo,h.vertTmp4=new o.VertexInfo,h.vertTmp5=new o.VertexInfo,h.vertTmp6=new o.VertexInfo,h.vertTmp7=new o.VertexInfo,h.vertTmp8=new o.VertexInfo,h.vectorPool=new s.FlushablePool((function(){return new a.Vector3}))},5223:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.IndexBufferObject=void 0;var s=i(8552),a=function(){function e(t,i){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n(this,e),this.isDirty=!0,this.isBound=!1,this.indicesLength=0,this.gl=t,this.empty=0===i,this.empty&&(i=1),this.byteBuffer=new Uint16Array(i),this.isDirect=!0,this.ownsBuffer=!0,this.indicesLength=0,this.bufferHandle=this.gl.createBuffer(),this.usage=r?s.GL20.GL_STATIC_DRAW:s.GL20.GL_DYNAMIC_DRAW}return r(e,[{key:"getNumIndices",value:function(){return this.indicesLength}},{key:"getNumMaxIndices",value:function(){return this.byteBuffer.length}},{key:"setIndices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;this.isDirty=!0,this.byteBuffer.set(e.slice(t,t+i),0),this.indicesLength=i,this.isBound&&(this.gl.bufferData(s.GL20.GL_ELEMENT_ARRAY_BUFFER,this.byteBuffer,this.usage),this.isDirty=!1)}},{key:"updateIndices",value:function(e,t,i,n){this.isDirty=!0,this.byteBuffer.set(t.slice(i,i+n),e),this.indicesLength=e+n,this.isBound&&(this.gl.bufferData(s.GL20.GL_ELEMENT_ARRAY_BUFFER,this.byteBuffer.subarray(0,this.indicesLength),this.usage),this.isDirty=!1)}},{key:"getBuffer",value:function(){return this.isDirty=!0,this.byteBuffer}},{key:"bind",value:function(){if(0===this.bufferHandle)throw new Error("No buffer allocated!");this.gl.bindBuffer(s.GL20.GL_ELEMENT_ARRAY_BUFFER,this.bufferHandle),this.isDirty&&(this.gl.bufferData(s.GL20.GL_ELEMENT_ARRAY_BUFFER,this.byteBuffer,this.usage),this.isDirty=!1),this.isBound=!0}},{key:"unbind",value:function(){this.gl.bindBuffer(s.GL20.GL_ELEMENT_ARRAY_BUFFER,null),this.isBound=!1}},{key:"invalidate",value:function(){this.bufferHandle=this.gl.createBuffer(),this.isDirty=!0}},{key:"dispose",value:function(){this.gl.bindBuffer(s.GL20.GL_ELEMENT_ARRAY_BUFFER,null),this.gl.deleteBuffer(this.bufferHandle),this.bufferHandle=new WebGLBuffer}}]),e}();t.IndexBufferObject=a},3776:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MeshBuilder=void 0;var a=i(5477),o=i(6239),l=i(4995),u=i(9699),h=i(1858),c=i(8606),f=i(7811),d=i(8633),m=i(427),_=i(8552),p=i(5766),v=i(3627),y=i(7083),g=i(6506),x=function(){function e(t){r(this,e),this.gl=t,this.vertTmp1=new g.VertexInfo,this.vertTmp2=new g.VertexInfo,this.vertTmp3=new g.VertexInfo,this.vertTmp4=new g.VertexInfo,this.tempC1=new c.Color,this.vertices=[],this.indices=[],this.parts=[],this.color=c.Color.WHITE,this.hasColor=!1,this.uOffset=0,this.uScale=1,this.vOffset=0,this.vScale=1,this.hasUVTransform=!1,this.vertexTransformationEnabled=!1,this.positionTransform=new l.Matrix4,this.normalTransform=new o.Matrix3,this.bounds=new a.BoundingBox,this.lastIndex=-1,this.tmpNormal=new f.Vector3}return s(e,[{key:"begin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(this.attributes)throw new Error("Call end() first");this.attributes=e,this.parts.length=0,this.vindex=0,this.lastIndex=-1,this.istart=0,this.meshPart=null,this.stride=e.vertexSize/4,(!this._vertex||this.vertex.length<this.stride)&&(this._vertex=new Array(this.stride));var i=e.findByUsage(d.Usage.Position);if(!i)throw new Error("Cannot build mesh without position attribute");this.posOffset=i.offset/4,this.posSize=i.numComponents,i=e.findByUsage(d.Usage.Normal),this.norOffset=i?i.offset/4:-1,i=e.findByUsage(d.Usage.BiNormal),this.biNorOffset=i?i.offset/4:-1,i=e.findByUsage(d.Usage.Tangent),this.tangentOffset=i?i.offset/4:-1,i=e.findByUsage(d.Usage.ColorUnpacked),this.colOffset=i?i.offset/4:-1,this.colSize=i?i.numComponents:0,i=e.findByUsage(d.Usage.ColorPacked),this.cpOffset=i?i.offset/4:-1,i=e.findByUsage(d.Usage.TextureCoordinates),this.uvOffset=i?i.offset/4:-1,this.setColor(null),this.setVertexTransform(null),this.setUVRangeByRegion(null),this.primitiveType=t,this.bounds.inf()}},{key:"setColor",value:function(e){this.hasColor=!!e;var t=this.hasColor?e:c.Color.WHITE;this.color.set(t.r,t.g,t.b,t.a)}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getLastIndex",value:function(){return this.lastIndex}},{key:"endpart",value:function(){this.meshPart&&(this.bounds.getCenter(this.meshPart.center),this.bounds.getDimensions(this.meshPart.halfExtents).scale(.5),this.meshPart.radius=this.meshPart.halfExtents.length(),this.bounds.inf(),this.meshPart.offset=this.istart,this.meshPart.size=this.indices.length-this.istart,this.istart=this.indices.length,this.meshPart=null)}},{key:"part",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.attributes)throw new Error("Call begin() first");return i||(i=new v.MeshPart),this.endpart(),this.meshPart=i,this.meshPart.id=e,this.primitiveType=this.meshPart.primitiveType=t,this.parts.push(this.meshPart),this.setColor(null),this.setVertexTransform(null),this.setUVRangeByRegion(null),this.meshPart}},{key:"end",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t||(t=new p.Mesh3D(this.gl,!0,!0,Math.min(this.vertices.length/this.stride,e.MAX_VERTICES),this.indices.length,this.attributes)),this.endpart(),!this.attributes)throw new Error("Call begin() first");if(!this.attributes.equals(t.getVertexAttributes()))throw new Error("Mesh attributes don't match");if(t.getMaxVertices()*this.stride<this.vertices.length)throw new Error("Mesh can't hold enough vertices: "+t.getMaxVertices()+" * "+this.stride+" < "+this.vertices.length);if(t.getMaxIndices()<this.indices.length)throw new Error("Mesh can't hold enough indices: "+t.getMaxIndices()+" < "+this.indices.length);t.setVertices(this.vertices,0,this.vertices.length),t.setIndices(this.indices,0,this.indices.length);var i,r=n(this.parts);try{for(r.s();!(i=r.n()).done;){var s=i.value;s.mesh=t}}catch(a){r.e(a)}finally{r.f()}return this.parts.length=0,this.attributes=null,this.vertices.length=0,this.indices.length=0,t}},{key:"clear",value:function(){this.vertices.length=0,this.indices.length=0,this.parts.length=0,this.vindex=0,this.lastIndex=-1,this.istart=0,this.meshPart=null}},{key:"getFloatsPerVertex",value:function(){return this.stride}},{key:"setUVRange",value:function(e,t,i,n){this.uOffset=e,this.vOffset=t,this.uScale=i-e,this.vScale=n-t,this.hasUVTransform=!(c.MathUtils.isZero(e)&&c.MathUtils.isZero(t)&&c.MathUtils.isEqual(i,1)&&c.MathUtils.isEqual(n,1))}},{key:"setUVRangeByRegion",value:function(e){e?(this.hasUVTransform=!0,this.setUVRange(e.u,e.v,e.u2,e.v2)):(this.hasUVTransform=!1,this.uOffset=this.vOffset=0,this.uScale=this.vScale=1)}},{key:"setVertexTransform",value:function(e){this.vertexTransformationEnabled=!!e,this.vertexTransformationEnabled?(this.positionTransform.set(e.values),this.normalTransform.setByMatrix4(e).inv().transpose()):(this.positionTransform.idt(),this.normalTransform.idt())}},{key:"addVertex",value:function(t,i){var n=this.vertices.length;c.Utils.arrayCopy(t,i,this.vertices,this.vertices.length,this.stride),this.lastIndex=this.vindex++,this.vertexTransformationEnabled&&(e.transformPosition(this.vertices,n+this.posOffset,this.posSize,this.positionTransform),this.norOffset>=0&&e.transformNormal(this.vertices,n+this.norOffset,3,this.normalTransform),this.biNorOffset>=0&&e.transformNormal(this.vertices,n+this.biNorOffset,3,this.normalTransform),this.tangentOffset>=0&&e.transformNormal(this.vertices,n+this.tangentOffset,3,this.normalTransform));var r=this.vertices[n+this.posOffset],s=this.posSize>1?this.vertices[n+this.posOffset+1]:0,a=this.posSize>2?this.vertices[n+this.posOffset+2]:0;if(this.bounds.ext(r,s,a),this.hasColor)if(this.colOffset>=0)this.vertices[n+this.colOffset]*=this.color.r,this.vertices[n+this.colOffset+1]*=this.color.g,this.vertices[n+this.colOffset+2]*=this.color.b,this.colSize>3&&(this.vertices[n+this.colOffset+3]*=this.color.a);else if(this.cpOffset>=0){c.Color.rgba8888ToColor(this.tempC1,this.vertices[n+this.cpOffset]);var o=this.tempC1.mul(this.color.r,this.color.g,this.color.b,this.color.a);u.NumberUtil.colorToFloat(o.r,o.g,o.b,o.a),this.vertices[n+this.cpOffset]=u.NumberUtil.colorToFloat(o.r,o.g,o.b,o.a)}this.hasUVTransform&&this.uvOffset>=0&&(this.vertices[n+this.uvOffset]=this.uOffset+this.uScale*this.vertices[n+this.uvOffset],this.vertices[n+this.uvOffset+1]=this.vOffset+this.vScale*this.vertices[n+this.uvOffset+1])}},{key:"box",value:function(e,t,i){y.BoxShapeBuilder.buildWithWidthHeight(this,e,t,i)}},{key:"vertexWithData",value:function(t,i,n,r){if(this.vindex>e.MAX_INDEX)throw new Error("Too many vertices used");return this._vertex[this.posOffset]=t.x,this.posSize>1&&(this._vertex[this.posOffset+1]=t.y),this.posSize>2&&(this._vertex[this.posOffset+2]=t.z),this.norOffset>=0&&(i||(i=this.tmpNormal.set(t.x,t.y,t.z).normalize()),this._vertex[this.norOffset]=i.x,this._vertex[this.norOffset+1]=i.y,this._vertex[this.norOffset+2]=i.z),this.colOffset>=0?(n||(n=c.Color.WHITE),this._vertex[this.colOffset]=n.r,this._vertex[this.colOffset+1]=n.g,this._vertex[this.colOffset+2]=n.b,this.colSize>3&&(this._vertex[this.colOffset+3]=n.a)):this.cpOffset>0&&(n||(n=c.Color.WHITE),this._vertex[this.cpOffset]=u.NumberUtil.colorToFloat(n.r,n.g,n.b,n.a)),r&&this.uvOffset>=0&&(this._vertex[this.uvOffset]=r.x,this._vertex[this.uvOffset+1]=r.y),this.addVertex(this._vertex,0),this.lastIndex}},{key:"vertex",value:function(e){return this.vertexWithData(e.hasPosition?e.position:null,e.hasNormal?e.normal:null,e.hasColor?e.color:null,e.hasUV?e.uv:null)}},{key:"index",value:function(e){this.indices.push(e)}},{key:"index2Values",value:function(e,t,i){this.indices.push(e),this.indices.push(t)}},{key:"index3Values",value:function(e,t,i){this.indices.push(e),this.indices.push(t),this.indices.push(i)}},{key:"index4Values",value:function(e,t,i,n){this.indices.push(e),this.indices.push(t),this.indices.push(i),this.indices.push(n)}},{key:"index6Values",value:function(e,t,i,n,r,s){this.indices.push(e),this.indices.push(t),this.indices.push(i),this.indices.push(n),this.indices.push(r),this.indices.push(s)}},{key:"index8Values",value:function(e,t,i,n,r,s,a,o){this.indices.push(e),this.indices.push(t),this.indices.push(i),this.indices.push(n),this.indices.push(r),this.indices.push(s),this.indices.push(a),this.indices.push(o)}},{key:"rect",value:function(e,t,i,n){if(this.primitiveType===_.GL20.GL_TRIANGLES)this.index6Values(e,t,i,i,n,e);else if(this.primitiveType===_.GL20.GL_LINES)this.index8Values(e,t,t,i,i,n,n,e);else{if(this.primitiveType!==_.GL20.GL_POINTS)throw new Error("Incorrect primitive type");this.index4Values(e,t,i,n)}}},{key:"rectWithVertexInfo",value:function(e,t,i,n){this.rect(this.vertex(e),this.vertex(t),this.vertex(i),this.vertex(n))}},{key:"rectWithVectorCorner",value:function(e,t,i,n,r){this.rectWithVertexInfo(this.vertTmp1.set(e,r,null,null).setUV(0,1),this.vertTmp2.set(t,r,null,null).setUV(1,1),this.vertTmp3.set(i,r,null,null).setUV(1,0),this.vertTmp4.set(n,r,null,null).setUV(0,0))}},{key:"rectWithValue",value:function(e,t,i,n,r,s,a,o,l,u,h,c,f,d,m){this.rectWithVertexInfo(this.vertTmp1.set(null,null,null,null).setPos(e,t,i).setNor(f,d,m).setUV(0,1),this.vertTmp2.set(null,null,null,null).setPos(n,r,s).setNor(f,d,m).setUV(1,1),this.vertTmp3.set(null,null,null,null).setPos(a,o,l).setNor(f,d,m).setUV(1,0),this.vertTmp4.set(null,null,null,null).setPos(u,h,c).setNor(f,d,m).setUV(0,0))}},{key:"getVertexTransform",value:function(e){return e.set(this.positionTransform.values)}},{key:"getPrimitiveType",value:function(){return this.primitiveType}}],[{key:"createAttributes",value:function(e){var t=[];return(e&d.Usage.Position)===d.Usage.Position&&t.push(d.VertexAttribute3D.Position()),(e&d.Usage.ColorUnpacked)===d.Usage.ColorUnpacked&&t.push(d.VertexAttribute3D.ColorUnpacked()),(e&d.Usage.ColorPacked)===d.Usage.ColorPacked&&t.push(d.VertexAttribute3D.ColorPacked()),(e&d.Usage.Normal)===d.Usage.Normal&&t.push(d.VertexAttribute3D.Normal()),(e&d.Usage.TextureCoordinates)===d.Usage.TextureCoordinates&&t.push(new d.VertexAttribute3D(d.Usage.TextureCoordinates,2,_.GL20.GL_FLOAT,!1,h.Shader.TEXCOORDS+"0")),new m.VertexAttributes(t)}},{key:"transformPosition",value:function(e,t,i,n){i>2?(this.vTmp.set(e[t],e[t+1],e[t+2]).multiply(n),e[t]=this.vTmp.x,e[t+1]=this.vTmp.y,e[t+2]=this.vTmp.z):i>1?(this.vTmp.set(e[t],e[t+1],0).multiply(n),e[t]=this.vTmp.x,e[t+1]=this.vTmp.y):e[t]=this.vTmp.set(e[t],0,0).multiply(n).x}},{key:"transformNormal",value:function(e,t,i,n){i>2?(this.vTmp.set(e[t],e[t+1],e[t+2]).multiplyMat3(n).normalize(),e[t]=this.vTmp.x,e[t+1]=this.vTmp.y,e[t+2]=this.vTmp.z):i>1?(this.vTmp.set(e[t],e[t+1],0).multiplyMat3(n).normalize(),e[t]=this.vTmp.x,e[t+1]=this.vTmp.y):e[t]=this.vTmp.set(e[t],0,0).multiplyMat3(n).normalize().x}}]),e}();t.MeshBuilder=x,x.MAX_VERTICES=65536,x.MAX_INDEX=x.MAX_VERTICES-1,x.vTmp=new f.Vector3,x.indicesMap=null},8128:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ModelBuilder=void 0;var a=i(4995),o=i(8552),l=i(663),u=i(1960),h=i(5413),c=i(3776),f=function(){function e(t){r(this,e),this.gl=t,this.builders=[],this.tmpTransform=new a.Matrix4}return s(e,[{key:"getBuilder",value:function(e){var t,i=n(this.builders);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.getAttributes().equals(e)&&r.getLastIndex()<16383.5)return r}}catch(a){i.e(a)}finally{i.f()}var s=new c.MeshBuilder(this.gl);return s.begin(e),this.builders.push(s),s}},{key:"begin",value:function(){if(this.model)throw new Error("Call end() first");this.node=null,this.model=new l.Model(this.gl),this.builders.length=0}},{key:"end",value:function(){if(!this.model)throw new Error("Call begin() first");var t=this.model;this.endnode(),this.model=null;var i,r=n(this.builders);try{for(r.s();!(i=r.n()).done;){i.value.end()}}catch(s){r.e(s)}finally{r.f()}return this.builders.length=0,e.rebuildReferencesWithModel(t),t}},{key:"createNode",value:function(){var e=new u.Node;return this.addNode(e),e.id="node"+this.model.nodes.length,e}},{key:"addNode",value:function(e){if(!this.model)throw new Error("Call begin() first");return this.endnode(),this.model.nodes.push(e),this.node=e,e}},{key:"endnode",value:function(){this.node&&(this.node=null)}},{key:"manage",value:function(e){if(!this.model)throw new Error("Call begin() first");this.model.manageDisposable(e)}},{key:"partByMeshPart",value:function(e,t){this.node||this.createNode(),this.node.parts.push(new h.NodePart(e,t))}},{key:"createBox",value:function(e,t,i,n,r){return this.begin(),this.part("box",o.GL20.GL_TRIANGLES,r,n).box(e,t,i),this.end()}},{key:"part",value:function(e,t,i,n){var r=this.getBuilder(c.MeshBuilder.createAttributes(i));return this.node||this.createNode(),this.node.parts.push(new h.NodePart(r.part(e,t),n)),r}}],[{key:"rebuildReferencesWithModel",value:function(t){t.materials.length=0,t.meshes.length=0,t.meshParts.length=0;var i,r=n(t.nodes);try{for(r.s();!(i=r.n()).done;){var s=i.value;e.rebuildReferences(t,s)}}catch(a){r.e(a)}finally{r.f()}}},{key:"rebuildReferences",value:function(e,t){var i,r=n(t.parts);try{for(r.s();!(i=r.n()).done;){var s=i.value;e.materials.includes(s.material)||e.materials.push(s.material),e.meshParts.includes(s.meshPart)||(e.meshParts.push(s.meshPart),e.meshes.includes(s.meshPart.mesh)||e.meshes.push(s.meshPart.mesh),e.manageDisposable(s.meshPart.mesh))}}catch(u){r.e(u)}finally{r.f()}var a,o=n(t.getChildren());try{for(o.s();!(a=o.n()).done;){var l=a.value;this.rebuildReferences(e,l)}}catch(u){o.e(u)}finally{o.f()}}}]),e}();t.ModelBuilder=f},2668:function(e,t,i){"use strict";var n=i(7061).default,r=i(6690).default,s=i(9728).default,a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function a(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FileTextureProvider=void 0;var o=i(7139),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.TextureFilter.Linear,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.TextureFilter.Linear,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.TextureWrap.Repeat,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.TextureWrap.Repeat,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];r(this,e),this.minFilter=t,this.magFilter=i,this.uWrap=n,this.vWrap=s,this.useMipMaps=a}return s(e,[{key:"load",value:function(e,t){return a(this,void 0,void 0,n().mark((function i(){var r;return n().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.Texture.load(e,t);case 2:return(r=i.sent).setFilters(this.minFilter,this.magFilter),r.setWraps(this.uWrap,this.vWrap),i.abrupt("return",r);case 6:case"end":return i.stop()}}),i,this)})))}}]),e}();t.FileTextureProvider=l},9131:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.VertexBufferObject=void 0;var s=i(8552),a=function(){function e(t,i,r,a){n(this,e),this.gl=t,this.verticesLength=0,this.isDirty=!1,this.isBound=!1,this.bufferHandle=this.gl.createBuffer();var o=new Float32Array(a.vertexSize*r);this.setBuffer(o,!0,a),this.setUsage(i?s.GL20.GL_STATIC_DRAW:s.GL20.GL_DYNAMIC_DRAW)}return r(e,[{key:"getAttributes",value:function(){return this.attributes}},{key:"getNumVertices",value:function(){return this.buffer.length/this.attributes.vertexSize}},{key:"getNumMaxVertices",value:function(){return this.buffer.length}},{key:"getBuffer",value:function(){return this.isDirty=!0,this.buffer}},{key:"setBuffer",value:function(e,t,i){if(this.isBound)throw new Error("Cannot change attributes while VBO is bound");this.attributes=i,this.ownsBuffer=t,this.buffer=e}},{key:"bufferChanged",value:function(){this.isBound&&(this.gl.bufferData(s.GL20.GL_ARRAY_BUFFER,this.buffer.subarray(0,this.verticesLength),this.usage),this.isDirty=!1)}},{key:"setVertices",value:function(e,t,i){this.isDirty=!0,this.buffer.set(e.slice(t,t+i),0),this.verticesLength<i&&(this.verticesLength=i),this.bufferChanged()}},{key:"updateVertices",value:function(e,t,i,n){this.isDirty=!0,this.buffer.set(t.slice(i,i+n),e),this.verticesLength=e+n,this.bufferChanged()}},{key:"getUsage",value:function(){return this.usage}},{key:"setUsage",value:function(e){if(this.isBound)throw new Error("Cannot change usage while VBO is bound");this.usage=e}},{key:"bind",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.gl.bindBuffer(s.GL20.GL_ARRAY_BUFFER,this.bufferHandle),this.isDirty&&(this.gl.bufferData(s.GL20.GL_ARRAY_BUFFER,this.buffer.subarray(0,this.verticesLength),this.usage),this.isDirty=!1);var i=this.attributes.size();if(t)for(var n=0;n<i;n++){var r=this.attributes.get(n),a=t[n];a<0||(this.gl.enableVertexAttribArray(a),this.gl.vertexAttribPointer(a,r.numComponents,r.type,r.normalized,this.attributes.vertexSize,r.offset))}else for(var o=0;o<i;o++){var l=this.attributes.get(o),u=e.getAttributeLocation(l.alias);u<0||(this.gl.enableVertexAttribArray(u),this.gl.vertexAttribPointer(u,l.numComponents,l.type,l.normalized,this.attributes.vertexSize,l.offset))}this.isBound=!0}},{key:"unbind",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.attributes.size();if(t)for(var n=0;n<i;n++){var r=t[n];r>=0&&this.gl.disableVertexAttribArray(r)}else for(var a=0;a<i;a++){var o=this.attributes.get(a).alias,l=e.getAttributeLocation(o);l>=0&&this.gl.disableVertexAttribArray(l)}this.gl.bindBuffer(s.GL20.GL_ARRAY_BUFFER,null),this.isBound=!1}},{key:"invalidate",value:function(){this.bufferHandle=this.gl.createBuffer(),this.isDirty=!0}},{key:"dispose",value:function(){this.gl.bindBuffer(s.GL20.GL_ARRAY_BUFFER,null),this.gl.deleteBuffer(this.bufferHandle)}}]),e}();t.VertexBufferObject=a},7243:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6506:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.VertexInfo=void 0;var s=i(8606),a=i(2283),o=i(7811),l=function(){function e(){n(this,e),this.position=new o.Vector3,this.normal=new o.Vector3(0,1,0),this.color=new s.Color(1,1,1,1),this.uv=new a.Vector2}return r(e,[{key:"reset",value:function(){this.position.set(0,0,0),this.normal.set(0,1,0),this.color.set(1,1,1,1),this.uv.set(0,0)}},{key:"set",value:function(e,t,i,n){return this.reset(),this.hasPosition=!!e,this.hasPosition&&this.position.set(e.x,e.y,e.z),this.hasNormal=!!t,this.hasNormal&&this.normal.set(t.x,t.y,t.z),this.hasColor=!!i,this.hasColor&&this.color.set(i.r,i.g,i.b,i.a),this.hasUV=!!n,this.hasUV&&this.uv.set(n.x,n.y),this}},{key:"setWithVertextInfo",value:function(e){return e?(this.hasPosition=e.hasPosition,this.position.set(e.position.x,e.position.y,e.position.z),this.hasNormal=e.hasNormal,this.normal.set(e.normal.x,e.normal.y,e.normal.z),this.hasColor=e.hasColor,this.color.set(e.color.r,e.color.g,e.color.b,e.color.a),this.hasUV=e.hasUV,this.uv.set(e.uv.x,e.uv.y),this):this.set(null,null,null,null)}},{key:"setPos",value:function(e,t,i){return this.position.set(e,t,i),this.hasPosition=!0,this}},{key:"setNor",value:function(e,t,i){return this.normal.set(e,t,i),this.hasNormal=!0,this}},{key:"setCol",value:function(e,t,i,n){return this.color.set(e,t,i,n),this.hasColor=!0,this}},{key:"setUV",value:function(e,t){return this.uv.set(e,t),this.hasUV=!0,this}},{key:"lerp",value:function(e,t){return this.hasPosition&&e.hasPosition&&this.position.lerp(e.position,t),this.hasNormal&&e.hasNormal&&this.normal.lerp(e.normal,t),this.hasColor&&e.hasColor&&this.color.lerp(e.color,t),this.hasUV&&e.hasUV&&this.uv.lerp(e.uv,t),this}}]),e}();t.VertexInfo=l},3975:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(6425),t),r(i(4644),t),r(i(7083),t),r(i(5223),t),r(i(3776),t),r(i(8128),t),r(i(2668),t),r(i(9131),t),r(i(7243),t),r(i(6506),t)},8656:function(e,t,i){"use strict";var n,r=i(4704).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Animation=t.PlayMode=void 0,function(e){e[e.NORMAL=0]="NORMAL",e[e.LOOP=1]="LOOP",e[e.LOOP_PINGPONG=2]="LOOP_PINGPONG",e[e.REVERSED=3]="REVERSED",e[e.LOOP_REVERSED=4]="LOOP_REVERSED"}(n=t.PlayMode||(t.PlayMode={}));var o=function(){function e(t,i){s(this,e),this.totalDuration=0,this.keyFrames=t,Array.isArray(i)||(i=[i]);for(var n=i[i.length-1]||0;i.length<t.length;)i.push(n);var a,o=r(i);try{for(o.s();!(a=o.n()).done;){var l=a.value;this.totalDuration+=l}}catch(u){o.e(u)}finally{o.f()}this.frameDurations=i}return a(e,[{key:"getFrameNumber",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.frameDurations,n=t?i.length-1:0;!((e-=i[n])<0);)t?n--:n++;return n}},{key:"getKeyFrame",value:function(e,t){var i=this.keyFrames,r=this.frameDurations,s=this.totalDuration,a=Math.floor(e/s),o=e%s,l=0;switch(t){case n.NORMAL:l=0===a?this.getFrameNumber(o):r.length-1;break;case n.LOOP:l=this.getFrameNumber(o);break;case n.LOOP_PINGPONG:l=this.getFrameNumber(o,a%2===1);break;case n.REVERSED:l=0===a?this.getFrameNumber(o,!0):0;break;case n.LOOP_REVERSED:l=this.getFrameNumber(o,!0)}return i[l]}}]),e}();t.Animation=o},2121:function(e,t,i){"use strict";var n=i(861).default,r=i(7061).default,s=i(4704).default,a=i(6690).default,o=i(9728).default,l=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function a(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AssetManager=void 0;var u=i(7581),h=i(7139),c=i(9396),f=function(){function e(t){a(this,e),this.promises=[],this.atlases=new Map,this.textures=new Map,this.jsonData=new Map,this.binaryData=new Map,this.done=0,this.listeners=[],this.fonts=new Map,this.gl=t}return o(e,[{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"reportDone",value:function(){this.done++;var e,t=s(this.listeners);try{for(t.s();!(e=t.n()).done;){(0,e.value)(this.done/this.getTotal()*100,this.done>=this.getTotal())}}catch(i){t.e(i)}finally{t.f()}}},{key:"loadAtlas",value:function(e,t){var i=this,n=c.TextureAtlas.load(this.gl,e,{}).then((function(e){return i.atlases.set(t,e),i.reportDone(),e}));return this.promises.push(n),n}},{key:"getAtlas",value:function(e){return this.atlases.get(e)}},{key:"loadJsonData",value:function(e,t){var i=this,n=fetch(e).then((function(e){return e.json()})).then((function(e){return i.jsonData.set(t,e),i.reportDone(),e}));return this.promises.push(n),n}},{key:"getJsonData",value:function(e){return this.jsonData.get(e)}},{key:"loadBinaryData",value:function(e,t){var i=this,n=fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){return i.binaryData.set(t,e),i.reportDone(),e}));return this.promises.push(n),n}},{key:"getBinaryData",value:function(e){return this.binaryData.get(e)}},{key:"loadFont",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=u.BitmapFont.load(this.gl,e,n).then((function(e){return i.fonts.set(t,e),i.reportDone(),e}));return this.promises.push(r),r}},{key:"getFont",value:function(e){return this.fonts.get(e)}},{key:"loadTexture",value:function(e,t){var i=this,n=h.Texture.load(this.gl,e).then((function(e){return i.textures.set(t,e),i.reportDone(),e}));return this.promises.push(n),n}},{key:"getTexture",value:function(e){return this.textures.get(e)}},{key:"finishLoading",value:function(){return l(this,void 0,void 0,r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.promises);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"getDone",value:function(){return this.done}},{key:"getTotal",value:function(){return this.promises.length}},{key:"disposeAll",value:function(){var e=this;n(this.atlases.keys()).forEach((function(t){var i;((null===(i=e.atlases.get(t))||void 0===i?void 0:i.getRegions())||[]).forEach((function(e){var t;null===(t=e.texture)||void 0===t||t.destroy()})),e.atlases.delete(t)})),n(this.textures.keys()).forEach((function(t){var i;null===(i=e.textures.get(t))||void 0===i||i.destroy(),e.textures.delete(t)})),n(this.fonts.keys()).forEach((function(t){var i;((null===(i=e.fonts.get(t))||void 0===i?void 0:i.getRegions())||[]).forEach((function(e){var t;null===(t=e.texture)||void 0===t||t.destroy()})),e.fonts.delete(t)}))}}]),e}();t.AssetManager=f,t.default=f},7581:function(e,t,i){"use strict";var n=i(7061).default,r=i(9728).default,s=i(6690).default,a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function a(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BitmapFont=void 0;var o=i(3959),l=i(2791),u=i(8606),h=r((function e(t,i,n){var r=this;s(this,e),this.load=function(e){for(var t=Object.values(e.glyphs),i=0;i<t.length;i++){var n=t[i];if(n)for(var s=0;s<n.length;s++){var a=n[s];a&&e.setGlyphRegion(a,r.regions[a.page])}}null!=e.missingGlyph&&e.setGlyphRegion(e.missingGlyph,r.regions[e.missingGlyph.page])},this.draw=function(e,t,i,n,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:u.Align.left,o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:t.length,c=arguments.length>9?arguments[9]:void 0;r.cache.clear(),r.cache.addText(t,i,n,l,h,s,a,o,c),r.cache.draw(e)},this.getColor=function(){return r.cache.getColor()},this.getScaleX=function(){return r.data.scaleX},this.getScaleY=function(){return r.data.scaleY},this.getRegions=function(){return r.regions},this.getRegion=function(e){return r.regions[e]},this.getLineHeight=function(){return r.data.lineHeight},this.getSpaceXadvance=function(){return r.data.spaceXadvance},this.getXHeight=function(){return r.data.xHeight},this.getCapHeight=function(){return r.data.capHeight},this.getAscent=function(){return r.data.ascent},this.getDescent=function(){return r.data.descent},this.isFlipped=function(){return r.flipped},this.dispose=function(){if(r.ownsTexture)for(var e=0;e<r.regions.length;e++)r.regions[e].texture.dispose()},this.setFixedWidthGlyphs=function(e){for(var t=r.data,i=0,n=0,s=e.length;n<s;n++){var a=t.getGlyph(e.charAt(n));null!=a&&a.xadvance>i&&(i=a.xadvance)}for(var o=0,l=e.length;o<l;o++){var u=t.getGlyph(e.charAt(o));u&&(u.xoffset+=(i-u.xadvance)/2,u.xadvance=i,u.kerning=[],u.kerning=null,u.fixedWidth=!0)}},this.setUseIntegerPositions=function(e){r.integer=e,r.cache.setUseIntegerPositions(e)},this.usesIntegerPositions=function(){return r.integer},this.getCache=function(){return r.cache},this.getData=function(){return r.data},this.getOwnsTexture=function(){return r.ownsTexture},this.setOwnsTexture=function(e){r.ownsTexture=e},this.newFontCache=function(){return new o.BitmapFontCache(r,r.integer)},this.regions=i,this.flipped=t.flipped,this.data=t,this.integer=n,0!==this.regions.length?(this.ownsTexture=!1,this.cache=this.newFontCache(),this.load(t)):console.log("No texture region were found")}));t.BitmapFont=h,h.load=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return a(void 0,void 0,void 0,n().mark((function s(){var a;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=new l.BitmapFontData(t,i),n.next=3,a.loadFont(e);case 3:return n.abrupt("return",new h(a,a.regions,r));case 4:case"end":return n.stop()}}),s)})))}},3959:function(e,t,i){"use strict";var n=i(861).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BitmapFontCache=void 0;var a=i(7712),o=i(9699),l=i(8606),u=function(){function e(t,i){var s=this;r(this,e),this.tempColor=new l.Color(1,1,1,1),this.drawingTexts=[],this.layouts=[],this.pooledLayouts=[],this.color=new l.Color(1,1,1,1),this.setPosition=function(e,t){s.translate(e-s.x,t-s.y)},this.translate=function(e,t){if(0!==e||0!==t){s.integer&&(e=Math.round(e),t=Math.round(t)),s.x+=e,s.y+=t;for(var i=s.pageVertices,n=0,r=i.length;n<r;n++)for(var a=i[n],o=0,l=s.idx[n];o<l;o+=5)a[o]+=e,a[o+1]+=t}},this.setColors=function(e,t,i,n){for(var r=255<<24|255*i<<16|255*t<<8|255*e,a=o.NumberUtil.intToFloatColor(r),l=0,u=s.pageVertices.length;l<u;l++)for(var h=s.pageVertices[l],c=2,f=s.idx[l];c<f;c+=5)h[c]=a},this.getColor=function(){return s.color},this.setColor=function(e,t,i,n){s.color.set(e,t,i,n)},this.clear=function(){s.x=0,s.y=0,l.Pools.freeAll("GlyphLayout",s.pooledLayouts),s.pooledLayouts.length=0,s.layouts.length=0;for(var e=0,t=s.idx.length;e<t;e++)null!=s.pageGlyphIndices&&(s.pageGlyphIndices[e].length=0),s.idx[e]=0},this.requireGlyphs=function(e){if(1===s.pageVertices.length)s.requirePageGlyphs(0,e.glyphCount);else{for(var t=s.tempGlyphCount,i=0;i<t.length;i++)t[i]=0;for(var n=0,r=e.runs.length;n<r;n++)for(var a=e.runs[n].glyphs,o=a,l=0,u=a.length;l<u;l++)t[o[l].page]++;for(var h=0,c=t.length;h<c;h++)s.requirePageGlyphs(h,t[h])}},this.requirePageGlyphs=function(e,t){var i=s.idx[e]+20*t,n=s.pageVertices[e];if(n){if(n.length<i){var r=new Array(i);l.Utils.arrayCopy(n,0,r,0,s.idx[e]),s.pageVertices[e]=r}}else s.pageVertices[e]=new Array(i)},this.setPageCount=function(e){var t=new Array(e).fill([]);l.Utils.arrayCopy(s.pageVertices,0,t,0,s.pageVertices.length),s.pageVertices=n(t);var i=new Array(e);l.Utils.arrayCopy(s.idx,0,i,0,s.idx.length),s.idx=i;var r=new Array(e),a=0;null!=s.pageGlyphIndices&&(a=s.pageGlyphIndices.length,l.Utils.arrayCopy(s.pageGlyphIndices,0,r,0,s.pageGlyphIndices.length));for(var o=a;o<e;o++)r[o]=[];s.pageGlyphIndices=r,s.tempGlyphCount=new Array(e)},this.addToCache=function(e,t,i){var n=e.runs.length;if(0!==n){s.pageVertices.length<s.font.regions.length&&s.setPageCount(s.font.regions.length),s.layouts.push(e),s.requireGlyphs(e);var r=e.colors,a=0,l=0,u=0,h=0;s.drawingTexts.length=0;for(var c=0;c<n;c++)for(var f=e.runs[c],d=f.glyphs,m=f.xAdvances,_=t+f.x,p=i+f.y,v=0,y=f.glyphs.length;v<y;v++)u++===l&&(h=o.NumberUtil.intToFloatColor(r[++a]),l=++a<r.length?r[a]:-1),_+=m[v],s.drawingTexts.push(d[v].id),s.addGlyph(d[v],_,p,h);s.currentTint=o.NumberUtil.intToFloatColor(-1)}},this.addGlyph=function(e,t,i,n){var r=s.font.data.scaleX,a=s.font.data.scaleY;t+=e.xoffset*r,i+=e.yoffset*a;var o=e.width*r,l=e.height*a,u=e.u,h=e.u2,c=e.v,f=e.v2;s.integer&&(t=Math.round(t),i=Math.round(i),o=Math.round(o),l=Math.round(l));var d=t+o,m=i+l,_=e.page,p=s.idx[_];s.idx[_]+=20,null!=s.pageGlyphIndices&&s.pageGlyphIndices[_].push(s.glyphCount++);var v=s.pageVertices[_];v[p++]=t,v[p++]=i,v[p++]=n,v[p++]=u,v[p++]=c,v[p++]=t,v[p++]=m,v[p++]=n,v[p++]=u,v[p++]=f,v[p++]=d,v[p++]=m,v[p++]=n,v[p++]=h,v[p++]=f,v[p++]=d,v[p++]=i,v[p++]=n,v[p++]=h,v[p]=c},this.setText=function(e,t,i,n,r,a,o,l,u){return s.clear(),s.addText(e,t,i,n,r,a,o,l,u)},this.setTextToCache=function(e,t,i){s.clear(),s.addTextToCache(e,t,i)},this.addText=function(e,t,i,n,r,a,o,u,h){var c=l.Pools.obtain("GlyphLayout");return s.pooledLayouts.push(c),c.setText(s.font,e,n,r,s.color,a,o,u,h),s.addTextToCache(c,t,i),c},this.addTextToCache=function(e,t,i){s.addToCache(e,t,i+s.font.data.ascent)},this.getX=function(){return s.x},this.getY=function(){return s.y},this.getFont=function(){return s.font},this.setUseIntegerPositions=function(e){s.integer=e},this.usesIntegerPositions=function(){return s.integer},this.getVertices=function(e){return s.pageVertices[e]},this.getVertexCount=function(e){return s.idx[e]},this.getLayouts=function(){return s.layouts},this.font=t,this.integer=i;var u=t.regions.length;if(0===u&&console.log("The specified font must contain at least one texture page."),this.pageVertices=new Array(u).fill([]),this.idx=new Array(u),u>1){this.pageGlyphIndices=new Array(u);for(var h=0,c=this.pageGlyphIndices.length;h<c;h++)this.pageGlyphIndices[h]=[]}this.tempGlyphCount=new Array(u),l.Pools.get("GlyphLayout",(function(){return new a.GlyphLayout(t,"",0,0,l.Color.WHITE,0,l.Align.left,!1)}))}return s(e,[{key:"draw",value:function(e){for(var t=this,i=this.font.getRegions(),n=0;n<this.pageVertices.length;n++)if(this.idx[n]>0)for(var r=this.pageVertices[n],s=function(n){var s=20*n,a=i.find((function(e){var i;return e.id===(null===(i=t.drawingTexts)||void 0===i?void 0:i[n])}));a&&a.draw(e,r[0+s],r[1+s],r[10+s]-r[0+s],r[11+s]-r[1+s])},a=0;a<this.idx[n]/20;a++)s(a)}}]),e}();t.BitmapFontCache=u},2791:function(e,t,i){"use strict";var n=i(861).default,r=i(7061).default,s=i(6690).default,a=i(9728).default,o=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function a(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BitmapFontData=void 0;var l=i(2013),u=i(7139),h=i(859),c=i(8606),f=65535,d=function(){function e(t,i){var n=this;s(this,e),this.capHeight=1,this.blankLineScale=1,this.scaleX=1,this.scaleY=1,this.glyphs={},this.xHeight=1,this.xChars=["x","e","a","o","n","s","r","c","u","m","v","w","z"],this.capChars=["M","N","B","D","C","E","F","K","A","G","H","I","J","L","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.loadFont=function(e){return o(n,void 0,void 0,r().mark((function t(){var i,n,s,a,o,d,_,p,v,y,g,x,b,w,A,S,M,C,k,B,V,T,P,L,E,I,R,F,G,D,O,N,z,U,j,W,q,H,X,J,Y,Z,Q,K,$,ee,te,ie,ne,re,se,ae,oe,le,ue,he,ce,fe,de,me,_e,pe,ve,ye,ge,xe;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==this.imagePaths){t.next=2;break}return t.abrupt("return");case 2:return i=0,t.next=5,fetch(this.fontFile);case 5:return s=t.sent,t.next=8,s.text();case 8:if(n=t.sent,a=n.split(/\r?\n/).map((function(e){return e.trim()})),t.prev=10,"string"===typeof(o=a[i])){t.next=14;break}throw new Error("File is empty.");case 14:if(o=o.substring(o.indexOf("padding=")+8),4===(d=o.substring(0,o.indexOf(" ")).split(",",4)).length){t.next=18;break}throw new Error("Invalid padding.");case 18:if(this.padTop=parseInt(d[0]),this.padRight=parseInt(d[1]),this.padBottom=parseInt(d[2]),this.padLeft=parseInt(d[3]),_=this.padTop+this.padBottom,i++,"string"===typeof(o=a[i])){t.next=27;break}throw new Error("Missing common header.");case 27:if(!((p=o.split(" ",9)).length<3)){t.next=30;break}throw new Error("Invalid common header.");case 30:if(p[1].startsWith("lineHeight=")){t.next=32;break}throw new Error("Missing: lineHeight");case 32:if(this.lineHeight=parseInt(p[1].substring(11)),p[2].startsWith("base=")){t.next=35;break}throw new Error("Missing: base");case 35:if(v=parseInt(p[2].substring(5)),y=1,p.length>=6&&null!=p[5]&&p[5].startsWith("pages="))try{y=Math.max(1,parseInt(p[5].substring(6)))}catch(r){}this.imagePaths=new Array(y),g=[],x=0;case 41:if(!(x<y)){t.next=65;break}if(i++,"string"===typeof(o=a[i])){t.next=46;break}throw new Error("Missing additional page definitions.");case 46:if(!((b=o.match(new RegExp(".*id=(\\d+)")))&&b.length>1)){t.next=57;break}if(w=b[1],t.prev=49,parseInt(w)===x){t.next=53;break}throw new Error("Page IDs must be indices starting at 0: "+w);case 53:t.next=57;break;case 55:t.prev=55,t.t0=t.catch(49);case 57:if((A=o.match(new RegExp('.*file="?([^"]+)"?')))&&!(A.length<=1)){t.next=60;break}throw new Error("Missing: file");case 60:S=A[1],g[x]=S;case 62:x++,t.next=41;break;case 65:this.descent=0;case 66:if(i++,o=a[i]){t.next=71;break}return t.abrupt("break",105);case 71:if(!o.startsWith("kernings ")){t.next=73;break}return t.abrupt("break",105);case 73:if(!o.startsWith("metrics ")){t.next=75;break}return t.abrupt("break",105);case 75:if(o.startsWith("char ")){t.next=77;break}return t.abrupt("continue",66);case 77:if(M=new l.Glyph,(C=new m(o,"=")).nextToken(),C.nextToken(),!((k=parseInt(C.nextToken()))>0&&k>f)){t.next=84;break}return t.abrupt("continue",66);case 84:if(M.id=k+"",C.nextToken(),M.srcX=parseInt(C.nextToken()),C.nextToken(),M.srcY=parseInt(C.nextToken()),C.nextToken(),M.width=parseInt(C.nextToken()),C.nextToken(),M.height=parseInt(C.nextToken()),C.nextToken(),M.xoffset=parseInt(C.nextToken()),C.nextToken(),this.flipped?M.yoffset=parseInt(C.nextToken()):M.yoffset=-(M.height+parseInt(C.nextToken())),C.nextToken(),M.xadvance=parseInt(C.nextToken()),C.hasMoreTokens()&&C.nextToken(),C.hasMoreTokens())try{M.page=parseInt(C.nextToken())}catch(be){}M.width>0&&M.height>0&&(this.descent=Math.min(v+M.yoffset,this.descent)),k<=0?this.missingGlyph=M:k<=f&&this.setGlyph(k,M),t.next=66;break;case 105:this.descent+=this.padBottom;case 106:if(i++,"string"===typeof(o=a[i])){t.next=111;break}return t.abrupt("break",127);case 111:if(o.startsWith("kerning ")){t.next=113;break}return t.abrupt("break",127);case 113:if((B=new m(o,"=")).nextToken(),B.nextToken(),V=parseInt(B.nextToken()),B.nextToken(),T=parseInt(B.nextToken()),!(V<0||V>f||T<0||T>f)){t.next=121;break}return t.abrupt("continue",106);case 121:P=this.getGlyph(V+""),B.nextToken(),L=parseInt(B.nextToken()),P&&P.setKerning(T,L),t.next=106;break;case 127:E=!1,I=0,R=0,F=0,G=0,D=0,O=0,N=0,null!=o&&o.startsWith("metrics ")&&(E=!0,(z=new m(o,"=")).nextToken(),z.nextToken(),I=parseFloat(z.nextToken()),z.nextToken(),R=parseFloat(z.nextToken()),z.nextToken(),F=parseFloat(z.nextToken()),z.nextToken(),G=parseFloat(z.nextToken()),z.nextToken(),D=parseFloat(z.nextToken()),z.nextToken(),O=parseFloat(z.nextToken()),z.nextToken(),N=parseFloat(z.nextToken())),(U=this.getGlyph("32"))||((U=new l.Glyph).id="32",(j=this.getGlyph("l"))||(j=this.getFirstGlyph()),U.xadvance=j.xadvance,this.setGlyph(32,U)),0===U.width&&(U.width=this.padLeft+U.xadvance+this.padRight,U.xoffset=-this.padLeft),this.spaceXadvance=U.xadvance,q=0;case 141:if(!(q<this.xChars.length)){t.next=148;break}if(!(W=this.getGlyph(this.xChars[q]))){t.next=145;break}return t.abrupt("break",148);case 145:q++,t.next=141;break;case 148:W||(W=this.getFirstGlyph()),this.xHeight=W.height-_,X=0;case 151:if(!(X<this.capChars.length)){t.next=158;break}if(!(H=this.getGlyph(this.capChars[X]))){t.next=155;break}return t.abrupt("break",158);case 155:X++,t.next=151;break;case 158:if(H){t.next=178;break}J=Object.values(this.glyphs),Y=0;case 161:if(!(Y<J.length)){t.next=176;break}if(Z=J[Y]){t.next=165;break}return t.abrupt("continue",173);case 165:Q=0;case 166:if(!(Q<Z.length)){t.next=173;break}if(Z[Q]&&0!==Z[Q].height&&0!==Z[Q].width){t.next=169;break}return t.abrupt("continue",170);case 169:this.capHeight=Math.max(this.capHeight,Z[Q].height);case 170:Q++,t.next=166;break;case 173:Y++,t.next=161;break;case 176:t.next=179;break;case 178:this.capHeight=H.height;case 179:for(this.capHeight-=_,this.ascent=v-this.capHeight,this.down=-this.lineHeight,this.flipped&&(this.ascent=-this.ascent,this.down=-this.down),E&&(this.ascent=I,this.descent=R,this.down=F,this.capHeight=G,this.lineHeight=D,this.spaceXadvance=O,this.xHeight=N),K=[],$=Object.values(this.glyphs),ee=0;ee<$.length;ee++)for(te=Object.values($[ee]),ie=0;ie<te.length;ie++)ne={id:te[ie].id,left:te[ie].srcX,top:te[ie].srcY,width:te[ie].width,height:te[ie].height,xoffset:te[ie].xoffset,yoffset:te[ie].yoffset,xadvance:te[ie].xadvance,page:g[te[ie].page],pageId:te[ie].page},K.push(ne);re=[],se=0;case 189:if(!(se<y)){t.next=199;break}return t.next=192,u.Texture.load(e,(0,c.concatAndResolveUrl)(this.fontFile,"../".concat(g[se])));case 192:ae=t.sent,oe=1/ae.width,le=1/ae.height,re.push({texture:ae,invTexWidth:oe,invTexHeight:le});case 196:se++,t.next=189;break;case 199:for(this.regions=[],ue=0,he=K;ue<he.length;ue++)ce=he[ue],fe=ce.left,de=ce.top,me=ce.width,_e=ce.height,pe=re[ce.pageId],ve=pe.texture,ye=pe.invTexWidth,ge=pe.invTexHeight,(xe=new h.TextureRegion(ve,fe,de,me,_e,ce,ye,ge)).originalWidth=me,xe.originalHeight=_e,xe.offsetX=0,xe.offsetY=0,this.regions.push(xe);t.next=206;break;case 203:t.prev=203,t.t1=t.catch(10),console.error(t.t1);case 206:case"end":return t.stop()}}),t,this,[[10,203],[49,55]])})))},this.setGlyphRegion=function(e,t){var i=t.texture,r=1/i.width,s=1/i.height,a=t.u,o=t.v,l=(t.originalWidth,t.originalHeight,e.srcX),u=e.srcX+e.width,h=e.srcY,c=e.srcY+e.height;e.u=a+l*r,e.u2=a+u*r,n.flipped?(e.v=o+h*s,e.v2=o+c*s):(e.v2=o+h*s,e.v=o+c*s)},this.setLineHeight=function(e){n.lineHeight=e*n.scaleY,n.down=n.flipped?n.lineHeight:-n.lineHeight},this.setGlyph=function(e,t){var i=n.glyphs[e/l.PAGE_SIZE];i||(i=new Array(l.PAGE_SIZE),n.glyphs[e/l.PAGE_SIZE]=i),i[e&l.PAGE_SIZE-1]=t},this.getFirstGlyph=function(){for(var e=Object.values(n.glyphs),t=0;t<e.length;t++){var i=e[t];if(i)for(var r=0;r<i.length;r++){var s=i[r];if(s&&0!==s.height&&0!==s.width)return s}}},this.hasGlyph=function(e){return!!n.missingGlyph||null!=n.getGlyph(e)},this.getGlyph=function(e){var t=n.glyphs[e.charCodeAt(0)/l.PAGE_SIZE];if(null!=t)return t[e.charCodeAt(0)&l.PAGE_SIZE-1]},this.getGlyphs=function(e,t,i,r,s){if(0!==r-i){var a=n.markupEnabled,o=n.scaleX,l=e.glyphs,u=e.xAdvances;do{var h=t.charAt(i++);if("\r"!==h){var c=n.getGlyph(h);if(!c){if(!n.missingGlyph)continue;c=n.missingGlyph}l.push(c),u.push(s?(s.xadvance+s.getKerning(h))*o:c.fixedWidth?0:-c.xoffset*o-n.padLeft),s=c,a&&"["===h&&i<r&&"["===t.charAt(i)&&i++}}while(i<r);if(s){var f=s.fixedWidth?s.xadvance*o:(s.width+s.xoffset)*o-n.padRight;u.push(f)}}},this.getWrapIndex=function(e,t){var i=t-1,r=e,s=r[i].id;if(n.isWhitespace(s+""))return i;for(n.isBreakChar(s+"")&&i--;i>0;i--)if(s=r[i].id,n.isWhitespace(s+"")||n.isBreakChar(s+""))return i+1;return 0},this.isBreakChar=function(e){if(!n.breakChars)return!1;for(var t=String.fromCharCode(parseInt(e)),i=0;i<n.breakChars.length;i++)if(t===n.breakChars[i])return!0;return!1},this.isWhitespace=function(e){switch(String.fromCharCode(parseInt(e))){case"\n":case"\r":case"\t":case" ":return!0;default:return!1}},this.getImagePath=function(e){return n.imagePaths[e]},this.getImagePaths=function(){return n.imagePaths},this.setScale=function(e,t){if(0!==e&&0!==t){var i=e/n.scaleX,r=t/n.scaleY;n.lineHeight*=r,n.spaceXadvance*=i,n.xHeight*=r,n.capHeight*=r,n.ascent*=r,n.descent*=r,n.down*=r,n.padLeft*=i,n.padRight*=i,n.padTop*=r,n.padBottom*=r,n.scaleX=e,n.scaleY=t}},this.scale=function(e){n.setScale(n.scaleX+e,n.scaleY+e)},this.fontFile=t,this.flipped=i}return a(e,[{key:"setXYScale",value:function(e){this.setScale(e,e)}}]),e}();t.BitmapFontData=d;var m=function(){function e(t,i){s(this,e),this.strArray=[],this.currentIndex=0;for(var r=t.split(/\s+/),a=0;a<r.length;a++){var o,l=r[a];(o=this.strArray).push.apply(o,n(l.split(i)))}}return a(e,[{key:"hasMoreTokens",value:function(){return this.currentIndex>=this.strArray.length}},{key:"nextToken",value:function(){return this.strArray[this.currentIndex++]}}]),e}()},5477:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BoundingBox=void 0;var a=i(7811),o=function(){function e(){r(this,e),this.min=new a.Vector3,this.max=new a.Vector3,this.cnt=new a.Vector3,this.dim=new a.Vector3,this.clr()}return s(e,[{key:"getCenter",value:function(e){return e.setFrom(this.cnt)}},{key:"getCenterX",value:function(){return this.cnt.x}},{key:"getCenterY",value:function(){return this.cnt.y}},{key:"getCenterZ",value:function(){return this.cnt.z}},{key:"getCorner000",value:function(e){return e.set(this.min.x,this.min.y,this.min.z)}},{key:"getCorner001",value:function(e){return e.set(this.min.x,this.min.y,this.max.z)}},{key:"getCorner010",value:function(e){return e.set(this.min.x,this.max.y,this.min.z)}},{key:"getCorner011",value:function(e){return e.set(this.min.x,this.max.y,this.max.z)}},{key:"getCorner100",value:function(e){return e.set(this.max.x,this.min.y,this.min.z)}},{key:"getCorner101",value:function(e){return e.set(this.max.x,this.min.y,this.max.z)}},{key:"getCorner110",value:function(e){return e.set(this.max.x,this.max.y,this.min.z)}},{key:"getCorner111",value:function(e){return e.set(this.max.x,this.max.y,this.max.z)}},{key:"getDimensions",value:function(e){return e.setFrom(this.dim)}},{key:"getWidth",value:function(){return this.dim.x}},{key:"getHeight",value:function(){return this.dim.y}},{key:"getDepth",value:function(){return this.dim.z}},{key:"getMin",value:function(e){return e.setFrom(this.min)}},{key:"getMax",value:function(e){return e.setFrom(this.max)}},{key:"setFromBounds",value:function(e){return this.set(e.min,e.max)}},{key:"set",value:function(e,t){return this.min.set(e.x<t.x?e.x:t.x,e.y<t.y?e.y:t.y,e.z<t.z?e.z:t.z),this.max.set(e.x>t.x?e.x:t.x,e.y>t.y?e.y:t.y,e.z>t.z?e.z:t.z),this.update(),this}},{key:"update",value:function(){this.cnt.setFrom(this.min).add(this.max).scale(.5),this.dim.setFrom(this.max).sub(this.min)}},{key:"setFromPoints",value:function(e){this.inf();var t,i=n(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.extPoint(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"inf",value:function(){return this.min.set(1/0,1/0,1/0),this.max.set(-1/0,-1/0,-1/0),this.cnt.set(0,0,0),this.dim.set(0,0,0),this}},{key:"extPoint",value:function(e){return this.set(this.min.set(Math.min(this.min.x,e.x),Math.min(this.min.y,e.y),Math.min(this.min.z,e.z)),this.max.set(Math.max(this.max.x,e.x),Math.max(this.max.y,e.y),Math.max(this.max.z,e.z)))}},{key:"clr",value:function(){return this.set(this.min.set(0,0,0),this.max.set(0,0,0))}},{key:"isValid",value:function(){return this.min.x<=this.max.x&&this.min.y<=this.max.y&&this.min.z<=this.max.z}},{key:"extBounds",value:function(e){return this.set(this.min.set(Math.min(this.min.x,e.min.x),Math.min(this.min.y,e.min.y),Math.min(this.min.z,e.min.z)),this.max.set(Math.max(this.max.x,e.max.x),Math.max(this.max.y,e.max.y),Math.max(this.max.z,e.max.z)))}},{key:"extSphere",value:function(e,t){return this.set(this.min.set(Math.min(this.min.x,e.x-t),Math.min(this.min.y,e.y-t),Math.min(this.min.z,e.z-t)),this.max.set(Math.max(this.max.x,e.x+t),Math.max(this.max.y,e.y+t),Math.max(this.max.z,e.z+t)))}},{key:"extTransformedBox",value:function(t,i){return this.extPoint(e.tmpVector.set(t.min.x,t.min.y,t.min.z).multiply(i)),this.extPoint(e.tmpVector.set(t.min.x,t.min.y,t.max.z).multiply(i)),this.extPoint(e.tmpVector.set(t.min.x,t.max.y,t.min.z).multiply(i)),this.extPoint(e.tmpVector.set(t.min.x,t.max.y,t.max.z).multiply(i)),this.extPoint(e.tmpVector.set(t.max.x,t.min.y,t.min.z).multiply(i)),this.extPoint(e.tmpVector.set(t.max.x,t.min.y,t.max.z).multiply(i)),this.extPoint(e.tmpVector.set(t.max.x,t.max.y,t.min.z).multiply(i)),this.extPoint(e.tmpVector.set(t.max.x,t.max.y,t.max.z).multiply(i)),this}},{key:"mul",value:function(t){var i=this.min.x,n=this.min.y,r=this.min.z,s=this.max.x,a=this.max.y,o=this.max.z;return this.inf(),this.extPoint(e.tmpVector.set(i,n,r).multiply(t)),this.extPoint(e.tmpVector.set(i,n,o).multiply(t)),this.extPoint(e.tmpVector.set(i,a,r).multiply(t)),this.extPoint(e.tmpVector.set(i,a,o).multiply(t)),this.extPoint(e.tmpVector.set(s,n,r).multiply(t)),this.extPoint(e.tmpVector.set(s,n,o).multiply(t)),this.extPoint(e.tmpVector.set(s,a,r).multiply(t)),this.extPoint(e.tmpVector.set(s,a,o).multiply(t)),this}},{key:"containsBounds",value:function(e){return!this.isValid()||this.min.x<=e.min.x&&this.min.y<=e.min.y&&this.min.z<=e.min.z&&this.max.x>=e.max.x&&this.max.y>=e.max.y&&this.max.z>=e.max.z}},{key:"intersects",value:function(e){if(!this.isValid())return!1;var t=Math.abs(this.cnt.x-e.cnt.x),i=this.dim.x/2+e.dim.x/2,n=Math.abs(this.cnt.y-e.cnt.y),r=this.dim.y/2+e.dim.y/2,s=Math.abs(this.cnt.z-e.cnt.z),a=this.dim.z/2+e.dim.z/2;return t<=i&&n<=r&&s<=a}},{key:"containsPoint",value:function(e){return this.min.x<=e.x&&this.max.x>=e.x&&this.min.y<=e.y&&this.max.y>=e.y&&this.min.z<=e.z&&this.max.z>=e.z}},{key:"ext",value:function(e,t,i){return this.set(this.min.set(Math.min(this.min.x,e),Math.min(this.min.y,t),Math.min(this.min.z,i)),this.max.set(Math.max(this.max.x,e),Math.max(this.max.y,t),Math.max(this.max.z,i)))}}]),e}();t.BoundingBox=o,o.tmpVector=new a.Vector3},7459:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.OrthoCamera=void 0;var s=i(4995),a=i(7811),o=function(){function e(t,i,r,o){n(this,e),this.position=new a.Vector3(0,0,0),this.direction=new a.Vector3(0,0,-1),this.up=new a.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new s.Matrix4,this.inverseProjectionView=new s.Matrix4,this.projection=new s.Matrix4,this.view=new s.Matrix4,this.yDown=!1,this.tmp3=new a.Vector3,this.resize(t,i,r,o)}return r(e,[{key:"getYDown",value:function(){return this.yDown}},{key:"setYDown",value:function(e){this.yDown=e,e?(this.up.set(0,-1,0),this.direction.set(0,0,1)):(this.up.set(0,1,0),this.direction.set(0,0,-1)),this.update()}},{key:"resize",value:function(e,t,i,n){this.viewportWidth=e,this.viewportHeight=t,this.screenWidth=i,this.screenHeight=n,this.update()}},{key:"setPosition",value:function(e,t){this.position.set(e,t,this.position.z)}},{key:"update",value:function(){var e=this.projection,t=this.view,i=this.projectionView,n=this.inverseProjectionView,r=this.zoom,s=this.viewportWidth,a=this.viewportHeight;e.ortho(r*(-s/2),r*(s/2),r*(-a/2),r*(a/2),this.near,this.far),t.lookAt(this.position,this.direction,this.up),i.set(e.values),i.multiply(t),n.set(i.values).invert(),this.combined=i.values}},{key:"screenToWorld",value:function(e,t,i){t=t||this.screenWidth,i=i||this.screenHeight;var n=e.x,r=i-e.y-1;return e.x=2*n/t-1,e.y=2*r/i-1,e.z=2*e.z-1,e.project(this.inverseProjectionView),e}},{key:"worldToScreen",value:function(e,t,i){return t=t||this.screenWidth,i=i||this.screenHeight,e.project(this.projectionView),e.x=t*(e.x+1)/2,e.y=i*(e.y+1)/2,e.z=(e.z+1)/2,e}},{key:"unprojectVector2",value:function(e,t){this.tmp3.set(t.x,t.y,0),this.screenToWorld(this.tmp3),e.set(this.tmp3.x,this.tmp3.y)}},{key:"setViewport",value:function(e,t){this.viewportWidth=e,this.viewportHeight=t}}]),e}();t.OrthoCamera=o},6176:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var s=function(){function e(){n(this,e)}return r(e,[{key:"setScreen",value:function(e){this.currentScreen&&this.currentScreen.dispose&&this.currentScreen.dispose(),this.currentScreen=e,this.currentScreen&&this.currentScreen.init&&this.currentScreen.init(this)}},{key:"update",value:function(e){this.currentScreen&&this.currentScreen.update&&this.currentScreen.update(e,this)}}]),e}();t.Game=s,s.shared=new s},2013:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Glyph=t.PAGES=t.PAGE_SIZE=t.LOG2_PAGE_SIZE=void 0,t.LOG2_PAGE_SIZE=9,t.PAGE_SIZE=1<<t.LOG2_PAGE_SIZE,t.PAGES=65536/t.PAGE_SIZE;var s=function(){function e(){n(this,e),this.page=0}return r(e,[{key:"getKerning",value:function(e){if(this.kerning){var i=this.kerning[e.charCodeAt(0)>>>t.LOG2_PAGE_SIZE];if(null!=i)return i[e.charCodeAt(0)&t.PAGE_SIZE-1]}return 0}},{key:"setKerning",value:function(e,i){this.kerning||(this.kerning=[]);var n=this.kerning[e>>>t.LOG2_PAGE_SIZE];n||(this.kerning[e>>>t.LOG2_PAGE_SIZE]=n=new Uint32Array(new ArrayBuffer(t.PAGE_SIZE))),n[e&t.PAGE_SIZE-1]=i}}]),e}();t.Glyph=s},7712:function(e,t,i){"use strict";var n=i(861).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphLayout=void 0;var a=i(9045),o=i(8606),l=function(){function e(t,i){var s=this,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(null===i||void 0===i?void 0:i.length)||0,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.Color.WHITE,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o.Align.left,d=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],m=arguments.length>8?arguments[8]:void 0;r(this,e),this.epsilon=1e-4,this.glyphRunPool=o.Pools.get("GlyphRun",(function(){return new a.GlyphRun})),this.colorStack=new Array(4),this.runs=[],this.colors=[],this.setText=function(e,t,i,n,r,a,o,l,u){s.reset();var h=e.data;if(i!==n){l&&(a=Math.max(a,3*h.spaceXadvance));var c=l||null!=u,f=r.toIntBits(),d=f;s.colors.shift();var m=h.markupEnabled;m&&s.colorStack.push(f);for(var _=!1,p=0,v=h.down,y=null,g=null,x=i;;){var b=void 0,w=!1;if(i===n){if(x===n)break;b=n,_=!0}else{if("\n"!==t.charAt(i++))continue;b=i-1,w=!0}e:{var A=s.glyphRunPool.obtain();if(A.x=0,A.y=p,h.getGlyphs(A,t,x,b,g),s.glyphCount+=A.glyphs.length,d!==f&&(s.colors[s.colors.length-2]===s.glyphCount?s.colors[s.colors.length-1]=d:(s.colors.push(s.glyphCount),s.colors.push(d)),f=d),0===A.glyphs.length){if(s.glyphRunPool.free(A),!y)break}else y?(y.appendRun(A),s.glyphRunPool.free(A)):(y=A,s.runs.push(y));if(w||_?(s.setLastGlyphXAdvance(h,y),g=null):g=y.glyphs[y.glyphs.length-1],c&&0!==y.glyphs.length&&(w||_))for(var S=y.xAdvances[0]+y.xAdvances[1],M=2;M<y.xAdvances.length;M++){var C=y.glyphs[M-1];if(S+s.getGlyphWidth(C,h)-s.epsilon<=a)S+=y.xAdvances[M];else{if(null!=u){s.truncate(h,y,a,u);break}var k=h.getWrapIndex(y.glyphs,M);if((0===k&&0===y.x||k>=y.glyphs.length)&&(k=M-1),!(y=s.wrap(h,y,k)))break e;s.runs.push(y),p+=v,y.x=0,y.y=p,S=y.xAdvances[0]+y.xAdvances[1],M=1}}}w&&(y=null,g=null,p+=b===x?v*h.blankLineScale:v),x=i}s.height=h.capHeight+Math.abs(p),s.calculateWidths(h),s.alignRuns(a,o),m&&(s.colorStack.length=0)}else s.height=h.capHeight},this.calculateWidths=function(e){for(var t,i=0,r=n(s.runs),a=0,o=s.runs.length;a<o;a++){for(var l=r[a],u=l.xAdvances,h=l.x+u[0],c=0,f=l.glyphs,d=0;d<l.glyphs.length;){var m=f[d],_=s.getGlyphWidth(m,e);c=Math.max(c,h+_),h+=null!==(t=u[++d])&&void 0!==t?t:0}l.width=Math.max(h,c)-l.x,i=Math.max(i,l.x+(isNaN(l.width)?h:l.width))}s.width=i},this.alignRuns=function(e,t){if(0===(t&o.Align.left))for(var i=0!==(t&o.Align.center),r=n(s.runs),a=0,l=s.runs.length;a<l;a++){var u=r[a];u.x+=i?.5*(e-u.width):e-u.width}},this.truncate=function(e,t,i,n){var r=t.glyphs.length,a=s.glyphRunPool.obtain();e.getGlyphs(a,n,0,n.length,null);var l=0;if(a.xAdvances.length>0){s.setLastGlyphXAdvance(e,a);for(var u=a.xAdvances,h=1;h<a.xAdvances.length;h++)l+=u[h]}i-=l;for(var c=0,f=t.x,d=t.xAdvances;c<t.xAdvances.length;){if((f+=d[c])>i)break;c++}if(c>1){if(c-1>=0&&t.glyphs.length>c-1)for(var m=c-1;m<t.glyphs.length;m++)t.glyphs.splice(m,1);if(c>=0&&t.xAdvances.length>c)for(var _=c;_<t.xAdvances.length;_++)t.xAdvances.splice(_,1);s.setLastGlyphXAdvance(e,t),a.xAdvances.length>0&&o.Utils.arrayCopy(a.xAdvances,1,t.xAdvances,t.xAdvances.length,a.xAdvances.length-1)}else t.glyphs.length=0,t.xAdvances.length=0,o.Utils.arrayCopy(a.xAdvances,0,t.xAdvances,t.xAdvances.length,a.xAdvances.length);var p=r-t.glyphs.length;if(p>0&&(s.glyphCount-=p,e.markupEnabled))for(;s.colors.length>2&&s.colors[s.colors.length-2]>=s.glyphCount;)s.colors.length-=2;o.Utils.arrayCopy(a.glyphs,0,t.glyphs,t.glyphs.length,a.glyphs.length),s.glyphCount+=n.length,s.glyphRunPool.free(a)},this.setLastGlyphXAdvance=function(e,t){var i=t.glyphs[t.glyphs.length-1];i.fixedWidth||(t.xAdvances[t.xAdvances.length-1]=s.getGlyphWidth(i,e))},this.getGlyphWidth=function(e,t){return(e.width+e.xoffset)*t.scaleX-t.padRight},this.getLineOffset=function(e,t){return-e[0].xoffset*t.scaleX-t.padLeft},this.reset=function(){s.glyphRunPool.freeAll(s.runs),s.runs.length=0,s.colors.length=0,s.glyphCount=0,s.width=0,s.height=0},t&&i&&this.setText(t,i,l,u,h,c,f,d,m)}return s(e,[{key:"wrap",value:function(e,t,i){for(var n=t.glyphs.length,r=t.glyphs,s=t.xAdvances,a=i;a>0&&e.isWhitespace(r[a-1].id);a--);for(var l,u=i;u<n&&e.isWhitespace(r[u].id);u++);if(u<n){var h=(l=this.glyphRunPool.obtain()).glyphs;o.Utils.arrayCopy(r,0,h,h.length,a),r.splice(0,u-1+1),t.glyphs=h,l.glyphs=r;var c=l.xAdvances;o.Utils.arrayCopy(s,0,c,c.length,a+1),s.splice(1,u),s[0]=this.getLineOffset(r,e),t.xAdvances=c,l.xAdvances=s;var f=t.glyphs.length,d=l.glyphs.length,m=n-f-d;if(this.glyphCount-=m,e.markupEnabled&&m>0)for(var _=this.glyphCount-d,p=this.colors.length-2;p>=2;p-=2){var v=this.colors[p];if(v<=_)break;this.colors[p]=v-m}}else{r=r.slice(0,a),s=s.slice(0,a+1);var y=u-a;if(y>0&&(this.glyphCount-=y,e.markupEnabled&&this.colors[this.colors.length-2]>this.glyphCount)){for(var g=this.colors[this.colors.length-1];this.colors[this.colors.length-2]>this.glyphCount;)this.colors.length-=2;this.colors[this.colors.length-2]=this.glyphCount,this.colors[this.colors.length-1]=g}}return 0===a?(this.glyphRunPool.free(t),this.runs.pop()):this.setLastGlyphXAdvance(e,t),l}}]),e}();t.GlyphLayout=l},9045:function(e,t,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphRun=void 0;var s=n((function e(){var t=this;r(this,e),this.glyphs=[],this.xAdvances=[],this.appendRun=function(e){t.glyphs.concat(e.glyphs),t.xAdvances.length||t.xAdvances.length--,t.xAdvances.concat(e.xAdvances)},this.reset=function(){t.glyphs.length=0,t.xAdvances.length=0}}));t.GlyphRun=s},6964:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.InputEvent=void 0;var s=i(8041),a=i(2283);!function(e){e.TouchStart="touchStart",e.TouchEnd="touchEnd",e.TouchMove="touchMove"}(t.InputEvent||(t.InputEvent={}));var o=function(){function e(t){var i=this;n(this,e),this.screenCoord=new a.Vector2,this.worldCoord=new a.Vector2,this.canvas=t,this.lastX=0,this.lastY=0,this.touched=!1;var r=this.emitter=new s.EventEmitter;this.mouseDownHandler=function(e){i.touched=!0,i.handleMove(e),r.emit("touchStart",i.getX(),i.getY())},this.mouseUpHandler=function(e){i.touched=!1,r.emit("touchEnd",i.getX(),i.getY())},this.mouseMoveHandler=function(e){i.handleMove(e),r.emit("touchMove",i.getX(),i.getY())},this.touchStartHandler=function(e){e.preventDefault();var t=e.touches[0];i.canvas.dispatchEvent(new MouseEvent("mousedown",{clientX:t.clientX,clientY:t.clientY}))},this.touchEndHandler=function(e){e.preventDefault(),i.canvas.dispatchEvent(new MouseEvent("mouseup"))},this.touchMoveHandler=function(e){e.preventDefault();var t=e.touches[0];i.canvas.dispatchEvent(new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY}))},this.canvas.addEventListener("mousedown",this.mouseDownHandler,!1),this.canvas.addEventListener("mouseup",this.mouseUpHandler,!1),this.canvas.addEventListener("mousemove",this.mouseMoveHandler,!1),this.canvas.addEventListener("touchstart",this.touchStartHandler,!1),this.canvas.addEventListener("touchend",this.touchEndHandler,!1),this.canvas.addEventListener("touchmove",this.touchMoveHandler,!1)}return r(e,[{key:"cleanup",value:function(){this.canvas.removeEventListener("mousedown",this.mouseDownHandler),this.canvas.removeEventListener("mouseup",this.mouseUpHandler),this.canvas.removeEventListener("mousemove",this.mouseMoveHandler),this.canvas.removeEventListener("touchstart",this.touchStartHandler),this.canvas.removeEventListener("touchend",this.touchEndHandler),this.canvas.removeEventListener("touchmove",this.touchMoveHandler)}},{key:"addEventListener",value:function(e,t){this.emitter.addListener(e,t)}},{key:"handleMove",value:function(e){var t=this.canvas.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top;this.lastX=i,this.lastY=n}},{key:"getX",value:function(){return this.lastX}},{key:"getY",value:function(){return this.lastY}},{key:"isTouched",value:function(){return this.touched}},{key:"getTouchedWorldCoord",value:function(e){return this.screenCoord.set(this.getX(),this.getY()),e.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),e}();t.InputHandler=o},6239:function(e,t,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix3=void 0;var a=i(4995),o=i(8606),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r(this,e),this.val=new Array(9),this.tmp=new Array(9),t?this.setByMatrix3(t):this.idt()}return s(e,[{key:"idt",value:function(){var t=this.val;return t[e.M00]=1,t[e.M10]=0,t[e.M20]=0,t[e.M01]=0,t[e.M11]=1,t[e.M21]=0,t[e.M02]=0,t[e.M12]=0,t[e.M22]=1,this}},{key:"mulWithMatrix3",value:function(t){var i=this.val,n=i[e.M00]*t.val[e.M00]+i[e.M01]*t.val[e.M10]+i[e.M02]*t.val[e.M20],r=i[e.M00]*t.val[e.M01]+i[e.M01]*t.val[e.M11]+i[e.M02]*t.val[e.M21],s=i[e.M00]*t.val[e.M02]+i[e.M01]*t.val[e.M12]+i[e.M02]*t.val[e.M22],a=i[e.M10]*t.val[e.M00]+i[e.M11]*t.val[e.M10]+i[e.M12]*t.val[e.M20],o=i[e.M10]*t.val[e.M01]+i[e.M11]*t.val[e.M11]+i[e.M12]*t.val[e.M21],l=i[e.M10]*t.val[e.M02]+i[e.M11]*t.val[e.M12]+i[e.M12]*t.val[e.M22],u=i[e.M20]*t.val[e.M00]+i[e.M21]*t.val[e.M10]+i[e.M22]*t.val[e.M20],h=i[e.M20]*t.val[e.M01]+i[e.M21]*t.val[e.M11]+i[e.M22]*t.val[e.M21],c=i[e.M20]*t.val[e.M02]+i[e.M21]*t.val[e.M12]+i[e.M22]*t.val[e.M22];return i[e.M00]=n,i[e.M10]=a,i[e.M20]=u,i[e.M01]=r,i[e.M11]=o,i[e.M21]=h,i[e.M02]=s,i[e.M12]=l,i[e.M22]=c,this}},{key:"mulLeft",value:function(t){var i=this.val,n=t.val[e.M00]*i[e.M00]+t.val[e.M01]*i[e.M10]+t.val[e.M02]*i[e.M20],r=t.val[e.M00]*i[e.M01]+t.val[e.M01]*i[e.M11]+t.val[e.M02]*i[e.M21],s=t.val[e.M00]*i[e.M02]+t.val[e.M01]*i[e.M12]+t.val[e.M02]*i[e.M22],a=t.val[e.M10]*i[e.M00]+t.val[e.M11]*i[e.M10]+t.val[e.M12]*i[e.M20],o=t.val[e.M10]*i[e.M01]+t.val[e.M11]*i[e.M11]+t.val[e.M12]*i[e.M21],l=t.val[e.M10]*i[e.M02]+t.val[e.M11]*i[e.M12]+t.val[e.M12]*i[e.M22],u=t.val[e.M20]*i[e.M00]+t.val[e.M21]*i[e.M10]+t.val[e.M22]*i[e.M20],h=t.val[e.M20]*i[e.M01]+t.val[e.M21]*i[e.M11]+t.val[e.M22]*i[e.M21],c=t.val[e.M20]*i[e.M02]+t.val[e.M21]*i[e.M12]+t.val[e.M22]*i[e.M22];return i[e.M00]=n,i[e.M10]=a,i[e.M20]=u,i[e.M01]=r,i[e.M11]=o,i[e.M21]=h,i[e.M02]=s,i[e.M12]=l,i[e.M22]=c,this}},{key:"setToRotation",value:function(e){return this.setToRotationRad(o.MathUtils.degreesToRadians*e)}},{key:"setToRotationRad",value:function(t){var i=Math.cos(t),n=Math.sin(t),r=this.val;return r[e.M00]=i,r[e.M10]=n,r[e.M20]=0,r[e.M01]=-n,r[e.M11]=i,r[e.M21]=0,r[e.M02]=0,r[e.M12]=0,r[e.M22]=1,this}},{key:"setToRotationWithAxis",value:function(t,i){var n=Math.cos(i),r=Math.sin(i),s=this.val,a=1-n;return s[e.M00]=a*t.x*t.x+n,s[e.M01]=a*t.x*t.y-t.z*r,s[e.M02]=a*t.z*t.x+t.y*r,s[e.M10]=a*t.x*t.y+t.z*r,s[e.M11]=a*t.y*t.y+n,s[e.M12]=a*t.y*t.z-t.x*r,s[e.M20]=a*t.z*t.x-t.y*r,s[e.M21]=a*t.y*t.z+t.x*r,s[e.M22]=a*t.z*t.z+n,this}},{key:"setToTranslation",value:function(t,i){var n=this.val;return n[e.M00]=1,n[e.M10]=0,n[e.M20]=0,n[e.M01]=0,n[e.M11]=1,n[e.M21]=0,n[e.M02]=t,n[e.M12]=i,n[e.M22]=1,this}},{key:"setToScaling",value:function(t,i){var n=this.val;return n[e.M00]=t,n[e.M10]=0,n[e.M20]=0,n[e.M01]=0,n[e.M11]=i,n[e.M21]=0,n[e.M02]=0,n[e.M12]=0,n[e.M22]=1,this}},{key:"toString",value:function(){var t=this.val;return"["+t[e.M00]+"|"+t[e.M01]+"|"+t[e.M02]+"]\n["+t[e.M10]+"|"+t[e.M11]+"|"+t[e.M12]+"]\n["+t[e.M20]+"|"+t[e.M21]+"|"+t[e.M22]+"]"}},{key:"det",value:function(){var t=this.val;return t[e.M00]*t[e.M11]*t[e.M22]+t[e.M01]*t[e.M12]*t[e.M20]+t[e.M02]*t[e.M10]*t[e.M21]-t[e.M00]*t[e.M12]*t[e.M21]-t[e.M01]*t[e.M10]*t[e.M22]-t[e.M02]*t[e.M11]*t[e.M20]}},{key:"inv",value:function(){var t=this.det();if(0===t)throw new Error("Can't invert a singular matrix");var i=1/t,n=this.tmp,r=this.val;return n[e.M00]=r[e.M11]*r[e.M22]-r[e.M21]*r[e.M12],n[e.M10]=r[e.M20]*r[e.M12]-r[e.M10]*r[e.M22],n[e.M20]=r[e.M10]*r[e.M21]-r[e.M20]*r[e.M11],n[e.M01]=r[e.M21]*r[e.M02]-r[e.M01]*r[e.M22],n[e.M11]=r[e.M00]*r[e.M22]-r[e.M20]*r[e.M02],n[e.M21]=r[e.M20]*r[e.M01]-r[e.M00]*r[e.M21],n[e.M02]=r[e.M01]*r[e.M12]-r[e.M11]*r[e.M02],n[e.M12]=r[e.M10]*r[e.M02]-r[e.M00]*r[e.M12],n[e.M22]=r[e.M00]*r[e.M11]-r[e.M10]*r[e.M01],r[e.M00]=i*n[e.M00],r[e.M10]=i*n[e.M10],r[e.M20]=i*n[e.M20],r[e.M01]=i*n[e.M01],r[e.M11]=i*n[e.M11],r[e.M21]=i*n[e.M21],r[e.M02]=i*n[e.M02],r[e.M12]=i*n[e.M12],r[e.M22]=i*n[e.M22],this}},{key:"setByMatrix3",value:function(e){var t,i=n(e.val);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.val.push(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"setByMatrix4",value:function(t){var i=this.val;return i[e.M00]=t.values[a.Matrix4.M00],i[e.M10]=t.values[a.Matrix4.M10],i[e.M20]=t.values[a.Matrix4.M20],i[e.M01]=t.values[a.Matrix4.M01],i[e.M11]=t.values[a.Matrix4.M11],i[e.M21]=t.values[a.Matrix4.M21],i[e.M02]=t.values[a.Matrix4.M02],i[e.M12]=t.values[a.Matrix4.M12],i[e.M22]=t.values[a.Matrix4.M22],this}},{key:"trnByVector2",value:function(t){var i=this.val;return i[e.M02]+=t.x,i[e.M12]+=t.y,this}},{key:"trnByMatrix3",value:function(t,i){var n=this.val;return n[e.M02]+=t,n[e.M12]+=i,this}},{key:"trnByVector3",value:function(t){var i=this.val;return i[e.M02]+=t.x,i[e.M12]+=t.y,this}},{key:"translate",value:function(t,i){var n=this.val;return this.tmp[e.M00]=1,this.tmp[e.M10]=0,this.tmp[e.M20]=0,this.tmp[e.M01]=0,this.tmp[e.M11]=1,this.tmp[e.M21]=0,this.tmp[e.M02]=t,this.tmp[e.M12]=i,this.tmp[e.M22]=1,e.mul(n,this.tmp),this}},{key:"rotate",value:function(e){return this.rotateRad(o.MathUtils.degreesToRadians*e)}},{key:"rotateRad",value:function(t){if(0===t)return this;var i=Math.cos(t),n=Math.sin(t),r=this.tmp;return r[e.M00]=i,r[e.M10]=n,r[e.M20]=0,r[e.M01]=-n,r[e.M11]=i,r[e.M21]=0,r[e.M02]=0,r[e.M12]=0,r[e.M22]=1,e.mul(this.val,r),this}},{key:"scale",value:function(t,i){var n=this.tmp;return n[e.M00]=t,n[e.M10]=0,n[e.M20]=0,n[e.M01]=0,n[e.M11]=i,n[e.M21]=0,n[e.M02]=0,n[e.M12]=0,n[e.M22]=1,e.mul(this.val,n),this}},{key:"getValues",value:function(){return this.val}},{key:"getTranslation",value:function(t){return t.x=this.val[e.M02],t.y=this.val[e.M12],t}},{key:"getScale",value:function(t){var i=this.val;return t.x=Math.sqrt(i[e.M00]*i[e.M00]+i[e.M01]*i[e.M01]),t.y=Math.sqrt(i[e.M10]*i[e.M10]+i[e.M11]*i[e.M11]),t}},{key:"getRotation",value:function(){return o.MathUtils.radiansToDegrees*Math.atan2(this.val[e.M10],this.val[e.M00])}},{key:"getRotationRad",value:function(){return Math.atan2(this.val[e.M10],this.val[e.M00])}},{key:"sclByNumber",value:function(t){return this.val[e.M00]*=t,this.val[e.M11]*=t,this}},{key:"sclByVector2",value:function(t){return this.val[e.M00]*=t.x,this.val[e.M11]*=t.y,this}},{key:"scl",value:function(t){return this.val[e.M00]*=t.x,this.val[e.M11]*=t.y,this}},{key:"transpose",value:function(){var t=this.val,i=t[e.M10],n=t[e.M20],r=t[e.M01],s=t[e.M21],a=t[e.M02],o=t[e.M12];return t[e.M01]=i,t[e.M02]=n,t[e.M10]=r,t[e.M12]=s,t[e.M20]=a,t[e.M21]=o,this}}],[{key:"mul",value:function(t,i){var n=t[e.M00]*i[e.M00]+t[e.M01]*i[e.M10]+t[e.M02]*i[e.M20],r=t[e.M00]*i[e.M01]+t[e.M01]*i[e.M11]+t[e.M02]*i[e.M21],s=t[e.M00]*i[e.M02]+t[e.M01]*i[e.M12]+t[e.M02]*i[e.M22],a=t[e.M10]*i[e.M00]+t[e.M11]*i[e.M10]+t[e.M12]*i[e.M20],o=t[e.M10]*i[e.M01]+t[e.M11]*i[e.M11]+t[e.M12]*i[e.M21],l=t[e.M10]*i[e.M02]+t[e.M11]*i[e.M12]+t[e.M12]*i[e.M22],u=t[e.M20]*i[e.M00]+t[e.M21]*i[e.M10]+t[e.M22]*i[e.M20],h=t[e.M20]*i[e.M01]+t[e.M21]*i[e.M11]+t[e.M22]*i[e.M21],c=t[e.M20]*i[e.M02]+t[e.M21]*i[e.M12]+t[e.M22]*i[e.M22];t[e.M00]=n,t[e.M10]=a,t[e.M20]=u,t[e.M01]=r,t[e.M11]=o,t[e.M21]=h,t[e.M02]=s,t[e.M12]=l,t[e.M22]=c}}]),e}();t.Matrix3=l,l.M00=0,l.M01=3,l.M02=6,l.M10=1,l.M11=4,l.M12=7,l.M20=2,l.M21=5,l.M22=8},4995:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix4=void 0;var s=i(5122),a=i(8606),o=i(7811),l=function(){function e(){n(this,e),this.temp=new Float32Array(16),this.values=new Float32Array(16);var t=this.values;t[e.M00]=1,t[e.M11]=1,t[e.M22]=1,t[e.M33]=1}return r(e,[{key:"set",value:function(e){return this.values.set(e),this}},{key:"setFromQuaternion",value:function(t){var i=2*t.x,n=2*t.y,r=2*t.z,s=t.w*i,a=t.w*n,o=t.w*r,l=t.x*i,u=t.x*n,h=t.x*r,c=t.y*n,f=t.y*r,d=t.z*r,m=this.values;return m[e.M00]=1-(c+d),m[e.M01]=u-o,m[e.M02]=h+a,m[e.M03]=0,m[e.M10]=u+o,m[e.M11]=1-(l+d),m[e.M12]=f-s,m[e.M13]=0,m[e.M20]=h-a,m[e.M21]=f+s,m[e.M22]=1-(l+c),m[e.M23]=0,m[e.M30]=0,m[e.M31]=0,m[e.M32]=0,m[e.M33]=1,this}},{key:"setFromTranslationRotation",value:function(t,i,n){var r=2*i.x,s=2*i.y,a=2*i.z,o=i.w*r,l=i.w*s,u=i.w*a,h=i.x*r,c=i.x*s,f=i.x*a,d=i.y*s,m=i.y*a,_=i.z*a,p=this.values;return p[e.M00]=n.x*(1-(d+_)),p[e.M01]=n.y*(c-u),p[e.M02]=n.z*(f+l),p[e.M03]=t.x,p[e.M10]=n.x*(c+u),p[e.M11]=n.y*(1-(h+_)),p[e.M12]=n.z*(m-o),p[e.M13]=t.y,p[e.M20]=n.x*(f-l),p[e.M21]=n.y*(m+o),p[e.M22]=n.z*(1-(h+d)),p[e.M23]=t.z,p[e.M30]=0,p[e.M31]=0,p[e.M32]=0,p[e.M33]=1,this}},{key:"transpose",value:function(){var t=this.temp,i=this.values;return t[e.M00]=i[e.M00],t[e.M01]=i[e.M10],t[e.M02]=i[e.M20],t[e.M03]=i[e.M30],t[e.M10]=i[e.M01],t[e.M11]=i[e.M11],t[e.M12]=i[e.M21],t[e.M13]=i[e.M31],t[e.M20]=i[e.M02],t[e.M21]=i[e.M12],t[e.M22]=i[e.M22],t[e.M23]=i[e.M32],t[e.M30]=i[e.M03],t[e.M31]=i[e.M13],t[e.M32]=i[e.M23],t[e.M33]=i[e.M33],this.set(t)}},{key:"identity",value:function(){var t=this.values;return t[e.M00]=1,t[e.M01]=0,t[e.M02]=0,t[e.M03]=0,t[e.M10]=0,t[e.M11]=1,t[e.M12]=0,t[e.M13]=0,t[e.M20]=0,t[e.M21]=0,t[e.M22]=1,t[e.M23]=0,t[e.M30]=0,t[e.M31]=0,t[e.M32]=0,t[e.M33]=1,this}},{key:"invert",value:function(){var t=this.values,i=this.temp,n=t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33];if(0===n)throw new Error("non-invertible matrix");var r=1/n;return i[e.M00]=t[e.M12]*t[e.M23]*t[e.M31]-t[e.M13]*t[e.M22]*t[e.M31]+t[e.M13]*t[e.M21]*t[e.M32]-t[e.M11]*t[e.M23]*t[e.M32]-t[e.M12]*t[e.M21]*t[e.M33]+t[e.M11]*t[e.M22]*t[e.M33],i[e.M01]=t[e.M03]*t[e.M22]*t[e.M31]-t[e.M02]*t[e.M23]*t[e.M31]-t[e.M03]*t[e.M21]*t[e.M32]+t[e.M01]*t[e.M23]*t[e.M32]+t[e.M02]*t[e.M21]*t[e.M33]-t[e.M01]*t[e.M22]*t[e.M33],i[e.M02]=t[e.M02]*t[e.M13]*t[e.M31]-t[e.M03]*t[e.M12]*t[e.M31]+t[e.M03]*t[e.M11]*t[e.M32]-t[e.M01]*t[e.M13]*t[e.M32]-t[e.M02]*t[e.M11]*t[e.M33]+t[e.M01]*t[e.M12]*t[e.M33],i[e.M03]=t[e.M03]*t[e.M12]*t[e.M21]-t[e.M02]*t[e.M13]*t[e.M21]-t[e.M03]*t[e.M11]*t[e.M22]+t[e.M01]*t[e.M13]*t[e.M22]+t[e.M02]*t[e.M11]*t[e.M23]-t[e.M01]*t[e.M12]*t[e.M23],i[e.M10]=t[e.M13]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M20]*t[e.M32]+t[e.M10]*t[e.M23]*t[e.M32]+t[e.M12]*t[e.M20]*t[e.M33]-t[e.M10]*t[e.M22]*t[e.M33],i[e.M11]=t[e.M02]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M22]*t[e.M30]+t[e.M03]*t[e.M20]*t[e.M32]-t[e.M00]*t[e.M23]*t[e.M32]-t[e.M02]*t[e.M20]*t[e.M33]+t[e.M00]*t[e.M22]*t[e.M33],i[e.M12]=t[e.M03]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M10]*t[e.M32]+t[e.M00]*t[e.M13]*t[e.M32]+t[e.M02]*t[e.M10]*t[e.M33]-t[e.M00]*t[e.M12]*t[e.M33],i[e.M13]=t[e.M02]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M12]*t[e.M20]+t[e.M03]*t[e.M10]*t[e.M22]-t[e.M00]*t[e.M13]*t[e.M22]-t[e.M02]*t[e.M10]*t[e.M23]+t[e.M00]*t[e.M12]*t[e.M23],i[e.M20]=t[e.M11]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M21]*t[e.M30]+t[e.M13]*t[e.M20]*t[e.M31]-t[e.M10]*t[e.M23]*t[e.M31]-t[e.M11]*t[e.M20]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M33],i[e.M21]=t[e.M03]*t[e.M21]*t[e.M30]-t[e.M01]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M20]*t[e.M31]+t[e.M00]*t[e.M23]*t[e.M31]+t[e.M01]*t[e.M20]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M33],i[e.M22]=t[e.M01]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M11]*t[e.M30]+t[e.M03]*t[e.M10]*t[e.M31]-t[e.M00]*t[e.M13]*t[e.M31]-t[e.M01]*t[e.M10]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M33],i[e.M23]=t[e.M03]*t[e.M11]*t[e.M20]-t[e.M01]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M10]*t[e.M21]+t[e.M00]*t[e.M13]*t[e.M21]+t[e.M01]*t[e.M10]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M23],i[e.M30]=t[e.M12]*t[e.M21]*t[e.M30]-t[e.M11]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M20]*t[e.M31]+t[e.M10]*t[e.M22]*t[e.M31]+t[e.M11]*t[e.M20]*t[e.M32]-t[e.M10]*t[e.M21]*t[e.M32],i[e.M31]=t[e.M01]*t[e.M22]*t[e.M30]-t[e.M02]*t[e.M21]*t[e.M30]+t[e.M02]*t[e.M20]*t[e.M31]-t[e.M00]*t[e.M22]*t[e.M31]-t[e.M01]*t[e.M20]*t[e.M32]+t[e.M00]*t[e.M21]*t[e.M32],i[e.M32]=t[e.M02]*t[e.M11]*t[e.M30]-t[e.M01]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M10]*t[e.M31]+t[e.M00]*t[e.M12]*t[e.M31]+t[e.M01]*t[e.M10]*t[e.M32]-t[e.M00]*t[e.M11]*t[e.M32],i[e.M33]=t[e.M01]*t[e.M12]*t[e.M20]-t[e.M02]*t[e.M11]*t[e.M20]+t[e.M02]*t[e.M10]*t[e.M21]-t[e.M00]*t[e.M12]*t[e.M21]-t[e.M01]*t[e.M10]*t[e.M22]+t[e.M00]*t[e.M11]*t[e.M22],t[e.M00]=i[e.M00]*r,t[e.M01]=i[e.M01]*r,t[e.M02]=i[e.M02]*r,t[e.M03]=i[e.M03]*r,t[e.M10]=i[e.M10]*r,t[e.M11]=i[e.M11]*r,t[e.M12]=i[e.M12]*r,t[e.M13]=i[e.M13]*r,t[e.M20]=i[e.M20]*r,t[e.M21]=i[e.M21]*r,t[e.M22]=i[e.M22]*r,t[e.M23]=i[e.M23]*r,t[e.M30]=i[e.M30]*r,t[e.M31]=i[e.M31]*r,t[e.M32]=i[e.M32]*r,t[e.M33]=i[e.M33]*r,this}},{key:"determinant",value:function(){var t=this.values;return t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33]}},{key:"translate",value:function(t,i,n){var r=this.values;return r[e.M03]+=t,r[e.M13]+=i,r[e.M23]+=n,this}},{key:"setTranslation",value:function(t,i,n){var r=this.values;return r[e.M03]=t,r[e.M13]=i,r[e.M23]=n,this}},{key:"getTranslation",value:function(t){var i=this.values;return t.x=i[e.M03],t.y=i[e.M13],t.z=i[e.M23],t}},{key:"hasRotationOrScaling",value:function(){var t=this.values;return!(a.MathUtils.isEqual(t[e.M00],1)&&a.MathUtils.isEqual(t[e.M11],1)&&a.MathUtils.isEqual(t[e.M22],1)&&a.MathUtils.isZero(t[e.M01])&&a.MathUtils.isZero(t[e.M02])&&a.MathUtils.isZero(t[e.M10])&&a.MathUtils.isZero(t[e.M12])&&a.MathUtils.isZero(t[e.M20])&&a.MathUtils.isZero(t[e.M21]))}},{key:"det3x3",value:function(){var t=this.values;return t[e.M00]*t[e.M11]*t[e.M22]+t[e.M01]*t[e.M12]*t[e.M20]+t[e.M02]*t[e.M10]*t[e.M21]-t[e.M00]*t[e.M12]*t[e.M21]-t[e.M01]*t[e.M10]*t[e.M22]-t[e.M02]*t[e.M11]*t[e.M20]}},{key:"copy",value:function(){return(new e).set(this.values)}},{key:"projection",value:function(t,i,n,r){this.identity();var s=1/Math.tan(n*(Math.PI/180)/2),a=(i+t)/(t-i),o=2*i*t/(t-i),l=this.values;return l[e.M00]=s/r,l[e.M10]=0,l[e.M20]=0,l[e.M30]=0,l[e.M01]=0,l[e.M11]=s,l[e.M21]=0,l[e.M31]=0,l[e.M02]=0,l[e.M12]=0,l[e.M22]=a,l[e.M32]=-1,l[e.M03]=0,l[e.M13]=0,l[e.M23]=o,l[e.M33]=0,this}},{key:"ortho2d",value:function(e,t,i,n){return this.ortho(e,e+i,t,t+n,0,1)}},{key:"ortho",value:function(t,i,n,r,s,a){this.identity();var o=2/(i-t),l=2/(r-n),u=-2/(a-s),h=-(i+t)/(i-t),c=-(r+n)/(r-n),f=-(a+s)/(a-s),d=this.values;return d[e.M00]=o,d[e.M10]=0,d[e.M20]=0,d[e.M30]=0,d[e.M01]=0,d[e.M11]=l,d[e.M21]=0,d[e.M31]=0,d[e.M02]=0,d[e.M12]=0,d[e.M22]=u,d[e.M32]=0,d[e.M03]=h,d[e.M13]=c,d[e.M23]=f,d[e.M33]=1,this}},{key:"multiply",value:function(t){var i=this.temp,n=this.values,r=t.values;return i[e.M00]=n[e.M00]*r[e.M00]+n[e.M01]*r[e.M10]+n[e.M02]*r[e.M20]+n[e.M03]*r[e.M30],i[e.M01]=n[e.M00]*r[e.M01]+n[e.M01]*r[e.M11]+n[e.M02]*r[e.M21]+n[e.M03]*r[e.M31],i[e.M02]=n[e.M00]*r[e.M02]+n[e.M01]*r[e.M12]+n[e.M02]*r[e.M22]+n[e.M03]*r[e.M32],i[e.M03]=n[e.M00]*r[e.M03]+n[e.M01]*r[e.M13]+n[e.M02]*r[e.M23]+n[e.M03]*r[e.M33],i[e.M10]=n[e.M10]*r[e.M00]+n[e.M11]*r[e.M10]+n[e.M12]*r[e.M20]+n[e.M13]*r[e.M30],i[e.M11]=n[e.M10]*r[e.M01]+n[e.M11]*r[e.M11]+n[e.M12]*r[e.M21]+n[e.M13]*r[e.M31],i[e.M12]=n[e.M10]*r[e.M02]+n[e.M11]*r[e.M12]+n[e.M12]*r[e.M22]+n[e.M13]*r[e.M32],i[e.M13]=n[e.M10]*r[e.M03]+n[e.M11]*r[e.M13]+n[e.M12]*r[e.M23]+n[e.M13]*r[e.M33],i[e.M20]=n[e.M20]*r[e.M00]+n[e.M21]*r[e.M10]+n[e.M22]*r[e.M20]+n[e.M23]*r[e.M30],i[e.M21]=n[e.M20]*r[e.M01]+n[e.M21]*r[e.M11]+n[e.M22]*r[e.M21]+n[e.M23]*r[e.M31],i[e.M22]=n[e.M20]*r[e.M02]+n[e.M21]*r[e.M12]+n[e.M22]*r[e.M22]+n[e.M23]*r[e.M32],i[e.M23]=n[e.M20]*r[e.M03]+n[e.M21]*r[e.M13]+n[e.M22]*r[e.M23]+n[e.M23]*r[e.M33],i[e.M30]=n[e.M30]*r[e.M00]+n[e.M31]*r[e.M10]+n[e.M32]*r[e.M20]+n[e.M33]*r[e.M30],i[e.M31]=n[e.M30]*r[e.M01]+n[e.M31]*r[e.M11]+n[e.M32]*r[e.M21]+n[e.M33]*r[e.M31],i[e.M32]=n[e.M30]*r[e.M02]+n[e.M31]*r[e.M12]+n[e.M32]*r[e.M22]+n[e.M33]*r[e.M32],i[e.M33]=n[e.M30]*r[e.M03]+n[e.M31]*r[e.M13]+n[e.M32]*r[e.M23]+n[e.M33]*r[e.M33],this.set(this.temp)}},{key:"multiplyLeft",value:function(t){var i=this.temp,n=this.values,r=t.values;return i[e.M00]=r[e.M00]*n[e.M00]+r[e.M01]*n[e.M10]+r[e.M02]*n[e.M20]+r[e.M03]*n[e.M30],i[e.M01]=r[e.M00]*n[e.M01]+r[e.M01]*n[e.M11]+r[e.M02]*n[e.M21]+r[e.M03]*n[e.M31],i[e.M02]=r[e.M00]*n[e.M02]+r[e.M01]*n[e.M12]+r[e.M02]*n[e.M22]+r[e.M03]*n[e.M32],i[e.M03]=r[e.M00]*n[e.M03]+r[e.M01]*n[e.M13]+r[e.M02]*n[e.M23]+r[e.M03]*n[e.M33],i[e.M10]=r[e.M10]*n[e.M00]+r[e.M11]*n[e.M10]+r[e.M12]*n[e.M20]+r[e.M13]*n[e.M30],i[e.M11]=r[e.M10]*n[e.M01]+r[e.M11]*n[e.M11]+r[e.M12]*n[e.M21]+r[e.M13]*n[e.M31],i[e.M12]=r[e.M10]*n[e.M02]+r[e.M11]*n[e.M12]+r[e.M12]*n[e.M22]+r[e.M13]*n[e.M32],i[e.M13]=r[e.M10]*n[e.M03]+r[e.M11]*n[e.M13]+r[e.M12]*n[e.M23]+r[e.M13]*n[e.M33],i[e.M20]=r[e.M20]*n[e.M00]+r[e.M21]*n[e.M10]+r[e.M22]*n[e.M20]+r[e.M23]*n[e.M30],i[e.M21]=r[e.M20]*n[e.M01]+r[e.M21]*n[e.M11]+r[e.M22]*n[e.M21]+r[e.M23]*n[e.M31],i[e.M22]=r[e.M20]*n[e.M02]+r[e.M21]*n[e.M12]+r[e.M22]*n[e.M22]+r[e.M23]*n[e.M32],i[e.M23]=r[e.M20]*n[e.M03]+r[e.M21]*n[e.M13]+r[e.M22]*n[e.M23]+r[e.M23]*n[e.M33],i[e.M30]=r[e.M30]*n[e.M00]+r[e.M31]*n[e.M10]+r[e.M32]*n[e.M20]+r[e.M33]*n[e.M30],i[e.M31]=r[e.M30]*n[e.M01]+r[e.M31]*n[e.M11]+r[e.M32]*n[e.M21]+r[e.M33]*n[e.M31],i[e.M32]=r[e.M30]*n[e.M02]+r[e.M31]*n[e.M12]+r[e.M32]*n[e.M22]+r[e.M33]*n[e.M32],i[e.M33]=r[e.M30]*n[e.M03]+r[e.M31]*n[e.M13]+r[e.M32]*n[e.M23]+r[e.M33]*n[e.M33],this.set(this.temp)}},{key:"idt",value:function(){var t=this.values;return t[e.M00]=1,t[e.M01]=0,t[e.M02]=0,t[e.M03]=0,t[e.M10]=0,t[e.M11]=1,t[e.M12]=0,t[e.M13]=0,t[e.M20]=0,t[e.M21]=0,t[e.M22]=1,t[e.M23]=0,t[e.M30]=0,t[e.M31]=0,t[e.M32]=0,t[e.M33]=1,this}},{key:"lookAt",value:function(t,i,n){e.initTemps();var r=e.xAxis,s=e.yAxis,a=e.zAxis;a.setFrom(i).normalize(),r.setFrom(i).normalize(),r.cross(n).normalize(),s.setFrom(r).cross(a).normalize(),this.identity();var o=this.values;return o[e.M00]=r.x,o[e.M01]=r.y,o[e.M02]=r.z,o[e.M10]=s.x,o[e.M11]=s.y,o[e.M12]=s.z,o[e.M20]=-a.x,o[e.M21]=-a.y,o[e.M22]=-a.z,e.tmpMatrix.identity(),e.tmpMatrix.values[e.M03]=-t.x,e.tmpMatrix.values[e.M13]=-t.y,e.tmpMatrix.values[e.M23]=-t.z,this.multiply(e.tmpMatrix),this}},{key:"setToLookAt",value:function(t,i,n){return null===e.tempVec&&(e.tempVec=new o.Vector3),e.tempVec.setFrom(i).sub(t),this.lookAt(t,e.tempVec,n),this}},{key:"rotate",value:function(t){var i=t.x,n=t.y,r=t.z,s=t.w,a=i*i,o=i*n,l=i*r,u=i*s,h=n*n,c=n*r,f=n*s,d=r*r,m=r*s,_=1-2*(h+d),p=2*(o-m),v=2*(l+f),y=2*(o+m),g=1-2*(a+d),x=2*(c-u),b=2*(l-f),w=2*(c+u),A=1-2*(a+h),S=this.values,M=S[e.M00]*_+S[e.M01]*y+S[e.M02]*b,C=S[e.M00]*p+S[e.M01]*g+S[e.M02]*w,k=S[e.M00]*v+S[e.M01]*x+S[e.M02]*A,B=S[e.M10]*_+S[e.M11]*y+S[e.M12]*b,V=S[e.M10]*p+S[e.M11]*g+S[e.M12]*w,T=S[e.M10]*v+S[e.M11]*x+S[e.M12]*A,P=S[e.M20]*_+S[e.M21]*y+S[e.M22]*b,L=S[e.M20]*p+S[e.M21]*g+S[e.M22]*w,E=S[e.M20]*v+S[e.M21]*x+S[e.M22]*A,I=S[e.M30]*_+S[e.M31]*y+S[e.M32]*b,R=S[e.M30]*p+S[e.M31]*g+S[e.M32]*w,F=S[e.M30]*v+S[e.M31]*x+S[e.M32]*A;return S[e.M00]=M,S[e.M10]=B,S[e.M20]=P,S[e.M30]=I,S[e.M01]=C,S[e.M11]=V,S[e.M21]=L,S[e.M31]=R,S[e.M02]=k,S[e.M12]=T,S[e.M22]=E,S[e.M32]=F,this}},{key:"scale",value:function(t,i,n){var r=this.values;return r[e.M00]*=t,r[e.M01]*=i,r[e.M02]*=n,r[e.M10]*=t,r[e.M11]*=i,r[e.M12]*=n,r[e.M20]*=t,r[e.M21]*=i,r[e.M22]*=n,r[e.M30]*=t,r[e.M31]*=i,r[e.M32]*=n,this}},{key:"setToRotation",value:function(t,i){return 0===i?(this.idt(),this):this.setFromQuaternion(e.quat.setFromAxis(t.x,t.y,t.z,i))}}],[{key:"initTemps",value:function(){null===e.xAxis&&(e.xAxis=new o.Vector3),null===e.yAxis&&(e.yAxis=new o.Vector3),null===e.zAxis&&(e.zAxis=new o.Vector3)}},{key:"matrix4_proj",value:function(t,i){var n=1/(i[0]*t[e.M30]+i[1]*t[e.M31]+i[2]*t[e.M32]+t[e.M33]),r=(i[0]*t[e.M00]+i[1]*t[e.M01]+i[2]*t[e.M02]+t[e.M03])*n,s=(i[0]*t[e.M10]+i[1]*t[e.M11]+i[2]*t[e.M12]+t[e.M13])*n,a=(i[0]*t[e.M20]+i[1]*t[e.M21]+i[2]*t[e.M22]+t[e.M23])*n;i[0]=r,i[1]=s,i[2]=a}},{key:"prj",value:function(t,i,n,r,s){for(var a=e.tmpArrayForVec,o=0;o<r;o++){var l=n+o*s,u=0;a[u]=i[l+u++],a[u]=i[l+u++],a[u]=i[l+u++],u=0,e.matrix4_proj(t.values,a),i[o*s+u]=a[u++],i[o*s+u]=a[u++],i[o*s+u]=a[u++]}}}]),e}();t.Matrix4=l,l.M00=0,l.M01=4,l.M02=8,l.M03=12,l.M10=1,l.M11=5,l.M12=9,l.M13=13,l.M20=2,l.M21=6,l.M22=10,l.M23=14,l.M30=3,l.M31=7,l.M32=11,l.M33=15,l.xAxis=null,l.yAxis=null,l.zAxis=null,l.tempVec=null,l.tmpMatrix=new l,l.quat=new s.Quaternion,l.tmpArrayForVec=[]},1514:function(e,t,i){"use strict";var n=i(1655).default,r=i(6389).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Color2Attribute=t.ColorAttribute=t.TexCoordAttribute=t.Position3Attribute=t.Position2Attribute=t.VertexAttribute=t.VertexAttributeType=t.Mesh=void 0;var o,l=i(1858),u=function(){function e(t,i,n,r){s(this,e),this.attributes=i,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=t,this.elementsPerVertex=0;for(var a=0;a<i.length;a++)this.elementsPerVertex+=i[a].numElements;this.vertices=new Float32Array(n*this.elementsPerVertex),this.indices=new Uint16Array(r)}return a(e,[{key:"getAttributes",value:function(){return this.attributes}},{key:"maxVertices",value:function(){return this.vertices.length/this.elementsPerVertex}},{key:"numVertices",value:function(){return this.verticesLength/this.elementsPerVertex}},{key:"setVerticesLength",value:function(e){this.dirtyVertices=!0,this.verticesLength=e}},{key:"getVertices",value:function(){return this.vertices}},{key:"maxIndices",value:function(){return this.indices.length}},{key:"numIndices",value:function(){return this.indicesLength}},{key:"setIndicesLength",value:function(e){this.dirtyIndices=!0,this.indicesLength=e}},{key:"getIndices",value:function(){return this.indices}},{key:"getVertexSizeInFloats",value:function(){for(var e=0,t=0;t<this.attributes.length;t++){e+=this.attributes[t].numElements}return e}},{key:"setVertices",value:function(e){if(this.dirtyVertices=!0,e.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(e,0),this.verticesLength=e.length}},{key:"setIndices",value:function(e){if(this.dirtyIndices=!0,e.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(e,0),this.indicesLength=e.length}},{key:"draw",value:function(e,t){this.drawWithOffset(e,t,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}},{key:"drawWithOffset",value:function(e,t,i,n){var r=this.context;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(e),this.indicesLength>0?r.drawElements(t,n,r.UNSIGNED_SHORT,2*i):r.drawArrays(t,i,n),this.unbind(e)}},{key:"bind",value:function(e){var t=this.context;t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer);for(var i=0,n=0;n<this.attributes.length;n++){var r=this.attributes[n],s=e.getAttributeLocation(r.name);t.enableVertexAttribArray(s),t.vertexAttribPointer(s,r.numElements,t.FLOAT,!1,4*this.elementsPerVertex,4*i),i+=r.numElements}this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}},{key:"unbind",value:function(e){for(var t=this.context,i=0;i<this.attributes.length;i++){var n=this.attributes[i],r=e.getAttributeLocation(n.name);t.disableVertexAttribArray(r)}t.bindBuffer(t.ARRAY_BUFFER,null),this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},{key:"update",value:function(){var e=this.context;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),e.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),e.DYNAMIC_DRAW),this.dirtyIndices=!1)}},{key:"restore",value:function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}},{key:"dispose",value:function(){var e=this.context;e.deleteBuffer(this.verticesBuffer),e.deleteBuffer(this.indicesBuffer)}}]),e}();t.Mesh=u,function(e){e[e.Float=0]="Float"}(o=t.VertexAttributeType||(t.VertexAttributeType={}));var h=a((function e(t,i,n){s(this,e),this.name=t,this.type=i,this.numElements=n}));t.VertexAttribute=h;var c=function(e){n(i,e);var t=r(i);function i(){return s(this,i),t.call(this,l.Shader.POSITION,o.Float,2)}return a(i)}(h);t.Position2Attribute=c;var f=function(e){n(i,e);var t=r(i);function i(){return s(this,i),t.call(this,l.Shader.POSITION,o.Float,3)}return a(i)}(h);t.Position3Attribute=f;var d=function(e){n(i,e);var t=r(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return s(this,i),t.call(this,l.Shader.TEXCOORDS+(0===e?"":e),o.Float,2)}return a(i)}(h);t.TexCoordAttribute=d;var m=function(e){n(i,e);var t=r(i);function i(){return s(this,i),t.call(this,l.Shader.COLOR,o.Float,4)}return a(i)}(h);t.ColorAttribute=m;var _=function(e){n(i,e);var t=r(i);function i(){return s(this,i),t.call(this,l.Shader.COLOR2,o.Float,4)}return a(i)}(h);t.Color2Attribute=_},9699:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.NumberUtil=void 0;var s=new Int8Array(4),a=new Int32Array(s.buffer,0,1),o=new Float32Array(s.buffer,0,1),l=function(){function e(){n(this,e)}return r(e,null,[{key:"intBitsToFloat",value:function(e){return a[0]=e,o[0]}},{key:"floatToIntBits",value:function(e){return o[0]=e,a[0]}},{key:"intToFloatColor",value:function(t){return e.intBitsToFloat(4278190079&t)}},{key:"colorToFloat",value:function(t,i,n,r){var s=t<<24|i<<16|n<<8|r;return e.intToFloatColor(s)}},{key:"isPowerOfTwo",value:function(e){return 0===(e&e-1)}},{key:"nextPowerOfTwo",value:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1}}]),e}();t.NumberUtil=l},1251:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.PolygonBatch=void 0;var s=i(8606),a=i(1514),o=i(1858),l=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],u=new s.Color(1,1,1,1),h=function(){function e(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10920;if(n(this,e),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,this.projectionValues=new Float32Array(16),this.color=u,this.twoColorTint=!0,this.yDown=!1,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);this.context=t;var s=i?[new a.Position2Attribute,new a.ColorAttribute,new a.TexCoordAttribute,new a.Color2Attribute]:[new a.Position2Attribute,new a.ColorAttribute,new a.TexCoordAttribute];this.mesh=new a.Mesh(t,s,r,3*r),this.shader=o.Shader.newTwoColoredTextured(t);var l=this.context;this.srcColorBlend=l.SRC_ALPHA,this.srcAlphaBlend=l.ONE,this.dstBlend=l.ONE_MINUS_SRC_ALPHA,this.twoColorTint=i}return r(e,[{key:"setColor",value:function(e){this.color=e}},{key:"setShader",value:function(e){this.shader.dispose(),this.shader=e}},{key:"setProjection",value:function(e){this.projectionValues=e}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0;var e=this.shader;this.lastTexture=null,this.isDrawing=!0,e.bind(),e.setUniform4x4f(o.Shader.MVP_MATRIX,this.projectionValues),e.setUniformi("u_texture",0);var t=this.context;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(e,t,i){this.srcColorBlend===e&&this.srcAlphaBlend===t&&this.dstBlend===i||(this.srcColorBlend=e,this.srcAlphaBlend=t,this.dstBlend=i,this.isDrawing&&(this.flush(),this.context.blendFuncSeparate(e,i,t,i)))}},{key:"drawVerticesWithOffset",value:function(t,i,n,r){for(var s=[],a=0;a<r;a++)s[a]=i[a+n];this.drawVertices(t,s,e.QUAD_TRIANGLES)}},{key:"drawVertices",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.QUAD_TRIANGLES;t!==this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+i.length>this.mesh.getVertices().length||this.indicesLength+n.length>this.mesh.getIndices().length)&&this.flush();var r=this.mesh.numVertices();this.mesh.getVertices().set(i,this.verticesLength),this.verticesLength+=i.length,this.mesh.setVerticesLength(this.verticesLength);for(var s=this.mesh.getIndices(),a=this.indicesLength,o=0;o<n.length;a++,o++)s[a]=n[o]+r;this.indicesLength+=n.length,this.mesh.setIndicesLength(this.indicesLength)}},{key:"flush",value:function(){0!==this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader.unbind(),this.lastTexture=null,this.isDrawing=!1,e.totalDrawCalls+=this.drawCalls;var t=this.context;t.disable(t.BLEND)}},{key:"getDrawCalls",value:function(){return this.drawCalls}},{key:"dispose",value:function(){this.mesh.dispose()}},{key:"setYDown",value:function(e){this.yDown=e}},{key:"draw",value:function(t,i,n,r,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1,m=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,_=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]&&arguments[14],v=this.color;if(this.yDown){var y=d;d=_,_=y}i=i||0,n=n||0;var g=-a,x=(r=0===r?r:r||t.width)-a,b=r-a,w=-a,A=-o,S=-o,M=(s=0===s?s:s||t.height)-o,C=s-o;if(1!==h&&(g*=h,x*=h,b*=h,w*=h),1!==c&&(A*=c,S*=c,M*=c,C*=c),0!==u){var k=Math.cos(u),B=Math.sin(u),V=k*g-B*A,T=B*g+k*A,P=k*x-B*S,L=B*x+k*S,E=k*b-B*M,I=B*b+k*M,R=k*w-B*C,F=B*w+k*C;g=V,x=P,b=E,w=R,A=T,S=L,M=I,C=F}g+=i+a,x+=i+a,b+=i+a,w+=i+a,A+=n+o,S+=n+o,M+=n+o,C+=n+o;var G=f,D=d,O=m,N=_,z=O,U=D,j=G,W=N;p&&(this.yDown?(G=f,D=_,O=m,N=d,z=f,U=d,j=m,W=_):(G=m,D=d,O=f,N=_,z=m,U=_,j=f,W=d));var q=0;l[q++]=g,l[q++]=A,l[q++]=v.r,l[q++]=v.g,l[q++]=v.b,l[q++]=v.a,l[q++]=G,l[q++]=D,this.twoColorTint&&(l[q++]=0,l[q++]=0,l[q++]=0,l[q++]=0),l[q++]=x,l[q++]=S,l[q++]=v.r,l[q++]=v.g,l[q++]=v.b,l[q++]=v.a,l[q++]=z,l[q++]=U,this.twoColorTint&&(l[q++]=0,l[q++]=0,l[q++]=0,l[q++]=0),l[q++]=b,l[q++]=M,l[q++]=v.r,l[q++]=v.g,l[q++]=v.b,l[q++]=v.a,l[q++]=O,l[q++]=N,this.twoColorTint&&(l[q++]=0,l[q++]=0,l[q++]=0,l[q++]=0),l[q++]=w,l[q++]=C,l[q++]=v.r,l[q++]=v.g,l[q++]=v.b,l[q++]=v.a,l[q++]=j,l[q++]=W,this.twoColorTint&&(l[q++]=0,l[q++]=0,l[q++]=0,l[q]=0),this.drawVertices(t,l,e.QUAD_TRIANGLES)}}],[{key:"resetTotalDrawCalls",value:function(){e.totalDrawCalls=0}}]),e}();t.PolygonBatch=h,h.QUAD_TRIANGLES=[0,1,2,2,3,0],h.totalDrawCalls=0},5122:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Quaternion=void 0;var s=i(4995),a=i(8606),o=i(7811),l=i(6239),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n(this,e),this.set(t,i,r,s)}return r(e,[{key:"set",value:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}},{key:"setFrom",value:function(e){return this.set(e.x,e.y,e.z,e.w)}},{key:"len",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"toString",value:function(){return"["+this.x+"|"+this.y+"|"+this.z+"|"+this.w+"]"}},{key:"setEulerAngles",value:function(e,t,i){return this.setEulerAnglesRad(e*a.MathUtils.degreesToRadians,t*a.MathUtils.degreesToRadians,i*a.MathUtils.degreesToRadians)}},{key:"setEulerAnglesRad",value:function(e,t,i){var n=.5*i,r=Math.sin(n),s=Math.cos(n),a=.5*t,o=Math.sin(a),l=Math.cos(a),u=.5*e,h=Math.sin(u),c=Math.cos(u),f=c*o,d=h*l,m=c*l,_=h*o;return this.x=f*s+d*r,this.y=d*s-f*r,this.z=m*r-_*s,this.w=m*s+_*r,this}},{key:"getGimbalPole",value:function(){var e=this.y*this.x+this.z*this.w;return e>.499?1:e<-.499?-1:0}},{key:"getRollRad",value:function(){var e=this.getGimbalPole();return 0===e?Math.atan2(2*(this.w*this.z+this.y*this.x),1-2*(this.x*this.x+this.z*this.z)):2*e*Math.atan2(this.y,this.w)}},{key:"getRoll",value:function(){return this.getRollRad()*a.MathUtils.radiansToDegrees}},{key:"getPitchRad",value:function(){var e=this.getGimbalPole();return 0===e?Math.asin(a.MathUtils.clamp(2*(this.w*this.x-this.z*this.y),-1,1)):e*a.MathUtils.PI*.5}},{key:"getPitch",value:function(){return this.getPitchRad()*a.MathUtils.radiansToDegrees}},{key:"getYawRad",value:function(){return 0===this.getGimbalPole()?Math.atan2(2*(this.y*this.w+this.x*this.z),1-2*(this.y*this.y+this.x*this.x)):0}},{key:"getYaw",value:function(){return this.getYawRad()*a.MathUtils.radiansToDegrees}},{key:"len2",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"nor",value:function(){var e=this.len2();return 0===e||a.MathUtils.isEqual(e,1)||(e=Math.sqrt(e),this.w/=e,this.x/=e,this.y/=e,this.z/=e),this}},{key:"conjugate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"transform",value:function(t){e.tmp2.set(this.x,this.y,this.z,this.w),e.tmp2.conjugate();var i=e.tmp1.set(t.x,t.y,t.z,0);return e.tmp2.mulLeft(i.x,i.y,i.z,i.w).mulLeft(this.x,this.y,this.z,this.w),t.x=e.tmp2.x,t.y=e.tmp2.y,t.z=e.tmp2.z,t}},{key:"mul",value:function(e,t,i,n){var r=this.w*e+this.x*n+this.y*i-this.z*t,s=this.w*t+this.y*n+this.z*e-this.x*i,a=this.w*i+this.z*n+this.x*t-this.y*e,o=this.w*n-this.x*e-this.y*t-this.z*i;return this.x=r,this.y=s,this.z=a,this.w=o,this}},{key:"mulLeft",value:function(e,t,i,n){var r=n*this.x+e*this.w+t*this.z-i*this.y,s=n*this.y+t*this.w+i*this.x-e*this.z,a=n*this.z+i*this.w+e*this.y-t*this.x,o=n*this.w-e*this.x-t*this.y-i*this.z;return this.x=r,this.y=s,this.z=a,this.w=o,this}},{key:"add",value:function(e,t,i,n){return this.x+=e,this.y+=t,this.z+=i,this.w+=n,this}},{key:"toMatrix",value:function(e){var t=this.x*this.x,i=this.x*this.y,n=this.x*this.z,r=this.x*this.w,a=this.y*this.y,o=this.y*this.z,l=this.y*this.w,u=this.z*this.z,h=this.z*this.w;e[s.Matrix4.M00]=1-2*(a+u),e[s.Matrix4.M01]=2*(i-h),e[s.Matrix4.M02]=2*(n+l),e[s.Matrix4.M03]=0,e[s.Matrix4.M10]=2*(i+h),e[s.Matrix4.M11]=1-2*(t+u),e[s.Matrix4.M12]=2*(o-r),e[s.Matrix4.M13]=0,e[s.Matrix4.M20]=2*(n-l),e[s.Matrix4.M21]=2*(o+r),e[s.Matrix4.M22]=1-2*(t+a),e[s.Matrix4.M23]=0,e[s.Matrix4.M30]=0,e[s.Matrix4.M31]=0,e[s.Matrix4.M32]=0,e[s.Matrix4.M33]=1}},{key:"idt",value:function(){return this.set(0,0,0,1)}},{key:"isIdentity",value:function(){return a.MathUtils.isZero(this.x)&&a.MathUtils.isZero(this.y)&&a.MathUtils.isZero(this.z)&&a.MathUtils.isEqual(this.w,1)}},{key:"setFromAxis",value:function(e,t,i,n){return this.setFromAxisRad(e,t,i,n*a.MathUtils.degreesToRadians)}},{key:"setFromAxisRad",value:function(e,t,i,n){var r=new o.Vector3(e,t,i).length();if(0===r)return this.idt();r=1/r;var s=n<0?a.MathUtils.PI2- -n%a.MathUtils.PI2:n%a.MathUtils.PI2,l=Math.sin(s/2),u=Math.cos(s/2);return this.set(r*e*l,r*t*l,r*i*l,u).nor()}},{key:"setFromMatrix4",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.setFromAxes(e.values[s.Matrix4.M00],e.values[s.Matrix4.M01],e.values[s.Matrix4.M02],e.values[s.Matrix4.M10],e.values[s.Matrix4.M11],e.values[s.Matrix4.M12],e.values[s.Matrix4.M20],e.values[s.Matrix4.M21],e.values[s.Matrix4.M22],t)}},{key:"setFromMatrix3",value:function(e,t){return this.setFromAxes(e.val[l.Matrix3.M00],e.val[l.Matrix3.M01],e.val[l.Matrix3.M02],e.val[l.Matrix3.M10],e.val[l.Matrix3.M11],e.val[l.Matrix3.M12],e.val[l.Matrix3.M20],e.val[l.Matrix3.M21],e.val[l.Matrix3.M22],t)}},{key:"setFromAxes",value:function(e,t,i,n,r,s,a,l,u){var h=arguments.length>9&&void 0!==arguments[9]&&arguments[9];if(h){var c=1/new o.Vector3(e,t,i).length(),f=1/new o.Vector3(n,r,s).length(),d=1/new o.Vector3(a,l,u).length();e*=c,t*=c,i*=c,n*=f,r*=f,s*=f,a*=d,l*=d,u*=d}var m=e+r+u;if(m>=0){var _=Math.sqrt(m+1);this.w=.5*_,_=.5/_,this.x=(l-s)*_,this.y=(i-a)*_,this.z=(n-t)*_}else if(e>r&&e>u){var p=Math.sqrt(1+e-r-u);this.x=.5*p,p=.5/p,this.y=(n+t)*p,this.z=(i+a)*p,this.w=(l-s)*p}else if(r>u){var v=Math.sqrt(1+r-e-u);this.y=.5*v,v=.5/v,this.x=(n+t)*v,this.z=(l+s)*v,this.w=(i-a)*v}else{var y=Math.sqrt(1+u-e-r);this.z=.5*y,y=.5/y,this.x=(i+a)*y,this.y=(l+s)*y,this.w=(n-t)*y}return this}},{key:"setFromCross",value:function(e,t){var i=a.MathUtils.clamp(e.dot(t),-1,1),n=Math.acos(i);return this.setFromAxisRad(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x,n)}},{key:"slerp",value:function(e,t){var i=this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w,n=i<0?-i:i,r=1-t,s=t;if(1-n>.1){var a=Math.acos(n),o=1/Math.sin(a);r=Math.sin((1-t)*a)*o,s=Math.sin(t*a)*o}return i<0&&(s=-s),this.x=r*this.x+s*e.x,this.y=r*this.y+s*e.y,this.z=r*this.z+s*e.z,this.w=r*this.w+s*e.w,this}},{key:"slerpWithQuaternions",value:function(t){var i=1/t.length;this.set(t[0].x,t[0].y,t[0].z,t[0].w).exp(i);for(var n=1;n<t.length;n++){var r=e.tmp1.set(t[n].x,t[n].y,t[n].z,t[n].w).exp(i);this.mul(r.x,r.y,r.z,r.w)}return this.nor(),this}},{key:"exp",value:function(e){var t=this.len(),i=Math.pow(t,e),n=Math.acos(this.w/t),r=0;return r=Math.abs(n)<.001?i*e/t:i*Math.sin(e*n)/(t*Math.sin(n)),this.w=i*Math.cos(e*n),this.x*=r,this.y*=r,this.z*=r,this.nor(),this}},{key:"dot",value:function(e,t,i,n){return this.x*e+this.y*t+this.z*i+this.w*n}},{key:"mulByScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"getAxisAngle",value:function(e){return this.getAxisAngleRad(e.x,e.y,e.z)*a.MathUtils.radiansToDegrees}},{key:"getAxisAngleRad",value:function(e,t,i){this.w>1&&this.nor();var n=2*Math.acos(this.w),r=Math.sqrt(1-this.w*this.w);return r<a.MathUtils.FLOAT_ROUNDING_ERROR?(this.x,this.y,this.z):(this.x/r,this.y/r,this.z/r),n}},{key:"getAngleRad",value:function(){return 2*Math.acos(this.w>1?this.w/this.len():this.w)}},{key:"getAngle",value:function(){return this.getAngleRad()*a.MathUtils.radiansToDegrees}}],[{key:"len",value:function(e,t,i,n){return Math.sqrt(e*e+t*t+i*i+n*n)}},{key:"len2",value:function(e,t,i,n){return e*e+t*t+i*i+n*n}},{key:"dot",value:function(e,t,i,n,r,s,a,o){return e*r+t*s+i*a+n*o}}]),e}();t.Quaternion=u,u.tmp1=new u(0,0,0,0),u.tmp2=new u(0,0,0,0)},1858:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Shader=void 0;var s=function(){function e(t,i,r){n(this,e),this.vertexShader=i,this.fragmentShader=r,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=i,this.fsSource=r,this.context=t,this.compile()}return r(e,[{key:"getProgram",value:function(){return this.program}},{key:"getVertexShader",value:function(){return this.vertexShader}},{key:"getFragmentShader",value:function(){return this.fragmentShader}},{key:"getVertexShaderSource",value:function(){return this.vsSource}},{key:"getFragmentSource",value:function(){return this.fsSource}},{key:"compile",value:function(){var e=this.context;try{this.vs=this.compileShader(e.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(e.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw this.dispose(),t}}},{key:"compileShader",value:function(e,t){var i=this.context,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS)){var r="Couldn't compile shader: "+i.getShaderInfoLog(n);if(i.deleteShader(n),!i.isContextLost())throw new Error(r)}return n}},{key:"compileProgram",value:function(e,t){var i=this.context,n=i.createProgram();if(i.attachShader(n,e),i.attachShader(n,t),i.linkProgram(n),!i.getProgramParameter(n,i.LINK_STATUS)){var r="Couldn't compile shader program: "+i.getProgramInfoLog(n);if(i.deleteProgram(n),!i.isContextLost())throw new Error(r)}return n}},{key:"restore",value:function(){this.compile()}},{key:"bind",value:function(){this.context.useProgram(this.program)}},{key:"unbind",value:function(){this.context.useProgram(null)}},{key:"setUniformi",value:function(e,t){this.context.uniform1i(this.getUniformLocation(e),t)}},{key:"setUniformf",value:function(e,t){this.context.uniform1f(this.getUniformLocation(e),t)}},{key:"setUniform2f",value:function(e,t,i){this.context.uniform2f(this.getUniformLocation(e),t,i)}},{key:"setUniform3f",value:function(e,t,i,n){this.context.uniform3f(this.getUniformLocation(e),t,i,n)}},{key:"setUniform1fWithLocation",value:function(e,t){this.context.uniform1f(e,t)}},{key:"setUniform3fWithLocation",value:function(e,t,i,n){this.context.uniform3f(e,t,i,n)}},{key:"setUniform4f",value:function(e,t,i,n,r){this.context.uniform4f(this.getUniformLocation(e),t,i,n,r)}},{key:"setUniform2x2f",value:function(e,t){this.tmp2x2.set(t),this.context.uniformMatrix2fv(this.getUniformLocation(e),!1,this.tmp2x2)}},{key:"setUniform3x3f",value:function(e,t){this.tmp3x3.set(t),this.context.uniformMatrix3fv(this.getUniformLocation(e),!1,this.tmp3x3)}},{key:"setUniform4x4f",value:function(e,t){this.tmp4x4.set(t),this.context.uniformMatrix4fv(this.getUniformLocation(e),!1,this.tmp4x4)}},{key:"setUniform4x4fWithLocation",value:function(e,t){this.context.uniformMatrix4fv(e,!1,t)}},{key:"setUniform3fv",value:function(e,t){this.context.uniform3fv(this.getUniformLocation(e),t)}},{key:"getUniformLocation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.context.getUniformLocation(this.program,e);if(t&&!i&&!this.context.isContextLost())throw new Error("Couldn't find location for uniform ".concat(e));return i}},{key:"getAttributeLocation",value:function(e){return this.context.getAttribLocation(this.program,e)}},{key:"dispose",value:function(){this.vs&&(this.context.deleteShader(this.vs),this.vs=null),this.fs&&(this.context.deleteShader(this.fs),this.fs=null),this.program&&(this.context.deleteProgram(this.program),this.program=null)}}],[{key:"newColoredTextured",value:function(t){return new e(t,"\n         attribute vec4 ".concat(e.POSITION,";\n         attribute vec4 ").concat(e.COLOR,";\n         attribute vec2 ").concat(e.TEXCOORDS,";\n         uniform mat4 ").concat(e.MVP_MATRIX,";\n         varying vec4 v_color;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_color = ").concat(e.COLOR,";\n           v_texCoords = ").concat(e.TEXCOORDS,";\n           gl_Position = ").concat(e.MVP_MATRIX," * ").concat(e.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           gl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n         }\n       ")}},{key:"newTwoColoredTextured",value:function(t){return new e(t,"\n         attribute vec4 ".concat(e.POSITION,";\n         attribute vec4 ").concat(e.COLOR,";\n         attribute vec4 ").concat(e.COLOR2,";\n         attribute vec2 ").concat(e.TEXCOORDS,";\n         uniform mat4 ").concat(e.MVP_MATRIX,";\n         varying vec4 v_light;\n         varying vec4 v_dark;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_light = ").concat(e.COLOR,";\n           v_dark = ").concat(e.COLOR2,";\n           v_texCoords = ").concat(e.TEXCOORDS,";\n           gl_Position = ").concat(e.MVP_MATRIX," * ").concat(e.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_light;\n         varying LOWP vec4 v_dark;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           vec4 texColor = texture2D(u_texture, v_texCoords);\n           gl_FragColor.a = texColor.a * v_light.a;\n           gl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n         }\n       ")}},{key:"newColored",value:function(t){return new e(t,"\n         attribute vec4 ".concat(e.POSITION,";\n         attribute vec4 ").concat(e.COLOR,";\n         uniform mat4 ").concat(e.MVP_MATRIX,";\n         varying vec4 v_color;\n \n         void main () {\n           v_color = ").concat(e.COLOR,";\n           gl_Position = ").concat(e.MVP_MATRIX," * ").concat(e.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n \n         void main () {\n           gl_FragColor = v_color;\n         }\n       ")}}]),e}();t.Shader=s,s.MVP_MATRIX="u_projTrans",s.POSITION="a_position",s.COLOR="a_color",s.COLOR2="a_color2",s.TEXCOORDS="a_texCoords",s.SAMPLER="u_texture",s.NORMAL="a_normal",s.TANGENT="a_tangent",s.BINORMAL="a_binormal",s.BONEWEIGHT="a_boneWeight"},2987:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeRenderer=t.ShapeType=void 0;var s,a=i(1514),o=i(1858),l=i(8606),u=i(2283);!function(e){e[e.Point=0]="Point",e[e.Line=1]="Line",e[e.Filled=4]="Filled"}(s=t.ShapeType||(t.ShapeType={}));var h=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10920;if(n(this,e),this.isDrawing=!1,this.shapeType=s.Filled,this.color=new l.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new u.Vector2,this.projectionValues=new Float32Array(16),i>10920)throw new Error("Can't have more than 10920 triangles per batch: "+i);this.context=t,this.mesh=new a.Mesh(t,[new a.Position2Attribute,new a.ColorAttribute],i,0);var r=this.context;this.srcColorBlend=r.SRC_ALPHA,this.srcAlphaBlend=r.ONE,this.dstBlend=r.ONE_MINUS_SRC_ALPHA,this.shader=o.Shader.newColored(r)}return r(e,[{key:"setProjection",value:function(e){this.projectionValues=e}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.vertexIndex=0,this.isDrawing=!0,this.shader.bind(),this.shader.setUniform4x4f(o.Shader.MVP_MATRIX,this.projectionValues);var e=this.context;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(e,t,i){(this.srcColorBlend=e,this.srcAlphaBlend=t,this.dstBlend=i,this.isDrawing)&&(this.flush(),this.context.blendFuncSeparate(e,i,t,i))}},{key:"setColor",value:function(e){this.color.setFromColor(e)}},{key:"setColorWith",value:function(e,t,i,n){this.color.set(e,t,i,n)}},{key:"point",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.check(s.Point,1),null===i&&(i=this.color),this.vertex(e,t,i)}},{key:"line",value:function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.check(s.Line,2),null===r&&(r=this.color),this.vertex(e,t,r),this.vertex(i,n,r)}},{key:"triangle",value:function(e,t,i,n,r,a,o){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(e?s.Filled:s.Line,3),null===l&&(l=this.color),null===u&&(u=this.color),null===h&&(h=this.color),e?(this.vertex(t,i,l),this.vertex(n,r,u),this.vertex(a,o,h)):(this.vertex(t,i,l),this.vertex(n,r,u),this.vertex(n,r,l),this.vertex(a,o,u),this.vertex(a,o,l),this.vertex(t,i,u))}},{key:"quad",value:function(e,t,i,n,r,a,o,l,u){var h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,d=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null;this.check(e?s.Filled:s.Line,3),null===h&&(h=this.color),null===c&&(c=this.color),null===f&&(f=this.color),null===d&&(d=this.color),e?(this.vertex(t,i,h),this.vertex(n,r,c),this.vertex(a,o,f),this.vertex(a,o,f),this.vertex(l,u,d),this.vertex(t,i,h)):(this.vertex(t,i,h),this.vertex(n,r,c),this.vertex(n,r,c),this.vertex(a,o,f),this.vertex(a,o,f),this.vertex(l,u,d),this.vertex(l,u,d),this.vertex(t,i,h))}},{key:"rect",value:function(e,t,i,n,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.quad(e,t,i,t+n,i,t+n,i+r,t,i+r,s,s,s,s)}},{key:"rectLine",value:function(e,t,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.check(e?s.Filled:s.Line,8),null===o&&(o=this.color);var l=this.tmp.set(r-i,t-n);l.nor(),a*=.5;var u=l.x*a,h=l.y*a;e?(this.vertex(t+u,i+h,o),this.vertex(t-u,i-h,o),this.vertex(n+u,r+h,o),this.vertex(n-u,r-h,o),this.vertex(n+u,r+h,o),this.vertex(t-u,i-h,o)):(this.vertex(t+u,i+h,o),this.vertex(t-u,i-h,o),this.vertex(n+u,r+h,o),this.vertex(n-u,r-h,o),this.vertex(n+u,r+h,o),this.vertex(t+u,i+h,o),this.vertex(n-u,r-h,o),this.vertex(t-u,i-h,o))}},{key:"x",value:function(e,t,i){this.line(e-i,t-i,e+i,t+i),this.line(e-i,t+i,e+i,t-i)}},{key:"polygon",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i<3)throw new Error("Polygon must contain at least 3 vertices");this.check(s.Line,2*i),null===n&&(n=this.color),i<<=1;for(var r=e[t<<=1],a=e[t+1],o=t+i,l=t,u=t+i-2;l<u;l+=2){var h=e[l],c=e[l+1],f=0,d=0;l+2>=o?(f=r,d=a):(f=e[l+2],d=e[l+3]),this.vertex(h,c,n),this.vertex(f,d,n)}}},{key:"circle",value:function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(0===a&&(a=Math.max(1,6*l.MathUtils.cbrt(n)|0)),a<=0)throw new Error("segments must be > 0.");null===r&&(r=this.color);var o=2*l.MathUtils.PI/a,u=Math.cos(o),h=Math.sin(o),c=n,f=0;if(e){this.check(s.Filled,3*a+3),a--;for(var d=0;d<a;d++){this.vertex(t,i,r),this.vertex(t+c,i+f,r);var m=c;c=u*c-h*f,f=h*m+u*f,this.vertex(t+c,i+f,r)}this.vertex(t,i,r),this.vertex(t+c,i+f,r)}else{this.check(s.Line,2*a+2);for(var _=0;_<a;_++){this.vertex(t+c,i+f,r);var p=c;c=u*c-h*f,f=h*p+u*f,this.vertex(t+c,i+f,r)}this.vertex(t+c,i+f,r)}c=n,f=0,this.vertex(t+c,i+f,r)}},{key:"curve",value:function(e,t,i,n,r,a,o,l,u){var h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(s.Line,2*u+2),null===h&&(h=this.color);for(var c=1/u,f=c*c,d=c*c*c,m=3*c,_=3*f,p=6*f,v=6*d,y=e-2*i+r,g=t-2*n+a,x=3*(i-r)-e+o,b=3*(n-a)-t+l,w=e,A=t,S=(i-e)*m+y*_+x*d,M=(n-t)*m+g*_+b*d,C=y*p+x*v,k=g*p+b*v,B=x*v,V=b*v;u-- >0;)this.vertex(w,A,h),w+=S,A+=M,S+=C,M+=k,C+=B,k+=V,this.vertex(w,A,h);this.vertex(w,A,h),this.vertex(o,l,h)}},{key:"vertex",value:function(e,t,i){var n=this.vertexIndex,r=this.mesh.getVertices();r[n++]=e,r[n++]=t,r[n++]=i.r,r[n++]=i.g,r[n++]=i.b,r[n++]=i.a,this.vertexIndex=n}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();var e=this.context;e.disable(e.BLEND),this.isDrawing=!1}},{key:"flush",value:function(){0!==this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)}},{key:"check",value:function(e,t){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType===e){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<t))return;this.flush()}else this.flush(),this.shapeType=e}},{key:"dispose",value:function(){this.mesh.dispose()}}]),e}();t.ShapeRenderer=h},5297:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Sprite=void 0;var s=i(8606),a=i(2283),o=function(){function e(t){n(this,e),this.region=t,this.dirty=!1,this.position=new a.Vector2(0,0),this.size=new a.Vector2(0,0),this.origin=new a.Vector2(0,0),this.scale=new a.Vector2(1,1),this.color=new s.Color(1,1,1,1),this.rotation=0,this.vertices=new Float32Array(48),this.bounds={x:0,y:0,width:0,height:0},this.setSize(t.width,t.height),this.setOrigin(t.width/2,t.height/2)}return r(e,[{key:"set",value:function(e){this.region=e.region,this.position.setVector(e.position),this.size.setVector(e.size),this.origin.setVector(e.origin),this.rotation=e.rotation,this.scale.setVector(e.scale),this.color.setFromColor(e.color),this.dirty=!0}},{key:"setBounds",value:function(e,t,i,n){this.setPosition(e,t),this.setSize(e,t),this.dirty=!0}},{key:"setSize",value:function(e,t){this.size.set(e,t),this.dirty=!0}},{key:"setPosition",value:function(e,t){this.position.set(e,t),this.dirty=!0}},{key:"setOriginBasedPosition",value:function(e,t){this.setPosition(e-this.origin.x,t-this.origin.y)}},{key:"setX",value:function(e){this.position.x=e,this.dirty=!0}},{key:"setY",value:function(e){this.position.y=e,this.dirty=!0}},{key:"setCenterX",value:function(e){this.setX(e-this.size.x/2)}},{key:"setCenterY",value:function(e){this.setY(e-this.size.y/2)}},{key:"setCenter",value:function(e,t){this.setPosition(e-this.size.x/2,t-this.size.y/2)}},{key:"translateX",value:function(e){this.translate(e,0)}},{key:"translateY",value:function(e){this.translate(0,e)}},{key:"translate",value:function(e,t){this.position.add(e,t),this.dirty=!0}},{key:"setColor",value:function(e){this.color.setFromColor(e),this.dirty=!0}},{key:"setAlpha",value:function(e){this.color.a=e,this.dirty=!0}},{key:"setOrigin",value:function(e,t){this.origin.set(e,t),this.dirty=!0}},{key:"setOriginCenter",value:function(){this.origin.set(this.size.x/2,this.size.y/2),this.dirty=!0}},{key:"setRotation",value:function(e){this.rotation=e,this.dirty=!0}},{key:"getRotation",value:function(){return this.rotation}},{key:"rotate",value:function(e){0!==e&&(this.rotation+=e,this.dirty=!0)}},{key:"setScale",value:function(e,t){this.scale.set(e,t),this.dirty=!0}},{key:"applyScale",value:function(e){this.scale.scale(e),this.dirty=!0}},{key:"getVertices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.vertices,i=this.region;if(!this.dirty)return t;var n=this.position.x,r=this.position.y,s=this.size.x,a=this.size.y,o=this.origin.x,l=this.origin.y,u=this.rotation,h=this.scale.x,c=this.scale.y,f=i.u,d=i.v,m=i.u2,_=i.v2,p=this.color,v=i.rotated,y=s/i.originalWidth,g=a/i.originalHeight,x=i.width*y,b=i.height*g,w=n+i.offsetX*y;if(n=w,r=e?r+a-i.offsetY*g-b:r+i.offsetY*g,e){var A=d;d=_,_=A}var S=-o,M=(s=x)-o,C=s-o,k=-o,B=-l,V=-l,T=(a=b)-l,P=a-l;if(1!==h&&(S*=h,M*=h,C*=h,k*=h),1!==c&&(B*=c,V*=c,T*=c,P*=c),0!==u){var L=Math.cos(u),E=Math.sin(u),I=L*S-E*B,R=E*S+L*B,F=L*M-E*V,G=E*M+L*V,D=L*C-E*T,O=E*C+L*T,N=L*k-E*P,z=E*k+L*P;S=I,M=F,C=D,k=N,B=R,V=G,T=O,P=z}S+=n+o,M+=n+o,C+=n+o,k+=n+o,B+=r+l,V+=r+l,T+=r+l,P+=r+l;var U=f,j=d,W=m,q=_,H=W,X=j,J=U,Y=q;v&&(e?(U=f,j=_,W=m,q=d,H=f,X=d,J=m,Y=_):(U=m,j=d,W=f,q=_,H=m,X=_,J=f,Y=d));var Z=0;return t[Z++]=S,t[Z++]=B,t[Z++]=p.r,t[Z++]=p.g,t[Z++]=p.b,t[Z++]=p.a,t[Z++]=U,t[Z++]=j,t[Z++]=0,t[Z++]=0,t[Z++]=0,t[Z++]=0,t[Z++]=M,t[Z++]=V,t[Z++]=p.r,t[Z++]=p.g,t[Z++]=p.b,t[Z++]=p.a,t[Z++]=H,t[Z++]=X,t[Z++]=0,t[Z++]=0,t[Z++]=0,t[Z++]=0,t[Z++]=C,t[Z++]=T,t[Z++]=p.r,t[Z++]=p.g,t[Z++]=p.b,t[Z++]=p.a,t[Z++]=W,t[Z++]=q,t[Z++]=0,t[Z++]=0,t[Z++]=0,t[Z++]=0,t[Z++]=k,t[Z++]=P,t[Z++]=p.r,t[Z++]=p.g,t[Z++]=p.b,t[Z++]=p.a,t[Z++]=J,t[Z++]=Y,t[Z++]=0,t[Z++]=0,t[Z++]=0,t[Z]=0,t}},{key:"getBoundingRectangle",value:function(){var e=this.vertices,t=e[0],i=e[1],n=e[0],r=e[1];return t=(t=(t=t>e[12]?e[12]:t)>e[24]?e[24]:t)>e[36]?e[36]:t,n=(n=(n=n<e[12]?e[12]:n)<e[24]?e[24]:n)<e[36]?e[36]:n,i=(i=(i=i>e[13]?e[13]:i)>e[25]?e[25]:i)>e[37]?e[37]:i,r=(r=(r=r<e[13]?e[13]:r)<e[25]?e[25]:r)<e[37]?e[37]:r,this.bounds.x=t,this.bounds.y=i,this.bounds.width=n-t,this.bounds.height=r-i,this.bounds}},{key:"draw",value:function(e){e.drawVertices(this.region.texture,this.getVertices(e.yDown))}},{key:"drawWithAlpha",value:function(e,t){var i=this.getColor().a;this.setAlpha(i*t),this.draw(e),this.setAlpha(i)}},{key:"getX",value:function(){return this.position.x}},{key:"getY",value:function(){return this.position.y}},{key:"getWidth",value:function(){return this.size.x}},{key:"getHeight",value:function(){return this.size.y}},{key:"getOriginX",value:function(){return this.origin.x}},{key:"getOriginY",value:function(){return this.origin.y}},{key:"getScaleX",value:function(){return this.scale.x}},{key:"getScaleY",value:function(){return this.scale.y}},{key:"getColor",value:function(){return this.color}}]),e}();t.Sprite=o},7139:function(e,t,i){"use strict";var n,r=i(6690).default,s=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Texture=t.TextureWrap=t.TextureFilter=void 0,function(e){e[e.Nearest=9728]="Nearest",e[e.Linear=9729]="Linear",e[e.MipMap=9987]="MipMap",e[e.MipMapNearestNearest=9984]="MipMapNearestNearest",e[e.MipMapLinearNearest=9985]="MipMapLinearNearest",e[e.MipMapNearestLinear=9986]="MipMapNearestLinear",e[e.MipMapLinearLinear=9987]="MipMapLinearLinear"}(n=t.TextureFilter||(t.TextureFilter={})),function(e){e[e.MirroredRepeat=33648]="MirroredRepeat",e[e.ClampToEdge=33071]="ClampToEdge",e[e.Repeat=10497]="Repeat"}(t.TextureWrap||(t.TextureWrap={}));var a=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,e),this.texture=null,this.boundUnit=0,this.useMipMaps=!1,this.width=0,this.height=0,this._image=i,this.context=t,this.useMipMaps=n,this.restore(),this.width=i.width,this.height=i.height}return s(e,[{key:"getImage",value:function(){return this._image}},{key:"getWebGLTexture",value:function(){return this.texture}},{key:"setFilters",value:function(t,i){var n=this.context;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e.validateMagFilter(i))}},{key:"setWraps",value:function(e,t){var i=this.context;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t)}},{key:"update",value:function(t){var i=this.context;this.texture||(this.texture=this.context.createTexture()),this.bind(),e.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._image),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),t&&i.generateMipmap(i.TEXTURE_2D)}},{key:"restore",value:function(){this.texture=null,this.update(this.useMipMaps)}},{key:"bind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.context;this.boundUnit=e,t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.texture)}},{key:"unbind",value:function(){var e=this.context;e.activeTexture(e.TEXTURE0+this.boundUnit),e.bindTexture(e.TEXTURE_2D,null)}},{key:"dispose",value:function(){this.context.deleteTexture(this.texture)}}],[{key:"createWhiteTexture",value:function(t){return new e(t,new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1))}},{key:"load",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r){var s=new Image;s.onload=function(){r(new e(t,s,n))},s.src=i}))}},{key:"validateMagFilter",value:function(e){switch(e){case n.MipMap:case n.MipMapLinearLinear:case n.MipMapLinearNearest:case n.MipMapNearestLinear:case n.MipMapNearestNearest:return n.Linear;default:return e}}}]),e}();t.Texture=a,a.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1},9396:function(e,t,i){"use strict";var n=i(7061).default,r=i(7424).default,s=i(4704).default,a=i(6690).default,o=i(9728).default,l=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function a(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAtlas=void 0;var u=i(7139),h=i(859),c=i(8606),f=function(){function e(t,i){a(this,e),this.pages=t,this.regions=i}return o(e,[{key:"dispose",value:function(){var e,t=s(this.pages);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(i){t.e(i)}finally{t.f()}}},{key:"getPages",value:function(){return this.pages}},{key:"getRegions",value:function(){return this.regions}},{key:"findRegion",value:function(e,t){for(var i=0;i<this.regions.length;i++){var n=this.regions[i];if(n.name===e&&(void 0===t||n.index===t))return n}return null}},{key:"findRegions",value:function(e){return this.regions.filter((function(t){return t.name===e})).sort((function(e,t){return e.index-t.index}))}}],[{key:"load",value:function(t,i,s){return l(this,void 0,void 0,n().mark((function a(){var o,l,f,d,m,_,p,v,y,g,x,b,w,A,S,M,C,k,B,V,T,P,L,E,I,R,F,G,D,O,N,z,U,j,W,q,H,X,J,Y,Z;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(i).then((function(e){return e.text()}));case 2:o=n.sent,l=[],f=[],d=[],_=o.split(/\r?\n/),p=0;case 8:if(void 0!==(y=_[p])){n.next=12;break}return n.abrupt("break",16);case 12:0===y.trim().length?m=null:m?(V=y,p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),T="true"===v[0],p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),P=parseInt(v[0],10),L=parseInt(v[1],10),p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),E=parseInt(v[0],10),I=parseInt(v[1],10),R={name:V,rotate:T,left:P,top:L,width:E,height:I,page:m},p++,y=_[p],4===(v=y.split(":")[1].split(",").map((function(e){return e.trim()}))).length&&(R.splits=v.map((function(e){return parseInt(e,10)})),p++,y=_[p],4===(v=y.split(":")[1].split(",").map((function(e){return e.trim()}))).length&&(R.pads=v.map((function(e){return parseInt(e,10)})),p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})))),R.originalWidth=parseInt(v[0],10),R.originalHeight=parseInt(v[1],10),p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),R.offsetX=parseInt(v[0],10),R.offsetY=parseInt(v[1],10),p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),R.index=parseInt(v[0],10),d.push(R)):(g=(0,c.concatAndResolveUrl)(i,"../".concat(y)),p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),x=parseInt(v[0],10),b=parseInt(v[1],10),p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),w=v[0],p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),A=r(v,2),S=A[0],M=A[1],p++,y=_[p],v=y.split(":")[1].split(",").map((function(e){return e.trim()})),C=v[0],k=u.TextureWrap.ClampToEdge,B=u.TextureWrap.ClampToEdge,"x"===C?k=u.TextureWrap.Repeat:"y"===C?B=u.TextureWrap.Repeat:"xy"===C&&(k=u.TextureWrap.Repeat,B=u.TextureWrap.Repeat),m={file:g,width:x,height:b,format:w,mipMaps:"Nearest"!==S&&"Linear"!==S,min:S,max:M,direction:C,repeatX:k,repeatY:B},l.push(m)),p++,n.next=8;break;case 16:F=0,G=l;case 17:if(!(F<G.length)){n.next=27;break}return D=G[F],n.next=21,u.Texture.load(t,D.file,s);case 21:D.texture=n.sent,D.invTexWidth=1/D.texture.width,D.invTexHeight=1/D.texture.height;case 24:F++,n.next=17;break;case 27:for(O=[],N=0,z=d;N<z.length;N++)U=z[N],j=U.left,W=U.top,q=U.rotate?U.height:U.width,H=U.rotate?U.width:U.height,X=U.page,J=X.texture,Y=X.invTexWidth,Z=X.invTexHeight,O.push(new h.TextureRegion(J,j,W,q,H,U,Y,Z,U.rotate));return n.abrupt("return",new e(f,O));case 30:case"end":return n.stop()}}),a)})))}}]),e}();t.TextureAtlas=f},859:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.TextureRegion=void 0;var s=function(){function e(t,i,r,s,a,o,l,u){var h=arguments.length>8&&void 0!==arguments[8]&&arguments[8];n(this,e),this.name=null,this.index=0,this.texture=null,this.regionX=0,this.regionY=0,this.width=0,this.height=0,this.invTexWidth=0,this.invTexHeight=0,this.originalWidth=0,this.originalHeight=0,this.offsetX=0,this.offsetY=0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.rotated=!1,l&&u||(l=1/t.width,u=1/t.height);var c=i*l,f=(r+a)*u,d=(i+s)*l,m=r*u;for(var _ in this.texture=t,this.regionX=i,this.regionY=r,this.width=s,this.height=a,this.originalWidth=s,this.originalHeight=a,this.offsetX=0,this.offsetY=0,this.u=c,this.v=f,this.u2=d,this.v2=m,this.rotated=h,o)this[_]=o[_]}return r(e,[{key:"draw",value:function(e,t,i,n,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,h=this.originalWidth,c=this.originalHeight,f=this.offsetX,d=this.offsetY,m=this.width,_=this.height,p=n/h,v=r/c,y=m*p,g=_*v,x=t+f*p,b=0;s-=x-t,a-=(b=e.yDown?i+r-d*v-g:i+d*v)-i,e.draw(this.texture,x,b,y,g,s,a,o,l,u,this.u,this.v,this.u2,this.v2,this.rotated)}}],[{key:"splitTexture",value:function(t,i,n){for(var r=t.width/i,s=t.height/n,a=[],o=0;o<n;o++)for(var l=0;l<i;l++)a.push(new e(t,l*r,o*s,r,s,{}));return a}}]),e}();t.TextureRegion=s},8606:function(e,t,i){"use strict";var n,r=i(1588).default,s=i(3808).default,a=i(1655).default,o=i(6389).default,l=i(6690).default,u=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.concatAndResolveUrl=t.ArrayMap=t.copyArray=t.createStage=t.pointInRect=t.resizeCanvas=t.createGameLoop=t.WindowedMean=t.TimeKeeper=t.Pools=t.FlushablePool=t.Pool=t.Utils=t.PowOut=t.Pow=t.Interpolation=t.MathUtils=t.Color=t.StringSet=t.IntSet=t.Align=void 0;var h=function(){function e(){l(this,e)}return u(e,null,[{key:"isLeft",value:function(e){return 0!==(e&this.left)}},{key:"isRight",value:function(e){return 0!==(e&this.right)}},{key:"isTop",value:function(e){return 0!==(e&this.top)}},{key:"isBottom",value:function(e){return 0!==(e&this.bottom)}},{key:"isCenterVertical",value:function(e){return 0===(e&this.top)&&0===(e&this.bottom)}},{key:"isCenterHorizontal",value:function(e){return 0===(e&this.left)&&0===(e&this.right)}}]),e}();t.Align=h,n=h,h.center=1,h.top=2,h.bottom=4,h.left=8,h.right=16,h.topLeft=n.top|n.left,h.topRight=n.top|n.right,h.bottomLeft=n.bottom|n.left,h.bottomRight=n.bottom|n.right;var c=function(){function e(){l(this,e),this.array=new Array}return u(e,[{key:"add",value:function(e){var t=this.contains(e);return this.array[0|e]=0|e,!t}},{key:"contains",value:function(e){return void 0!==this.array[0|e]}},{key:"remove",value:function(e){this.array[0|e]=void 0}},{key:"clear",value:function(){this.array.length=0}}]),e}();t.IntSet=c;var f=function(){function e(){l(this,e),this.entries={},this.size=0}return u(e,[{key:"add",value:function(e){var t=this.entries[e];return this.entries[e]=!0,!t&&(this.size++,!0)}},{key:"addAll",value:function(e){for(var t=this.size,i=0,n=e.length;i<n;i++)this.add(e[i]);return t!==this.size}},{key:"contains",value:function(e){return this.entries[e]}},{key:"clear",value:function(){this.entries={},this.size=0}}]),e}();t.StringSet=f;var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;l(this,e),this.r=t,this.g=i,this.b=n,this.a=r}return u(e,[{key:"unsafeSet",value:function(e,t,i,n){this.r=e,this.g=t,this.b=i,this.a=n}},{key:"set",value:function(e,t,i,n){return this.r=e,this.g=t,this.b=i,this.a=n,this.clamp()}},{key:"setFromColor",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}},{key:"setFromString",value:function(e){return e="#"===e.charAt(0)?e.substring(1):e,this.r=parseInt(e.substring(0,2),16)/255,this.g=parseInt(e.substring(2,4),16)/255,this.b=parseInt(e.substring(4,6),16)/255,this.a=8!==e.length?1:parseInt(e.substring(6,8),16)/255,this}},{key:"add",value:function(e,t,i,n){return this.r+=e,this.g+=t,this.b+=i,this.a+=n,this.clamp()}},{key:"clamp",value:function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}},{key:"lerp",value:function(e,t){return this.r+=t*(e.r-this.r),this.g+=t*(e.g-this.g),this.b+=t*(e.b-this.b),this.a+=t*(e.a-this.a),this.clamp()}},{key:"mul",value:function(e,t,i,n){return this.r*=e,this.g*=t,this.b*=i,this.a*=n,this.clamp()}},{key:"toIntBits",value:function(){return 255*this.a<<24|255*this.b<<16|255*this.g<<8|255*this.r}},{key:"equals",value:function(e){return this===e||this.toIntBits()===e.toIntBits()}}],[{key:"rgba8888ToColor",value:function(e,t){e.r=((4278190080&t)>>>24)/255,e.g=((16711680&t)>>>16)/255,e.b=((65280&t)>>>8)/255,e.a=(255&t)/255}},{key:"rgb888ToColor",value:function(e,t){e.r=((16711680&t)>>>16)/255,e.g=((65280&t)>>>8)/255,e.b=(255&t)/255}},{key:"fromString",value:function(t){return(new e).setFromString(t)}}]),e}();t.Color=d,d.WHITE=new d(1,1,1,1),d.RED=new d(1,0,0,1),d.GREEN=new d(0,1,0,1),d.BLUE=new d(0,0,1,1),d.MAGENTA=new d(1,0,1,1);var m=function(){function e(){l(this,e)}return u(e,null,[{key:"clamp",value:function(e,t,i){return e<t?t:e>i?i:e}},{key:"cosDeg",value:function(t){return Math.cos(t*e.degRad)}},{key:"sinDeg",value:function(t){return Math.sin(t*e.degRad)}},{key:"signum",value:function(e){return e>0?1:e<0?-1:0}},{key:"toInt",value:function(e){return e>0?Math.floor(e):Math.ceil(e)}},{key:"cbrt",value:function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t}},{key:"randomTriangular",value:function(t,i){return e.randomTriangularWith(t,i,.5*(t+i))}},{key:"randomTriangularWith",value:function(e,t,i){var n=Math.random(),r=t-e;return n<=(i-e)/r?e+Math.sqrt(n*r*(i-e)):t-Math.sqrt((1-n)*r*(t-i))}},{key:"isPowerOfTwo",value:function(e){return e&&0===(e&e-1)}},{key:"isEqual",value:function(t,i){return Math.abs(t-i)<=e.FLOAT_ROUNDING_ERROR}},{key:"isZero",value:function(t){return Math.abs(t)<=e.FLOAT_ROUNDING_ERROR}}]),e}();t.MathUtils=m,m.FLOAT_ROUNDING_ERROR=1e-6,m.PI=3.1415927,m.PI2=2*m.PI,m.radiansToDegrees=180/m.PI,m.radDeg=m.radiansToDegrees,m.degreesToRadians=m.PI/180,m.degRad=m.degreesToRadians;var _=function(){function e(){l(this,e)}return u(e,[{key:"apply",value:function(e,t,i){return e+(t-e)*this.applyInternal(i)}}]),e}();t.Interpolation=_;var p=function(e){a(i,e);var t=o(i);function i(e){var n;return l(this,i),(n=t.call(this)).power=2,n.power=e,n}return u(i,[{key:"applyInternal",value:function(e){return e<=.5?Math.pow(2*e,this.power)/2:Math.pow(2*(e-1),this.power)/(this.power%2===0?-2:2)+1}}]),i}(_);t.Pow=p;var v=function(e){a(i,e);var t=o(i);function i(){return l(this,i),t.apply(this,arguments)}return u(i,[{key:"applyInternal",value:function(e){return Math.pow(e-1,this.power)*(this.power%2===0?-1:1)+1}}]),i}(p);t.PowOut=v;var y=function(){function e(){l(this,e)}return u(e,null,[{key:"arrayCopy",value:function(e,t,i,n,r){for(var s=t,a=n;s<t+r;s++,a++)i[a]=e[s]}},{key:"arrayFill",value:function(e,t,i,n){for(var r=t;r<i;r++)e[r]=n}},{key:"setArraySize",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.length;if(n===t)return e;if(e.length=t,n<t)for(var r=n;r<t;r++)e[r]=i;return e}},{key:"ensureArrayCapacity",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.length>=i?t:e.setArraySize(t,i,n)}},{key:"newArray",value:function(e,t){for(var i=new Array(e),n=0;n<e;n++)i[n]=t;return i}},{key:"newFloatArray",value:function(t){if(e.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);for(var i=new Array(t),n=0;n<i.length;n++)i[n]=0;return i}},{key:"newShortArray",value:function(t){if(e.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);for(var i=new Array(t),n=0;n<i.length;n++)i[n]=0;return i}},{key:"toFloatArray",value:function(t){return e.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}},{key:"toSinglePrecision",value:function(t){return e.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}},{key:"contains",value:function(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return!0;return!1}},{key:"enumValue",value:function(e,t){return e[t[0].toUpperCase()+t.slice(1)]}},{key:"getHashCodeOfString",value:function(e){var t,i=0;if(0===this.length)return i;for(t=0;t<this.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i}}]),e}();t.Utils=y,y.SUPPORTS_TYPED_ARRAYS="undefined"!==typeof Float32Array;var g=function(){function e(t){l(this,e),this.items=new Array,this.instantiator=t||function(){return{}}}return u(e,[{key:"obtain",value:function(){return this.items.length>0?this.items.pop():this.instantiator()}},{key:"free",value:function(e){(null===e||void 0===e?void 0:e.reset)&&e.reset(),this.items.push(e)}},{key:"freeAll",value:function(e){for(var t=0;t<e.length;t++)this.free(e[t])}},{key:"clear",value:function(){this.items.length=0}}]),e}();t.Pool=g;var x=function(e){a(i,e);var t=o(i);function i(e){var n;return l(this,i),(n=t.call(this,e)).obtained=new Array,n}return u(i,[{key:"obtain",value:function(){var e=r(s(i.prototype),"obtain",this).call(this);return this.obtained.push(e),e}},{key:"flush",value:function(){r(s(i.prototype),"freeAll",this).call(this,this.obtained),this.obtained.length=0}},{key:"free",value:function(e){var t=this.obtained.indexOf(e);t>-1&&this.obtained.splice(t,1),r(s(i.prototype),"free",this).call(this,e)}},{key:"freeAll",value:function(e){for(var t=0;t<e.length;t++){var n=this.obtained.indexOf(e[t]);n>=0&&this.obtained.splice(n,1)}r(s(i.prototype),"freeAll",this).call(this,e)}}]),i}(g);t.FlushablePool=x;var b=function(){function e(){l(this,e)}return u(e,null,[{key:"free",value:function(e,t){this.pools[e]&&this.pools[e].free(t)}},{key:"freeAll",value:function(e,t){this.pools[e]&&this.pools[e].freeAll(t)}},{key:"get",value:function(e,t){return this.pools[e]||(this.pools[e]=new g(t)),this.pools[e]}},{key:"set",value:function(e,t){this.pools[e]=t}},{key:"obtain",value:function(e,t){return this.get(e,t).obtain()}}]),e}();t.Pools=b,b.pools={};var w=function(){function e(){l(this,e),this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return u(e,[{key:"update",value:function(){var e=Date.now()/1e3;this.delta=e-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=e,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}]),e}();t.TimeKeeper=w;var A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;l(this,e),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}return u(e,[{key:"hasEnoughData",value:function(){return this.addedValues>=this.values.length}},{key:"addValue",value:function(e){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=e,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0}},{key:"getMean",value:function(){if(this.hasEnoughData()){if(this.dirty){for(var e=0,t=0;t<this.values.length;t++)e+=this.values[t];this.mean=e/this.values.length,this.dirty=!1}return this.mean}return 0}}]),e}();t.WindowedMean=A;t.createGameLoop=function(e){var t,i=Date.now(),n=0,r=!0,s=0,a=0;function o(){if(r){var l=Date.now()-i;i=Date.now(),s++,(a+=l)>=1e3&&(n=s,s=0,a-=1e3),t=requestAnimationFrame(o),e(l/1e3)}}return o(),{isRunning:function(){return r},start:function(){r||(r=!0,o())},stop:function(){t&&cancelAnimationFrame(t),r=!1},getFps:function(){return n}}};t.resizeCanvas=function(e,t){var i=t||window.devicePixelRatio||1,n=e.clientWidth*i,r=e.clientHeight*i;return e.width===n&&e.height===r||(e.width=n,e.height=r),[n,r]};t.pointInRect=function(e,t,i,n,r,s){return e>i&&e<i+r&&t>n&&t<n+s};t.createStage=function(e){e=Object.assign(Object.assign({},{hidden:!1,info:!0}),e);var t=document.createElement("div");t.setAttribute("style","position:fixed;top:0;left:0;right:0;bottom:0;"),e.wrapperClassName&&(t.className=e.wrapperClassName),e.hidden&&(t.style.display="none");var i=document.createElement("canvas");i.setAttribute("style","width:100%;height:100%;");var n=document.createElement("div");return n.setAttribute("style","position:absolute;top:1em;left:1em;color:white"),e.info||(n.style.display="none"),t.appendChild(i),t.appendChild(n),document.body.appendChild(t),{getCanvas:function(){return i},getInfo:function(){return n},show:function(){return t.style.display="block"},hide:function(){return t.style.display="none"},cleanup:function(){return document.body.removeChild(t)}}};t.copyArray=function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.length,s=0;s<r;s++)t[i+s]=e[n+s]};var S=function(){function e(){l(this,e),this.keys=[],this.values=[],this.size=0}return u(e,[{key:"set",value:function(e,t){var i=this.indexOfKey(e);return-1===i&&(i=this.size++),this.keys[i]=e,this.values[i]=t,i}},{key:"get",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.size-1;i>=0;i--)if(this.keys[i]===e)return this.values[i];return t}},{key:"indexOfKey",value:function(e){for(var t=0,i=this.size;t<i;t++)if(this.keys[t]===e)return t;return-1}},{key:"removeKey",value:function(e){for(var t=0,i=this.size;t<i;t++)this.keys[t]===e&&this.removeIndex(t)}},{key:"removeIndex",value:function(e){if(e>=this.size)throw new Error("index out of bound");this.size--,this.keys.splice(e,1),this.values.splice(e,1)}},{key:"clear",value:function(){this.keys.length=0,this.values.length=0,this.size=0}}]),e}();t.ArrayMap=S,t.concatAndResolveUrl=function(e,t){for(var i=e.split("/"),n=t.split("/"),r=[],s=0,a=i.length;s<a;s++)if(".."===i[s])r.pop();else{if("."===i[s])continue;r.push(i[s])}for(var o=0,l=n.length;o<l;o++)if(".."===n[o])r.pop();else{if("."===n[o])continue;r.push(n[o])}return r.join("/")}},2283:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Vector2=void 0;var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,e),this.x=0,this.y=0,this.x=t,this.y=i}return r(e,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setVector",value:function(e){return this.set(e.x,e.y)}},{key:"add",value:function(e,t){return this.x+=e,this.y+=t,this}},{key:"addVector",value:function(e){return this.add(e.x,e.y)}},{key:"sub",value:function(e,t){return this.add(-e,-t)}},{key:"subVector",value:function(e){return this.sub(e.x,e.y)}},{key:"scale",value:function(e){return this.x*=e,this.y*=e,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"distanceSqr",value:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i}},{key:"distance",value:function(e){return Math.sqrt(this.distanceSqr(e))}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"len2",value:function(){return this.x*this.x+this.y*this.y}},{key:"len",value:function(){return Math.sqrt(this.len2())}},{key:"nor",value:function(){var e=this.len();return 0!==e&&(this.x/=e,this.y/=e),this}},{key:"rotateRad",value:function(e){var t=Math.cos(e),i=Math.sin(e),n=this.x*t-this.y*i,r=this.x*i+this.y*t;return this.x=n,this.y=r,this}},{key:"rotate",value:function(e){return this.rotateRad(e*Math.PI/180)}},{key:"cpy",value:function(){return new e(this.x,this.y)}},{key:"mul",value:function(e){var t=this.x*e.val[0]+this.y*e.val[3]+e.val[6],i=this.x*e.val[1]+this.y*e.val[4]+e.val[7];return this.x=t,this.y=i,this}},{key:"lerp",value:function(e,t){var i=1-t;return this.x=this.x*i+e.x*t,this.y=this.y*i+e.y*t,this}}]),e}();t.Vector2=s},7811:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Vector3=void 0;var s=i(6239),a=i(4995),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n(this,e),this.x=0,this.y=0,this.z=0,this.x=t,this.y=i,this.z=r}return r(e,[{key:"isZero",value:function(){return 0===this.x&&0===this.y&&0===this.z}},{key:"dst2",value:function(e){var t=e.x-this.x,i=e.y-this.y,n=e.z-this.z;return t*t+i*i+n*n}},{key:"setFrom",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"set",value:function(e,t,i){return this.x=e,this.y=t,this.z=i,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"scale",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"normalize",value:function(){var e=this.length();return 0===e||(e=1/e,this.x*=e,this.y*=e,this.z*=e),this}},{key:"cross",value:function(e){return this.set(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}},{key:"multiply",value:function(e){var t=e.values;return this.set(this.x*t[a.Matrix4.M00]+this.y*t[a.Matrix4.M01]+this.z*t[a.Matrix4.M02]+t[a.Matrix4.M03],this.x*t[a.Matrix4.M10]+this.y*t[a.Matrix4.M11]+this.z*t[a.Matrix4.M12]+t[a.Matrix4.M13],this.x*t[a.Matrix4.M20]+this.y*t[a.Matrix4.M21]+this.z*t[a.Matrix4.M22]+t[a.Matrix4.M23])}},{key:"multiplyMat3",value:function(e){var t=e.val;return this.set(this.x*t[s.Matrix3.M00]+this.y*t[s.Matrix3.M01]+this.z*t[s.Matrix3.M02],this.x*t[s.Matrix3.M10]+this.y*t[s.Matrix3.M11]+this.z*t[s.Matrix3.M12],this.x*t[s.Matrix3.M20]+this.y*t[s.Matrix3.M21]+this.z*t[s.Matrix3.M22])}},{key:"project",value:function(e){var t=e.values,i=1/(this.x*t[a.Matrix4.M30]+this.y*t[a.Matrix4.M31]+this.z*t[a.Matrix4.M32]+t[a.Matrix4.M33]);return this.set((this.x*t[a.Matrix4.M00]+this.y*t[a.Matrix4.M01]+this.z*t[a.Matrix4.M02]+t[a.Matrix4.M03])*i,(this.x*t[a.Matrix4.M10]+this.y*t[a.Matrix4.M11]+this.z*t[a.Matrix4.M12]+t[a.Matrix4.M13])*i,(this.x*t[a.Matrix4.M20]+this.y*t[a.Matrix4.M21]+this.z*t[a.Matrix4.M22]+t[a.Matrix4.M23])*i)}},{key:"unproject",value:function(e,t,i,n,r,s){var a=this.x,o=this.y,l=this.z;return a-=i,o=s-o-1,o-=n,e.set(2*a/r-1,2*o/s-1,2*l-1),e.project(t),e}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"dotWithValue",value:function(e,t,i){return this.x*e+this.y*t+this.z*i}},{key:"rotate",value:function(t,i){return e.tmpMat.setToRotation(t,i),this.multiply(e.tmpMat)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"length2",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"distance",value:function(e){var t=e.x-this.x,i=e.y-this.y,n=e.z-this.z;return Math.sqrt(t*t+i*i+n*n)}},{key:"lerp",value:function(e,t){return this.x+=t*(e.x-this.x),this.y+=t*(e.y-this.y),this.z+=t*(e.z-this.z),this}},{key:"equals",value:function(e){return this===e||this.x===e.x&&this.y===e.y&&this.z===e.z}}]),e}();t.Vector3=o,o.X=new o(1,0,0),o.Y=new o(0,1,0),o.Z=new o(0,0,1),o.Zero=new o(0,0,0),o.tmpMat=new a.Matrix4},5533:function(e,t,i){"use strict";var n=i(4704).default,r=i(7424).default;Object.defineProperty(t,"__esModule",{value:!0}),t.createViewport=void 0;var s=i(7459),a=i(8606);t.createViewport=function(e,t,i,o){var l,u={autoUpdate:!0,pixelRatio:void 0,crop:!0};(o=Object.assign(Object.assign({},u),o)).disablePremultipliedAlpha&&(l={premultipliedAlpha:!1}),l=Object.assign(Object.assign({},l),o.contextOption);var h,c=e.getContext("webgl2",l),f=[],d=o,m=d.autoUpdate,_=d.pixelRatio,p=d.crop,v={pixelRatio:_=_||window.devicePixelRatio||1,x:0,y:0,width:t,height:i,worldWidth:t,worldHeight:i},y=(0,a.resizeCanvas)(e,_),g=r(y,2),x=g[0],b=g[1],w=new s.OrthoCamera(t,i,x,b);m&&(h=function(e){A.update()},window.addEventListener("resize",h));var A={getViewportInfo:function(){return v},getCamera:function(){return w},addCamera:function(e){f.push(e)},getContext:function(){return c},getCanvas:function(){return e},update:function(){var s=(0,a.resizeCanvas)(e,_),o=r(s,2),l=o[0],u=o[1],h=t/i,d=l/u;if(p){var m,y;h<d?(y=u,m=u*h):(m=l,y=l/h);var g=(l-m)/2,x=(u-y)/2;v.x=g,v.y=x,v.width=m,v.height=y,c.viewport(g,x,m,y),w.setPosition(t/2,i/2),w.resize(t,i,m,y);var b,A=n(f);try{for(A.s();!(b=A.n()).done;){var S=b.value;S.setPosition(t/2,i/2),S.resize(t,i,m,y)}}catch(L){A.e(L)}finally{A.f()}}else{var M,C,k,B;v.x=0,v.y=0,v.width=l,v.height=u,c.viewport(0,0,l,u),h<d?(k=-((M=(C=i)*d)-t)/2,B=0):(k=0,B=-((C=(M=t)/d)-i)/2),w.setPosition(k+M/2,B+C/2),w.resize(M,C,l,u);var V,T=n(f);try{for(T.s();!(V=T.n()).done;){var P=V.value;P.setPosition(k+M/2,B+C/2),P.resize(M,C,l,u)}}catch(L){T.e(L)}finally{T.f()}}},cleanUp:function(){h&&window.removeEventListener("resize",h)}};return m&&A.update(),A}},4411:function(e,t,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ViewportInputHandler=void 0;var s=i(6964),a=i(2283),o=function(){function e(t){n(this,e),this.screenCoord=new a.Vector2,this.worldCoord=new a.Vector2,this.viewport=t,this.canvas=t.getCanvas(),this.inputHandler=new s.InputHandler(this.canvas)}return r(e,[{key:"isTouched",value:function(){return this.inputHandler.isTouched()}},{key:"cleanup",value:function(){this.inputHandler.cleanup()}},{key:"addEventListener",value:function(e,t){var i,n;this.inputHandler.addEventListener(e,(i=t,n=this.viewport,function(e,t){var r=n.getViewportInfo(),s=r.x,a=r.y,o=r.pixelRatio;i(e=e*o-s,t=t*o-a)}))}},{key:"getX",value:function(){var e=this.viewport.getViewportInfo(),t=e.x,i=e.pixelRatio;return this.inputHandler.getX()*i-t}},{key:"getY",value:function(){var e=this.viewport.getViewportInfo(),t=e.y,i=e.pixelRatio;return this.inputHandler.getY()*i-t}},{key:"getTouchedWorldCoord",value:function(e){return e||(e=this.viewport.getCamera()),this.screenCoord.set(this.getX(),this.getY()),e.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),e}();t.ViewportInputHandler=o},2955:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(i(6893),t),r(i(8656),t),r(i(2121),t),r(i(7581),t),r(i(3959),t),r(i(2791),t),r(i(5477),t),r(i(7459),t),r(i(6176),t),r(i(2013),t),r(i(7712),t),r(i(9045),t),r(i(6964),t),r(i(4995),t),r(i(1514),t),r(i(9699),t),r(i(1251),t),r(i(5122),t),r(i(1858),t),r(i(2987),t),r(i(5297),t),r(i(7139),t),r(i(9396),t),r(i(859),t),r(i(8606),t),r(i(2283),t),r(i(7811),t),r(i(5533),t),r(i(4411),t)},6510:function(e,t,i){var n;!function(){"use strict";var r=function(){this.init()};r.prototype={init:function(){var e=this||s;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||s;if(e=parseFloat(e),t.ctx||d(),"undefined"!==typeof e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,s.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),r=0;r<n.length;r++){var a=t._howls[i]._soundById(n[r]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||s;t.ctx||d(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,s.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),r=0;r<n.length;r++){var a=t._howls[i]._soundById(n[r]);a&&a._node&&(a._node.muted=!!e||a._muted)}return t},stop:function(){for(var e=this||s,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||s,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&"undefined"!==typeof e.ctx.close&&(e.ctx.close(),e.ctx=null,d()),e},codecs:function(e){return(this||s)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||s;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!==typeof Audio)try{"undefined"===typeof(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(t){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||s,t=null;try{t="undefined"!==typeof Audio?new Audio:null}catch(h){return e}if(!t||"function"!==typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator?e._navigator.userAgent:"",r=n.match(/OPR\/([0-6].)/g),a=r&&parseInt(r[0].split("/")[1],10)<33,o=-1!==n.indexOf("Safari")&&-1===n.indexOf("Chrome"),l=n.match(/Version\/(.*?) /),u=o&&l&&parseInt(l[1],10)<15;return e._codecs={mp3:!(a||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(u||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(u||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||s;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function t(i){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,e._releaseHtml5Audio(n)}catch(i){e.noAudio=!0;break}for(var r=0;r<e._howls.length;r++)if(!e._howls[r]._webAudio)for(var s=e._howls[r]._getSoundIds(),a=0;a<s.length;a++){var o=e._howls[r]._soundById(s[a]);o&&o._node&&!o._node._unlocked&&(o._node._unlocked=!0,o._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),"undefined"===typeof l.start?l.noteOn(0):l.start(0),"function"===typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||s;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!==typeof Promise&&(t instanceof Promise||"function"===typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||s;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&"undefined"!==typeof e.ctx.suspend&&s.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&"undefined"!==typeof e.ctx.resume&&s.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var s=new r,a=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return s.ctx||d(),t._autoplay=e.autoplay||!1,t._format="string"!==typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!==typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!==typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=s.usingWebAudio&&!t._html5,"undefined"!==typeof s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(s.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"===typeof e._src&&(e._src=[e._src]);for(var i=0;i<e._src.length;i++){var n,r;if(e._format&&e._format[i])n=e._format[i];else{if("string"!==typeof(r=e._src[i])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(r))||(n=/\.([^.]+)$/.exec(r.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&s.codecs(n)){t=e._src[i];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&u(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var i=this,n=null;if("number"===typeof e)n=e,e=null;else{if("string"===typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if("undefined"===typeof e&&(e="__default",!i._playLock)){for(var r=0,a=0;a<i._sounds.length;a++)i._sounds[a]._paused&&!i._sounds[a]._ended&&(r++,n=i._sounds[a]._id);1===r?e=null:n=null}}var o=n?i._soundById(n):i._inactiveSound();if(!o)return null;if(n&&!e&&(e=o._sprite||"__default"),"loaded"!==i._state){o._sprite=e,o._ended=!1;var l=o._id;return i._queue.push({event:"play",action:function(){i.play(l)}}),l}if(n&&!o._paused)return t||i._loadQueue("play"),o._id;i._webAudio&&s._autoResume();var u=Math.max(0,o._seek>0?o._seek:i._sprite[e][0]/1e3),h=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-u),c=1e3*h/Math.abs(o._rate),f=i._sprite[e][0]/1e3,d=(i._sprite[e][0]+i._sprite[e][1])/1e3;o._sprite=e,o._ended=!1;var m=function(){o._paused=!1,o._seek=u,o._start=f,o._stop=d,o._loop=!(!o._loop&&!i._sprite[e][2])};if(!(u>=d)){var _=o._node;if(i._webAudio){var p=function(){i._playLock=!1,m(),i._refreshBuffer(o);var e=o._muted||i._muted?0:o._volume;_.gain.setValueAtTime(e,s.ctx.currentTime),o._playStart=s.ctx.currentTime,"undefined"===typeof _.bufferSource.start?o._loop?_.bufferSource.noteGrainOn(0,u,86400):_.bufferSource.noteGrainOn(0,u,h):o._loop?_.bufferSource.start(0,u,86400):_.bufferSource.start(0,u,h),c!==1/0&&(i._endTimers[o._id]=setTimeout(i._ended.bind(i,o),c)),t||setTimeout((function(){i._emit("play",o._id),i._loadQueue()}),0)};"running"===s.state&&"interrupted"!==s.ctx.state?p():(i._playLock=!0,i.once("resume",p),i._clearTimer(o._id))}else{var v=function(){_.currentTime=u,_.muted=o._muted||i._muted||s._muted||_.muted,_.volume=o._volume*s.volume(),_.playbackRate=o._rate;try{var n=_.play();if(n&&"undefined"!==typeof Promise&&(n instanceof Promise||"function"===typeof n.then)?(i._playLock=!0,m(),n.then((function(){i._playLock=!1,_._unlocked=!0,t?i._loadQueue():i._emit("play",o._id)})).catch((function(){i._playLock=!1,i._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),o._ended=!0,o._paused=!0}))):t||(i._playLock=!1,m(),i._emit("play",o._id)),_.playbackRate=o._rate,_.paused)return void i._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||o._loop?i._endTimers[o._id]=setTimeout(i._ended.bind(i,o),c):(i._endTimers[o._id]=function(){i._ended(o),_.removeEventListener("ended",i._endTimers[o._id],!1)},_.addEventListener("ended",i._endTimers[o._id],!1))}catch(r){i._emit("playerror",o._id,r)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===_.src&&(_.src=i._src,_.load());var y=window&&window.ejecta||!_.readyState&&s._navigator.isCocoonJS;if(_.readyState>=3||y)v();else{i._playLock=!0,i._state="loading";_.addEventListener(s._canPlayEvent,(function e(){i._state="loaded",v(),_.removeEventListener(s._canPlayEvent,e,!1)}),!1),i._clearTimer(o._id)}}return o._id}i._ended(o)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),n=0;n<i.length;n++){t._clearTimer(i[n]);var r=t._soundById(i[n]);if(r&&!r._paused&&(r._seek=t.seek(i[n]),r._rateSeek=0,r._paused=!0,t._stopFade(i[n]),r._node))if(t._webAudio){if(!r._node.bufferSource)continue;"undefined"===typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),t._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||t._emit("pause",r?r._id:null)}return t},stop:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var n=i._getSoundIds(e),r=0;r<n.length;r++){i._clearTimer(n[r]);var s=i._soundById(n[r]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,i._stopFade(n[r]),s._node&&(i._webAudio?s._node.bufferSource&&("undefined"===typeof s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),i._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&i._clearSound(s._node))),t||i._emit("stop",s._id))}return i},mute:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if("undefined"===typeof t){if("boolean"!==typeof e)return i._muted;i._muted=e}for(var n=i._getSoundIds(t),r=0;r<n.length;r++){var a=i._soundById(n[r]);a&&(a._muted=e,a._interval&&i._stopFade(a._id),i._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,s.ctx.currentTime):a._node&&(a._node.muted=!!s._muted||e),i._emit("mute",a._id))}return i},volume:function(){var e,t,i,n=this,r=arguments;if(0===r.length)return n._volume;if(1===r.length||2===r.length&&"undefined"===typeof r[1]){var a=n._getSoundIds(),o=a.indexOf(r[0]);o>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(!("undefined"!==typeof e&&e>=0&&e<=1))return(i=t?n._soundById(t):n._sounds[0])?i._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,r)}}),n;"undefined"===typeof t&&(n._volume=e),t=n._getSoundIds(t);for(var l=0;l<t.length;l++)(i=n._soundById(t[l]))&&(i._volume=e,r[2]||n._stopFade(t[l]),n._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,s.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*s.volume()),n._emit("volume",i._id));return n},fade:function(e,t,i,n){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(e,t,i,n)}}),r;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),i=parseFloat(i),r.volume(e,n);for(var a=r._getSoundIds(n),o=0;o<a.length;o++){var l=r._soundById(a[o]);if(l){if(n||r._stopFade(a[o]),r._webAudio&&!l._muted){var u=s.ctx.currentTime,h=u+i/1e3;l._volume=e,l._node.gain.setValueAtTime(e,u),l._node.gain.linearRampToValueAtTime(t,h)}r._startFadeInterval(l,e,t,i,a[o],"undefined"===typeof n)}}return r},_startFadeInterval:function(e,t,i,n,r,s){var a=this,o=t,l=i-t,u=Math.abs(l/.01),h=Math.max(4,u>0?n/u:n),c=Date.now();e._fadeTo=i,e._interval=setInterval((function(){var r=(Date.now()-c)/n;c=Date.now(),o+=l*r,o=Math.round(100*o)/100,o=l<0?Math.max(i,o):Math.min(i,o),a._webAudio?e._volume=o:a.volume(o,e._id,!0),s&&(a._volume=o),(i<t&&o<=i||i>t&&o>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,a.volume(i,e._id),a._emit("fade",e._id))}),h)},_stopFade:function(e){var t=this,i=t._soundById(e);return i&&i._interval&&(t._webAudio&&i._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(i._interval),i._interval=null,t.volume(i._fadeTo,e),i._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,i,n=this,r=arguments;if(0===r.length)return n._loop;if(1===r.length){if("boolean"!==typeof r[0])return!!(i=n._soundById(parseInt(r[0],10)))&&i._loop;e=r[0],n._loop=e}else 2===r.length&&(e=r[0],t=parseInt(r[1],10));for(var s=n._getSoundIds(t),a=0;a<s.length;a++)(i=n._soundById(s[a]))&&(i._loop=e,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=e,e&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop,n.playing(s[a])&&(n.pause(s[a],!0),n.play(s[a],!0)))));return n},rate:function(){var e,t,i,n=this,r=arguments;if(0===r.length)t=n._sounds[0]._id;else if(1===r.length){var a=n._getSoundIds(),o=a.indexOf(r[0]);o>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if("number"!==typeof e)return(i=n._soundById(t))?i._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,r)}}),n;"undefined"===typeof t&&(n._rate=e),t=n._getSoundIds(t);for(var l=0;l<t.length;l++)if(i=n._soundById(t[l])){n.playing(t[l])&&(i._rateSeek=n.seek(t[l]),i._playStart=n._webAudio?s.ctx.currentTime:i._playStart),i._rate=e,n._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,s.ctx.currentTime):i._node&&(i._node.playbackRate=e);var u=n.seek(t[l]),h=(n._sprite[i._sprite][0]+n._sprite[i._sprite][1])/1e3-u,c=1e3*h/Math.abs(i._rate);!n._endTimers[t[l]]&&i._paused||(n._clearTimer(t[l]),n._endTimers[t[l]]=setTimeout(n._ended.bind(n,i),c)),n._emit("rate",i._id)}return n},seek:function(){var e,t,i=this,n=arguments;if(0===n.length)i._sounds.length&&(t=i._sounds[0]._id);else if(1===n.length){var r=i._getSoundIds(),a=r.indexOf(n[0]);a>=0?t=parseInt(n[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(n[0]))}else 2===n.length&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if("undefined"===typeof t)return 0;if("number"===typeof e&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,n)}}),i;var o=i._soundById(t);if(o){if(!("number"===typeof e&&e>=0)){if(i._webAudio){var l=i.playing(t)?s.ctx.currentTime-o._playStart:0,u=o._rateSeek?o._rateSeek-o._seek:0;return o._seek+(u+l*Math.abs(o._rate))}return o._node.currentTime}var h=i.playing(t);h&&i.pause(t,!0),o._seek=e,o._ended=!1,i._clearTimer(t),i._webAudio||!o._node||isNaN(o._node.duration)||(o._node.currentTime=e);var c=function(){h&&i.play(t,!0),i._emit("seek",t)};if(h&&!i._webAudio){var f=function e(){i._playLock?setTimeout(e,0):c()};setTimeout(f,0)}else c()}return i},playing:function(e){var t=this;if("number"===typeof e){var i=t._soundById(e);return!!i&&!i._paused}for(var n=0;n<t._sounds.length;n++)if(!t._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this,i=t._duration,n=t._soundById(e);return n&&(i=t._sprite[n._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(s._canPlayEvent,t[i]._loadFn,!1),t[i]._node.removeEventListener("ended",t[i]._endFn,!1),s._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var n=s._howls.indexOf(e);n>=0&&s._howls.splice(n,1);var r=!0;for(i=0;i<s._howls.length;i++)if(s._howls[i]._src===e._src||e._src.indexOf(s._howls[i]._src)>=0){r=!1;break}return l&&r&&delete l[e._src],s.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,n){var r=this["_on"+e];return"function"===typeof t&&r.push(n?{id:i,fn:t,once:n}:{id:i,fn:t}),this},off:function(e,t,i){var n=this,r=n["_on"+e],s=0;if("number"===typeof t&&(i=t,t=null),t||i)for(s=0;s<r.length;s++){var a=i===r[s].id;if(t===r[s].fn&&a||!t&&a){r.splice(s,1);break}}else if(e)n["_on"+e]=[];else{var o=Object.keys(n);for(s=0;s<o.length;s++)0===o[s].indexOf("_on")&&Array.isArray(n[o[s]])&&(n[o[s]]=[])}return n},once:function(e,t,i){return this.on(e,t,i,1),this},_emit:function(e,t,i){for(var n=this,r=n["_on"+e],s=r.length-1;s>=0;s--)r[s].id&&r[s].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(n,r[s].fn),0),r[s].once&&n.off(e,r[s].fn,r[s].id));return n._loadQueue(e),n},_loadQueue:function(e){var t=this;if(t._queue.length>0){var i=t._queue[0];i.event===e&&(t._queue.shift(),t._loadQueue()),e||i.action()}return t},_ended:function(e){var t=this,i=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var n=!(!e._loop&&!t._sprite[i][2]);if(t._emit("end",e._id),!t._webAudio&&n&&t.stop(e._id,!0).play(e._id),t._webAudio&&n){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=s.ctx.currentTime;var r=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),r)}return t._webAudio&&!n&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),s._autoSuspend()),t._webAudio||n||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!==typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var i=t._soundById(e);i&&i._node&&i._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,i=0;i<t._sounds.length;i++)if(e===t._sounds[i]._id)return t._sounds[i];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new o(e)},_drain:function(){var e=this,t=e._pool,i=0,n=0;if(!(e._sounds.length<t)){for(n=0;n<e._sounds.length;n++)e._sounds[n]._ended&&i++;for(n=e._sounds.length-1;n>=0;n--){if(i<=t)return;e._sounds[n]._ended&&(e._webAudio&&e._sounds[n]._node&&e._sounds[n]._node.disconnect(0),e._sounds.splice(n,1),i--)}}},_getSoundIds:function(e){if("undefined"===typeof e){for(var t=[],i=0;i<this._sounds.length;i++)t.push(this._sounds[i]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=s.ctx.createBufferSource(),e._node.bufferSource.buffer=l[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,s.ctx.currentTime),this},_cleanBuffer:function(e){var t=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(s._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=s._scratchBuffer}catch(i){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++s._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,i=s._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node="undefined"===typeof s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),e._node.gain.setValueAtTime(i,s.ctx.currentTime),e._node.paused=!0,e._node.connect(s.masterGain)):s.noAudio||(e._node=s._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(s._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=i*s.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++s._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(s._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var l={},u=function(e){var t=e._src;if(l[t])return e._duration=l[t].duration,void f(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),n=new Uint8Array(i.length),r=0;r<i.length;++r)n[r]=i.charCodeAt(r);c(n.buffer,e)}else{var s=new XMLHttpRequest;s.open(e._xhr.method,t,!0),s.withCredentials=e._xhr.withCredentials,s.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){s.setRequestHeader(t,e._xhr.headers[t])})),s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?c(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete l[t],e.load())},h(s)}},h=function(e){try{e.send()}catch(t){e.onerror()}},c=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},n=function(e){e&&t._sounds.length>0?(l[t._src]=e,f(t,e)):i()};"undefined"!==typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(e).then(n).catch(i):s.ctx.decodeAudioData(e,n,i)},f=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},d=function(){if(s.usingWebAudio){try{"undefined"!==typeof AudioContext?s.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(r){s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),t=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var n=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!n&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain="undefined"===typeof s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};void 0===(n=function(){return{Howler:s,Howl:a}}.apply(t,[]))||(e.exports=n),t.Howler=s,t.Howl=a,"undefined"!==typeof i.g?(i.g.HowlerGlobal=r,i.g.Howler=s,i.g.Howl=a,i.g.Sound=o):"undefined"!==typeof window&&(window.HowlerGlobal=r,window.Howler=s,window.Howl=a,window.Sound=o)}(),function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var i=t._howls.length-1;i>=0;i--)t._howls[i].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,i){var n=this;return n.ctx&&n.ctx.listener?(t="number"!==typeof t?n._pos[1]:t,i="number"!==typeof i?n._pos[2]:i,"number"!==typeof e?n._pos:(n._pos=[e,t,i],"undefined"!==typeof n.ctx.listener.positionX?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(e,t,i,n,r,s){var a=this;if(!a.ctx||!a.ctx.listener)return a;var o=a._orientation;return t="number"!==typeof t?o[1]:t,i="number"!==typeof i?o[2]:i,n="number"!==typeof n?o[3]:n,r="number"!==typeof r?o[4]:r,s="number"!==typeof s?o[5]:s,"number"!==typeof e?o:(a._orientation=[e,t,i,n,r,s],"undefined"!==typeof a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(e,t,i,n,r,s),a)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var i=this;return i._orientation=t.orientation||[1,0,0],i._stereo=t.stereo||null,i._pos=t.pos||null,i._pannerAttr={coneInnerAngle:"undefined"!==typeof t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:"undefined"!==typeof t.coneOuterGain?t.coneOuterGain:0,distanceModel:"undefined"!==typeof t.distanceModel?t.distanceModel:"inverse",maxDistance:"undefined"!==typeof t.maxDistance?t.maxDistance:1e4,panningModel:"undefined"!==typeof t.panningModel?t.panningModel:"HRTF",refDistance:"undefined"!==typeof t.refDistance?t.refDistance:1,rolloffFactor:"undefined"!==typeof t.rolloffFactor?t.rolloffFactor:1},i._onstereo=t.onstereo?[{fn:t.onstereo}]:[],i._onpos=t.onpos?[{fn:t.onpos}]:[],i._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,i)}}),n;var r="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof i){if("number"!==typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var s=n._getSoundIds(i),a=0;a<s.length;a++){var o=n._soundById(s[a]);if(o){if("number"!==typeof e)return o._stereo;o._stereo=e,o._pos=[e,0,0],o._node&&(o._pannerAttr.panningModel="equalpower",o._panner&&o._panner.pan||t(o,r),"spatial"===r?"undefined"!==typeof o._panner.positionX?(o._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),o._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),o._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):o._panner.setPosition(e,0,0):o._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",o._id)}}return n},Howl.prototype.pos=function(e,i,n,r){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(e,i,n,r)}}),s;if(i="number"!==typeof i?0:i,n="number"!==typeof n?-.5:n,"undefined"===typeof r){if("number"!==typeof e)return s._pos;s._pos=[e,i,n]}for(var a=s._getSoundIds(r),o=0;o<a.length;o++){var l=s._soundById(a[o]);if(l){if("number"!==typeof e)return l._pos;l._pos=[e,i,n],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),"undefined"!==typeof l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setPosition(e,i,n)),s._emit("pos",l._id)}}return s},Howl.prototype.orientation=function(e,i,n,r){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(e,i,n,r)}}),s;if(i="number"!==typeof i?s._orientation[1]:i,n="number"!==typeof n?s._orientation[2]:n,"undefined"===typeof r){if("number"!==typeof e)return s._orientation;s._orientation=[e,i,n]}for(var a=s._getSoundIds(r),o=0;o<a.length;o++){var l=s._soundById(a[o]);if(l){if("number"!==typeof e)return l._orientation;l._orientation=[e,i,n],l._node&&(l._panner||(l._pos||(l._pos=s._pos||[0,0,-.5]),t(l,"spatial")),"undefined"!==typeof l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setOrientation(e,i,n)),s._emit("orientation",l._id)}}return s},Howl.prototype.pannerAttr=function(){var e,i,n,r=this,s=arguments;if(!r._webAudio)return r;if(0===s.length)return r._pannerAttr;if(1===s.length){if("object"!==typeof s[0])return(n=r._soundById(parseInt(s[0],10)))?n._pannerAttr:r._pannerAttr;e=s[0],"undefined"===typeof i&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),r._pannerAttr={coneInnerAngle:"undefined"!==typeof e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:"undefined"!==typeof e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:"undefined"!==typeof e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:"undefined"!==typeof e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:r._distanceModel,maxDistance:"undefined"!==typeof e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:r._maxDistance,refDistance:"undefined"!==typeof e.pannerAttr.refDistance?e.pannerAttr.refDistance:r._refDistance,rolloffFactor:"undefined"!==typeof e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:"undefined"!==typeof e.pannerAttr.panningModel?e.pannerAttr.panningModel:r._panningModel})}else 2===s.length&&(e=s[0],i=parseInt(s[1],10));for(var a=r._getSoundIds(i),o=0;o<a.length;o++)if(n=r._soundById(a[o])){var l=n._pannerAttr;l={coneInnerAngle:"undefined"!==typeof e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:"undefined"!==typeof e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:"undefined"!==typeof e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:"undefined"!==typeof e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:"undefined"!==typeof e.maxDistance?e.maxDistance:l.maxDistance,refDistance:"undefined"!==typeof e.refDistance?e.refDistance:l.refDistance,rolloffFactor:"undefined"!==typeof e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:"undefined"!==typeof e.panningModel?e.panningModel:l.panningModel};var u=n._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel):(n._pos||(n._pos=r._pos||[0,0,-.5]),t(n,"spatial"))}return r},Sound.prototype.init=function(e){return function(){var t=this,i=t._parent;t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,e.call(this),t._stereo?i.stereo(t._stereo):t._pos&&i.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,i=t._parent;return t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,t._stereo?i.stereo(t._stereo):t._pos?i.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,i._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,"undefined"!==typeof e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),"undefined"!==typeof e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()},534:function(e,t,i){"use strict";var n=i(7313),r=i(2224);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var h=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),c=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},m={};function _(e,t,i,n,r,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var p={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){p[e]=new _(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];p[t]=new _(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){p[e]=new _(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){p[e]=new _(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){p[e]=new _(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){p[e]=new _(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){p[e]=new _(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){p[e]=new _(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){p[e]=new _(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function g(e,t,i,n){var r=p.hasOwnProperty(t)?p[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,n){if(null===t||"undefined"===typeof t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,r,n)&&(i=null),n||null===r?function(e){return!!c.call(m,e)||!c.call(d,e)&&(f.test(e)?m[e]=!0:(d[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);p[t]=new _(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);p[t]=new _(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);p[t]=new _(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){p[e]=new _(e,1,!1,e.toLowerCase(),null,!1,!1)})),p.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){p[e]=new _(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),k=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var E=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var F,G=Object.assign;function D(e){if(void 0===F)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var O=!1;function N(e,t){if(!e||O)return"";O=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&"string"===typeof u.stack){for(var r=u.stack.split("\n"),s=n.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{O=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?D(e):""}function z(e){switch(e.tag){case 5:return D(e.type);case 16:return D("Lazy");case 13:return D("Suspense");case 19:return D("SuspenseList");case 0:case 2:case 15:return e=N(e.type,!1);case 11:return e=N(e.type.render,!1);case 1:return e=N(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case A:return"Fragment";case w:return"Portal";case M:return"Profiler";case S:return"StrictMode";case V:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case B:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case L:t=e._payload,e=e._init;try{return U(e(t))}catch(i){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=q(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var i=t.checked;return G({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function Z(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=W(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&g(e,"checked",t,!1)}function K(e,t){Q(e,t);var i=W(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,i):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function ee(e,t,i){"number"===t&&J(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var te=Array.isArray;function ie(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+W(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return G({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(s(92));if(te(i)){if(1<i.length)throw Error(s(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:W(i)}}function se(e,t){var i=W(t.value),n=W(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,he,ce=(he=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction((function(){return he(e,t)}))}:he);function fe(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function _e(e,t,i){return null==t||"boolean"===typeof t||""===t?"":i||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function pe(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=_e(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}Object.keys(de).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var ve=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ge(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ae=null,Se=null;function Me(e){if(e=gr(e)){if("function"!==typeof we)throw Error(s(280));var t=e.stateNode;t&&(t=br(t),we(e.stateNode,e.type,t))}}function Ce(e){Ae?Se?Se.push(e):Se=[e]:Ae=e}function ke(){if(Ae){var e=Ae,t=Se;if(Se=Ae=null,Me(e),t)for(e=0;e<t.length;e++)Me(t[e])}}function Be(e,t){return e(t)}function Ve(){}var Te=!1;function Pe(e,t,i){if(Te)return e(t,i);Te=!0;try{return Be(e,t,i)}finally{Te=!1,(null!==Ae||null!==Se)&&(Ve(),ke())}}function Le(e,t){var i=e.stateNode;if(null===i)return null;var n=br(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(s(231,t,typeof i));return i}var Ee=!1;if(h)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){Ee=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(he){Ee=!1}function Re(e,t,i,n,r,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(i,u)}catch(h){this.onError(h)}}var Fe=!1,Ge=null,De=!1,Oe=null,Ne={onError:function(e){Fe=!0,Ge=e}};function ze(e,t,i,n,r,s,a,o,l){Fe=!1,Ge=null,Re.apply(Ne,arguments)}function Ue(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ue(e)!==e)throw Error(s(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(s(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(n=r.return)){i=n;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===i)return We(r),e;if(a===n)return We(r),t;a=a.sibling}throw Error(s(188))}if(i.return!==n.return)i=r,n=a;else{for(var o=!1,l=r.child;l;){if(l===i){o=!0,i=r,n=a;break}if(l===n){o=!0,n=r,i=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===i){o=!0,i=a,n=r;break}if(l===n){o=!0,n=a,i=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(i.alternate!==n)throw Error(s(190))}if(3!==i.tag)throw Error(s(188));return i.stateNode.current===i?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Xe=r.unstable_scheduleCallback,Je=r.unstable_cancelCallback,Ye=r.unstable_shouldYield,Ze=r.unstable_requestPaint,Qe=r.unstable_now,Ke=r.unstable_getCurrentPriorityLevel,$e=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,it=r.unstable_LowPriority,nt=r.unstable_IdlePriority,rt=null,st=null;var at=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ut=64,ht=4194304;function ct(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var i=e.pendingLanes;if(0===i)return 0;var n=0,r=e.suspendedLanes,s=e.pingedLanes,a=268435455&i;if(0!==a){var o=a&~r;0!==o?n=ct(o):0!==(s&=a)&&(n=ct(s))}else 0!==(a=i&~r)?n=ct(a):0!==s&&(n=ct(s));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&r)&&((r=n&-n)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&n)&&(n|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(i=31-at(t)),n|=e[i],t&=~r;return n}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function _t(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function pt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function vt(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=i}function yt(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-at(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var gt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,wt,At,St,Mt,Ct=!1,kt=[],Bt=null,Vt=null,Tt=null,Pt=new Map,Lt=new Map,Et=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":Bt=null;break;case"dragenter":case"dragleave":Vt=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lt.delete(t.pointerId)}}function Ft(e,t,i,n,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=gr(t))&&wt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Gt(e){var t=yr(e.target);if(null!==t){var i=Ue(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=je(i)))return e.blockedOn=t,void Mt(e.priority,(function(){At(i)}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Dt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=gr(i))&&wt(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);xe=n,i.target.dispatchEvent(n),xe=null,t.shift()}return!0}function Ot(e,t,i){Dt(e)&&i.delete(t)}function Nt(){Ct=!1,null!==Bt&&Dt(Bt)&&(Bt=null),null!==Vt&&Dt(Vt)&&(Vt=null),null!==Tt&&Dt(Tt)&&(Tt=null),Pt.forEach(Ot),Lt.forEach(Ot)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Nt)))}function Ut(e){function t(t){return zt(t,e)}if(0<kt.length){zt(kt[0],e);for(var i=1;i<kt.length;i++){var n=kt[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Bt&&zt(Bt,e),null!==Vt&&zt(Vt,e),null!==Tt&&zt(Tt,e),Pt.forEach(t),Lt.forEach(t),i=0;i<Et.length;i++)(n=Et[i]).blockedOn===e&&(n.blockedOn=null);for(;0<Et.length&&null===(i=Et[0]).blockedOn;)Gt(i),null===i.blockedOn&&Et.shift()}var jt=x.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,i,n){var r=gt,s=jt.transition;jt.transition=null;try{gt=1,Xt(e,t,i,n)}finally{gt=r,jt.transition=s}}function Ht(e,t,i,n){var r=gt,s=jt.transition;jt.transition=null;try{gt=4,Xt(e,t,i,n)}finally{gt=r,jt.transition=s}}function Xt(e,t,i,n){if(Wt){var r=Yt(e,t,i,n);if(null===r)Wn(e,t,n,Jt,i),Rt(e,n);else if(function(e,t,i,n,r){switch(t){case"focusin":return Bt=Ft(Bt,e,t,i,n,r),!0;case"dragenter":return Vt=Ft(Vt,e,t,i,n,r),!0;case"mouseover":return Tt=Ft(Tt,e,t,i,n,r),!0;case"pointerover":var s=r.pointerId;return Pt.set(s,Ft(Pt.get(s)||null,e,t,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Lt.set(s,Ft(Lt.get(s)||null,e,t,i,n,r)),!0}return!1}(r,e,t,i,n))n.stopPropagation();else if(Rt(e,n),4&t&&-1<It.indexOf(e)){for(;null!==r;){var s=gr(r);if(null!==s&&bt(s),null===(s=Yt(e,t,i,n))&&Wn(e,t,n,Jt,i),s===r)break;r=s}null!==r&&n.stopPropagation()}else Wn(e,t,n,null,i)}}var Jt=null;function Yt(e,t,i,n){if(Jt=null,null!==(e=yr(e=be(n))))if(null===(t=Ue(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=je(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ke()){case $e:return 1;case et:return 4;case tt:case it:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Qt=null,Kt=null,$t=null;function ei(){if($t)return $t;var e,t,i=Kt,n=i.length,r="value"in Qt?Qt.value:Qt.textContent,s=r.length;for(e=0;e<n&&i[e]===r[e];e++);var a=n-e;for(t=1;t<=a&&i[n-t]===r[s-t];t++);return $t=r.slice(e,1<t?1-t:void 0)}function ti(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ii(){return!0}function ni(){return!1}function ri(e){function t(t,i,n,r,s){for(var a in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ii:ni,this.isPropagationStopped=ni,this}return G(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),t}var si,ai,oi,li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ui=ri(li),hi=G({},li,{view:0,detail:0}),ci=ri(hi),fi=G({},hi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Si,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==oi&&(oi&&"mousemove"===e.type?(si=e.screenX-oi.screenX,ai=e.screenY-oi.screenY):ai=si=0,oi=e),si)},movementY:function(e){return"movementY"in e?e.movementY:ai}}),di=ri(fi),mi=ri(G({},fi,{dataTransfer:0})),_i=ri(G({},hi,{relatedTarget:0})),pi=ri(G({},li,{animationName:0,elapsedTime:0,pseudoElement:0})),vi=G({},li,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yi=ri(vi),gi=ri(G({},li,{data:0})),xi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ai(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wi[e])&&!!t[e]}function Si(){return Ai}var Mi=G({},hi,{key:function(e){if(e.key){var t=xi[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ti(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Si,charCode:function(e){return"keypress"===e.type?ti(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ti(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ci=ri(Mi),ki=ri(G({},fi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Bi=ri(G({},hi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Si})),Vi=ri(G({},li,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ti=G({},fi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pi=ri(Ti),Li=[9,13,27,32],Ei=h&&"CompositionEvent"in window,Ii=null;h&&"documentMode"in document&&(Ii=document.documentMode);var Ri=h&&"TextEvent"in window&&!Ii,Fi=h&&(!Ei||Ii&&8<Ii&&11>=Ii),Gi=String.fromCharCode(32),Di=!1;function Oi(e,t){switch(e){case"keyup":return-1!==Li.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ni(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zi=!1;var Ui={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ji(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ui[e.type]:"textarea"===t}function Wi(e,t,i,n){Ce(n),0<(t=Hn(t,"onChange")).length&&(i=new ui("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var qi=null,Hi=null;function Xi(e){Dn(e,0)}function Ji(e){if(X(xr(e)))return e}function Yi(e,t){if("change"===e)return t}var Zi=!1;if(h){var Qi;if(h){var Ki="oninput"in document;if(!Ki){var $i=document.createElement("div");$i.setAttribute("oninput","return;"),Ki="function"===typeof $i.oninput}Qi=Ki}else Qi=!1;Zi=Qi&&(!document.documentMode||9<document.documentMode)}function en(){qi&&(qi.detachEvent("onpropertychange",tn),Hi=qi=null)}function tn(e){if("value"===e.propertyName&&Ji(Hi)){var t=[];Wi(t,Hi,e,be(e)),Pe(Xi,t)}}function nn(e,t,i){"focusin"===e?(en(),Hi=i,(qi=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function rn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ji(Hi)}function sn(e,t){if("click"===e)return Ji(t)}function an(e,t){if("input"===e||"change"===e)return Ji(t)}var on="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(on(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!c.call(t,r)||!on(e[r],t[r]))return!1}return!0}function un(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hn(e,t){var i,n=un(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=un(n)}}function cn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?cn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fn(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(n){i=!1}if(!i)break;t=J((e=t.contentWindow).document)}return t}function dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=fn(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&cn(i.ownerDocument.documentElement,i)){if(null!==n&&dn(i))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=i.textContent.length,s=Math.min(n.start,r);n=void 0===n.end?s:Math.min(n.end,r),!e.extend&&s>n&&(r=n,n=s,s=r),r=hn(i,s);var a=hn(i,n);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _n=h&&"documentMode"in document&&11>=document.documentMode,pn=null,vn=null,yn=null,gn=!1;function xn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;gn||null==pn||pn!==J(n)||("selectionStart"in(n=pn)&&dn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&ln(yn,n)||(yn=n,0<(n=Hn(vn,"onSelect")).length&&(t=new ui("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=pn)))}function bn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var wn={animationend:bn("Animation","AnimationEnd"),animationiteration:bn("Animation","AnimationIteration"),animationstart:bn("Animation","AnimationStart"),transitionend:bn("Transition","TransitionEnd")},An={},Sn={};function Mn(e){if(An[e])return An[e];if(!wn[e])return e;var t,i=wn[e];for(t in i)if(i.hasOwnProperty(t)&&t in Sn)return An[e]=i[t];return e}h&&(Sn=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var Cn=Mn("animationend"),kn=Mn("animationiteration"),Bn=Mn("animationstart"),Vn=Mn("transitionend"),Tn=new Map,Pn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ln(e,t){Tn.set(e,t),l(t,[e])}for(var En=0;En<Pn.length;En++){var In=Pn[En];Ln(In.toLowerCase(),"on"+(In[0].toUpperCase()+In.slice(1)))}Ln(Cn,"onAnimationEnd"),Ln(kn,"onAnimationIteration"),Ln(Bn,"onAnimationStart"),Ln("dblclick","onDoubleClick"),Ln("focusin","onFocus"),Ln("focusout","onBlur"),Ln(Vn,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rn));function Gn(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,r,a,o,l,u){if(ze.apply(this,arguments),Fe){if(!Fe)throw Error(s(198));var h=Ge;Fe=!1,Ge=null,De||(De=!0,Oe=h)}}(n,t,void 0,e),e.currentTarget=null}function Dn(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;Gn(r,o,u),s=l}else for(a=0;a<n.length;a++){if(l=(o=n[a]).instance,u=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;Gn(r,o,u),s=l}}}if(De)throw e=Oe,De=!1,Oe=null,e}function On(e,t){var i=t[_r];void 0===i&&(i=t[_r]=new Set);var n=e+"__bubble";i.has(n)||(jn(t,e,2,!1),i.add(n))}function Nn(e,t,i){var n=0;t&&(n|=4),jn(i,e,n,t)}var zn="_reactListening"+Math.random().toString(36).slice(2);function Un(e){if(!e[zn]){e[zn]=!0,a.forEach((function(t){"selectionchange"!==t&&(Fn.has(t)||Nn(t,!1,e),Nn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zn]||(t[zn]=!0,Nn("selectionchange",!1,t))}}function jn(e,t,i,n){switch(Zt(t)){case 1:var r=qt;break;case 4:r=Ht;break;default:r=Xt}i=r.bind(null,t,i,e),r=void 0,!Ee||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function Wn(e,t,i,n,r){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var o=n.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===a)for(a=n.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==o;){if(null===(a=yr(o)))return;if(5===(l=a.tag)||6===l){n=s=a;continue e}o=o.parentNode}}n=n.return}Pe((function(){var n=s,r=be(i),a=[];e:{var o=Tn.get(e);if(void 0!==o){var l=ui,u=e;switch(e){case"keypress":if(0===ti(i))break e;case"keydown":case"keyup":l=Ci;break;case"focusin":u="focus",l=_i;break;case"focusout":u="blur",l=_i;break;case"beforeblur":case"afterblur":l=_i;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=di;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Bi;break;case Cn:case kn:case Bn:l=pi;break;case Vn:l=Vi;break;case"scroll":l=ci;break;case"wheel":l=Pi;break;case"copy":case"cut":case"paste":l=yi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=ki}var h=0!==(4&t),c=!h&&"scroll"===e,f=h?null!==o?o+"Capture":null:o;h=[];for(var d,m=n;null!==m;){var _=(d=m).stateNode;if(5===d.tag&&null!==_&&(d=_,null!==f&&(null!=(_=Le(m,f))&&h.push(qn(m,_,d)))),c)break;m=m.return}0<h.length&&(o=new l(o,u,null,i,r),a.push({event:o,listeners:h}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||i===xe||!(u=i.relatedTarget||i.fromElement)||!yr(u)&&!u[mr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(u=(u=i.relatedTarget||i.toElement)?yr(u):null)&&(u!==(c=Ue(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=n),l!==u)){if(h=di,_="onMouseLeave",f="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(h=ki,_="onPointerLeave",f="onPointerEnter",m="pointer"),c=null==l?o:xr(l),d=null==u?o:xr(u),(o=new h(_,m+"leave",l,i,r)).target=c,o.relatedTarget=d,_=null,yr(r)===n&&((h=new h(f,m+"enter",u,i,r)).target=d,h.relatedTarget=c,_=h),c=_,l&&u)e:{for(f=u,m=0,d=h=l;d;d=Xn(d))m++;for(d=0,_=f;_;_=Xn(_))d++;for(;0<m-d;)h=Xn(h),m--;for(;0<d-m;)f=Xn(f),d--;for(;m--;){if(h===f||null!==f&&h===f.alternate)break e;h=Xn(h),f=Xn(f)}h=null}else h=null;null!==l&&Jn(a,o,l,h,!1),null!==u&&null!==c&&Jn(a,c,u,h,!0)}if("select"===(l=(o=n?xr(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var p=Yi;else if(ji(o))if(Zi)p=an;else{p=rn;var v=nn}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(p=sn);switch(p&&(p=p(e,n))?Wi(a,p,i,r):(v&&v(e,o,n),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=n?xr(n):window,e){case"focusin":(ji(v)||"true"===v.contentEditable)&&(pn=v,vn=n,yn=null);break;case"focusout":yn=vn=pn=null;break;case"mousedown":gn=!0;break;case"contextmenu":case"mouseup":case"dragend":gn=!1,xn(a,i,r);break;case"selectionchange":if(_n)break;case"keydown":case"keyup":xn(a,i,r)}var y;if(Ei)e:{switch(e){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else zi?Oi(e,i)&&(g="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(g="onCompositionStart");g&&(Fi&&"ko"!==i.locale&&(zi||"onCompositionStart"!==g?"onCompositionEnd"===g&&zi&&(y=ei()):(Kt="value"in(Qt=r)?Qt.value:Qt.textContent,zi=!0)),0<(v=Hn(n,g)).length&&(g=new gi(g,e,null,i,r),a.push({event:g,listeners:v}),y?g.data=y:null!==(y=Ni(i))&&(g.data=y))),(y=Ri?function(e,t){switch(e){case"compositionend":return Ni(t);case"keypress":return 32!==t.which?null:(Di=!0,Gi);case"textInput":return(e=t.data)===Gi&&Di?null:e;default:return null}}(e,i):function(e,t){if(zi)return"compositionend"===e||!Ei&&Oi(e,t)?(e=ei(),$t=Kt=Qt=null,zi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fi&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(n=Hn(n,"onBeforeInput")).length&&(r=new gi("onBeforeInput","beforeinput",null,i,r),a.push({event:r,listeners:n}),r.data=y))}Dn(a,t)}))}function qn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Hn(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Le(e,i))&&n.unshift(qn(e,s,r)),null!=(s=Le(e,t))&&n.push(qn(e,s,r))),e=e.return}return n}function Xn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jn(e,t,i,n,r){for(var s=t._reactName,a=[];null!==i&&i!==n;){var o=i,l=o.alternate,u=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==u&&(o=u,r?null!=(l=Le(i,s))&&a.unshift(qn(i,l,o)):r||null!=(l=Le(i,s))&&a.push(qn(i,l,o))),i=i.return}0!==a.length&&e.push({event:t,listeners:a})}var Yn=/\r\n?/g,Zn=/\u0000|\uFFFD/g;function Qn(e){return("string"===typeof e?e:""+e).replace(Yn,"\n").replace(Zn,"")}function Kn(e,t,i){if(t=Qn(t),Qn(e)!==t&&i)throw Error(s(425))}function $n(){}var er=null,tr=null;function ir(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var nr="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(or)}:nr;function or(e){setTimeout((function(){throw e}))}function lr(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&8===r.nodeType)if("/$"===(i=r.data)){if(0===n)return e.removeChild(r),void Ut(t);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=r}while(i);Ut(t)}function ur(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function hr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var cr=Math.random().toString(36).slice(2),fr="__reactFiber$"+cr,dr="__reactProps$"+cr,mr="__reactContainer$"+cr,_r="__reactEvents$"+cr,pr="__reactListeners$"+cr,vr="__reactHandles$"+cr;function yr(e){var t=e[fr];if(t)return t;for(var i=e.parentNode;i;){if(t=i[mr]||i[fr]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=hr(e);null!==e;){if(i=e[fr])return i;e=hr(e)}return t}i=(e=i).parentNode}return null}function gr(e){return!(e=e[fr]||e[mr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function br(e){return e[dr]||null}var wr=[],Ar=-1;function Sr(e){return{current:e}}function Mr(e){0>Ar||(e.current=wr[Ar],wr[Ar]=null,Ar--)}function Cr(e,t){Ar++,wr[Ar]=e.current,e.current=t}var kr={},Br=Sr(kr),Vr=Sr(!1),Tr=kr;function Pr(e,t){var i=e.type.contextTypes;if(!i)return kr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in i)s[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Lr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Er(){Mr(Vr),Mr(Br)}function Ir(e,t,i){if(Br.current!==kr)throw Error(s(168));Cr(Br,t),Cr(Vr,i)}function Rr(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in t))throw Error(s(108,j(e)||"Unknown",r));return G({},i,n)}function Fr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||kr,Tr=Br.current,Cr(Br,e),Cr(Vr,Vr.current),!0}function Gr(e,t,i){var n=e.stateNode;if(!n)throw Error(s(169));i?(e=Rr(e,t,Tr),n.__reactInternalMemoizedMergedChildContext=e,Mr(Vr),Mr(Br),Cr(Br,e)):Mr(Vr),Cr(Vr,i)}var Dr=null,Or=!1,Nr=!1;function zr(e){null===Dr?Dr=[e]:Dr.push(e)}function Ur(){if(!Nr&&null!==Dr){Nr=!0;var e=0,t=gt;try{var i=Dr;for(gt=1;e<i.length;e++){var n=i[e];do{n=n(!0)}while(null!==n)}Dr=null,Or=!1}catch(r){throw null!==Dr&&(Dr=Dr.slice(e+1)),Xe($e,Ur),r}finally{gt=t,Nr=!1}}return null}var jr=[],Wr=0,qr=null,Hr=0,Xr=[],Jr=0,Yr=null,Zr=1,Qr="";function Kr(e,t){jr[Wr++]=Hr,jr[Wr++]=qr,qr=e,Hr=t}function $r(e,t,i){Xr[Jr++]=Zr,Xr[Jr++]=Qr,Xr[Jr++]=Yr,Yr=e;var n=Zr;e=Qr;var r=32-at(n)-1;n&=~(1<<r),i+=1;var s=32-at(t)+r;if(30<s){var a=r-r%5;s=(n&(1<<a)-1).toString(32),n>>=a,r-=a,Zr=1<<32-at(t)+r|i<<r|n,Qr=s+e}else Zr=1<<s|i<<r|n,Qr=e}function es(e){null!==e.return&&(Kr(e,1),$r(e,1,0))}function ts(e){for(;e===qr;)qr=jr[--Wr],jr[Wr]=null,Hr=jr[--Wr],jr[Wr]=null;for(;e===Yr;)Yr=Xr[--Jr],Xr[Jr]=null,Qr=Xr[--Jr],Xr[Jr]=null,Zr=Xr[--Jr],Xr[Jr]=null}var is=null,ns=null,rs=!1,ss=null;function as(e,t){var i=Pu(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function os(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,is=e,ns=ur(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,is=e,ns=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==Yr?{id:Zr,overflow:Qr}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=Pu(18,null,null,0)).stateNode=t,i.return=e,e.child=i,is=e,ns=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(rs){var t=ns;if(t){var i=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ur(i.nextSibling);var n=is;t&&os(e,t)?as(n,i):(e.flags=-4097&e.flags|2,rs=!1,is=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,is=e}}}function hs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;is=e}function cs(e){if(e!==is)return!1;if(!rs)return hs(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ir(e.type,e.memoizedProps)),t&&(t=ns)){if(ls(e))throw fs(),Error(s(418));for(;t;)as(e,t),t=ur(t.nextSibling)}if(hs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){ns=ur(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}ns=null}}else ns=is?ur(e.stateNode.nextSibling):null;return!0}function fs(){for(var e=ns;e;)e=ur(e.nextSibling)}function ds(){ns=is=null,rs=!1}function ms(e){null===ss?ss=[e]:ss.push(e)}var _s=x.ReactCurrentBatchConfig;function ps(e,t){if(e&&e.defaultProps){for(var i in t=G({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}var vs=Sr(null),ys=null,gs=null,xs=null;function bs(){xs=gs=ys=null}function ws(e){var t=vs.current;Mr(vs),e._currentValue=t}function As(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Ss(e,t){ys=e,xs=gs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xo=!0),e.firstContext=null)}function Ms(e){var t=e._currentValue;if(xs!==e)if(e={context:e,memoizedValue:t,next:null},null===gs){if(null===ys)throw Error(s(308));gs=e,ys.dependencies={lanes:0,firstContext:e}}else gs=gs.next=e;return t}var Cs=null;function ks(e){null===Cs?Cs=[e]:Cs.push(e)}function Bs(e,t,i,n){var r=t.interleaved;return null===r?(i.next=i,ks(t)):(i.next=r.next,r.next=i),t.interleaved=i,Vs(e,n)}function Vs(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var Ts=!1;function Ps(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Es(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Is(e,t,i){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Bl)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Vs(e,i)}return null===(r=n.interleaved)?(t.next=t,ks(n)):(t.next=r.next,r.next=t),n.interleaved=t,Vs(e,i)}function Rs(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,yt(e,i)}}function Fs(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,s=null;if(null!==(i=i.firstBaseUpdate)){do{var a={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===s?r=s=a:s=s.next=a,i=i.next}while(null!==i);null===s?r=s=t:s=s.next=t}else r=s=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Gs(e,t,i,n){var r=e.updateQueue;Ts=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,u=l.next;l.next=null,null===a?s=u:a.next=u,a=l;var h=e.alternate;null!==h&&((o=(h=h.updateQueue).lastBaseUpdate)!==a&&(null===o?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=l))}if(null!==s){var c=r.baseState;for(a=0,h=u=l=null,o=s;;){var f=o.lane,d=o.eventTime;if((n&f)===f){null!==h&&(h=h.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,_=o;switch(f=t,d=i,_.tag){case 1:if("function"===typeof(m=_.payload)){c=m.call(d,c,f);break e}c=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(f="function"===typeof(m=_.payload)?m.call(d,c,f):m)||void 0===f)break e;c=G({},c,f);break e;case 2:Ts=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(f=r.effects)?r.effects=[o]:f.push(o))}else d={eventTime:d,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===h?(u=h=d,l=c):h=h.next=d,a|=f;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(f=o).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}if(null===h&&(l=c),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=h,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Fl|=a,e.lanes=a,e.memoizedState=c}}function Ds(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!==typeof r)throw Error(s(191,r));r.call(n)}}}var Os=(new n.Component).refs;function Ns(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:G({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var zs={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=eu(),r=tu(e),s=Es(n,r);s.payload=t,void 0!==i&&null!==i&&(s.callback=i),null!==(t=Is(e,s,r))&&(iu(t,e,r,n),Rs(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=eu(),r=tu(e),s=Es(n,r);s.tag=1,s.payload=t,void 0!==i&&null!==i&&(s.callback=i),null!==(t=Is(e,s,r))&&(iu(t,e,r,n),Rs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=eu(),n=tu(e),r=Es(i,n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Is(e,r,n))&&(iu(t,e,n,i),Rs(t,e,n))}};function Us(e,t,i,n,r,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!ln(i,n)||!ln(r,s))}function js(e,t,i){var n=!1,r=kr,s=t.contextType;return"object"===typeof s&&null!==s?s=Ms(s):(r=Lr(t)?Tr:Br.current,s=(n=null!==(n=t.contextTypes)&&void 0!==n)?Pr(e,r):kr),t=new t(i,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=zs,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ws(e,t,i,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&zs.enqueueReplaceState(t,t.state,null)}function qs(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs=Os,Ps(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ms(s):(s=Lr(t)?Tr:Br.current,r.context=Pr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(Ns(e,t,s,i),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&zs.enqueueReplaceState(r,r.state,null),Gs(e,i,r,n),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function Hs(e,t,i){if(null!==(e=i.ref)&&"function"!==typeof e&&"object"!==typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(s(309));var n=i.stateNode}if(!n)throw Error(s(147,e));var r=n,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;t===Os&&(t=r.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!i._owner)throw Error(s(290,e))}return e}function Xs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Js(e){return(0,e._init)(e._payload)}function Ys(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Eu(e,t)).index=0,e.sibling=null,e}function a(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=2,i):n:(t.flags|=2,i):(t.flags|=1048576,i)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,i,n){return null===t||6!==t.tag?((t=Gu(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function u(e,t,i,n){var s=i.type;return s===A?c(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===L&&Js(s)===t.type)?((n=r(t,i.props)).ref=Hs(e,t,i),n.return=e,n):((n=Iu(i.type,i.key,i.props,null,e.mode,n)).ref=Hs(e,t,i),n.return=e,n)}function h(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Du(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function c(e,t,i,n,s){return null===t||7!==t.tag?((t=Ru(i,e.mode,n,s)).return=e,t):((t=r(t,i)).return=e,t)}function f(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Gu(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(i=Iu(t.type,t.key,t.props,null,e.mode,i)).ref=Hs(e,null,t),i.return=e,i;case w:return(t=Du(t,e.mode,i)).return=e,t;case L:return f(e,(0,t._init)(t._payload),i)}if(te(t)||R(t))return(t=Ru(t,e.mode,i,null)).return=e,t;Xs(e,t)}return null}function d(e,t,i,n){var r=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==r?null:l(e,t,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case b:return i.key===r?u(e,t,i,n):null;case w:return i.key===r?h(e,t,i,n):null;case L:return d(e,t,(r=i._init)(i._payload),n)}if(te(i)||R(i))return null!==r?null:c(e,t,i,n,null);Xs(e,i)}return null}function m(e,t,i,n,r){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(i)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return u(t,e=e.get(null===n.key?i:n.key)||null,n,r);case w:return h(t,e=e.get(null===n.key?i:n.key)||null,n,r);case L:return m(e,t,i,(0,n._init)(n._payload),r)}if(te(n)||R(n))return c(t,e=e.get(i)||null,n,r,null);Xs(t,n)}return null}function _(r,s,o,l){for(var u=null,h=null,c=s,_=s=0,p=null;null!==c&&_<o.length;_++){c.index>_?(p=c,c=null):p=c.sibling;var v=d(r,c,o[_],l);if(null===v){null===c&&(c=p);break}e&&c&&null===v.alternate&&t(r,c),s=a(v,s,_),null===h?u=v:h.sibling=v,h=v,c=p}if(_===o.length)return i(r,c),rs&&Kr(r,_),u;if(null===c){for(;_<o.length;_++)null!==(c=f(r,o[_],l))&&(s=a(c,s,_),null===h?u=c:h.sibling=c,h=c);return rs&&Kr(r,_),u}for(c=n(r,c);_<o.length;_++)null!==(p=m(c,r,_,o[_],l))&&(e&&null!==p.alternate&&c.delete(null===p.key?_:p.key),s=a(p,s,_),null===h?u=p:h.sibling=p,h=p);return e&&c.forEach((function(e){return t(r,e)})),rs&&Kr(r,_),u}function p(r,o,l,u){var h=R(l);if("function"!==typeof h)throw Error(s(150));if(null==(l=h.call(l)))throw Error(s(151));for(var c=h=null,_=o,p=o=0,v=null,y=l.next();null!==_&&!y.done;p++,y=l.next()){_.index>p?(v=_,_=null):v=_.sibling;var g=d(r,_,y.value,u);if(null===g){null===_&&(_=v);break}e&&_&&null===g.alternate&&t(r,_),o=a(g,o,p),null===c?h=g:c.sibling=g,c=g,_=v}if(y.done)return i(r,_),rs&&Kr(r,p),h;if(null===_){for(;!y.done;p++,y=l.next())null!==(y=f(r,y.value,u))&&(o=a(y,o,p),null===c?h=y:c.sibling=y,c=y);return rs&&Kr(r,p),h}for(_=n(r,_);!y.done;p++,y=l.next())null!==(y=m(_,r,p,y.value,u))&&(e&&null!==y.alternate&&_.delete(null===y.key?p:y.key),o=a(y,o,p),null===c?h=y:c.sibling=y,c=y);return e&&_.forEach((function(e){return t(r,e)})),rs&&Kr(r,p),h}return function e(n,s,a,l){if("object"===typeof a&&null!==a&&a.type===A&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case b:e:{for(var u=a.key,h=s;null!==h;){if(h.key===u){if((u=a.type)===A){if(7===h.tag){i(n,h.sibling),(s=r(h,a.props.children)).return=n,n=s;break e}}else if(h.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===L&&Js(u)===h.type){i(n,h.sibling),(s=r(h,a.props)).ref=Hs(n,h,a),s.return=n,n=s;break e}i(n,h);break}t(n,h),h=h.sibling}a.type===A?((s=Ru(a.props.children,n.mode,l,a.key)).return=n,n=s):((l=Iu(a.type,a.key,a.props,null,n.mode,l)).ref=Hs(n,s,a),l.return=n,n=l)}return o(n);case w:e:{for(h=a.key;null!==s;){if(s.key===h){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){i(n,s.sibling),(s=r(s,a.children||[])).return=n,n=s;break e}i(n,s);break}t(n,s),s=s.sibling}(s=Du(a,n.mode,l)).return=n,n=s}return o(n);case L:return e(n,s,(h=a._init)(a._payload),l)}if(te(a))return _(n,s,a,l);if(R(a))return p(n,s,a,l);Xs(n,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(i(n,s.sibling),(s=r(s,a)).return=n,n=s):(i(n,s),(s=Gu(a,n.mode,l)).return=n,n=s),o(n)):i(n,s)}}var Zs=Ys(!0),Qs=Ys(!1),Ks={},$s=Sr(Ks),ea=Sr(Ks),ta=Sr(Ks);function ia(e){if(e===Ks)throw Error(s(174));return e}function na(e,t){switch(Cr(ta,t),Cr(ea,e),Cr($s,Ks),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Mr($s),Cr($s,t)}function ra(){Mr($s),Mr(ea),Mr(ta)}function sa(e){ia(ta.current);var t=ia($s.current),i=le(t,e.type);t!==i&&(Cr(ea,e),Cr($s,i))}function aa(e){ea.current===e&&(Mr($s),Mr(ea))}var oa=Sr(0);function la(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ua=[];function ha(){for(var e=0;e<ua.length;e++)ua[e]._workInProgressVersionPrimary=null;ua.length=0}var ca=x.ReactCurrentDispatcher,fa=x.ReactCurrentBatchConfig,da=0,ma=null,_a=null,pa=null,va=!1,ya=!1,ga=0,xa=0;function ba(){throw Error(s(321))}function wa(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!on(e[i],t[i]))return!1;return!0}function Aa(e,t,i,n,r,a){if(da=a,ma=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ca.current=null===e||null===e.memoizedState?ao:oo,e=i(n,r),ya){a=0;do{if(ya=!1,ga=0,25<=a)throw Error(s(301));a+=1,pa=_a=null,t.updateQueue=null,ca.current=lo,e=i(n,r)}while(ya)}if(ca.current=so,t=null!==_a&&null!==_a.next,da=0,pa=_a=ma=null,va=!1,t)throw Error(s(300));return e}function Sa(){var e=0!==ga;return ga=0,e}function Ma(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===pa?ma.memoizedState=pa=e:pa=pa.next=e,pa}function Ca(){if(null===_a){var e=ma.alternate;e=null!==e?e.memoizedState:null}else e=_a.next;var t=null===pa?ma.memoizedState:pa.next;if(null!==t)pa=t,_a=e;else{if(null===e)throw Error(s(310));e={memoizedState:(_a=e).memoizedState,baseState:_a.baseState,baseQueue:_a.baseQueue,queue:_a.queue,next:null},null===pa?ma.memoizedState=pa=e:pa=pa.next=e}return pa}function ka(e,t){return"function"===typeof t?t(e):t}function Ba(e){var t=Ca(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var n=_a,r=n.baseQueue,a=i.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}n.baseQueue=r=a,i.pending=null}if(null!==r){a=r.next,n=n.baseState;var l=o=null,u=null,h=a;do{var c=h.lane;if((da&c)===c)null!==u&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),n=h.hasEagerState?h.eagerState:e(n,h.action);else{var f={lane:c,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};null===u?(l=u=f,o=n):u=u.next=f,ma.lanes|=c,Fl|=c}h=h.next}while(null!==h&&h!==a);null===u?o=n:u.next=l,on(n,t.memoizedState)||(xo=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,i.lastRenderedState=n}if(null!==(e=i.interleaved)){r=e;do{a=r.lane,ma.lanes|=a,Fl|=a,r=r.next}while(r!==e)}else null===r&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Va(e){var t=Ca(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,a=t.memoizedState;if(null!==r){i.pending=null;var o=r=r.next;do{a=e(a,o.action),o=o.next}while(o!==r);on(a,t.memoizedState)||(xo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),i.lastRenderedState=a}return[a,n]}function Ta(){}function Pa(e,t){var i=ma,n=Ca(),r=t(),a=!on(n.memoizedState,r);if(a&&(n.memoizedState=r,xo=!0),n=n.queue,ja(Ia.bind(null,i,n,e),[e]),n.getSnapshot!==t||a||null!==pa&&1&pa.memoizedState.tag){if(i.flags|=2048,Da(9,Ea.bind(null,i,n,r,t),void 0,null),null===Vl)throw Error(s(349));0!==(30&da)||La(i,t,r)}return r}function La(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=ma.updateQueue)?(t={lastEffect:null,stores:null},ma.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function Ea(e,t,i,n){t.value=i,t.getSnapshot=n,Ra(t)&&Fa(e)}function Ia(e,t,i){return i((function(){Ra(t)&&Fa(e)}))}function Ra(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!on(e,i)}catch(n){return!0}}function Fa(e){var t=Vs(e,1);null!==t&&iu(t,e,1,-1)}function Ga(e){var t=Ma();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,ma,e),[t.memoizedState,e]}function Da(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=ma.updateQueue)?(t={lastEffect:null,stores:null},ma.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function Oa(){return Ca().memoizedState}function Na(e,t,i,n){var r=Ma();ma.flags|=e,r.memoizedState=Da(1|t,i,void 0,void 0===n?null:n)}function za(e,t,i,n){var r=Ca();n=void 0===n?null:n;var s=void 0;if(null!==_a){var a=_a.memoizedState;if(s=a.destroy,null!==n&&wa(n,a.deps))return void(r.memoizedState=Da(t,i,s,n))}ma.flags|=e,r.memoizedState=Da(1|t,i,s,n)}function Ua(e,t){return Na(8390656,8,e,t)}function ja(e,t){return za(2048,8,e,t)}function Wa(e,t){return za(4,2,e,t)}function qa(e,t){return za(4,4,e,t)}function Ha(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xa(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,za(4,4,Ha.bind(null,t,e),i)}function Ja(){}function Ya(e,t){var i=Ca();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&wa(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Za(e,t){var i=Ca();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&wa(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function Qa(e,t,i){return 0===(21&da)?(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=i):(on(i,t)||(i=_t(),ma.lanes|=i,Fl|=i,e.baseState=!0),t)}function Ka(e,t){var i=gt;gt=0!==i&&4>i?i:4,e(!0);var n=fa.transition;fa.transition={};try{e(!1),t()}finally{gt=i,fa.transition=n}}function $a(){return Ca().memoizedState}function eo(e,t,i){var n=tu(e);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},io(e))no(t,i);else if(null!==(i=Bs(e,t,i,n))){iu(i,e,n,eu()),ro(i,t,n)}}function to(e,t,i){var n=tu(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(io(e))no(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,i);if(r.hasEagerState=!0,r.eagerState=o,on(o,a)){var l=t.interleaved;return null===l?(r.next=r,ks(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(u){}null!==(i=Bs(e,t,r,n))&&(iu(i,e,n,r=eu()),ro(i,t,n))}}function io(e){var t=e.alternate;return e===ma||null!==t&&t===ma}function no(e,t){ya=va=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function ro(e,t,i){if(0!==(4194240&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,yt(e,i)}}var so={readContext:Ms,useCallback:ba,useContext:ba,useEffect:ba,useImperativeHandle:ba,useInsertionEffect:ba,useLayoutEffect:ba,useMemo:ba,useReducer:ba,useRef:ba,useState:ba,useDebugValue:ba,useDeferredValue:ba,useTransition:ba,useMutableSource:ba,useSyncExternalStore:ba,useId:ba,unstable_isNewReconciler:!1},ao={readContext:Ms,useCallback:function(e,t){return Ma().memoizedState=[e,void 0===t?null:t],e},useContext:Ms,useEffect:Ua,useImperativeHandle:function(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Na(4194308,4,Ha.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Na(4194308,4,e,t)},useInsertionEffect:function(e,t){return Na(4,2,e,t)},useMemo:function(e,t){var i=Ma();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=Ma();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=eo.bind(null,ma,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Ma().memoizedState=e},useState:Ga,useDebugValue:Ja,useDeferredValue:function(e){return Ma().memoizedState=e},useTransition:function(){var e=Ga(!1),t=e[0];return e=Ka.bind(null,e[1]),Ma().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=ma,r=Ma();if(rs){if(void 0===i)throw Error(s(407));i=i()}else{if(i=t(),null===Vl)throw Error(s(349));0!==(30&da)||La(n,t,i)}r.memoizedState=i;var a={value:i,getSnapshot:t};return r.queue=a,Ua(Ia.bind(null,n,a,e),[e]),n.flags|=2048,Da(9,Ea.bind(null,n,a,i,t),void 0,null),i},useId:function(){var e=Ma(),t=Vl.identifierPrefix;if(rs){var i=Qr;t=":"+t+"R"+(i=(Zr&~(1<<32-at(Zr)-1)).toString(32)+i),0<(i=ga++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=xa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Ms,useCallback:Ya,useContext:Ms,useEffect:ja,useImperativeHandle:Xa,useInsertionEffect:Wa,useLayoutEffect:qa,useMemo:Za,useReducer:Ba,useRef:Oa,useState:function(){return Ba(ka)},useDebugValue:Ja,useDeferredValue:function(e){return Qa(Ca(),_a.memoizedState,e)},useTransition:function(){return[Ba(ka)[0],Ca().memoizedState]},useMutableSource:Ta,useSyncExternalStore:Pa,useId:$a,unstable_isNewReconciler:!1},lo={readContext:Ms,useCallback:Ya,useContext:Ms,useEffect:ja,useImperativeHandle:Xa,useInsertionEffect:Wa,useLayoutEffect:qa,useMemo:Za,useReducer:Va,useRef:Oa,useState:function(){return Va(ka)},useDebugValue:Ja,useDeferredValue:function(e){var t=Ca();return null===_a?t.memoizedState=e:Qa(t,_a.memoizedState,e)},useTransition:function(){return[Va(ka)[0],Ca().memoizedState]},useMutableSource:Ta,useSyncExternalStore:Pa,useId:$a,unstable_isNewReconciler:!1};function uo(e,t){try{var i="",n=t;do{i+=z(n),n=n.return}while(n);var r=i}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ho(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function co(e,t){try{console.error(t.value)}catch(i){setTimeout((function(){throw i}))}}var fo="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,i){(i=Es(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Wl||(Wl=!0,ql=n),co(0,t)},i}function _o(e,t,i){(i=Es(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){co(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(i.callback=function(){co(0,t),"function"!==typeof n&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function po(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new fo;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=Mu.bind(null,e,t,i),t.then(e,e))}function vo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,i,n,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=Es(-1,1)).tag=2,Is(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var go=x.ReactCurrentOwner,xo=!1;function bo(e,t,i,n){t.child=null===e?Qs(t,null,i,n):Zs(t,e.child,i,n)}function wo(e,t,i,n,r){i=i.render;var s=t.ref;return Ss(t,r),n=Aa(e,t,i,n,s,r),i=Sa(),null===e||xo?(rs&&i&&es(t),t.flags|=1,bo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function Ao(e,t,i,n,r){if(null===e){var s=i.type;return"function"!==typeof s||Lu(s)||void 0!==s.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=Iu(i.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,So(e,t,s,n,r))}if(s=e.child,0===(e.lanes&r)){var a=s.memoizedProps;if((i=null!==(i=i.compare)?i:ln)(a,n)&&e.ref===t.ref)return Wo(e,t,r)}return t.flags|=1,(e=Eu(s,n)).ref=t.ref,e.return=t,t.child=e}function So(e,t,i,n,r){if(null!==e){var s=e.memoizedProps;if(ln(s,n)&&e.ref===t.ref){if(xo=!1,t.pendingProps=n=s,0===(e.lanes&r))return t.lanes=e.lanes,Wo(e,t,r);0!==(131072&e.flags)&&(xo=!0)}}return ko(e,t,i,n,r)}function Mo(e,t,i){var n=t.pendingProps,r=n.children,s=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(El,Ll),Ll|=i;else{if(0===(1073741824&i))return e=null!==s?s.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cr(El,Ll),Ll|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==s?s.baseLanes:i,Cr(El,Ll),Ll|=n}else null!==s?(n=s.baseLanes|i,t.memoizedState=null):n=i,Cr(El,Ll),Ll|=n;return bo(e,t,r,i),t.child}function Co(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function ko(e,t,i,n,r){var s=Lr(i)?Tr:Br.current;return s=Pr(t,s),Ss(t,r),i=Aa(e,t,i,n,s,r),n=Sa(),null===e||xo?(rs&&n&&es(t),t.flags|=1,bo(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function Bo(e,t,i,n,r){if(Lr(i)){var s=!0;Fr(t)}else s=!1;if(Ss(t,r),null===t.stateNode)jo(e,t),js(t,i,n),qs(t,i,n,r),n=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=i.contextType;"object"===typeof u&&null!==u?u=Ms(u):u=Pr(t,u=Lr(i)?Tr:Br.current);var h=i.getDerivedStateFromProps,c="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate;c||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==n||l!==u)&&Ws(t,a,n,u),Ts=!1;var f=t.memoizedState;a.state=f,Gs(t,n,a,r),l=t.memoizedState,o!==n||f!==l||Vr.current||Ts?("function"===typeof h&&(Ns(t,i,h,n),l=t.memoizedState),(o=Ts||Us(t,i,o,n,f,l,u))?(c||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,Ls(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ps(t.type,o),a.props=u,c=t.pendingProps,f=a.context,"object"===typeof(l=i.contextType)&&null!==l?l=Ms(l):l=Pr(t,l=Lr(i)?Tr:Br.current);var d=i.getDerivedStateFromProps;(h="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==c||f!==l)&&Ws(t,a,n,l),Ts=!1,f=t.memoizedState,a.state=f,Gs(t,n,a,r);var m=t.memoizedState;o!==c||f!==m||Vr.current||Ts?("function"===typeof d&&(Ns(t,i,d,n),m=t.memoizedState),(u=Ts||Us(t,i,u,n,f,m,l)||!1)?(h||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,m,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,m,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),a.props=n,a.state=m,a.context=l,n=u):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Vo(e,t,i,n,s,r)}function Vo(e,t,i,n,r,s){Co(e,t);var a=0!==(128&t.flags);if(!n&&!a)return r&&Gr(t,i,!1),Wo(e,t,s);n=t.stateNode,go.current=t;var o=a&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=Zs(t,e.child,null,s),t.child=Zs(t,null,o,s)):bo(e,t,o,s),t.memoizedState=n.state,r&&Gr(t,i,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Ir(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ir(0,t.context,!1),na(e,t.containerInfo)}function Po(e,t,i,n,r){return ds(),ms(r),t.flags|=256,bo(e,t,i,n),t.child}var Lo,Eo,Io,Ro={dehydrated:null,treeContext:null,retryLane:0};function Fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Go(e,t,i){var n,r=t.pendingProps,a=oa.current,o=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&a)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Cr(oa,1&a),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Fu(l,r,0,null),e=Ru(e,r,i,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Fo(i),t.memoizedState=Ro,e):Do(t,l));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated))return function(e,t,i,n,r,a,o){if(i)return 256&t.flags?(t.flags&=-257,Oo(e,t,o,n=ho(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=n.fallback,r=t.mode,n=Fu({mode:"visible",children:n.children},r,0,null),(a=Ru(a,r,o,null)).flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,0!==(1&t.mode)&&Zs(t,e.child,null,o),t.child.memoizedState=Fo(o),t.memoizedState=Ro,a);if(0===(1&t.mode))return Oo(e,t,o,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var l=n.dgst;return n=l,Oo(e,t,o,n=ho(a=Error(s(419)),n,void 0))}if(l=0!==(o&e.childLanes),xo||l){if(null!==(n=Vl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|o))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Vs(e,r),iu(n,e,r,-1))}return _u(),Oo(e,t,o,n=ho(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=ku.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,ns=ur(r.nextSibling),is=t,rs=!0,ss=null,null!==e&&(Xr[Jr++]=Zr,Xr[Jr++]=Qr,Xr[Jr++]=Yr,Zr=e.id,Qr=e.overflow,Yr=t),(t=Do(t,n.children)).flags|=4096,t)}(e,t,l,r,n,a,i);if(o){o=r.fallback,l=t.mode,n=(a=e.child).sibling;var u={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==a?((r=t.child).childLanes=0,r.pendingProps=u,t.deletions=null):(r=Eu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==n?o=Eu(n,o):(o=Ru(o,l,i,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Fo(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~i,t.memoizedState=Ro,r}return e=(o=e.child).sibling,r=Eu(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=i),r.return=t,r.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r,t.memoizedState=null,r}function Do(e,t){return(t=Fu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Oo(e,t,i,n){return null!==n&&ms(n),Zs(t,e.child,null,i),(e=Do(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function No(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),As(e.return,t,i)}function zo(e,t,i,n,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r)}function Uo(e,t,i){var n=t.pendingProps,r=n.revealOrder,s=n.tail;if(bo(e,t,n.children,i),0!==(2&(n=oa.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&No(e,i,t);else if(19===e.tag)No(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Cr(oa,n),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===la(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),zo(t,!1,r,i,s);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===la(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}zo(t,!0,i,null,s);break;case"together":zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function jo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(i=Eu(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Eu(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function qo(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ho(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function Xo(e,t,i){var n=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ho(t),null;case 1:case 17:return Lr(t.type)&&Er(),Ho(t),null;case 3:return n=t.stateNode,ra(),Mr(Vr),Mr(Br),ha(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(cs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(au(ss),ss=null))),Ho(t),null;case 5:aa(t);var r=ia(ta.current);if(i=t.type,null!==e&&null!=t.stateNode)Eo(e,t,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(s(166));return Ho(t),null}if(e=ia($s.current),cs(t)){n=t.stateNode,i=t.type;var a=t.memoizedProps;switch(n[fr]=t,n[dr]=a,e=0!==(1&t.mode),i){case"dialog":On("cancel",n),On("close",n);break;case"iframe":case"object":case"embed":On("load",n);break;case"video":case"audio":for(r=0;r<Rn.length;r++)On(Rn[r],n);break;case"source":On("error",n);break;case"img":case"image":case"link":On("error",n),On("load",n);break;case"details":On("toggle",n);break;case"input":Z(n,a),On("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},On("invalid",n);break;case"textarea":re(n,a),On("invalid",n)}for(var l in ye(i,a),r=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?n.textContent!==u&&(!0!==a.suppressHydrationWarning&&Kn(n.textContent,u,e),r=["children",u]):"number"===typeof u&&n.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Kn(n.textContent,u,e),r=["children",""+u]):o.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&On("scroll",n)}switch(i){case"input":H(n),$(n,a,!0);break;case"textarea":H(n),ae(n);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(n.onclick=$n)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(i,{is:n.is}):(e=l.createElement(i),"select"===i&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,i),e[fr]=t,e[dr]=n,Lo(e,t),t.stateNode=e;e:{switch(l=ge(i,n),i){case"dialog":On("cancel",e),On("close",e),r=n;break;case"iframe":case"object":case"embed":On("load",e),r=n;break;case"video":case"audio":for(r=0;r<Rn.length;r++)On(Rn[r],e);r=n;break;case"source":On("error",e),r=n;break;case"img":case"image":case"link":On("error",e),On("load",e),r=n;break;case"details":On("toggle",e),r=n;break;case"input":Z(e,n),r=Y(e,n),On("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=G({},n,{value:void 0}),On("invalid",e);break;case"textarea":re(e,n),r=ne(e,n),On("invalid",e)}for(a in ye(i,r),u=r)if(u.hasOwnProperty(a)){var h=u[a];"style"===a?pe(e,h):"dangerouslySetInnerHTML"===a?null!=(h=h?h.__html:void 0)&&ce(e,h):"children"===a?"string"===typeof h?("textarea"!==i||""!==h)&&fe(e,h):"number"===typeof h&&fe(e,""+h):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=h&&"onScroll"===a&&On("scroll",e):null!=h&&g(e,a,h,l))}switch(i){case"input":H(e),$(e,n,!1);break;case"textarea":H(e),ae(e);break;case"option":null!=n.value&&e.setAttribute("value",""+W(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?ie(e,!!n.multiple,a,!1):null!=n.defaultValue&&ie(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=$n)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ho(t),null;case 6:if(e&&null!=t.stateNode)Io(0,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(s(166));if(i=ia(ta.current),ia($s.current),cs(t)){if(n=t.stateNode,i=t.memoizedProps,n[fr]=t,(a=n.nodeValue!==i)&&null!==(e=is))switch(e.tag){case 3:Kn(n.nodeValue,i,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Kn(n.nodeValue,i,0!==(1&e.mode))}a&&(t.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[fr]=t,t.stateNode=n}return Ho(t),null;case 13:if(Mr(oa),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==ns&&0!==(1&t.mode)&&0===(128&t.flags))fs(),ds(),t.flags|=98560,a=!1;else if(a=cs(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[fr]=t}else ds(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ho(t),a=!1}else null!==ss&&(au(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=i,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&oa.current)?0===Il&&(Il=3):_u())),null!==t.updateQueue&&(t.flags|=4),Ho(t),null);case 4:return ra(),null===e&&Un(t.stateNode.containerInfo),Ho(t),null;case 10:return ws(t.type._context),Ho(t),null;case 19:if(Mr(oa),null===(a=t.memoizedState))return Ho(t),null;if(n=0!==(128&t.flags),null===(l=a.rendering))if(n)qo(a,!1);else{if(0!==Il||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=la(e))){for(t.flags|=128,qo(a,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;null!==i;)e=n,(a=i).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Cr(oa,1&oa.current|2),t.child}e=e.sibling}null!==a.tail&&Qe()>Ul&&(t.flags|=128,n=!0,qo(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=la(l))){if(t.flags|=128,n=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),qo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!rs)return Ho(t),null}else 2*Qe()-a.renderingStartTime>Ul&&1073741824!==i&&(t.flags|=128,n=!0,qo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(i=a.last)?i.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qe(),t.sibling=null,i=oa.current,Cr(oa,n?1&i|2:1&i),t):(Ho(t),null);case 22:case 23:return cu(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Ll)&&(Ho(t),6&t.subtreeFlags&&(t.flags|=8192)):Ho(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Jo(e,t){switch(ts(t),t.tag){case 1:return Lr(t.type)&&Er(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ra(),Mr(Vr),Mr(Br),ha(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return aa(t),null;case 13:if(Mr(oa),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ds()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Mr(oa),null;case 4:return ra(),null;case 10:return ws(t.type._context),null;case 22:case 23:return cu(),null;default:return null}}Lo=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Eo=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,ia($s.current);var s,a=null;switch(i){case"input":r=Y(e,r),n=Y(e,n),a=[];break;case"select":r=G({},r,{value:void 0}),n=G({},n,{value:void 0}),a=[];break;case"textarea":r=ne(e,r),n=ne(e,n),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof n.onClick&&(e.onclick=$n)}for(h in ye(i,n),i=null,r)if(!n.hasOwnProperty(h)&&r.hasOwnProperty(h)&&null!=r[h])if("style"===h){var l=r[h];for(s in l)l.hasOwnProperty(s)&&(i||(i={}),i[s]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(o.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in n){var u=n[h];if(l=null!=r?r[h]:void 0,n.hasOwnProperty(h)&&u!==l&&(null!=u||null!=l))if("style"===h)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(i||(i={}),i[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(i||(i={}),i[s]=u[s])}else i||(a||(a=[]),a.push(h,i)),i=u;else"dangerouslySetInnerHTML"===h?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(h,u)):"children"===h?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(h,""+u):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(o.hasOwnProperty(h)?(null!=u&&"onScroll"===h&&On("scroll",e),a||l===u||(a=[])):(a=a||[]).push(h,u))}i&&(a=a||[]).push("style",i);var h=a;(t.updateQueue=h)&&(t.flags|=4)}},Io=function(e,t,i,n){i!==n&&(t.flags|=4)};var Yo=!1,Zo=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Ko=null;function $o(e,t){var i=e.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(n){Su(e,t,n)}else i.current=null}function el(e,t,i){try{i()}catch(n){Su(e,t,n)}}var tl=!1;function il(e,t,i){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,i,s)}r=r.next}while(r!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function rl(e){var t=e.ref;if(null!==t){var i=e.stateNode;e.tag,e=i,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fr],delete t[dr],delete t[_r],delete t[pr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=$n));else if(4!==n&&null!==(e=e.child))for(ll(e,t,i),e=e.sibling;null!==e;)ll(e,t,i),e=e.sibling}function ul(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&null!==(e=e.child))for(ul(e,t,i),e=e.sibling;null!==e;)ul(e,t,i),e=e.sibling}var hl=null,cl=!1;function fl(e,t,i){for(i=i.child;null!==i;)dl(e,t,i),i=i.sibling}function dl(e,t,i){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,i)}catch(o){}switch(i.tag){case 5:Zo||$o(i,t);case 6:var n=hl,r=cl;hl=null,fl(e,t,i),cl=r,null!==(hl=n)&&(cl?(e=hl,i=i.stateNode,8===e.nodeType?e.parentNode.removeChild(i):e.removeChild(i)):hl.removeChild(i.stateNode));break;case 18:null!==hl&&(cl?(e=hl,i=i.stateNode,8===e.nodeType?lr(e.parentNode,i):1===e.nodeType&&lr(e,i),Ut(e)):lr(hl,i.stateNode));break;case 4:n=hl,r=cl,hl=i.stateNode.containerInfo,cl=!0,fl(e,t,i),hl=n,cl=r;break;case 0:case 11:case 14:case 15:if(!Zo&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var s=r,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&el(i,t,a),r=r.next}while(r!==n)}fl(e,t,i);break;case 1:if(!Zo&&($o(i,t),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(o){Su(i,t,o)}fl(e,t,i);break;case 21:fl(e,t,i);break;case 22:1&i.mode?(Zo=(n=Zo)||null!==i.memoizedState,fl(e,t,i),Zo=n):fl(e,t,i);break;default:fl(e,t,i)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new Qo),t.forEach((function(t){var n=Bu.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))}))}}function _l(e,t){var i=t.deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,cl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,cl=!0;break e}l=l.return}if(null===hl)throw Error(s(160));dl(a,o,r),hl=null,cl=!1;var u=r.alternate;null!==u&&(u.return=null),r.return=null}catch(h){Su(r,t,h)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}function pl(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_l(t,e),vl(e),4&n){try{il(3,e,e.return),nl(3,e)}catch(p){Su(e,e.return,p)}try{il(5,e,e.return)}catch(p){Su(e,e.return,p)}}break;case 1:_l(t,e),vl(e),512&n&&null!==i&&$o(i,i.return);break;case 5:if(_l(t,e),vl(e),512&n&&null!==i&&$o(i,i.return),32&e.flags){var r=e.stateNode;try{fe(r,"")}catch(p){Su(e,e.return,p)}}if(4&n&&null!=(r=e.stateNode)){var a=e.memoizedProps,o=null!==i?i.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&Q(r,a),ge(l,o);var h=ge(l,a);for(o=0;o<u.length;o+=2){var c=u[o],f=u[o+1];"style"===c?pe(r,f):"dangerouslySetInnerHTML"===c?ce(r,f):"children"===c?fe(r,f):g(r,c,f,h)}switch(l){case"input":K(r,a);break;case"textarea":se(r,a);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var m=a.value;null!=m?ie(r,!!a.multiple,m,!1):d!==!!a.multiple&&(null!=a.defaultValue?ie(r,!!a.multiple,a.defaultValue,!0):ie(r,!!a.multiple,a.multiple?[]:"",!1))}r[dr]=a}catch(p){Su(e,e.return,p)}}break;case 6:if(_l(t,e),vl(e),4&n){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(p){Su(e,e.return,p)}}break;case 3:if(_l(t,e),vl(e),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(p){Su(e,e.return,p)}break;case 4:default:_l(t,e),vl(e);break;case 13:_l(t,e),vl(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(zl=Qe())),4&n&&ml(e);break;case 22:if(c=null!==i&&null!==i.memoizedState,1&e.mode?(Zo=(h=Zo)||c,_l(t,e),Zo=h):_l(t,e),vl(e),8192&n){if(h=null!==e.memoizedState,(e.stateNode.isHidden=h)&&!c&&0!==(1&e.mode))for(Ko=e,c=e.child;null!==c;){for(f=Ko=c;null!==Ko;){switch(m=(d=Ko).child,d.tag){case 0:case 11:case 14:case 15:il(4,d,d.return);break;case 1:$o(d,d.return);var _=d.stateNode;if("function"===typeof _.componentWillUnmount){n=d,i=d.return;try{t=n,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(p){Su(n,i,p)}}break;case 5:$o(d,d.return);break;case 22:if(null!==d.memoizedState){bl(f);continue}}null!==m?(m.return=d,Ko=m):bl(f)}c=c.sibling}e:for(c=null,f=e;;){if(5===f.tag){if(null===c){c=f;try{r=f.stateNode,h?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=f.stateNode,o=void 0!==(u=f.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=_e("display",o))}catch(p){Su(e,e.return,p)}}}else if(6===f.tag){if(null===c)try{f.stateNode.nodeValue=h?"":f.memoizedProps}catch(p){Su(e,e.return,p)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:_l(t,e),vl(e),4&n&&ml(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(al(i)){var n=i;break e}i=i.return}throw Error(s(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(fe(r,""),n.flags&=-33),ul(e,ol(e),r);break;case 3:case 4:var a=n.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(o){Su(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,i){Ko=e,gl(e,t,i)}function gl(e,t,i){for(var n=0!==(1&e.mode);null!==Ko;){var r=Ko,s=r.child;if(22===r.tag&&n){var a=null!==r.memoizedState||Yo;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Zo;o=Yo;var u=Zo;if(Yo=a,(Zo=l)&&!u)for(Ko=r;null!==Ko;)l=(a=Ko).child,22===a.tag&&null!==a.memoizedState?wl(r):null!==l?(l.return=a,Ko=l):wl(r);for(;null!==s;)Ko=s,gl(s,t,i),s=s.sibling;Ko=r,Yo=o,Zo=u}xl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Ko=s):xl(e)}}function xl(e){for(;null!==Ko;){var t=Ko;if(0!==(8772&t.flags)){var i=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Zo||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Zo)if(null===i)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:ps(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Ds(t,a,n);break;case 3:var o=t.updateQueue;if(null!==o){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}Ds(t,o,i)}break;case 5:var l=t.stateNode;if(null===i&&4&t.flags){i=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&i.focus();break;case"img":u.src&&(i.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var h=t.alternate;if(null!==h){var c=h.memoizedState;if(null!==c){var f=c.dehydrated;null!==f&&Ut(f)}}}break;default:throw Error(s(163))}Zo||512&t.flags&&rl(t)}catch(d){Su(t,t.return,d)}}if(t===e){Ko=null;break}if(null!==(i=t.sibling)){i.return=t.return,Ko=i;break}Ko=t.return}}function bl(e){for(;null!==Ko;){var t=Ko;if(t===e){Ko=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Ko=i;break}Ko=t.return}}function wl(e){for(;null!==Ko;){var t=Ko;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{nl(4,t)}catch(l){Su(t,i,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(l){Su(t,r,l)}}var s=t.return;try{rl(t)}catch(l){Su(t,s,l)}break;case 5:var a=t.return;try{rl(t)}catch(l){Su(t,a,l)}}}catch(l){Su(t,t.return,l)}if(t===e){Ko=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Ko=o;break}Ko=t.return}}var Al,Sl=Math.ceil,Ml=x.ReactCurrentDispatcher,Cl=x.ReactCurrentOwner,kl=x.ReactCurrentBatchConfig,Bl=0,Vl=null,Tl=null,Pl=0,Ll=0,El=Sr(0),Il=0,Rl=null,Fl=0,Gl=0,Dl=0,Ol=null,Nl=null,zl=0,Ul=1/0,jl=null,Wl=!1,ql=null,Hl=null,Xl=!1,Jl=null,Yl=0,Zl=0,Ql=null,Kl=-1,$l=0;function eu(){return 0!==(6&Bl)?Qe():-1!==Kl?Kl:Kl=Qe()}function tu(e){return 0===(1&e.mode)?1:0!==(2&Bl)&&0!==Pl?Pl&-Pl:null!==_s.transition?(0===$l&&($l=_t()),$l):0!==(e=gt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function iu(e,t,i,n){if(50<Zl)throw Zl=0,Ql=null,Error(s(185));vt(e,i,n),0!==(2&Bl)&&e===Vl||(e===Vl&&(0===(2&Bl)&&(Gl|=i),4===Il&&ou(e,Pl)),nu(e,n),1===i&&0===Bl&&0===(1&t.mode)&&(Ul=Qe()+500,Or&&Ur()))}function nu(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=r[a];-1===l?0!==(o&i)&&0===(o&n)||(r[a]=dt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var n=ft(e,e===Vl?Pl:0);if(0===n)null!==i&&Je(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=i&&Je(i),1===t)0===e.tag?function(e){Or=!0,zr(e)}(lu.bind(null,e)):zr(lu.bind(null,e)),ar((function(){0===(6&Bl)&&Ur()})),i=null;else{switch(xt(n)){case 1:i=$e;break;case 4:i=et;break;case 16:default:i=tt;break;case 536870912:i=nt}i=Vu(i,ru.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function ru(e,t){if(Kl=-1,$l=0,0!==(6&Bl))throw Error(s(327));var i=e.callbackNode;if(wu()&&e.callbackNode!==i)return null;var n=ft(e,e===Vl?Pl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=pu(e,n);else{t=n;var r=Bl;Bl|=2;var a=mu();for(Vl===e&&Pl===t||(jl=null,Ul=Qe()+500,fu(e,t));;)try{yu();break}catch(l){du(e,l)}bs(),Ml.current=a,Bl=r,null!==Tl?t=0:(Vl=null,Pl=0,t=Il)}if(0!==t){if(2===t&&(0!==(r=mt(e))&&(n=r,t=su(e,r))),1===t)throw i=Rl,fu(e,0),ou(e,n),nu(e,Qe()),i;if(6===t)ou(e,n);else{if(r=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var r=i[n],s=r.getSnapshot;r=r.value;try{if(!on(s(),r))return!1}catch(o){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=pu(e,n))&&(0!==(a=mt(e))&&(n=a,t=su(e,a))),1===t))throw i=Rl,fu(e,0),ou(e,n),nu(e,Qe()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(s(345));case 2:case 5:bu(e,Nl,jl);break;case 3:if(ou(e,n),(130023424&n)===n&&10<(t=zl+500-Qe())){if(0!==ft(e,0))break;if(((r=e.suspendedLanes)&n)!==n){eu(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=nr(bu.bind(null,e,Nl,jl),t);break}bu(e,Nl,jl);break;case 4:if(ou(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var o=31-at(n);a=1<<o,(o=t[o])>r&&(r=o),n&=~a}if(n=r,10<(n=(120>(n=Qe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Sl(n/1960))-n)){e.timeoutHandle=nr(bu.bind(null,e,Nl,jl),n);break}bu(e,Nl,jl);break;default:throw Error(s(329))}}}return nu(e,Qe()),e.callbackNode===i?ru.bind(null,e):null}function su(e,t){var i=Ol;return e.current.memoizedState.isDehydrated&&(fu(e,t).flags|=256),2!==(e=pu(e,t))&&(t=Nl,Nl=i,null!==t&&au(t)),e}function au(e){null===Nl?Nl=e:Nl.push.apply(Nl,e)}function ou(e,t){for(t&=~Dl,t&=~Gl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-at(t),n=1<<i;e[i]=-1,t&=~n}}function lu(e){if(0!==(6&Bl))throw Error(s(327));wu();var t=ft(e,0);if(0===(1&t))return nu(e,Qe()),null;var i=pu(e,t);if(0!==e.tag&&2===i){var n=mt(e);0!==n&&(t=n,i=su(e,n))}if(1===i)throw i=Rl,fu(e,0),ou(e,t),nu(e,Qe()),i;if(6===i)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bu(e,Nl,jl),nu(e,Qe()),null}function uu(e,t){var i=Bl;Bl|=1;try{return e(t)}finally{0===(Bl=i)&&(Ul=Qe()+500,Or&&Ur())}}function hu(e){null!==Jl&&0===Jl.tag&&0===(6&Bl)&&wu();var t=Bl;Bl|=1;var i=kl.transition,n=gt;try{if(kl.transition=null,gt=1,e)return e()}finally{gt=n,kl.transition=i,0===(6&(Bl=t))&&Ur()}}function cu(){Ll=El.current,Mr(El)}function fu(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,rr(i)),null!==Tl)for(i=Tl.return;null!==i;){var n=i;switch(ts(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Er();break;case 3:ra(),Mr(Vr),Mr(Br),ha();break;case 5:aa(n);break;case 4:ra();break;case 13:case 19:Mr(oa);break;case 10:ws(n.type._context);break;case 22:case 23:cu()}i=i.return}if(Vl=e,Tl=e=Eu(e.current,null),Pl=Ll=t,Il=0,Rl=null,Dl=Gl=Fl=0,Nl=Ol=null,null!==Cs){for(t=0;t<Cs.length;t++)if(null!==(n=(i=Cs[t]).interleaved)){i.interleaved=null;var r=n.next,s=i.pending;if(null!==s){var a=s.next;s.next=r,n.next=a}i.pending=n}Cs=null}return e}function du(e,t){for(;;){var i=Tl;try{if(bs(),ca.current=so,va){for(var n=ma.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}va=!1}if(da=0,pa=_a=ma=null,ya=!1,ga=0,Cl.current=null,null===i||null===i.return){Il=1,Rl=t,Tl=null;break}e:{var a=e,o=i.return,l=i,u=t;if(t=Pl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var h=u,c=l,f=c.tag;if(0===(1&c.mode)&&(0===f||11===f||15===f)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=vo(o);if(null!==m){m.flags&=-257,yo(m,o,l,0,t),1&m.mode&&po(a,h,t),u=h;var _=(t=m).updateQueue;if(null===_){var p=new Set;p.add(u),t.updateQueue=p}else _.add(u);break e}if(0===(1&t)){po(a,h,t),_u();break e}u=Error(s(426))}else if(rs&&1&l.mode){var v=vo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),yo(v,o,l,0,t),ms(uo(u,l));break e}}a=u=uo(u,l),4!==Il&&(Il=2),null===Ol?Ol=[a]:Ol.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Fs(a,mo(0,u,t));break e;case 1:l=u;var y=a.type,g=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==g&&"function"===typeof g.componentDidCatch&&(null===Hl||!Hl.has(g)))){a.flags|=65536,t&=-t,a.lanes|=t,Fs(a,_o(a,l,t));break e}}a=a.return}while(null!==a)}xu(i)}catch(x){t=x,Tl===i&&null!==i&&(Tl=i=i.return);continue}break}}function mu(){var e=Ml.current;return Ml.current=so,null===e?so:e}function _u(){0!==Il&&3!==Il&&2!==Il||(Il=4),null===Vl||0===(268435455&Fl)&&0===(268435455&Gl)||ou(Vl,Pl)}function pu(e,t){var i=Bl;Bl|=2;var n=mu();for(Vl===e&&Pl===t||(jl=null,fu(e,t));;)try{vu();break}catch(r){du(e,r)}if(bs(),Bl=i,Ml.current=n,null!==Tl)throw Error(s(261));return Vl=null,Pl=0,Il}function vu(){for(;null!==Tl;)gu(Tl)}function yu(){for(;null!==Tl&&!Ye();)gu(Tl)}function gu(e){var t=Al(e.alternate,e,Ll);e.memoizedProps=e.pendingProps,null===t?xu(e):Tl=t,Cl.current=null}function xu(e){var t=e;do{var i=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(i=Xo(i,t,Ll)))return void(Tl=i)}else{if(null!==(i=Jo(i,t)))return i.flags&=32767,void(Tl=i);if(null===e)return Il=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Il&&(Il=5)}function bu(e,t,i){var n=gt,r=kl.transition;try{kl.transition=null,gt=1,function(e,t,i,n){do{wu()}while(null!==Jl);if(0!==(6&Bl))throw Error(s(327));i=e.finishedWork;var r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-at(i),s=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~s}}(e,a),e===Vl&&(Tl=Vl=null,Pl=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||Xl||(Xl=!0,Vu(tt,(function(){return wu(),null}))),a=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||a){a=kl.transition,kl.transition=null;var o=gt;gt=1;var l=Bl;Bl|=4,Cl.current=null,function(e,t){if(er=Wt,dn(e=fn())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{i.nodeType,a.nodeType}catch(b){i=null;break e}var o=0,l=-1,u=-1,h=0,c=0,f=e,d=null;t:for(;;){for(var m;f!==i||0!==r&&3!==f.nodeType||(l=o+r),f!==a||0!==n&&3!==f.nodeType||(u=o+n),3===f.nodeType&&(o+=f.nodeValue.length),null!==(m=f.firstChild);)d=f,f=m;for(;;){if(f===e)break t;if(d===i&&++h===r&&(l=o),d===a&&++c===n&&(u=o),null!==(m=f.nextSibling))break;d=(f=d).parentNode}f=m}i=-1===l||-1===u?null:{start:l,end:u}}else i=null}i=i||{start:0,end:0}}else i=null;for(tr={focusedElem:e,selectionRange:i},Wt=!1,Ko=t;null!==Ko;)if(e=(t=Ko).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ko=e;else for(;null!==Ko;){t=Ko;try{var _=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==_){var p=_.memoizedProps,v=_.memoizedState,y=t.stateNode,g=y.getSnapshotBeforeUpdate(t.elementType===t.type?p:ps(t.type,p),v);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(s(163))}}catch(b){Su(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Ko=e;break}Ko=t.return}_=tl,tl=!1}(e,i),pl(i,e),mn(tr),Wt=!!er,tr=er=null,e.current=i,yl(i,e,r),Ze(),Bl=l,gt=o,kl.transition=a}else e.current=i;if(Xl&&(Xl=!1,Jl=e,Yl=r),0===(a=e.pendingLanes)&&(Hl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),nu(e,Qe()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n((r=t[i]).value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=ql,ql=null,e;0!==(1&Yl)&&0!==e.tag&&wu(),0!==(1&(a=e.pendingLanes))?e===Ql?Zl++:(Zl=0,Ql=e):Zl=0,Ur()}(e,t,i,n)}finally{kl.transition=r,gt=n}return null}function wu(){if(null!==Jl){var e=xt(Yl),t=kl.transition,i=gt;try{if(kl.transition=null,gt=16>e?16:e,null===Jl)var n=!1;else{if(e=Jl,Jl=null,Yl=0,0!==(6&Bl))throw Error(s(331));var r=Bl;for(Bl|=4,Ko=e.current;null!==Ko;){var a=Ko,o=a.child;if(0!==(16&Ko.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var h=l[u];for(Ko=h;null!==Ko;){var c=Ko;switch(c.tag){case 0:case 11:case 15:il(8,c,a)}var f=c.child;if(null!==f)f.return=c,Ko=f;else for(;null!==Ko;){var d=(c=Ko).sibling,m=c.return;if(sl(c),c===h){Ko=null;break}if(null!==d){d.return=m,Ko=d;break}Ko=m}}}var _=a.alternate;if(null!==_){var p=_.child;if(null!==p){_.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(null!==p)}}Ko=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Ko=o;else e:for(;null!==Ko;){if(0!==(2048&(a=Ko).flags))switch(a.tag){case 0:case 11:case 15:il(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Ko=y;break e}Ko=a.return}}var g=e.current;for(Ko=g;null!==Ko;){var x=(o=Ko).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Ko=x;else e:for(o=g;null!==Ko;){if(0!==(2048&(l=Ko).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(w){Su(l,l.return,w)}if(l===o){Ko=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Ko=b;break e}Ko=l.return}}if(Bl=r,Ur(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(w){}n=!0}return n}finally{gt=i,kl.transition=t}}return!1}function Au(e,t,i){e=Is(e,t=mo(0,t=uo(i,t),1),1),t=eu(),null!==e&&(vt(e,1,t),nu(e,t))}function Su(e,t,i){if(3===e.tag)Au(e,e,i);else for(;null!==t;){if(3===t.tag){Au(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Hl||!Hl.has(n))){t=Is(t,e=_o(t,e=uo(i,e),1),1),e=eu(),null!==t&&(vt(t,1,e),nu(t,e));break}}t=t.return}}function Mu(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=eu(),e.pingedLanes|=e.suspendedLanes&i,Vl===e&&(Pl&i)===i&&(4===Il||3===Il&&(130023424&Pl)===Pl&&500>Qe()-zl?fu(e,0):Dl|=i),nu(e,t)}function Cu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ht,0===(130023424&(ht<<=1))&&(ht=4194304)));var i=eu();null!==(e=Vs(e,t))&&(vt(e,t,i),nu(e,i))}function ku(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),Cu(e,i)}function Bu(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(s(314))}null!==n&&n.delete(t),Cu(e,i)}function Vu(e,t){return Xe(e,t)}function Tu(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pu(e,t,i,n){return new Tu(e,t,i,n)}function Lu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Eu(e,t){var i=e.alternate;return null===i?((i=Pu(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Iu(e,t,i,n,r,a){var o=2;if(n=e,"function"===typeof e)Lu(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case A:return Ru(i.children,r,a,t);case S:o=8,r|=8;break;case M:return(e=Pu(12,i,t,2|r)).elementType=M,e.lanes=a,e;case V:return(e=Pu(13,i,t,r)).elementType=V,e.lanes=a,e;case T:return(e=Pu(19,i,t,r)).elementType=T,e.lanes=a,e;case E:return Fu(i,r,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case k:o=9;break e;case B:o=11;break e;case P:o=14;break e;case L:o=16,n=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Pu(o,i,t,r)).elementType=e,t.type=n,t.lanes=a,t}function Ru(e,t,i,n){return(e=Pu(7,e,n,t)).lanes=i,e}function Fu(e,t,i,n){return(e=Pu(22,e,n,t)).elementType=E,e.lanes=i,e.stateNode={isHidden:!1},e}function Gu(e,t,i){return(e=Pu(6,e,null,t)).lanes=i,e}function Du(e,t,i){return(t=Pu(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ou(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pt(0),this.expirationTimes=pt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Nu(e,t,i,n,r,s,a,o,l){return e=new Ou(e,t,i,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Pu(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ps(s),e}function zu(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}function Uu(e){if(!e)return kr;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Lr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var i=e.type;if(Lr(i))return Rr(e,i,t)}return t}function ju(e,t,i,n,r,s,a,o,l){return(e=Nu(i,n,!0,e,0,s,0,o,l)).context=Uu(null),i=e.current,(s=Es(n=eu(),r=tu(i))).callback=void 0!==t&&null!==t?t:null,Is(i,s,r),e.current.lanes=r,vt(e,r,n),nu(e,n),e}function Wu(e,t,i,n){var r=t.current,s=eu(),a=tu(r);return i=Uu(i),null===t.context?t.context=i:t.pendingContext=i,(t=Es(s,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Is(r,t,a))&&(iu(e,r,a,s),Rs(e,r,a)),a}function qu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function Xu(e,t){Hu(e,t),(e=e.alternate)&&Hu(e,t)}Al=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Vr.current)xo=!0;else{if(0===(e.lanes&i)&&0===(128&t.flags))return xo=!1,function(e,t,i){switch(t.tag){case 3:To(t),ds();break;case 5:sa(t);break;case 1:Lr(t.type)&&Fr(t);break;case 4:na(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Cr(vs,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Cr(oa,1&oa.current),t.flags|=128,null):0!==(i&t.child.childLanes)?Go(e,t,i):(Cr(oa,1&oa.current),null!==(e=Wo(e,t,i))?e.sibling:null);Cr(oa,1&oa.current);break;case 19:if(n=0!==(i&t.childLanes),0!==(128&e.flags)){if(n)return Uo(e,t,i);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr(oa,oa.current),n)break;return null;case 22:case 23:return t.lanes=0,Mo(e,t,i)}return Wo(e,t,i)}(e,t,i);xo=0!==(131072&e.flags)}else xo=!1,rs&&0!==(1048576&t.flags)&&$r(t,Hr,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;jo(e,t),e=t.pendingProps;var r=Pr(t,Br.current);Ss(t,i),r=Aa(null,t,n,e,r,i);var a=Sa();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Lr(n)?(a=!0,Fr(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ps(t),r.updater=zs,t.stateNode=r,r._reactInternals=t,qs(t,n,e,i),t=Vo(null,t,n,!0,a,i)):(t.tag=0,rs&&a&&es(t),bo(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch(jo(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"===typeof e)return Lu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===B)return 11;if(e===P)return 14}return 2}(n),e=ps(n,e),r){case 0:t=ko(null,t,n,e,i);break e;case 1:t=Bo(null,t,n,e,i);break e;case 11:t=wo(null,t,n,e,i);break e;case 14:t=Ao(null,t,n,ps(n.type,e),i);break e}throw Error(s(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,ko(e,t,n,r=t.elementType===n?r:ps(n,r),i);case 1:return n=t.type,r=t.pendingProps,Bo(e,t,n,r=t.elementType===n?r:ps(n,r),i);case 3:e:{if(To(t),null===e)throw Error(s(387));n=t.pendingProps,r=(a=t.memoizedState).element,Ls(e,t),Gs(t,n,null,i);var o=t.memoizedState;if(n=o.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Po(e,t,n,i,r=uo(Error(s(423)),t));break e}if(n!==r){t=Po(e,t,n,i,r=uo(Error(s(424)),t));break e}for(ns=ur(t.stateNode.containerInfo.firstChild),is=t,rs=!0,ss=null,i=Qs(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(ds(),n===r){t=Wo(e,t,i);break e}bo(e,t,n,i)}t=t.child}return t;case 5:return sa(t),null===e&&us(t),n=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,o=r.children,ir(n,r)?o=null:null!==a&&ir(n,a)&&(t.flags|=32),Co(e,t),bo(e,t,o,i),t.child;case 6:return null===e&&us(t),null;case 13:return Go(e,t,i);case 4:return na(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Zs(t,null,n,i):bo(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,wo(e,t,n,r=t.elementType===n?r:ps(n,r),i);case 7:return bo(e,t,t.pendingProps,i),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,a=t.memoizedProps,o=r.value,Cr(vs,n._currentValue),n._currentValue=o,null!==a)if(on(a.value,o)){if(a.children===r.children&&!Vr.current){t=Wo(e,t,i);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var u=l.firstContext;null!==u;){if(u.context===n){if(1===a.tag){(u=Es(-1,i&-i)).tag=2;var h=a.updateQueue;if(null!==h){var c=(h=h.shared).pending;null===c?u.next=u:(u.next=c.next,c.next=u),h.pending=u}}a.lanes|=i,null!==(u=a.alternate)&&(u.lanes|=i),As(a.return,i,t),l.lanes|=i;break}u=u.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=i,null!==(l=o.alternate)&&(l.lanes|=i),As(o,i,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}bo(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Ss(t,i),n=n(r=Ms(r)),t.flags|=1,bo(e,t,n,i),t.child;case 14:return r=ps(n=t.type,t.pendingProps),Ao(e,t,n,r=ps(n.type,r),i);case 15:return So(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:ps(n,r),jo(e,t),t.tag=1,Lr(n)?(e=!0,Fr(t)):e=!1,Ss(t,i),js(t,n,r),qs(t,n,r,i),Vo(null,t,n,!0,e,i);case 19:return Uo(e,t,i);case 22:return Mo(e,t,i)}throw Error(s(156,t.tag))};var Ju="function"===typeof reportError?reportError:function(e){console.error(e)};function Yu(e){this._internalRoot=e}function Zu(e){this._internalRoot=e}function Qu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ku(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $u(){}function eh(e,t,i,n,r){var s=i._reactRootContainer;if(s){var a=s;if("function"===typeof r){var o=r;r=function(){var e=qu(a);o.call(e)}}Wu(t,a,e,r)}else a=function(e,t,i,n,r){if(r){if("function"===typeof n){var s=n;n=function(){var e=qu(a);s.call(e)}}var a=ju(t,n,e,0,null,!1,0,"",$u);return e._reactRootContainer=a,e[mr]=a.current,Un(8===e.nodeType?e.parentNode:e),hu(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof n){var o=n;n=function(){var e=qu(l);o.call(e)}}var l=Nu(e,0,!1,null,0,!1,0,"",$u);return e._reactRootContainer=l,e[mr]=l.current,Un(8===e.nodeType?e.parentNode:e),hu((function(){Wu(t,l,i,n)})),l}(i,t,e,r,n);return qu(a)}Zu.prototype.render=Yu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Wu(e,t,null,null)},Zu.prototype.unmount=Yu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hu((function(){Wu(null,e,null,null)})),t[mr]=null}},Zu.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Et.length&&0!==t&&t<Et[i].priority;i++);Et.splice(i,0,e),0===i&&Gt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=ct(t.pendingLanes);0!==i&&(yt(t,1|i),nu(t,Qe()),0===(6&Bl)&&(Ul=Qe()+500,Ur()))}break;case 13:hu((function(){var t=Vs(e,1);if(null!==t){var i=eu();iu(t,e,1,i)}})),Xu(e,1)}},wt=function(e){if(13===e.tag){var t=Vs(e,134217728);if(null!==t)iu(t,e,134217728,eu());Xu(e,134217728)}},At=function(e){if(13===e.tag){var t=tu(e),i=Vs(e,t);if(null!==i)iu(i,e,t,eu());Xu(e,t)}},St=function(){return gt},Mt=function(e,t){var i=gt;try{return gt=e,t()}finally{gt=i}},we=function(e,t,i){switch(t){case"input":if(K(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=br(n);if(!r)throw Error(s(90));X(n),K(n,r)}}}break;case"textarea":se(e,i);break;case"select":null!=(t=i.value)&&ie(e,!!i.multiple,t,!1)}},Be=uu,Ve=hu;var th={usingClientEntryPoint:!1,Events:[gr,xr,br,Ce,ke,uu]},ih={findFiberByHostInstance:yr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nh={bundleType:ih.bundleType,version:ih.version,rendererPackageName:ih.rendererPackageName,rendererConfig:ih.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:ih.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rh.isDisabled&&rh.supportsFiber)try{rt=rh.inject(nh),st=rh}catch(he){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=th,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qu(t))throw Error(s(200));return zu(e,t,null,i)},t.createRoot=function(e,t){if(!Qu(e))throw Error(s(299));var i=!1,n="",r=Ju;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Nu(e,1,!1,null,0,i,0,n,r),e[mr]=t.current,Un(8===e.nodeType?e.parentNode:e),new Yu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return hu(e)},t.hydrate=function(e,t,i){if(!Ku(t))throw Error(s(200));return eh(null,e,t,!0,i)},t.hydrateRoot=function(e,t,i){if(!Qu(e))throw Error(s(405));var n=null!=i&&i.hydratedSources||null,r=!1,a="",o=Ju;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(a=i.identifierPrefix),void 0!==i.onRecoverableError&&(o=i.onRecoverableError)),t=ju(t,null,e,1,null!=i?i:null,r,0,a,o),e[mr]=t.current,Un(e),n)for(e=0;e<n.length;e++)r=(r=(i=n[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new Zu(t)},t.render=function(e,t,i){if(!Ku(t))throw Error(s(200));return eh(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!Ku(e))throw Error(s(40));return!!e._reactRootContainer&&(hu((function(){eh(null,null,e,!1,(function(){e._reactRootContainer=null,e[mr]=null}))})),!0)},t.unstable_batchedUpdates=uu,t.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!Ku(i))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eh(e,t,i,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},1739:function(e,t,i){"use strict";var n=i(1168);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},1168:function(e,t,i){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(534)},5918:function(e,t,i){"use strict";var n=i(7313),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,i){var n,s={},u=null,h=null;for(n in void 0!==i&&(u=""+i),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(h=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:r,type:e,key:u,ref:h,props:s,_owner:o.current}}t.jsx=u,t.jsxs=u},306:function(e,t){"use strict";var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,p={};function v(e,t,i){this.props=e,this.context=t,this.refs=p,this.updater=i||m}function y(){}function g(e,t,i){this.props=e,this.context=t,this.refs=p,this.updater=i||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=g.prototype=new y;x.constructor=g,_(x,v.prototype),x.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,A={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function M(e,t,n){var r,s={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)w.call(t,r)&&!S.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];s.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:i,type:e,key:a,ref:o,props:s,_owner:A.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var k=/\/+/g;function B(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function V(e,t,r,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case n:l=!0}}if(l)return a=a(l=e),e=""===s?"."+B(l,0):s,b(a)?(r="",null!=e&&(r=e.replace(k,"$&/")+"/"),V(a,t,r,"",(function(e){return e}))):null!=a&&(C(a)&&(a=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(k,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",b(e))for(var u=0;u<e.length;u++){var h=s+B(o=e[u],u);l+=V(o,t,r,h,a)}else if(h=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof h)for(e=h.call(e),u=0;!(o=e.next()).done;)l+=V(o=o.value,t,r,h=s+B(o,u++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,i){if(null==e)return e;var n=[],r=0;return V(e,n,"","",(function(e){return t.call(i,e,r++)})),n}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},E={transition:null},I={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:E,ReactCurrentOwner:A};t.Children={map:T,forEach:function(e,t,i){T(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=a,t.PureComponent=g,t.StrictMode=s,t.Suspense=h,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=_({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=A.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)w.call(t,u)&&!S.hasOwnProperty(u)&&(r[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:i,type:e.type,key:s,ref:a,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=M,t.createFactory=function(e){var t=M.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.transition;E.transition={};try{e()}finally{E.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return L.current.useCallback(e,t)},t.useContext=function(e){return L.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return L.current.useDeferredValue(e)},t.useEffect=function(e,t){return L.current.useEffect(e,t)},t.useId=function(){return L.current.useId()},t.useImperativeHandle=function(e,t,i){return L.current.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return L.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return L.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return L.current.useMemo(e,t)},t.useReducer=function(e,t,i){return L.current.useReducer(e,t,i)},t.useRef=function(e){return L.current.useRef(e)},t.useState=function(e){return L.current.useState(e)},t.useSyncExternalStore=function(e,t,i){return L.current.useSyncExternalStore(e,t,i)},t.useTransition=function(){return L.current.useTransition()},t.version="18.2.0"},7313:function(e,t,i){"use strict";e.exports=i(306)},6417:function(e,t,i){"use strict";e.exports=i(5918)},3095:function(e,t){"use strict";function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var n=i-1>>>1,r=e[n];if(!(0<s(r,t)))break e;e[n]=t,e[i]=r,i=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length,a=r>>>1;n<a;){var o=2*(n+1)-1,l=e[o],u=o+1,h=e[u];if(0>s(l,i))u<r&&0>s(h,l)?(e[n]=h,e[u]=i,n=u):(e[n]=l,e[o]=i,n=o);else{if(!(u<r&&0>s(h,i)))break e;e[n]=h,e[u]=i,n=u}}}return t}function s(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],h=[],c=1,f=null,d=3,m=!1,_=!1,p=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,g="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=n(h);null!==t;){if(null===t.callback)r(h);else{if(!(t.startTime<=e))break;r(h),t.sortIndex=t.expirationTime,i(u,t)}t=n(h)}}function b(e){if(p=!1,x(e),!_)if(null!==n(u))_=!0,E(w);else{var t=n(h);null!==t&&I(b,t.startTime-e)}}function w(e,i){_=!1,p&&(p=!1,y(C),C=-1),m=!0;var s=d;try{for(x(i),f=n(u);null!==f&&(!(f.expirationTime>i)||e&&!V());){var a=f.callback;if("function"===typeof a){f.callback=null,d=f.priorityLevel;var o=a(f.expirationTime<=i);i=t.unstable_now(),"function"===typeof o?f.callback=o:f===n(u)&&r(u),x(i)}else r(u);f=n(u)}if(null!==f)var l=!0;else{var c=n(h);null!==c&&I(b,c.startTime-i),l=!1}return l}finally{f=null,d=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var A,S=!1,M=null,C=-1,k=5,B=-1;function V(){return!(t.unstable_now()-B<k)}function T(){if(null!==M){var e=t.unstable_now();B=e;var i=!0;try{i=M(!0,e)}finally{i?A():(S=!1,M=null)}}else S=!1}if("function"===typeof g)A=function(){g(T)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,L=P.port2;P.port1.onmessage=T,A=function(){L.postMessage(null)}}else A=function(){v(T,0)};function E(e){M=e,S||(S=!0,A())}function I(e,i){C=v((function(){e(t.unstable_now())}),i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){_||m||(_=!0,E(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var i=d;d=t;try{return e()}finally{d=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=d;d=e;try{return t()}finally{d=i}},t.unstable_scheduleCallback=function(e,r,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:c++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,i(h,e),null===n(u)&&e===n(h)&&(p?(y(C),C=-1):p=!0,I(b,s-a))):(e.sortIndex=o,i(u,e),_||m||(_=!0,E(w))),e},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(e){var t=d;return function(){var i=d;d=t;try{return e.apply(this,arguments)}finally{d=i}}}},2224:function(e,t,i){"use strict";e.exports=i(3095)},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,i){var n=i(3897);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,i){var n=i(6015),r=i(9617);function s(t,i,a){return r()?(e.exports=s=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=s=function(e,t,i){var r=[null];r.push.apply(r,t);var s=new(Function.bind.apply(e,r));return i&&n(s,i.prototype),s},e.exports.__esModule=!0,e.exports.default=e.exports),s.apply(null,arguments)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e){function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,i){var n=i(6116);e.exports=function(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw a}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,i){var n=i(3808),r=i(9617),s=i(4993);e.exports=function(e){var t=r();return function(){var i,r=n(e);if(t){var a=n(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return s(this,i)}},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,i){var n=i(1753);function r(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(e,t,i){var r=n(e,t);if(r){var s=Object.getOwnPropertyDescriptor(r,t);return s.get?s.get.call(arguments.length<3?e:i):s.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(i){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,i){var n=i(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var i=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,s=[],a=!0,o=!1;try{for(i=i.call(e);!(a=(n=i.next()).done)&&(s.push(n.value),!t||s.length!==t);a=!0);}catch(l){o=!0,r=l}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,i){var n=i(8698).default,r=i(6115);e.exports=function(e,t){if(t&&("object"===n(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,i){var n=i(8698).default;function r(){"use strict";e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},i=Object.prototype,s=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function h(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(V){h=function(e,t,i){return e[t]=i}}function c(e,t,i,n){var r=t&&t.prototype instanceof m?t:m,s=Object.create(r.prototype),a=new C(n||[]);return s._invoke=function(e,t,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return B()}for(i.method=r,i.arg=s;;){var a=i.delegate;if(a){var o=A(a,i);if(o){if(o===d)continue;return o}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var l=f(e,t,i);if("normal"===l.type){if(n=i.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n="completed",i.method="throw",i.arg=l.arg)}}}(e,i,a),s}function f(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(V){return{type:"throw",arg:V}}}t.wrap=c;var d={};function m(){}function _(){}function p(){}var v={};h(v,o,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(k([])));g&&g!==i&&s.call(g,o)&&(v=g);var x=p.prototype=m.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,a,o,l){var u=f(e[r],e,a);if("throw"!==u.type){var h=u.arg,c=h.value;return c&&"object"==n(c)&&s.call(c,"__await")?t.resolve(c.__await).then((function(e){i("next",e,o,l)}),(function(e){i("throw",e,o,l)})):t.resolve(c).then((function(e){h.value=e,o(h)}),(function(e){return i("throw",e,o,l)}))}l(u.arg)}var r;this._invoke=function(e,n){function s(){return new t((function(t,r){i(e,n,t,r)}))}return r=r?r.then(s,s):s()}}function A(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,A(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=f(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var r=n.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function k(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(s.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:B}}function B(){return{value:void 0,done:!0}}return _.prototype=p,h(x,"constructor",p),h(p,"constructor",_),_.displayName=h(p,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,h(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},b(w.prototype),h(w.prototype,l,(function(){return this})),t.AsyncIterator=w,t.async=function(e,i,n,r,s){void 0===s&&(s=Promise);var a=new w(c(e,i,n,r),s);return t.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(x),h(x,u,"Generator"),h(x,o,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var n=t.pop();if(n in e)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=k,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(i,n){return a.type="throw",a.arg=e,t.next=i,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var o=s.call(r,"catchLoc"),l=s.call(r,"finallyLoc");if(o&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),M(i),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var r=n.arg;M(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:k(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(i,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(i,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,i){var n=i(5372),r=i(8872),s=i(6116),a=i(2218);e.exports=function(e,t){return n(e)||r(e,t)||s(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,i){var n=i(3808);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,i){var n=i(3405),r=i(9498),s=i(6116),a=i(2281);e.exports=function(e){return n(e)||r(e)||s(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(i){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,i){var n=i(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}i.m=e,i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var s=Object.create(null);i.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((function(e){a[e]=function(){return n[e]}}));return a.default=function(){return n},i.d(s,a),s}}(),i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,n){return i.f[n](e,t),t}),[]))},i.u=function(e){return"static/js/"+e+".d9b6a5c6.chunk.js"},i.miniCssF=function(e){},i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="7-11-plinko:";i.l=function(n,r,s,a){if(e[n])e[n].push(r);else{var o,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),h=0;h<u.length;h++){var c=u[h];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==t+s){o=c;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",t+s),o.src=n),e[n]=[r];var f=function(t,i){o.onerror=o.onload=null,clearTimeout(d);var r=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((function(e){return e(i)})),t)return t(i)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=f.bind(null,o.onerror),o.onload=f.bind(null,o.onload),l&&document.head.appendChild(o)}}}(),i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="./",function(){var e={179:0};i.f.j=function(t,n){var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var s=new Promise((function(i,n){r=e[t]=[i,n]}));n.push(r[2]=s);var a=i.p+i.u(t),o=new Error;i.l(a,(function(n){if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,r[1](o)}}),"chunk-"+t,t)}};var t=function(t,n){var r,s,a=n[0],o=n[1],l=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(r in o)i.o(o,r)&&(i.m[r]=o[r]);if(l)l(i)}for(t&&t(n);u<a.length;u++)s=a[u],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0},n=self.webpackChunk_7_11_plinko=self.webpackChunk_7_11_plinko||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),function(){"use strict";var e,t=i(1739),n=i(7313),r=i.t(n,2);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function a(e,t){if(e){if("string"===typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(e,t):void 0}}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,s=[],a=!0,o=!1;try{for(i=i.call(e);!(a=(n=i.next()).done)&&(s.push(n.value),!t||s.length!==t);a=!0);}catch(l){o=!0,r=l}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return s}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){if(t&&("object"===p(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function g(e){var t=_();return function(){var i,n=m(e);if(t){var r=m(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return y(this,i)}}function x(e,t,i){return x=_()?Reflect.construct.bind():function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&f(r,i.prototype),r},x.apply(null,arguments)}function b(e){var t="function"===typeof Map?new Map:void 0;return b=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return x(e,arguments,m(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)},b(e)}function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},w.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));var A,S="popstate";function M(e){return{usr:e.state,key:e.key}}function C(e,t,i,n){return void 0===i&&(i=null),w({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?B(t):t,{state:i,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function k(e){var t=e.pathname,i=void 0===t?"/":t,n=e.search,r=void 0===n?"":n,s=e.hash,a=void 0===s?"":s;return r&&"?"!==r&&(i+="?"===r.charAt(0)?r:"?"+r),a&&"#"!==a&&(i+="#"===a.charAt(0)?a:"#"+a),i}function B(e){var t={};if(e){var i=e.indexOf("#");i>=0&&(t.hash=e.substr(i),e=e.substr(0,i));var n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function V(t,i,n,r){void 0===r&&(r={});var s=r,a=s.window,o=void 0===a?document.defaultView:a,l=s.v5Compat,u=void 0!==l&&l,h=o.history,c=e.Pop,f=null;function d(){c=e.Pop,f&&f({action:c,location:m.location})}var m={get action(){return c},get location(){return t(o,h)},listen:function(e){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(S,d),f=e,function(){o.removeEventListener(S,d),f=null}},createHref:function(e){return i(o,e)},push:function(t,i){c=e.Push;var r=C(m.location,t,i);n&&n(r,t);var s=M(r),a=m.createHref(r);try{h.pushState(s,"",a)}catch(l){o.location.assign(a)}u&&f&&f({action:c,location:r})},replace:function(t,i){c=e.Replace;var r=C(m.location,t,i);n&&n(r,t);var s=M(r),a=m.createHref(r);h.replaceState(s,"",a),u&&f&&f({action:c,location:r})},go:function(e){return h.go(e)}};return m}function T(e,t,i){void 0===i&&(i="/");var n=G(("string"===typeof t?B(t):t).pathname||"/",i);if(null==n)return null;var r=P(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var i=e.length===t.length&&e.slice(0,-1).every((function(e,i){return e===t[i]}));return i?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(r);for(var s=null,a=0;null==s&&a<r.length;++a)s=R(r[a],n);return s}function P(e,t,i,n){return void 0===t&&(t=[]),void 0===i&&(i=[]),void 0===n&&(n=""),e.forEach((function(e,r){var s={relativePath:e.path||"",caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};s.relativePath.startsWith("/")&&(D(s.relativePath.startsWith(n),'Absolute route path "'+s.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(n.length));var a=U([n,s.relativePath]),o=i.concat(s);e.children&&e.children.length>0&&(D(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),P(e.children,t,o,a)),(null!=e.path||e.index)&&t.push({path:a,score:I(a,e.index),routesMeta:o})})),t}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(A||(A={}));var L=/^:\w+$/,E=function(e){return"*"===e};function I(e,t){var i=e.split("/"),n=i.length;return i.some(E)&&(n+=-2),t&&(n+=2),i.filter((function(e){return!E(e)})).reduce((function(e,t){return e+(L.test(t)?3:""===t?1:10)}),n)}function R(e,t){for(var i=e.routesMeta,n={},r="/",s=[],a=0;a<i.length;++a){var o=i[a],l=a===i.length-1,u="/"===r?t:t.slice(r.length)||"/",h=F({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},u);if(!h)return null;Object.assign(n,h.params);var c=o.route;s.push({params:n,pathname:U([r,h.pathname]),pathnameBase:j(U([r,h.pathnameBase])),route:c}),"/"!==h.pathnameBase&&(r=U([r,h.pathnameBase]))}return s}function F(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var i=function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=!0);O("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var n=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(e,t){return n.push(t),"([^\\/]+)"}));e.endsWith("*")?(n.push("*"),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");return[new RegExp(r,t?void 0:"i"),n]}(e.path,e.caseSensitive,e.end),n=o(i,2),r=n[0],s=n[1],a=t.match(r);if(!a)return null;var l=a[0],u=l.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:s.reduce((function(e,t,i){if("*"===t){var n=h[i]||"";u=l.slice(0,l.length-n.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(i){return O(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+i+")."),e}}(h[i]||"",t),e}),{}),pathname:l,pathnameBase:u,pattern:e}}function G(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var i=t.endsWith("/")?t.length-1:t.length,n=e.charAt(i);return n&&"/"!==n?null:e.slice(i)||"/"}function D(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function O(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(i){}}}function N(e,t,i,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+i+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function z(e,t,i,n){var r;void 0===n&&(n=!1),"string"===typeof e?r=B(e):(D(!(r=w({},e)).pathname||!r.pathname.includes("?"),N("?","pathname","search",r)),D(!r.pathname||!r.pathname.includes("#"),N("#","pathname","hash",r)),D(!r.search||!r.search.includes("#"),N("#","search","hash",r)));var s,a=""===e||""===r.pathname,o=a?"/":r.pathname;if(n||null==o)s=i;else{var l=t.length-1;if(o.startsWith("..")){for(var u=o.split("/");".."===u[0];)u.shift(),l-=1;r.pathname=u.join("/")}s=l>=0?t[l]:"/"}var h=function(e,t){void 0===t&&(t="/");var i="string"===typeof e?B(e):e,n=i.pathname,r=i.search,s=void 0===r?"":r,a=i.hash,o=void 0===a?"":a,l=n?n.startsWith("/")?n:function(e,t){var i=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?i.length>1&&i.pop():"."!==e&&i.push(e)})),i.length>1?i.join("/"):"/"}(n,t):t;return{pathname:l,search:W(s),hash:q(o)}}(r,s),c=o&&"/"!==o&&o.endsWith("/"),f=(a||"."===o)&&i.endsWith("/");return h.pathname.endsWith("/")||!c&&!f||(h.pathname+="/"),h}var U=function(e){return e.join("/").replace(/\/\/+/g,"/")},j=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},W=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},q=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},H=function(e){d(i,e);var t=g(i);function i(){return u(this,i),t.apply(this,arguments)}return c(i)}(b(Error));var X=c((function e(t,i,n){u(this,e),this.status=t,this.statusText=i||"",this.data=n}));function J(e){return e instanceof X}function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Y.apply(this,arguments)}var Z="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Q=n.useState,K=n.useEffect,$=n.useLayoutEffect,ee=n.useDebugValue;function te(e){var t=e.getSnapshot,i=e.value;try{var n=t();return!Z(i,n)}catch(r){return!0}}"undefined"===typeof window||"undefined"===typeof window.document||window.document.createElement,r.useSyncExternalStore;var ie=n.createContext(null);var ne=n.createContext(null);var re=n.createContext(null);var se=n.createContext(null);var ae=n.createContext(null);var oe=n.createContext(null);var le=n.createContext({outlet:null,matches:[]});var ue=n.createContext(null);function he(){return null!=n.useContext(oe)}function ce(){return he()||D(!1),n.useContext(oe).location}function fe(e){return e.filter((function(t,i){return 0===i||!t.route.index&&t.pathnameBase!==e[i-1].pathnameBase}))}function de(){he()||D(!1);var e=n.useContext(ae),t=e.basename,i=e.navigator,r=n.useContext(le).matches,s=ce().pathname,a=JSON.stringify(fe(r).map((function(e){return e.pathnameBase}))),o=n.useRef(!1);return n.useEffect((function(){o.current=!0})),n.useCallback((function(e,n){if(void 0===n&&(n={}),o.current)if("number"!==typeof e){var r=z(e,JSON.parse(a),s,"path"===n.relative);"/"!==t&&(r.pathname="/"===r.pathname?t:U([t,r.pathname])),(n.replace?i.replace:i.push)(r,n.state,n)}else i.go(e)}),[t,i,a,s])}function me(){var e=function(){var e,t=n.useContext(ue),i=xe(pe.UseRouteError),r=n.useContext(le),s=r.matches[r.matches.length-1];if(t)return t;return r||D(!1),!s.route.id&&D(!1),null==(e=i.errors)?void 0:e[s.route.id]}(),t=J(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r};return n.createElement(n.Fragment,null,n.createElement("h2",null,"Unhandled Thrown Error!"),n.createElement("h3",{style:{fontStyle:"italic"}},t),i?n.createElement("pre",{style:s},i):null,n.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),n.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own\xa0",n.createElement("code",{style:a},"errorElement")," props on\xa0",n.createElement("code",{style:a},"<Route>")))}var _e,pe,ve=function(e){d(i,e);var t=g(i);function i(e){var n;return u(this,i),(n=t.call(this,e)).state={location:e.location,error:e.error},n}return c(i,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?n.createElement(ue.Provider,{value:this.state.error,children:this.props.component}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}}]),i}(n.Component);function ye(e){var t=e.routeContext,i=e.match,r=e.children,s=n.useContext(ie);return s&&i.route.errorElement&&(s._deepestRenderedBoundaryId=i.route.id),n.createElement(le.Provider,{value:t},r)}function ge(e,t,i){if(void 0===t&&(t=[]),null==e){if(null==i||!i.errors)return null;e=i.matches}var r=e,s=null==i?void 0:i.errors;if(null!=s){var a=r.findIndex((function(e){return e.route.id&&(null==s?void 0:s[e.route.id])}));a>=0||D(!1),r=r.slice(0,Math.min(r.length,a+1))}return r.reduceRight((function(e,a,o){var l=a.route.id?null==s?void 0:s[a.route.id]:null,u=i?a.route.errorElement||n.createElement(me,null):null,h=function(){return n.createElement(ye,{match:a,routeContext:{outlet:e,matches:t.concat(r.slice(0,o+1))}},l?u:void 0!==a.route.element?a.route.element:e)};return i&&(a.route.errorElement||0===o)?n.createElement(ve,{location:i.location,component:u,error:l,children:h()}):h()}),null)}function xe(e){var t=n.useContext(re);return t||D(!1),t}!function(e){e.UseRevalidator="useRevalidator"}(_e||(_e={})),function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(pe||(pe={}));var be;function we(e){var t=e.to,i=e.replace,r=e.state,s=e.relative;he()||D(!1);var a=n.useContext(re),o=de();return n.useEffect((function(){a&&"idle"!==a.navigation.state||o(t,{replace:i,state:r,relative:s})})),null}function Ae(e){D(!1)}function Se(t){var i=t.basename,r=void 0===i?"/":i,s=t.children,a=void 0===s?null:s,o=t.location,l=t.navigationType,u=void 0===l?e.Pop:l,h=t.navigator,c=t.static,f=void 0!==c&&c;he()&&D(!1);var d=r.replace(/^\/*/,"/"),m=n.useMemo((function(){return{basename:d,navigator:h,static:f}}),[d,h,f]);"string"===typeof o&&(o=B(o));var _=o,p=_.pathname,v=void 0===p?"/":p,y=_.search,g=void 0===y?"":y,x=_.hash,b=void 0===x?"":x,w=_.state,A=void 0===w?null:w,S=_.key,M=void 0===S?"default":S,C=n.useMemo((function(){var e=G(v,d);return null==e?null:{pathname:e,search:g,hash:b,state:A,key:M}}),[d,v,g,b,A,M]);return null==C?null:n.createElement(ae.Provider,{value:m},n.createElement(oe.Provider,{children:a,value:{location:C,navigationType:u}}))}function Me(t){var i=t.children,r=t.location,s=n.useContext(ne);return function(t,i){he()||D(!1);var r,s=n.useContext(re),a=n.useContext(le).matches,o=a[a.length-1],l=o?o.params:{},u=(o&&o.pathname,o?o.pathnameBase:"/"),h=(o&&o.route,ce());if(i){var c,f="string"===typeof i?B(i):i;"/"===u||(null==(c=f.pathname)?void 0:c.startsWith(u))||D(!1),r=f}else r=h;var d=r.pathname||"/",m=T(t,{pathname:"/"===u?d:d.slice(u.length)||"/"}),_=ge(m&&m.map((function(e){return Object.assign({},e,{params:Object.assign({},l,e.params),pathname:U([u,e.pathname]),pathnameBase:"/"===e.pathnameBase?u:U([u,e.pathnameBase])})})),a,s||void 0);return i?n.createElement(oe.Provider,{value:{location:Y({pathname:"/",search:"",hash:"",state:null,key:"default"},r),navigationType:e.Pop}},_):_}(s&&!i?s.router.routes:ke(i),r)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(be||(be={}));var Ce=new Promise((function(){}));n.Component;function ke(e,t){void 0===t&&(t=[]);var i=[];return n.Children.forEach(e,(function(e,r){if(n.isValidElement(e))if(e.type!==n.Fragment){e.type!==Ae&&D(!1),e.props.index&&e.props.children&&D(!1);var s=[].concat(l(t),[r]),a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,hasErrorBoundary:null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle};e.props.children&&(a.children=ke(e.props.children,s)),i.push(a)}else i.push.apply(i,ke(e.props.children,t))})),i}function Be(e){var t,i=e.basename,r=e.children,s=e.window,a=n.useRef();null==a.current&&(a.current=(void 0===(t={window:s,v5Compat:!0})&&(t={}),V((function(e,t){var i=e.location;return C("",{pathname:i.pathname,search:i.search,hash:i.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:k(t)}),null,t)));var l=a.current,u=o(n.useState({action:l.action,location:l.location}),2),h=u[0],c=u[1];return n.useLayoutEffect((function(){return l.listen(c)}),[l]),n.createElement(Se,{basename:i,children:r,location:h.location,navigationType:h.action,navigator:l})}var Ve,Te;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(Ve||(Ve={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Te||(Te={}));var Pe="Layout_container__I-Od9";function Le(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ee(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ie(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(i),!0).forEach((function(t){Le(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ee(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Re=i(8041),Fe=new(i.n(Re)().EventEmitter),Ge="Modal_container__rEvDl",De=i(6417),Oe=function(){var e=o((0,n.useState)({visible:!1,child:null}),2),t=e[0],i=e[1];return(0,n.useEffect)((function(){var e=function(e){i((function(t){return Ie(Ie({},t),e)}))};return Fe.addListener("changeModalState",e),function(){Fe.removeListener("changeModalState",e)}}),[]),t.visible?(0,De.jsx)("div",{className:Ge,children:t.child}):null},Ne=function(e){var t=e.children;return(0,De.jsxs)("div",{className:Pe,children:[(0,De.jsx)(Oe,{}),t]})};function ze(e){var t,i,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(i=ze(e[t]))&&(n&&(n+=" "),n+=i);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}var Ue=function(){for(var e,t,i=0,n="";i<arguments.length;)(e=arguments[i++])&&(t=ze(e))&&(n&&(n+=" "),n+=t);return n},je={btnGreen:"TextButton_btnGreen__tHKEG",btnOrange:"TextButton_btnOrange__AoVaj"},We=function(e){var t=e.label,i=e.onClick,r=void 0===i?function(){}:i,s=e.className,a=void 0===s?"":s,o=e.disabled,l=void 0!==o&&o,u=e.greenStyle,h=void 0!==u&&u,c=(0,n.useCallback)((function(e){e.stopPropagation(),l||r&&r()}),[r,l]);return(0,De.jsx)("div",{className:Ue(h?je.btnGreen:je.btnOrange,l?je.btnDisabled:null,a),onClick:function(e){return c(e)},children:(0,De.jsx)("span",{children:t})})};function qe(){qe=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function o(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(k){o=function(e,t,i){return e[t]=i}}function l(e,t,i,n){var r=t&&t.prototype instanceof c?t:c,s=Object.create(r.prototype),a=new S(n||[]);return s._invoke=function(e,t,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return C()}for(i.method=r,i.arg=s;;){var a=i.delegate;if(a){var o=b(a,i);if(o){if(o===h)continue;return o}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var l=u(e,t,i);if("normal"===l.type){if(n=i.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n="completed",i.method="throw",i.arg=l.arg)}}}(e,i,a),s}function u(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(k){return{type:"throw",arg:k}}}e.wrap=l;var h={};function c(){}function f(){}function d(){}var m={};o(m,r,(function(){return this}));var _=Object.getPrototypeOf,v=_&&_(_(M([])));v&&v!==t&&i.call(v,r)&&(m=v);var y=d.prototype=c.prototype=Object.create(m);function g(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(r,s,a,o){var l=u(e[r],e,s);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==p(c)&&i.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,a,o)}),(function(e){n("throw",e,a,o)})):t.resolve(c).then((function(e){h.value=e,a(h)}),(function(e){return n("throw",e,a,o)}))}o(l.arg)}var r;this._invoke=function(e,i){function s(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(s,s):s()}}function b(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=u(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var r=n.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function M(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return s.next=s}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=d,o(y,"constructor",d),o(d,"constructor",f),f.displayName=o(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},g(x.prototype),o(x.prototype,s,(function(){return this})),e.AsyncIterator=x,e.async=function(t,i,n,r,s){void 0===s&&(s=Promise);var a=new x(l(t,i,n,r),s);return e.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(y),o(y,a,"Generator"),o(y,r,(function(){return this})),o(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var n=t.pop();if(n in e)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=M,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(i,n){return a.type="throw",a.arg=e,t.next=i,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var o=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(o&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),A(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var r=n.arg;A(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:M(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}function He(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=a(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}function Xe(e,t,i,n,r,s,a){try{var o=e[s](a),l=o.value}catch(u){return void i(u)}o.done?t(l):Promise.resolve(l).then(n,r)}function Je(e){return function(){var t=this,i=arguments;return new Promise((function(n,r){var s=e.apply(t,i);function a(e){Xe(s,n,r,a,o,"next",e)}function o(e){Xe(s,n,r,a,o,"throw",e)}a(void 0)}))}}var Ye,Ze,Qe,Ke,$e,et,tt,it=i(7276),nt=i(9997),rt=i(2955),st="GAME_EVENTS::REWARD",at="GAME_EVENTS::RESTART",ot="GAME_EVENTS::PLAY",lt=c((function e(){u(this,e)}));function ut(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ht(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}lt.WORLD_WIDTH=600,lt.WORLD_HEIGHT=1e3,lt.PIXEL_PER_METER=100,lt.FIX_DELTA=1/60,lt.PHYSIC_GRAVITY=-5,lt.VELOCITY_ITERATIONS=6,lt.POSITION_ITERATIONS=2,lt.BLOCK_RADIUS=3/lt.PIXEL_PER_METER,lt.TOTAL_BALLS=3,lt.BALL_RADIUS=18/lt.PIXEL_PER_METER,lt.BALL_RESTITUTION=.5,lt.DELTA_RANDOM_RANGE=2/lt.PIXEL_PER_METER,lt.PLATFORM_1_WIDTH=115/lt.PIXEL_PER_METER,lt.PLATFORM_2_WIDTH=175/lt.PIXEL_PER_METER,lt.PLATFORM_HEIGHT=28/lt.PIXEL_PER_METER,lt.PLATFORM_SPEED=300/lt.PIXEL_PER_METER,lt.PLATFORM_MOVING_DISTANCE=360,lt.DROPPER_SPEED=200,lt.DROPPER_POSTION_Y=lt.WORLD_HEIGHT-165,lt.PLATFORM_1_Y=457/lt.PIXEL_PER_METER,lt.PLATFORM_2_Y=367/lt.PIXEL_PER_METER;var ct,ft,dt,mt,_t,pt,vt,yt,gt,xt,bt,wt,At,St,Mt,Ct,kt,Bt,Vt,Tt,Pt,Lt,Et,It,Rt,Ft,Gt,Dt=(Ye=(0,nt.tB)("ball"),Ze=(0,nt.tB)("levelState"),Qe=(0,nt.tB)("mapData"),Ke=function(e){d(i,e);var t=g(i);function i(){var e;u(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return ut(e=t.call.apply(t,[this].concat(r)),"ball",$e,v(e)),ut(e,"levelState",et,v(e)),ut(e,"mapData",tt,v(e)),e.dropperDirection=1,e.boundLeft=void 0,e.boundRight=void 0,e.ballPos=new it.b2Vec2,e}return c(i,[{key:"initialized",value:function(){this.boundRight=lt.WORLD_WIDTH-150,this.boundLeft=150}},{key:"processMovingBall",value:function(){if(!this.levelState.ballDrop){var e=this.dropperDirection*lt.FIX_DELTA*lt.DROPPER_SPEED;this.levelState.dropperPos.x=this.levelState.dropperPos.x+e,(this.levelState.dropperPos.x<=this.boundLeft||this.levelState.dropperPos.x>=this.boundRight)&&(this.dropperDirection*=-1,this.levelState.dropperPos.x=this.dropperDirection>0?this.boundLeft:this.boundRight),this.ball.SetPositionXY(this.levelState.dropperPos.x/lt.PIXEL_PER_METER,this.levelState.dropperPos.y/lt.PIXEL_PER_METER)}}},{key:"processHitGiftBox",value:function(){if(this.levelState.ballDrop){this.ballPos.Copy(this.ball.GetPosition()).SelfMul(lt.PIXEL_PER_METER);for(var e=0;e<this.mapData.giftBoxs.length;e++){var t=this.mapData.giftBoxs[e];(0,rt.pointInRect)(this.ballPos.x,this.ballPos.y,t.x,t.y-t.height,t.width,t.height)&&(this.levelState.endGame=!0,this.ball.SetGravityScale(0),this.ball.SetActive(!1),Fe.emit(st))}}}},{key:"process",value:function(){this.levelState.endGame||(this.processMovingBall(),this.processHitGiftBox())}}]),i}(nt.xP),$e=ht(Ke.prototype,"ball",[Ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et=ht(Ke.prototype,"levelState",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tt=ht(Ke.prototype,"mapData",[Qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke),Ot=(ct=(0,nt.tB)("blocks"),ft=function(e){d(i,e);var t=g(i);function i(){var e;u(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return ut(e=t.call.apply(t,[this].concat(r)),"blocks",dt,v(e)),e.blockDirections=[1,-1],e.boundLeft=void 0,e.boundRight=void 0,e}return c(i,[{key:"callculateBound",value:function(e){this.boundRight=(lt.WORLD_WIDTH-.5*(lt.WORLD_WIDTH-lt.PLATFORM_MOVING_DISTANCE))/lt.PIXEL_PER_METER-e/2,this.boundLeft=e/2+.5*(lt.WORLD_WIDTH-lt.PLATFORM_MOVING_DISTANCE)/lt.PIXEL_PER_METER}},{key:"process",value:function(){for(var e=0;e<this.blocks.length;e++){e>=this.blockDirections.length&&(this.blockDirections[e]=1);var t=this.blocks[e],i=this.blockDirections[e]*lt.FIX_DELTA*lt.PLATFORM_SPEED,n=t.GetPosition();this.callculateBound(0===e?lt.PLATFORM_1_WIDTH:lt.PLATFORM_2_WIDTH);var r={x:n.x+i,y:n.y};(r.x<=this.boundLeft||r.x>=this.boundRight)&&(this.blockDirections[e]*=-1,r.x=this.blockDirections[e]>0?this.boundLeft:this.boundRight),t.SetPosition(r)}}}]),i}(nt.xP),dt=ht(ft.prototype,"blocks",[ct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft),Nt=function(e,t){var i=new it.b2BodyDef,n=e.CreateBody(i);return n.SetType(t),n},zt=function(e,t,i){var n=Nt(e,t),r=new it.b2CircleShape(i),s=new it.b2FixtureDef;return s.shape=r,s.density=1,n.CreateFixture(s),n},Ut=function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=Nt(e,t),a=new it.b2PolygonShape;a.SetAsBox(i.x/2,i.y/2,n);var o=new it.b2FixtureDef;o.shape=a,o.density=1,o.friction=.5;var l=s.CreateFixture(o);return l.SetSensor(r),s},jt=function(e,t,i){var n=Nt(e,t),r=new it.b2PolygonShape;r.SetAsArray(i);var s=new it.b2FixtureDef;return s.shape=r,s.density=1,s.friction=.5,n.CreateFixture(s),n},Wt=(mt=(0,nt.tB)("blocks"),_t=(0,nt.tB)("blockBodies"),pt=(0,nt.tB)("physicWorld"),vt=(0,nt.tB)("ball"),yt=(0,nt.tB)("levelState"),gt=(0,nt.tB)("mapData"),xt=function(e){d(i,e);var t=g(i);function i(){var e;u(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return ut(e=t.call.apply(t,[this].concat(r)),"blocks",bt,v(e)),ut(e,"blockBodies",wt,v(e)),ut(e,"physicWorld",At,v(e)),ut(e,"balls",St,v(e)),ut(e,"levelState",Mt,v(e)),ut(e,"mapData",Ct,v(e)),e.tempV2=new rt.Vector2,e}return c(i,[{key:"createBlock",value:function(e,t,i,n){var r={x:i,y:n},s=Ut(this.physicWorld,it.b2BodyType.b2_staticBody,r);return s.SetPositionXY(e,t),s}},{key:"getRandomPlatfomPosX",value:function(e){return lt.WORLD_WIDTH-lt.PLATFORM_MOVING_DISTANCE+Math.random()*(lt.PLATFORM_MOVING_DISTANCE-e)+e/2}},{key:"initialized",value:function(){var e,t=He(this.mapData.blocks);try{for(t.s();!(e=t.n()).done;){var i=e.value,n=zt(this.physicWorld,it.b2BodyType.b2_staticBody,lt.BLOCK_RADIUS);n.GetFixtureList().SetFriction(0),n.SetPositionXY(i.x/lt.PIXEL_PER_METER,i.y/lt.PIXEL_PER_METER)}}catch(y){t.e(y)}finally{t.f()}var r=this.createBlock(this.getRandomPlatfomPosX(lt.PLATFORM_1_WIDTH),lt.PLATFORM_1_Y,lt.PLATFORM_1_WIDTH,lt.PLATFORM_HEIGHT),s=this.createBlock(this.getRandomPlatfomPosX(lt.PLATFORM_2_WIDTH),lt.PLATFORM_2_Y,lt.PLATFORM_2_WIDTH,lt.PLATFORM_HEIGHT);this.blocks.push(r),this.blocks.push(s);var a,o=[],l=He(this.mapData.boundaries);try{for(l.s();!(a=l.n()).done;){var u=a.value;o.length=0;var h,c=He(u.polygon);try{for(c.s();!(h=c.n()).done;){var f=h.value;o.push({x:f.x/lt.PIXEL_PER_METER,y:-1*f.y/lt.PIXEL_PER_METER})}}catch(y){c.e(y)}finally{c.f()}var d=jt(this.physicWorld,it.b2BodyType.b2_staticBody,o);d.GetFixtureList().SetFriction(0),d.SetPositionXY(u.position.x/lt.PIXEL_PER_METER,u.position.y/lt.PIXEL_PER_METER)}}catch(y){l.e(y)}finally{l.f()}var m,_=He(this.mapData.giftBoxs);try{for(_.s();!(m=_.n()).done;){var p=m.value,v={x:p.width/lt.PIXEL_PER_METER,y:p.height/lt.PIXEL_PER_METER};Ut(this.physicWorld,it.b2BodyType.b2_staticBody,v,{x:v.x/2,y:-v.y/2},!0).SetPosition({x:p.x/lt.PIXEL_PER_METER,y:p.y/lt.PIXEL_PER_METER})}}catch(y){_.e(y)}finally{_.f()}}},{key:"process",value:function(){this.physicWorld.Step(lt.FIX_DELTA,lt.VELOCITY_ITERATIONS,lt.POSITION_ITERATIONS)}}]),i}(nt.xP),bt=ht(xt.prototype,"blocks",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=ht(xt.prototype,"blockBodies",[_t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=ht(xt.prototype,"physicWorld",[pt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St=ht(xt.prototype,"balls",[vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mt=ht(xt.prototype,"levelState",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct=ht(xt.prototype,"mapData",[gt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt),qt=new rt.Vector2(-2,-9),Ht=(kt=(0,nt.tB)("assetManager"),Bt=(0,nt.tB)("polygonBatch"),Vt=(0,nt.tB)("levelState"),Tt=(0,nt.tB)("ball"),Pt=(0,nt.tB)("blocks"),Lt=function(e){d(i,e);var t=g(i);function i(){var e;u(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return ut(e=t.call.apply(t,[this].concat(r)),"assetManager",Et,v(e)),ut(e,"polygonBatch",It,v(e)),ut(e,"levelState",Rt,v(e)),ut(e,"ball",Ft,v(e)),ut(e,"blocks",Gt,v(e)),e.backgroundRegion=void 0,e.topCoverRegion=void 0,e.ballRegions=void 0,e.platformRegions=void 0,e.ballShadowRegion=void 0,e.dropperRegion=void 0,e.ballSize=0,e.temp=new it.b2Vec2,e}return c(i,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("ui_atlas");this.ballRegions=e.findRegions("ball"),this.platformRegions=e.findRegions("platform"),this.ballShadowRegion=e.findRegion("ball_shadow"),this.backgroundRegion=e.findRegion("game_machine"),this.topCoverRegion=e.findRegion("top_cover"),this.dropperRegion=e.findRegion("dropper"),this.ballSize=lt.BALL_RADIUS*lt.PIXEL_PER_METER*2}},{key:"process",value:function(){this.polygonBatch.begin(),this.backgroundRegion.draw(this.polygonBatch,0,0,this.backgroundRegion.originalWidth,this.backgroundRegion.originalHeight),this.dropperRegion.draw(this.polygonBatch,this.levelState.dropperPos.x-this.dropperRegion.width/2,this.levelState.dropperPos.y-this.ballSize+10,this.dropperRegion.originalWidth,this.dropperRegion.originalHeight),this.topCoverRegion.draw(this.polygonBatch,0,this.backgroundRegion.height-this.topCoverRegion.height-8,this.topCoverRegion.originalWidth,this.topCoverRegion.originalHeight),this.temp.Copy(this.ball.GetPosition()).SelfMul(lt.PIXEL_PER_METER).SelfSubXY(this.ballSize/2,this.ballSize/2),this.ballShadowRegion.draw(this.polygonBatch,this.temp.x+qt.x,this.temp.y+qt.y,this.ballSize,this.ballSize),this.ballRegions[this.levelState.ballIndex].draw(this.polygonBatch,this.temp.x,this.temp.y,this.ballSize,this.ballSize,this.ballSize/2,this.ballSize/2,this.ball.GetAngle());for(var e=0;e<this.blocks.length;e++){var t=this.blocks[e];this.temp.Copy(t.GetPosition()).SelfMul(lt.PIXEL_PER_METER),this.platformRegions[e].draw(this.polygonBatch,this.temp.x-this.platformRegions[e].originalWidth/2,this.temp.y-this.platformRegions[e].originalHeight/2-12,this.platformRegions[e].originalWidth,this.platformRegions[e].originalHeight)}this.polygonBatch.end()}}]),i}(nt.xP),Et=ht(Lt.prototype,"assetManager",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=ht(Lt.prototype,"polygonBatch",[Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rt=ht(Lt.prototype,"levelState",[Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=ht(Lt.prototype,"ball",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=ht(Lt.prototype,"blocks",[Pt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt),Xt=function(){var e=Je(qe().mark((function e(t){var i,n,r,s,a,o,l,u,h,c,f,d,m,_,p,v,y,g,x,b,w,A,S,M,C,k,B,V,T,P,L;return qe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,rt.createViewport)(t,lt.WORLD_WIDTH,lt.WORLD_HEIGHT),n=i.getContext(),r=i.getCamera(),s=new rt.PolygonBatch(n,!0),a=new rt.ShapeRenderer(n),(o=new rt.AssetManager(n)).loadAtlas("./assets/atlas/ui_atlas.atlas","ui_atlas"),e.next=9,o.finishLoading();case 9:return(l=new it.b2World({x:0,y:lt.PHYSIC_GRAVITY})).SetAllowSleeping(!1),l.SetContinuousPhysics(!0),u=[],h=[],c={boundaries:[],blocks:[],giftBoxs:[]},e.next=17,fetch("./assets/layout.json").then((function(e){return e.json()}));case 17:f=e.sent,d=f.layers.find((function(e){return"boundaries"===e.name})),m=f.layers.find((function(e){return"blocks"===e.name})),_=f.layers.find((function(e){return"gift_boxs"===e.name})),p=He(d.objects),e.prev=22,p.s();case 24:if((v=p.n()).done){e.next=33;break}if((y=v.value).polygon){e.next=28;break}return e.abrupt("continue",31);case 28:if(!(y.polygon.length<3)){e.next=30;break}return e.abrupt("continue",31);case 30:c.boundaries.push({polygon:y.polygon,position:{x:y.x,y:lt.WORLD_HEIGHT-y.y}});case 31:e.next=24;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(22),p.e(e.t0);case 38:return e.prev=38,p.f(),e.finish(38);case 41:g=He(m.objects);try{for(g.s();!(x=g.n()).done;)b=x.value,c.blocks.push({x:b.x,y:lt.WORLD_HEIGHT-b.y})}catch(E){g.e(E)}finally{g.f()}w=He(_.objects);try{for(w.s();!(A=w.n()).done;)(S=A.value).y=lt.WORLD_HEIGHT-S.y,c.giftBoxs.push(S)}catch(E){w.e(E)}finally{w.f()}return M=function(){return Math.floor(Math.random()*lt.TOTAL_BALLS)},C={ballDrop:!1,dropperPos:new rt.Vector2(.5*lt.WORLD_WIDTH,lt.DROPPER_POSTION_Y),ballIndex:M(),endGame:!1},(k=zt(l,it.b2BodyType.b2_dynamicBody,lt.BALL_RADIUS)).SetPosition({x:C.dropperPos.x/lt.PIXEL_PER_METER,y:C.dropperPos.y/lt.PIXEL_PER_METER}),(B=k.GetFixtureList()).m_restitution=lt.BALL_RESTITUTION,B.m_friction=.5,k.SetGravityScale(0),V=function(){C.ballDrop||(k.SetGravityScale(1),C.ballDrop=!0,console.log("play"))},Fe.addListener(ot,V),T=function(){k.SetActive(!0),k.SetGravityScale(0),k.SetLinearVelocity({x:0,y:0}),C.endGame=!1,C.ballDrop=!1,C.ballIndex=M(),C.dropperPos.set(.5*lt.WORLD_WIDTH,lt.DROPPER_POSTION_Y),k.SetPosition({x:C.dropperPos.x/lt.PIXEL_PER_METER,y:C.dropperPos.y/lt.PIXEL_PER_METER}),console.log("rs")},Fe.addListener(at,T),(P=new nt.q3).register("gl",n),P.register("viewport",i),P.register("camera",r),P.register("mapData",c),P.register("polygonBatch",s),P.register("shapeRenderer",a),P.register("assetManager",o),P.register("physicWorld",l),P.register("blockBodies",u),P.register("ball",k),P.register("blocks",h),P.register("levelState",C),P.addSystem(new Ht,!1),P.addSystem(new Wt,!0),P.addSystem(new Ot,!0),P.addSystem(new Dt,!0),L=(0,rt.createGameLoop)((function(e){s.setProjection(r.combined),P.setDelta(lt.FIX_DELTA),P.processActiveSystem(),P.processPassiveSystem()})),e.abrupt("return",{stop:function(){L.stop(),s.dispose(),Fe.removeListener(ot,V),Fe.removeListener(at,T)}});case 76:case"end":return e.stop()}}),e,null,[[22,35,38,41]])})));return function(t){return e.apply(this,arguments)}}(),Jt=Xt,Yt=i(6510),Zt=new Map,Qt=new Map,Kt=function(e){return new Promise((function(t){var i=new Yt.Howl({src:["./assets/sound/".concat(e,".mp3")]});i.once("load",(function(){Zt.set(e,i),t()}))}))},$t=function(e){return new Promise((function(t){var i=new Yt.Howl({src:["./assets/sound/".concat(e,".mp3")]});i.once("load",(function(){Qt.set(e,i),t()}))}))},ei=function(){var e=Je(qe().mark((function e(){return qe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kt("drop_ball");case 2:return e.next=4,Kt("reward");case 4:return e.next=6,$t("gameplay_music");case 6:return e.next=8,$t("lobby_music");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ti=function(e){var t=Qt.get(e);t&&(t.loop(!0),t.play())},ii=function(e){var t=Zt.get(e);t&&t.play()},ni="GameScreen_container__7z5h-",ri="GameScreen_canvasContainer__T0Ccg",si="GameScreen_canvas__l7mPT",ai="GameScreen_footer__5LCgS",oi="GameScreen_btnPlay__GUHxV",li="GameScreen_button__SIlYm",ui=function(){var e=(0,n.useRef)(),t=(0,n.useRef)(null),i=o((0,n.useState)(0),2)[1];(0,n.useEffect)((function(){e.current&&i(e.current.clientHeight)}),[e]),(0,n.useEffect)((function(){var e=t.current,i=Jt(e);return function(){return i.then((function(e){return e.stop()}))}}),[t]),ti("gameplay_music");var r=de();return(0,De.jsxs)("div",{className:ni,children:[(0,De.jsx)("div",{ref:e,className:ri,children:(0,De.jsx)("canvas",{className:si,ref:t})}),(0,De.jsxs)("div",{className:ai,children:[(0,De.jsxs)("div",{className:li,children:[(0,De.jsx)("p",{children:"Quay l\u1ea1i"}),(0,De.jsx)("img",{src:"./assets/texture/btn_back.svg",alt:"btnBack",onClick:function(){ti("lobby_music"),r("/")}})]}),(0,De.jsx)(We,{className:oi,label:"TH\u1ea2",onClick:function(){Fe.emit(ot)}}),(0,De.jsxs)("div",{className:li,children:[(0,De.jsx)("p",{children:"Qu\xe0 c\u1ee7a t\xf4i"}),(0,De.jsx)("img",{src:"./assets/texture/btn_reward.svg",alt:"btnReward",onClick:function(){ti("lobby_music"),r("/reward")}})]})]})]})},hi="GuideScreen_container__x69ie",ci="GuideScreen_titleImage__pnAUl",fi="GuideScreen_background__9e+OT",di="GuideScreen_contentContainer__hWTHp",mi="GuideScreen_btnBack__FX9dF",_i=function(){var e=de();return(0,De.jsxs)("div",{className:hi,children:[(0,De.jsx)("img",{className:fi,src:"assets/texture/bg_guide.svg",alt:"bg"}),(0,De.jsx)("img",{className:ci,src:"assets/texture/title_guide.png",alt:"title"}),(0,De.jsx)("div",{className:di,children:(0,De.jsx)("p",{children:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."})}),(0,De.jsx)("img",{src:"./assets/texture/btn_home.svg",className:mi,onClick:function(){return e("/")},alt:"btn"})]})},pi="Leaderboard_container__2i0h6",vi="Leaderboard_lbContainer__5WQ5U",yi="Leaderboard_blueTable__K4is+",gi="Leaderboard_td1__jHA7T",xi="Leaderboard_td2__0k2c-",bi="Leaderboard_td3__Kfd84",wi="Leaderboard_tdCenter__9iybi",Ai="Leaderboard_thCenter__7e1Zv",Si="Leaderboard_btnBack__7PwUj",Mi="Leaderboard_titleImage__LIxFv",Ci=[{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3},{userID:"323012339123",amount:1e3}],ki=function(){var e=de();return(0,De.jsxs)("div",{className:pi,children:[(0,De.jsx)("img",{className:Mi,src:"assets/texture/leaderboard_title.png",alt:"title"}),(0,De.jsx)("div",{className:vi,children:(0,De.jsxs)("table",{className:yi,children:[(0,De.jsx)("thead",{children:(0,De.jsxs)("tr",{children:[(0,De.jsx)("th",{children:"#"}),(0,De.jsx)("th",{className:Ai,children:"ID kh\xe1ch h\xe0ng"}),(0,De.jsx)("th",{children:"T\u1ed5ng l\u01b0\u1ee3t quay"})]})}),(0,De.jsxs)("tbody",{children:[Ci.map((function(e,t){return(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:gi,children:t+1}),(0,De.jsx)("td",{className:xi,children:e.userID}),(0,De.jsx)("td",{className:bi,children:e.amount})]},t)})),(0,De.jsx)("tr",{children:(0,De.jsx)("td",{className:wi,colSpan:3,children:(0,De.jsx)("span",{children:"TH\u1ee8 H\u1ea0NG C\u1ee6A B\u1ea0N"})})}),(0,De.jsxs)("tr",{children:[(0,De.jsx)("td",{className:gi,children:1}),(0,De.jsx)("td",{className:xi,children:"323012339123"}),(0,De.jsx)("td",{className:bi,children:"1000"})]})]})]})}),(0,De.jsx)("img",{src:"./assets/texture/btn_home.svg",className:Si,onClick:function(){return e("/")},alt:"btn"})]})},Bi="MenuScreen_container__918qU",Vi="MenuScreen_decor__SmR57",Ti="MenuScreen_buttonContainer__8klQM",Pi="MenuScreen_btnPlay__gdfco",Li="MenuScreen_text__zVtqq",Ei=function(){var e=de();return ti("lobby_music"),(0,De.jsxs)("div",{className:Bi,children:[(0,De.jsx)("img",{className:Vi,src:"assets/texture/main_decor.png",alt:"decor"}),(0,De.jsxs)("div",{className:Ti,children:[(0,De.jsx)(We,{label:"CH\u01a0I NGAY",className:Pi,onClick:function(){return e("/game")}}),(0,De.jsx)(We,{label:"KHO QU\xc0 C\u1ee6A B\u1ea0N",greenStyle:!0,onClick:function(){return e("/reward")}}),(0,De.jsx)(We,{label:"B\u1ea2NG X\u1ebeP H\u1ea0NG",greenStyle:!0,onClick:function(){return e("/leaderboard")}}),(0,De.jsx)(We,{label:"TH\xcaM L\u01af\u1ee2T",greenStyle:!0,onClick:function(){return e("/quest")}})]}),(0,De.jsx)("p",{className:Li,onClick:function(){return e("/guide")},children:"H\u01af\u1edaNG D\u1eaaN, TH\u1ec2 L\u1ec6 CH\u01af\u01a0NG TR\xccNH"})]})},Ii=function(){Fe.emit("changeModalState",{visible:!1,child:null})},Ri="PopupReward_container__XgDFU",Fi="PopupReward_titleImage__Ui6WD",Gi="PopupReward_background__tzA9W",Di="PopupReward_contentContainer__BkU3+",Oi="PopupReward_title__OFRsI",Ni="PopupReward_btnContainer__byBZ4",zi=function(){var e=de();return(0,n.useEffect)((function(){ii("reward")})),(0,De.jsxs)("div",{className:Ri,children:[(0,De.jsx)("img",{className:Gi,src:"assets/texture/bg_reward_popup.svg",alt:"bg"}),(0,De.jsx)("img",{className:Fi,src:"assets/texture/popup_reward_title_0.png",alt:"title"}),(0,De.jsxs)("div",{className:Di,children:[(0,De.jsx)("img",{src:"./assets/texture/reward_robotCleaner_big.png"}),(0,De.jsx)("span",{className:Oi,children:"ROBOT H\xdaT B\u1ee4I XIAOMI VACUUM MOP 2 BHR5055"}),(0,De.jsx)("p",{children:"L\u01b0\u1ee3t ch\u01a1i c\xf2n l\u1ea1i: 2"}),(0,De.jsxs)("div",{className:Ni,children:[(0,De.jsx)(We,{label:"CH\u01a0I TI\u1ebeP",onClick:function(){Ii(),Fe.emit(at)}}),(0,De.jsx)(We,{label:"KHO QU\xc0",greenStyle:!0,onClick:function(){Ii(),ii("lobby_music"),e("/reward")}})]})]})]})},Ui="QuestContent_container__ua1Db",ji="QuestContent_background__CK3Jg",Wi="QuestContent_title__wWTUL",qi="QuestContent_textContainer__GSoq4",Hi=function(e){var t=e.title,i=e.description,n=e.conditions,r=n.length>1?"img_quest_tab_2.png":"img_quest_tab.png";return(0,De.jsxs)("div",{className:Ui,children:[(0,De.jsx)("img",{src:"./assets/texture/".concat(r),className:ji,alt:"bg"}),(0,De.jsx)("p",{className:Wi,children:t}),(0,De.jsxs)("div",{className:qi,children:[(0,De.jsx)("p",{children:i}),(0,De.jsx)("span",{children:"\u0110i\u1ec1u ki\u1ec7n:"}),n.map((function(e,t){return(0,De.jsx)("p",{children:e},t)}))]})]})},Xi="QuestScreen_container__GDk6o",Ji="QuestScreen_titleImage__4qUdn",Yi="QuestScreen_background__viDhu",Zi="QuestScreen_contentContainer__DvSaQ",Qi="QuestScreen_btnBack__Ih6TW",Ki=[{title:"\u0110\u0103ng nh\u1eadp App",description:"\u0110\u0103ng nh\u1eadp app 7-Eleven l\u1ea7n \u0111\u1ea7u nh\u1eadn ngay 1 l\u01b0\u1ee3t ch\u01a1i.",conditions:["T\u1ed1i \u0111a 1 l\u1ea7n / kh\xe1ch h\xe0ng / ch\u01b0\u01a1ng tr\xecnh."]},{title:"\u01afu \u0111\xe3i mua h\xe0ng",description:"H\xf3a \u0111\u01a1n t\u1eeb 80,000\u0111 t\xedch \u0111\u01b0\u1ee3c 1 l\u01b0\u1ee3t ch\u01a1i.",conditions:["T\u1ed1i \u0111a 1 l\u1ea7n / kh\xe1ch h\xe0ng / ch\u01b0\u01a1ng tr\xecnh."]},{title:"T\xedch \u0111i\u1ec3m th\xeam vui",description:"M\u1ed7i 1,000\u0111 chi ti\xeau t\u1ea1i 7-Eleven t\xedch \u0111\u01b0\u1ee3c 1 \u0111i\u1ec3m. \u0110\u1ed5i 400 \u0111i\u1ec3m \u0111\u01b0\u1ee3c 1 l\u01b0\u1ee3t ch\u01a1i.",conditions:["C\xf3 t\xedch \u0111i\u1ec3m tr\xean app 7-Eleven.","Ch\u1ec9 \xe1p d\u1ee5ng cho c\xe1c \u0111i\u1ec3m t\xedch l\u0169y \u0111\u01b0\u1ee3c trong th\u1eddi gian di\u1ec5n ra ch\u01b0\u01a1ng tr\xecnh."]}],$i=function(){var e=de();return(0,De.jsxs)("div",{className:Xi,children:[(0,De.jsx)("img",{className:Ji,src:"assets/texture/quest_title.png",alt:"title"}),(0,De.jsx)("img",{className:Yi,src:"assets/texture/bg_quest.svg",alt:"bg"}),(0,De.jsx)("div",{className:Zi,children:Ki.map((function(e,t){return(0,De.jsx)(Hi,{title:e.title,description:e.description,conditions:e.conditions},t)}))}),(0,De.jsx)("img",{src:"./assets/texture/btn_home.svg",className:Qi,onClick:function(){return e("/")},alt:"btn"})]})},en="RewardScreen_container__m4H5+",tn="RewardScreen_titleImage__CrSd2",nn="RewardScreen_background__XjGXI",rn="RewardScreen_rewardContainer__s7lEP",sn="RewardScreen_rewardContent__rFQYF",an="RewardScreen_textContainer__o-Fne",on="RewardScreen_buttonDetail__jET6W",ln="RewardScreen_btnBack__Ya1ru",un="electricBike",hn={electricBike:"Xe m\xe1y \u0111i\u1ec7n Vinfast Klara A2",robotCleaner:"Robot h\xfat b\u1ee5i Xiaomi Vacuum Mop 2 BHR5055",juicer:"M\xe1y \xe9p ch\u1eadm"},cn=[{type:un,date:"21/10/2022"},{type:"robotCleaner",date:"21/10/2022"},{type:un,date:"21/10/2022"},{type:"juicer",date:"21/10/2022"},{type:un,date:"21/10/2022"}],fn=function(){var e=de();return(0,De.jsxs)("div",{className:en,children:[(0,De.jsx)("img",{className:tn,src:"assets/texture/reward_screen_title.png",alt:"title"}),(0,De.jsx)("img",{className:nn,src:"assets/texture/bg_reward_screen.svg",alt:"bg"}),(0,De.jsx)("div",{className:rn,children:cn.map((function(e,t){return(0,De.jsxs)("div",{className:sn,children:[(0,De.jsx)("img",{src:"assets/texture/reward_".concat(e.type,".png"),alt:"img"}),(0,De.jsxs)("div",{className:an,children:[(0,De.jsx)("span",{children:hn[e.type]}),(0,De.jsx)("p",{children:"Ng\xe0y nh\u1eadn: ".concat(e.date)})]}),(0,De.jsx)(We,{label:"Chi ti\u1ebft",className:on})]},t)}))}),(0,De.jsx)("img",{src:"./assets/texture/btn_home.svg",className:ln,onClick:function(){return e("/")},alt:"btn"})]})},dn=function(){return Fe.addListener(st,(function(){var e;e=(0,De.jsx)(zi,{}),Fe.emit("changeModalState",{visible:!0,child:e})})),ei().then((function(){ti("lobby_music")})),(0,De.jsx)(Be,{children:(0,De.jsx)(Ne,{children:(0,De.jsx)(Me,{children:(0,De.jsxs)(n.Fragment,{children:[(0,De.jsx)(Ae,{path:"*",element:(0,De.jsx)(we,{to:"/"})}),(0,De.jsx)(Ae,{path:"/",element:(0,De.jsx)(Ei,{})}),(0,De.jsx)(Ae,{path:"/game",element:(0,De.jsx)(ui,{})}),(0,De.jsx)(Ae,{path:"/reward",element:(0,De.jsx)(fn,{})}),(0,De.jsx)(Ae,{path:"/leaderboard",element:(0,De.jsx)(ki,{})}),(0,De.jsx)(Ae,{path:"/quest",element:(0,De.jsx)($i,{})}),(0,De.jsx)(Ae,{path:"/guide",element:(0,De.jsx)(_i,{})})]})})})})},mn=function(){return(0,De.jsx)(dn,{})},_n=function(e){e&&e instanceof Function&&i.e(27).then(i.bind(i,4027)).then((function(t){var i=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;i(e),n(e),r(e),s(e),a(e)}))};t.createRoot(document.getElementById("root")).render((0,De.jsx)(mn,{})),_n()}()}();